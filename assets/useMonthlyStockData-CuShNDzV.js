import{r as l}from"./router-C0wDHNfv.js";import{P as v}from"./csv-B1Pu-2A6.js";const T=()=>{const[g,y]=l.useState([]),[w,M]=l.useState([]),[S,i]=l.useState(!0),[$,p]=l.useState(null),d=async()=>{try{i(!0),p(null),console.log("ðŸ” Attempting to load monthly stock data...");const c=["https://raw.githubusercontent.com/datamilo/put-options-se/main/data/Stocks_Monthly_Data.csv","/data/Stocks_Monthly_Data.csv"];let r="",u="";for(const t of c)try{console.log(`ðŸŒ Trying to fetch from: ${t}`);const n=t.includes("github")?`${t}?${Date.now()}`:t,a=await fetch(n);if(console.log(`ðŸ“¨ Response status: ${a.status} for ${t}`),a.ok){r=await a.text(),u=t,console.log(`âœ… Successfully loaded from: ${t}`),console.log(`ðŸ“„ CSV length: ${r.length} characters`),console.log(`ðŸ“„ First 200 chars: ${r.substring(0,200)}`);break}else console.log(`âŒ Failed to load from ${t}: ${a.status} ${a.statusText}`)}catch(n){console.warn(`âŒ Failed to fetch from ${t}:`,n)}if(!r)throw new Error("Could not load monthly stock data from GitHub or local source. Please check if the file exists and is accessible.");const _=v.parse(r,{header:!0,skipEmptyLines:!0,delimiter:"|",transform:(t,n)=>n==="month"?{Jan:1,Feb:2,Mar:3,Apr:4,May:5,Jun:6,Jul:7,Aug:8,Sep:9,Oct:10,Nov:11,Dec:12}[t]||parseInt(t)||0:["year","day_low_day_of_month","day_high_day_of_month"].includes(n)?parseInt(t)||0:["open","high","low","close","close_previous_month","low_previous_month","pct_return_month","pct_open_to_low","pct_low_to_high","pct_low_previous_month_to_low_current_month"].includes(n)?parseFloat(t)||0:t});_.errors.length>0&&console.warn("ðŸ“ CSV parsing warnings:",_.errors);const e=_.data.filter(t=>t.name&&t.month&&t.year);console.log(`ðŸ“Š Parsed ${e.length} monthly records`),console.log("ðŸ“Š Sample records:",e.slice(0,3)),y(e);const o=k(e);console.log(`ðŸ“ˆ Calculated stats for ${o.length} stock-month combinations`),M(o)}catch(c){console.error("âŒ Error loading monthly data:",c),p(c instanceof Error?c.message:"Unknown error occurred")}finally{i(!1)}},k=c=>{const r=new Map,u=c.reduce((e,o)=>{const t=`${o.name}-${o.month}`;return e[t]||(e[t]=[]),e[t].push(o),e},{});for(const[e,o]of Object.entries(u)){const[t,n]=e.split("-"),a=parseInt(n),f=o.filter(s=>s.pct_return_month>=0).length,h=o.length,b=o.reduce((s,m)=>s+m.pct_return_month,0)/h,x=o.reduce((s,m)=>s+m.pct_open_to_low,0)/h,D=Math.min(...o.map(s=>s.pct_open_to_low)),E=Math.max(...o.map(s=>s.pct_open_to_low));r.set(e,{name:t,month:a,number_of_months_available:h,number_of_months_positive_return:f,pct_pos_return_months:f/h*100,return_month_mean_pct_return_month:b*100,open_to_low_mean_pct_return_month:x,open_to_low_min_pct_return_month:D,open_to_low_max_pct_return_month:E,top_5_accumulated_score:0})}return Array.from(r.values())};return l.useEffect(()=>{d()},[]),{monthlyData:g,monthlyStats:w,isLoading:S,error:$,loadMonthlyData:d}};export{T as u};
