var IS=Object.defineProperty;var J0=e=>{throw TypeError(e)};var MS=(e,t,r)=>t in e?IS(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Q0=(e,t,r)=>MS(e,typeof t!="symbol"?t+"":t,r),kd=(e,t,r)=>t.has(e)||J0("Cannot "+r);var ue=(e,t,r)=>(kd(e,t,"read from private field"),r?r.call(e):t.get(e)),ot=(e,t,r)=>t.has(e)?J0("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),Ve=(e,t,r,n)=>(kd(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),nr=(e,t,r)=>(kd(e,t,"access private method"),r);var Gl=(e,t,r,n)=>({set _(s){Ve(e,t,s,r)},get _(){return ue(e,t,n)}});import{r as m,a as Vr,R as me,b as vh,$ as $g,d as FS,c as nn}from"./vendor-CAvPZb_x.js";import{c as Wg,R as Is,S as LS,C as rs,X as ns,Y as Fn,T as ss,L as Ac,a as BS,B as Sc,b as Es,_ as zr,d as yh,e as Z0,f as $S,g as Nc,h as WS}from"./charts-BNqDWXbe.js";import{u as ms,a as wh,b as Ug,c as _h,L as Dc,N as US,B as VS,R as HS,d as Kn}from"./router-Dywlzqul.js";import{P as Sa}from"./csv-fP-G1a8P.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();var Vg={exports:{}},vu={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zS=m,GS=Symbol.for("react.element"),KS=Symbol.for("react.fragment"),YS=Object.prototype.hasOwnProperty,XS=zS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,qS={key:!0,ref:!0,__self:!0,__source:!0};function Hg(e,t,r){var n,s={},a=null,i=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)YS.call(t,n)&&!qS.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:GS,type:e,key:a,ref:i,props:s,_owner:XS.current}}vu.Fragment=KS;vu.jsx=Hg;vu.jsxs=Hg;Vg.exports=vu;var l=Vg.exports,zg,em=Vr;zg=em.createRoot,em.hydrateRoot;const JS=1,QS=1e6;let Pd=0;function ZS(){return Pd=(Pd+1)%Number.MAX_SAFE_INTEGER,Pd.toString()}const Ad=new Map,tm=e=>{if(Ad.has(e))return;const t=setTimeout(()=>{Ad.delete(e),To({type:"REMOVE_TOAST",toastId:e})},QS);Ad.set(e,t)},e2=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,JS)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(r=>r.id===t.toast.id?{...r,...t.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=t;return r?tm(r):e.toasts.forEach(n=>{tm(n.id)}),{...e,toasts:e.toasts.map(n=>n.id===r||r===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(r=>r.id!==t.toastId)}}},Ec=[];let Tc={toasts:[]};function To(e){Tc=e2(Tc,e),Ec.forEach(t=>{t(Tc)})}function Cc({...e}){const t=ZS(),r=s=>To({type:"UPDATE_TOAST",toast:{...s,id:t}}),n=()=>To({type:"DISMISS_TOAST",toastId:t});return To({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:s=>{s||n()}}}),{id:t,dismiss:n,update:r}}function t2(){const[e,t]=m.useState(Tc);return m.useEffect(()=>(Ec.push(t),()=>{const r=Ec.indexOf(t);r>-1&&Ec.splice(r,1)}),[e]),{...e,toast:Cc,dismiss:r=>To({type:"DISMISS_TOAST",toastId:r})}}function he(e,t,{checkForDefaultPrevented:r=!0}={}){return function(s){if(e==null||e(s),r===!1||!s.defaultPrevented)return t==null?void 0:t(s)}}function r2(e,t){typeof e=="function"?e(t):e!=null&&(e.current=t)}function yu(...e){return t=>e.forEach(r=>r2(r,t))}function Me(...e){return m.useCallback(yu(...e),e)}function n2(e,t=[]){let r=[];function n(a,i){const o=m.createContext(i),c=r.length;r=[...r,i];function u(f){const{scope:h,children:p,...v}=f,g=(h==null?void 0:h[e][c])||o,x=m.useMemo(()=>v,Object.values(v));return l.jsx(g.Provider,{value:x,children:p})}function d(f,h){const p=(h==null?void 0:h[e][c])||o,v=m.useContext(p);if(v)return v;if(i!==void 0)return i;throw new Error(`\`${f}\` must be used within \`${a}\``)}return u.displayName=a+"Provider",[u,d]}const s=()=>{const a=r.map(i=>m.createContext(i));return function(o){const c=(o==null?void 0:o[e])||a;return m.useMemo(()=>({[`__scope${e}`]:{...o,[e]:c}}),[o,c])}};return s.scopeName=e,[n,s2(s,...t)]}function s2(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(a){const i=n.reduce((o,{useScope:c,scopeName:u})=>{const f=c(a)[`__scope${u}`];return{...o,...f}},{});return m.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return r.scopeName=t.scopeName,r}var ls=m.forwardRef((e,t)=>{const{children:r,...n}=e,s=m.Children.toArray(r),a=s.find(a2);if(a){const i=a.props.children,o=s.map(c=>c===a?m.Children.count(i)>1?m.Children.only(null):m.isValidElement(i)?i.props.children:null:c);return l.jsx(yf,{...n,ref:t,children:m.isValidElement(i)?m.cloneElement(i,void 0,o):null})}return l.jsx(yf,{...n,ref:t,children:r})});ls.displayName="Slot";var yf=m.forwardRef((e,t)=>{const{children:r,...n}=e;if(m.isValidElement(r)){const s=o2(r);return m.cloneElement(r,{...i2(n,r.props),ref:t?yu(t,s):s})}return m.Children.count(r)>1?m.Children.only(null):null});yf.displayName="SlotClone";var Gg=({children:e})=>l.jsx(l.Fragment,{children:e});function a2(e){return m.isValidElement(e)&&e.type===Gg}function i2(e,t){const r={...t};for(const n in t){const s=e[n],a=t[n];/^on[A-Z]/.test(n)?s&&a?r[n]=(...o)=>{a(...o),s(...o)}:s&&(r[n]=s):n==="style"?r[n]={...s,...a}:n==="className"&&(r[n]=[s,a].filter(Boolean).join(" "))}return{...e,...r}}function o2(e){var n,s;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function pl(e){const t=e+"CollectionProvider",[r,n]=n2(t),[s,a]=r(t,{collectionRef:{current:null},itemMap:new Map}),i=p=>{const{scope:v,children:g}=p,x=me.useRef(null),y=me.useRef(new Map).current;return l.jsx(s,{scope:v,itemMap:y,collectionRef:x,children:g})};i.displayName=t;const o=e+"CollectionSlot",c=me.forwardRef((p,v)=>{const{scope:g,children:x}=p,y=a(o,g),w=Me(v,y.collectionRef);return l.jsx(ls,{ref:w,children:x})});c.displayName=o;const u=e+"CollectionItemSlot",d="data-radix-collection-item",f=me.forwardRef((p,v)=>{const{scope:g,children:x,...y}=p,w=me.useRef(null),_=Me(v,w),b=a(u,g);return me.useEffect(()=>(b.itemMap.set(w,{ref:w,...y}),()=>void b.itemMap.delete(w))),l.jsx(ls,{[d]:"",ref:_,children:x})});f.displayName=u;function h(p){const v=a(e+"CollectionConsumer",p);return me.useCallback(()=>{const x=v.collectionRef.current;if(!x)return[];const y=Array.from(x.querySelectorAll(`[${d}]`));return Array.from(v.itemMap.values()).sort((b,T)=>y.indexOf(b.ref.current)-y.indexOf(T.ref.current))},[v.collectionRef,v.itemMap])}return[{Provider:i,Slot:c,ItemSlot:f},h,n]}function l2(e,t){const r=m.createContext(t),n=a=>{const{children:i,...o}=a,c=m.useMemo(()=>o,Object.values(o));return l.jsx(r.Provider,{value:c,children:i})};n.displayName=e+"Provider";function s(a){const i=m.useContext(r);if(i)return i;if(t!==void 0)return t;throw new Error(`\`${a}\` must be used within \`${e}\``)}return[n,s]}function bn(e,t=[]){let r=[];function n(a,i){const o=m.createContext(i),c=r.length;r=[...r,i];const u=f=>{var y;const{scope:h,children:p,...v}=f,g=((y=h==null?void 0:h[e])==null?void 0:y[c])||o,x=m.useMemo(()=>v,Object.values(v));return l.jsx(g.Provider,{value:x,children:p})};u.displayName=a+"Provider";function d(f,h){var g;const p=((g=h==null?void 0:h[e])==null?void 0:g[c])||o,v=m.useContext(p);if(v)return v;if(i!==void 0)return i;throw new Error(`\`${f}\` must be used within \`${a}\``)}return[u,d]}const s=()=>{const a=r.map(i=>m.createContext(i));return function(o){const c=(o==null?void 0:o[e])||a;return m.useMemo(()=>({[`__scope${e}`]:{...o,[e]:c}}),[o,c])}};return s.scopeName=e,[n,c2(s,...t)]}function c2(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(a){const i=n.reduce((o,{useScope:c,scopeName:u})=>{const f=c(a)[`__scope${u}`];return{...o,...f}},{});return m.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return r.scopeName=t.scopeName,r}var u2=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Ne=u2.reduce((e,t)=>{const r=m.forwardRef((n,s)=>{const{asChild:a,...i}=n,o=a?ls:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),l.jsx(o,{...i,ref:s})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function bh(e,t){e&&Vr.flushSync(()=>e.dispatchEvent(t))}function Et(e){const t=m.useRef(e);return m.useEffect(()=>{t.current=e}),m.useMemo(()=>(...r)=>{var n;return(n=t.current)==null?void 0:n.call(t,...r)},[])}function d2(e,t=globalThis==null?void 0:globalThis.document){const r=Et(e);m.useEffect(()=>{const n=s=>{s.key==="Escape"&&r(s)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var f2="DismissableLayer",wf="dismissableLayer.update",h2="dismissableLayer.pointerDownOutside",m2="dismissableLayer.focusOutside",rm,Kg=m.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),$a=m.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:a,onInteractOutside:i,onDismiss:o,...c}=e,u=m.useContext(Kg),[d,f]=m.useState(null),h=(d==null?void 0:d.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,p]=m.useState({}),v=Me(t,S=>f(S)),g=Array.from(u.layers),[x]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),y=g.indexOf(x),w=d?g.indexOf(d):-1,_=u.layersWithOutsidePointerEventsDisabled.size>0,b=w>=y,T=g2(S=>{const E=S.target,C=[...u.branches].some(L=>L.contains(E));!b||C||(s==null||s(S),i==null||i(S),S.defaultPrevented||o==null||o())},h),k=x2(S=>{const E=S.target;[...u.branches].some(L=>L.contains(E))||(a==null||a(S),i==null||i(S),S.defaultPrevented||o==null||o())},h);return d2(S=>{w===u.layers.size-1&&(n==null||n(S),!S.defaultPrevented&&o&&(S.preventDefault(),o()))},h),m.useEffect(()=>{if(d)return r&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(rm=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(d)),u.layers.add(d),nm(),()=>{r&&u.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=rm)}},[d,h,r,u]),m.useEffect(()=>()=>{d&&(u.layers.delete(d),u.layersWithOutsidePointerEventsDisabled.delete(d),nm())},[d,u]),m.useEffect(()=>{const S=()=>p({});return document.addEventListener(wf,S),()=>document.removeEventListener(wf,S)},[]),l.jsx(Ne.div,{...c,ref:v,style:{pointerEvents:_?b?"auto":"none":void 0,...e.style},onFocusCapture:he(e.onFocusCapture,k.onFocusCapture),onBlurCapture:he(e.onBlurCapture,k.onBlurCapture),onPointerDownCapture:he(e.onPointerDownCapture,T.onPointerDownCapture)})});$a.displayName=f2;var p2="DismissableLayerBranch",Yg=m.forwardRef((e,t)=>{const r=m.useContext(Kg),n=m.useRef(null),s=Me(t,n);return m.useEffect(()=>{const a=n.current;if(a)return r.branches.add(a),()=>{r.branches.delete(a)}},[r.branches]),l.jsx(Ne.div,{...e,ref:s})});Yg.displayName=p2;function g2(e,t=globalThis==null?void 0:globalThis.document){const r=Et(e),n=m.useRef(!1),s=m.useRef(()=>{});return m.useEffect(()=>{const a=o=>{if(o.target&&!n.current){let c=function(){Xg(h2,r,u,{discrete:!0})};const u={originalEvent:o};o.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=c,t.addEventListener("click",s.current,{once:!0})):c()}else t.removeEventListener("click",s.current);n.current=!1},i=window.setTimeout(()=>{t.addEventListener("pointerdown",a)},0);return()=>{window.clearTimeout(i),t.removeEventListener("pointerdown",a),t.removeEventListener("click",s.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function x2(e,t=globalThis==null?void 0:globalThis.document){const r=Et(e),n=m.useRef(!1);return m.useEffect(()=>{const s=a=>{a.target&&!n.current&&Xg(m2,r,{originalEvent:a},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function nm(){const e=new CustomEvent(wf);document.dispatchEvent(e)}function Xg(e,t,r,{discrete:n}){const s=r.originalEvent.target,a=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&s.addEventListener(e,t,{once:!0}),n?bh(s,a):s.dispatchEvent(a)}var v2=$a,y2=Yg,er=globalThis!=null&&globalThis.document?m.useLayoutEffect:()=>{},w2="Portal",Wi=m.forwardRef((e,t)=>{var o;const{container:r,...n}=e,[s,a]=m.useState(!1);er(()=>a(!0),[]);const i=r||s&&((o=globalThis==null?void 0:globalThis.document)==null?void 0:o.body);return i?vh.createPortal(l.jsx(Ne.div,{...n,ref:t}),i):null});Wi.displayName=w2;function _2(e,t){return m.useReducer((r,n)=>t[r][n]??r,e)}var Kt=e=>{const{present:t,children:r}=e,n=b2(t),s=typeof r=="function"?r({present:n.isPresent}):m.Children.only(r),a=Me(n.ref,S2(s));return typeof r=="function"||n.isPresent?m.cloneElement(s,{ref:a}):null};Kt.displayName="Presence";function b2(e){const[t,r]=m.useState(),n=m.useRef({}),s=m.useRef(e),a=m.useRef("none"),i=e?"mounted":"unmounted",[o,c]=_2(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return m.useEffect(()=>{const u=Kl(n.current);a.current=o==="mounted"?u:"none"},[o]),er(()=>{const u=n.current,d=s.current;if(d!==e){const h=a.current,p=Kl(u);e?c("MOUNT"):p==="none"||(u==null?void 0:u.display)==="none"?c("UNMOUNT"):c(d&&h!==p?"ANIMATION_OUT":"UNMOUNT"),s.current=e}},[e,c]),er(()=>{if(t){let u;const d=t.ownerDocument.defaultView??window,f=p=>{const g=Kl(n.current).includes(p.animationName);if(p.target===t&&g&&(c("ANIMATION_END"),!s.current)){const x=t.style.animationFillMode;t.style.animationFillMode="forwards",u=d.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=x)})}},h=p=>{p.target===t&&(a.current=Kl(n.current))};return t.addEventListener("animationstart",h),t.addEventListener("animationcancel",f),t.addEventListener("animationend",f),()=>{d.clearTimeout(u),t.removeEventListener("animationstart",h),t.removeEventListener("animationcancel",f),t.removeEventListener("animationend",f)}}else c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(o),ref:m.useCallback(u=>{u&&(n.current=getComputedStyle(u)),r(u)},[])}}function Kl(e){return(e==null?void 0:e.animationName)||"none"}function S2(e){var n,s;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function vn({prop:e,defaultProp:t,onChange:r=()=>{}}){const[n,s]=E2({defaultProp:t,onChange:r}),a=e!==void 0,i=a?e:n,o=Et(r),c=m.useCallback(u=>{if(a){const f=typeof u=="function"?u(e):u;f!==e&&o(f)}else s(u)},[a,e,s,o]);return[i,c]}function E2({defaultProp:e,onChange:t}){const r=m.useState(e),[n]=r,s=m.useRef(n),a=Et(t);return m.useEffect(()=>{s.current!==n&&(a(n),s.current=n)},[n,s,a]),r}var T2="VisuallyHidden",gl=m.forwardRef((e,t)=>l.jsx(Ne.span,{...e,ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}}));gl.displayName=T2;var C2=gl,Sh="ToastProvider",[Eh,k2,P2]=pl("Toast"),[qg,hW]=bn("Toast",[P2]),[A2,wu]=qg(Sh),Jg=e=>{const{__scopeToast:t,label:r="Notification",duration:n=5e3,swipeDirection:s="right",swipeThreshold:a=50,children:i}=e,[o,c]=m.useState(null),[u,d]=m.useState(0),f=m.useRef(!1),h=m.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${Sh}\`. Expected non-empty \`string\`.`),l.jsx(Eh.Provider,{scope:t,children:l.jsx(A2,{scope:t,label:r,duration:n,swipeDirection:s,swipeThreshold:a,toastCount:u,viewport:o,onViewportChange:c,onToastAdd:m.useCallback(()=>d(p=>p+1),[]),onToastRemove:m.useCallback(()=>d(p=>p-1),[]),isFocusedToastEscapeKeyDownRef:f,isClosePausedRef:h,children:i})})};Jg.displayName=Sh;var Qg="ToastViewport",N2=["F8"],_f="toast.viewportPause",bf="toast.viewportResume",Zg=m.forwardRef((e,t)=>{const{__scopeToast:r,hotkey:n=N2,label:s="Notifications ({hotkey})",...a}=e,i=wu(Qg,r),o=k2(r),c=m.useRef(null),u=m.useRef(null),d=m.useRef(null),f=m.useRef(null),h=Me(t,f,i.onViewportChange),p=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),v=i.toastCount>0;m.useEffect(()=>{const x=y=>{var _;n.length!==0&&n.every(b=>y[b]||y.code===b)&&((_=f.current)==null||_.focus())};return document.addEventListener("keydown",x),()=>document.removeEventListener("keydown",x)},[n]),m.useEffect(()=>{const x=c.current,y=f.current;if(v&&x&&y){const w=()=>{if(!i.isClosePausedRef.current){const k=new CustomEvent(_f);y.dispatchEvent(k),i.isClosePausedRef.current=!0}},_=()=>{if(i.isClosePausedRef.current){const k=new CustomEvent(bf);y.dispatchEvent(k),i.isClosePausedRef.current=!1}},b=k=>{!x.contains(k.relatedTarget)&&_()},T=()=>{x.contains(document.activeElement)||_()};return x.addEventListener("focusin",w),x.addEventListener("focusout",b),x.addEventListener("pointermove",w),x.addEventListener("pointerleave",T),window.addEventListener("blur",w),window.addEventListener("focus",_),()=>{x.removeEventListener("focusin",w),x.removeEventListener("focusout",b),x.removeEventListener("pointermove",w),x.removeEventListener("pointerleave",T),window.removeEventListener("blur",w),window.removeEventListener("focus",_)}}},[v,i.isClosePausedRef]);const g=m.useCallback(({tabbingDirection:x})=>{const w=o().map(_=>{const b=_.ref.current,T=[b,...V2(b)];return x==="forwards"?T:T.reverse()});return(x==="forwards"?w.reverse():w).flat()},[o]);return m.useEffect(()=>{const x=f.current;if(x){const y=w=>{var T,k,S;const _=w.altKey||w.ctrlKey||w.metaKey;if(w.key==="Tab"&&!_){const E=document.activeElement,C=w.shiftKey;if(w.target===x&&C){(T=u.current)==null||T.focus();return}const j=g({tabbingDirection:C?"backwards":"forwards"}),V=j.findIndex(A=>A===E);Nd(j.slice(V+1))?w.preventDefault():C?(k=u.current)==null||k.focus():(S=d.current)==null||S.focus()}};return x.addEventListener("keydown",y),()=>x.removeEventListener("keydown",y)}},[o,g]),l.jsxs(y2,{ref:c,role:"region","aria-label":s.replace("{hotkey}",p),tabIndex:-1,style:{pointerEvents:v?void 0:"none"},children:[v&&l.jsx(Sf,{ref:u,onFocusFromOutsideViewport:()=>{const x=g({tabbingDirection:"forwards"});Nd(x)}}),l.jsx(Eh.Slot,{scope:r,children:l.jsx(Ne.ol,{tabIndex:-1,...a,ref:h})}),v&&l.jsx(Sf,{ref:d,onFocusFromOutsideViewport:()=>{const x=g({tabbingDirection:"backwards"});Nd(x)}})]})});Zg.displayName=Qg;var ex="ToastFocusProxy",Sf=m.forwardRef((e,t)=>{const{__scopeToast:r,onFocusFromOutsideViewport:n,...s}=e,a=wu(ex,r);return l.jsx(gl,{"aria-hidden":!0,tabIndex:0,...s,ref:t,style:{position:"fixed"},onFocus:i=>{var u;const o=i.relatedTarget;!((u=a.viewport)!=null&&u.contains(o))&&n()}})});Sf.displayName=ex;var _u="Toast",D2="toast.swipeStart",j2="toast.swipeMove",R2="toast.swipeCancel",O2="toast.swipeEnd",tx=m.forwardRef((e,t)=>{const{forceMount:r,open:n,defaultOpen:s,onOpenChange:a,...i}=e,[o=!0,c]=vn({prop:n,defaultProp:s,onChange:a});return l.jsx(Kt,{present:r||o,children:l.jsx(F2,{open:o,...i,ref:t,onClose:()=>c(!1),onPause:Et(e.onPause),onResume:Et(e.onResume),onSwipeStart:he(e.onSwipeStart,u=>{u.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:he(e.onSwipeMove,u=>{const{x:d,y:f}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","move"),u.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${d}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${f}px`)}),onSwipeCancel:he(e.onSwipeCancel,u=>{u.currentTarget.setAttribute("data-swipe","cancel"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:he(e.onSwipeEnd,u=>{const{x:d,y:f}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","end"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${d}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${f}px`),c(!1)})})})});tx.displayName=_u;var[I2,M2]=qg(_u,{onClose(){}}),F2=m.forwardRef((e,t)=>{const{__scopeToast:r,type:n="foreground",duration:s,open:a,onClose:i,onEscapeKeyDown:o,onPause:c,onResume:u,onSwipeStart:d,onSwipeMove:f,onSwipeCancel:h,onSwipeEnd:p,...v}=e,g=wu(_u,r),[x,y]=m.useState(null),w=Me(t,A=>y(A)),_=m.useRef(null),b=m.useRef(null),T=s||g.duration,k=m.useRef(0),S=m.useRef(T),E=m.useRef(0),{onToastAdd:C,onToastRemove:L}=g,M=Et(()=>{var H;(x==null?void 0:x.contains(document.activeElement))&&((H=g.viewport)==null||H.focus()),i()}),j=m.useCallback(A=>{!A||A===1/0||(window.clearTimeout(E.current),k.current=new Date().getTime(),E.current=window.setTimeout(M,A))},[M]);m.useEffect(()=>{const A=g.viewport;if(A){const H=()=>{j(S.current),u==null||u()},G=()=>{const q=new Date().getTime()-k.current;S.current=S.current-q,window.clearTimeout(E.current),c==null||c()};return A.addEventListener(_f,G),A.addEventListener(bf,H),()=>{A.removeEventListener(_f,G),A.removeEventListener(bf,H)}}},[g.viewport,T,c,u,j]),m.useEffect(()=>{a&&!g.isClosePausedRef.current&&j(T)},[a,T,g.isClosePausedRef,j]),m.useEffect(()=>(C(),()=>L()),[C,L]);const V=m.useMemo(()=>x?lx(x):null,[x]);return g.viewport?l.jsxs(l.Fragment,{children:[V&&l.jsx(L2,{__scopeToast:r,role:"status","aria-live":n==="foreground"?"assertive":"polite","aria-atomic":!0,children:V}),l.jsx(I2,{scope:r,onClose:M,children:Vr.createPortal(l.jsx(Eh.ItemSlot,{scope:r,children:l.jsx(v2,{asChild:!0,onEscapeKeyDown:he(o,()=>{g.isFocusedToastEscapeKeyDownRef.current||M(),g.isFocusedToastEscapeKeyDownRef.current=!1}),children:l.jsx(Ne.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":a?"open":"closed","data-swipe-direction":g.swipeDirection,...v,ref:w,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:he(e.onKeyDown,A=>{A.key==="Escape"&&(o==null||o(A.nativeEvent),A.nativeEvent.defaultPrevented||(g.isFocusedToastEscapeKeyDownRef.current=!0,M()))}),onPointerDown:he(e.onPointerDown,A=>{A.button===0&&(_.current={x:A.clientX,y:A.clientY})}),onPointerMove:he(e.onPointerMove,A=>{if(!_.current)return;const H=A.clientX-_.current.x,G=A.clientY-_.current.y,q=!!b.current,Y=["left","right"].includes(g.swipeDirection),Q=["left","up"].includes(g.swipeDirection)?Math.min:Math.max,fe=Y?Q(0,H):0,oe=Y?0:Q(0,G),X=A.pointerType==="touch"?10:2,le={x:fe,y:oe},D={originalEvent:A,delta:le};q?(b.current=le,Yl(j2,f,D,{discrete:!1})):sm(le,g.swipeDirection,X)?(b.current=le,Yl(D2,d,D,{discrete:!1}),A.target.setPointerCapture(A.pointerId)):(Math.abs(H)>X||Math.abs(G)>X)&&(_.current=null)}),onPointerUp:he(e.onPointerUp,A=>{const H=b.current,G=A.target;if(G.hasPointerCapture(A.pointerId)&&G.releasePointerCapture(A.pointerId),b.current=null,_.current=null,H){const q=A.currentTarget,Y={originalEvent:A,delta:H};sm(H,g.swipeDirection,g.swipeThreshold)?Yl(O2,p,Y,{discrete:!0}):Yl(R2,h,Y,{discrete:!0}),q.addEventListener("click",Q=>Q.preventDefault(),{once:!0})}})})})}),g.viewport)})]}):null}),L2=e=>{const{__scopeToast:t,children:r,...n}=e,s=wu(_u,t),[a,i]=m.useState(!1),[o,c]=m.useState(!1);return W2(()=>i(!0)),m.useEffect(()=>{const u=window.setTimeout(()=>c(!0),1e3);return()=>window.clearTimeout(u)},[]),o?null:l.jsx(Wi,{asChild:!0,children:l.jsx(gl,{...n,children:a&&l.jsxs(l.Fragment,{children:[s.label," ",r]})})})},B2="ToastTitle",rx=m.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return l.jsx(Ne.div,{...n,ref:t})});rx.displayName=B2;var $2="ToastDescription",nx=m.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return l.jsx(Ne.div,{...n,ref:t})});nx.displayName=$2;var sx="ToastAction",ax=m.forwardRef((e,t)=>{const{altText:r,...n}=e;return r.trim()?l.jsx(ox,{altText:r,asChild:!0,children:l.jsx(Th,{...n,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${sx}\`. Expected non-empty \`string\`.`),null)});ax.displayName=sx;var ix="ToastClose",Th=m.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e,s=M2(ix,r);return l.jsx(ox,{asChild:!0,children:l.jsx(Ne.button,{type:"button",...n,ref:t,onClick:he(e.onClick,s.onClose)})})});Th.displayName=ix;var ox=m.forwardRef((e,t)=>{const{__scopeToast:r,altText:n,...s}=e;return l.jsx(Ne.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0,...s,ref:t})});function lx(e){const t=[];return Array.from(e.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&t.push(n.textContent),U2(n)){const s=n.ariaHidden||n.hidden||n.style.display==="none",a=n.dataset.radixToastAnnounceExclude==="";if(!s)if(a){const i=n.dataset.radixToastAnnounceAlt;i&&t.push(i)}else t.push(...lx(n))}}),t}function Yl(e,t,r,{discrete:n}){const s=r.originalEvent.currentTarget,a=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:r});t&&s.addEventListener(e,t,{once:!0}),n?bh(s,a):s.dispatchEvent(a)}var sm=(e,t,r=0)=>{const n=Math.abs(e.x),s=Math.abs(e.y),a=n>s;return t==="left"||t==="right"?a&&n>r:!a&&s>r};function W2(e=()=>{}){const t=Et(e);er(()=>{let r=0,n=0;return r=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(n)}},[t])}function U2(e){return e.nodeType===e.ELEMENT_NODE}function V2(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const s=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||s?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function Nd(e){const t=document.activeElement;return e.some(r=>r===t?!0:(r.focus(),document.activeElement!==t))}var H2=Jg,cx=Zg,ux=tx,dx=rx,fx=nx,hx=ax,mx=Th;const am=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,im=Wg,bu=(e,t)=>r=>{var n;if((t==null?void 0:t.variants)==null)return im(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:s,defaultVariants:a}=t,i=Object.keys(s).map(u=>{const d=r==null?void 0:r[u],f=a==null?void 0:a[u];if(d===null)return null;const h=am(d)||am(f);return s[u][h]}),o=r&&Object.entries(r).reduce((u,d)=>{let[f,h]=d;return h===void 0||(u[f]=h),u},{}),c=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((u,d)=>{let{class:f,className:h,...p}=d;return Object.entries(p).every(v=>{let[g,x]=v;return Array.isArray(x)?x.includes({...a,...o}[g]):{...a,...o}[g]===x})?[...u,f,h]:u},[]);return im(e,i,c,r==null?void 0:r.class,r==null?void 0:r.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z2=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),px=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var G2={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K2=m.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:a,iconNode:i,...o},c)=>m.createElement("svg",{ref:c,...G2,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:px("lucide",s),...o},[...i.map(([u,d])=>m.createElement(u,d)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=(e,t)=>{const r=m.forwardRef(({className:n,...s},a)=>m.createElement(K2,{ref:a,iconNode:t,className:px(`lucide-${z2(e)}`,n),...s}));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wo=rt("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y2=rt("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zr=rt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Di=rt("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X2=rt("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q2=rt("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ea=rt("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J2=rt("ChartNoAxesColumn",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pr=rt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ur=rt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q2=rt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z2=rt("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ta=rt("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eE=rt("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gx=rt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tE=rt("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jc=rt("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xx=rt("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mn=rt("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rE=rt("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nE=rt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sE=rt("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aE=rt("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iE=rt("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vx=rt("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oE=rt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xl=rt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lE=rt("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cE=rt("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yx=rt("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uo=rt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wx=rt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Ch="-",uE=e=>{const t=fE(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:i=>{const o=i.split(Ch);return o[0]===""&&o.length!==1&&o.shift(),_x(o,t)||dE(i)},getConflictingClassGroupIds:(i,o)=>{const c=r[i]||[];return o&&n[i]?[...c,...n[i]]:c}}},_x=(e,t)=>{var i;if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),s=n?_x(e.slice(1),n):void 0;if(s)return s;if(t.validators.length===0)return;const a=e.join(Ch);return(i=t.validators.find(({validator:o})=>o(a)))==null?void 0:i.classGroupId},om=/^\[(.+)\]$/,dE=e=>{if(om.test(e)){const t=om.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},fE=e=>{const{theme:t,prefix:r}=e,n={nextPart:new Map,validators:[]};return mE(Object.entries(e.classGroups),r).forEach(([a,i])=>{Ef(i,n,a,t)}),n},Ef=(e,t,r,n)=>{e.forEach(s=>{if(typeof s=="string"){const a=s===""?t:lm(t,s);a.classGroupId=r;return}if(typeof s=="function"){if(hE(s)){Ef(s(n),t,r,n);return}t.validators.push({validator:s,classGroupId:r});return}Object.entries(s).forEach(([a,i])=>{Ef(i,lm(t,a),r,n)})})},lm=(e,t)=>{let r=e;return t.split(Ch).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},hE=e=>e.isThemeGetter,mE=(e,t)=>t?e.map(([r,n])=>{const s=n.map(a=>typeof a=="string"?t+a:typeof a=="object"?Object.fromEntries(Object.entries(a).map(([i,o])=>[t+i,o])):a);return[r,s]}):e,pE=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const s=(a,i)=>{r.set(a,i),t++,t>e&&(t=0,n=r,r=new Map)};return{get(a){let i=r.get(a);if(i!==void 0)return i;if((i=n.get(a))!==void 0)return s(a,i),i},set(a,i){r.has(a)?r.set(a,i):s(a,i)}}},bx="!",gE=e=>{const{separator:t,experimentalParseClassName:r}=e,n=t.length===1,s=t[0],a=t.length,i=o=>{const c=[];let u=0,d=0,f;for(let x=0;x<o.length;x++){let y=o[x];if(u===0){if(y===s&&(n||o.slice(x,x+a)===t)){c.push(o.slice(d,x)),d=x+a;continue}if(y==="/"){f=x;continue}}y==="["?u++:y==="]"&&u--}const h=c.length===0?o:o.substring(d),p=h.startsWith(bx),v=p?h.substring(1):h,g=f&&f>d?f-d:void 0;return{modifiers:c,hasImportantModifier:p,baseClassName:v,maybePostfixModifierPosition:g}};return r?o=>r({className:o,parseClassName:i}):i},xE=e=>{if(e.length<=1)return e;const t=[];let r=[];return e.forEach(n=>{n[0]==="["?(t.push(...r.sort(),n),r=[]):r.push(n)}),t.push(...r.sort()),t},vE=e=>({cache:pE(e.cacheSize),parseClassName:gE(e),...uE(e)}),yE=/\s+/,wE=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:s}=t,a=[],i=e.trim().split(yE);let o="";for(let c=i.length-1;c>=0;c-=1){const u=i[c],{modifiers:d,hasImportantModifier:f,baseClassName:h,maybePostfixModifierPosition:p}=r(u);let v=!!p,g=n(v?h.substring(0,p):h);if(!g){if(!v){o=u+(o.length>0?" "+o:o);continue}if(g=n(h),!g){o=u+(o.length>0?" "+o:o);continue}v=!1}const x=xE(d).join(":"),y=f?x+bx:x,w=y+g;if(a.includes(w))continue;a.push(w);const _=s(g,v);for(let b=0;b<_.length;++b){const T=_[b];a.push(y+T)}o=u+(o.length>0?" "+o:o)}return o};function _E(){let e=0,t,r,n="";for(;e<arguments.length;)(t=arguments[e++])&&(r=Sx(t))&&(n&&(n+=" "),n+=r);return n}const Sx=e=>{if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=Sx(e[n]))&&(r&&(r+=" "),r+=t);return r};function bE(e,...t){let r,n,s,a=i;function i(c){const u=t.reduce((d,f)=>f(d),e());return r=vE(u),n=r.cache.get,s=r.cache.set,a=o,o(c)}function o(c){const u=n(c);if(u)return u;const d=wE(c,r);return s(c,d),d}return function(){return a(_E.apply(null,arguments))}}const vt=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},Ex=/^\[(?:([a-z-]+):)?(.+)\]$/i,SE=/^\d+\/\d+$/,EE=new Set(["px","full","screen"]),TE=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,CE=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,kE=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,PE=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,AE=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Yn=e=>hi(e)||EE.has(e)||SE.test(e),gs=e=>Ui(e,"length",FE),hi=e=>!!e&&!Number.isNaN(Number(e)),Dd=e=>Ui(e,"number",hi),fo=e=>!!e&&Number.isInteger(Number(e)),NE=e=>e.endsWith("%")&&hi(e.slice(0,-1)),We=e=>Ex.test(e),xs=e=>TE.test(e),DE=new Set(["length","size","percentage"]),jE=e=>Ui(e,DE,Tx),RE=e=>Ui(e,"position",Tx),OE=new Set(["image","url"]),IE=e=>Ui(e,OE,BE),ME=e=>Ui(e,"",LE),ho=()=>!0,Ui=(e,t,r)=>{const n=Ex.exec(e);return n?n[1]?typeof t=="string"?n[1]===t:t.has(n[1]):r(n[2]):!1},FE=e=>CE.test(e)&&!kE.test(e),Tx=()=>!1,LE=e=>PE.test(e),BE=e=>AE.test(e),$E=()=>{const e=vt("colors"),t=vt("spacing"),r=vt("blur"),n=vt("brightness"),s=vt("borderColor"),a=vt("borderRadius"),i=vt("borderSpacing"),o=vt("borderWidth"),c=vt("contrast"),u=vt("grayscale"),d=vt("hueRotate"),f=vt("invert"),h=vt("gap"),p=vt("gradientColorStops"),v=vt("gradientColorStopPositions"),g=vt("inset"),x=vt("margin"),y=vt("opacity"),w=vt("padding"),_=vt("saturate"),b=vt("scale"),T=vt("sepia"),k=vt("skew"),S=vt("space"),E=vt("translate"),C=()=>["auto","contain","none"],L=()=>["auto","hidden","clip","visible","scroll"],M=()=>["auto",We,t],j=()=>[We,t],V=()=>["",Yn,gs],A=()=>["auto",hi,We],H=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],G=()=>["solid","dashed","dotted","double","none"],q=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Y=()=>["start","end","center","between","around","evenly","stretch"],Q=()=>["","0",We],fe=()=>["auto","avoid","all","avoid-page","page","left","right","column"],oe=()=>[hi,We];return{cacheSize:500,separator:":",theme:{colors:[ho],spacing:[Yn,gs],blur:["none","",xs,We],brightness:oe(),borderColor:[e],borderRadius:["none","","full",xs,We],borderSpacing:j(),borderWidth:V(),contrast:oe(),grayscale:Q(),hueRotate:oe(),invert:Q(),gap:j(),gradientColorStops:[e],gradientColorStopPositions:[NE,gs],inset:M(),margin:M(),opacity:oe(),padding:j(),saturate:oe(),scale:oe(),sepia:Q(),skew:oe(),space:j(),translate:j()},classGroups:{aspect:[{aspect:["auto","square","video",We]}],container:["container"],columns:[{columns:[xs]}],"break-after":[{"break-after":fe()}],"break-before":[{"break-before":fe()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...H(),We]}],overflow:[{overflow:L()}],"overflow-x":[{"overflow-x":L()}],"overflow-y":[{"overflow-y":L()}],overscroll:[{overscroll:C()}],"overscroll-x":[{"overscroll-x":C()}],"overscroll-y":[{"overscroll-y":C()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[g]}],"inset-x":[{"inset-x":[g]}],"inset-y":[{"inset-y":[g]}],start:[{start:[g]}],end:[{end:[g]}],top:[{top:[g]}],right:[{right:[g]}],bottom:[{bottom:[g]}],left:[{left:[g]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",fo,We]}],basis:[{basis:M()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",We]}],grow:[{grow:Q()}],shrink:[{shrink:Q()}],order:[{order:["first","last","none",fo,We]}],"grid-cols":[{"grid-cols":[ho]}],"col-start-end":[{col:["auto",{span:["full",fo,We]},We]}],"col-start":[{"col-start":A()}],"col-end":[{"col-end":A()}],"grid-rows":[{"grid-rows":[ho]}],"row-start-end":[{row:["auto",{span:[fo,We]},We]}],"row-start":[{"row-start":A()}],"row-end":[{"row-end":A()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",We]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",We]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal",...Y()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...Y(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...Y(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[w]}],px:[{px:[w]}],py:[{py:[w]}],ps:[{ps:[w]}],pe:[{pe:[w]}],pt:[{pt:[w]}],pr:[{pr:[w]}],pb:[{pb:[w]}],pl:[{pl:[w]}],m:[{m:[x]}],mx:[{mx:[x]}],my:[{my:[x]}],ms:[{ms:[x]}],me:[{me:[x]}],mt:[{mt:[x]}],mr:[{mr:[x]}],mb:[{mb:[x]}],ml:[{ml:[x]}],"space-x":[{"space-x":[S]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[S]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",We,t]}],"min-w":[{"min-w":[We,t,"min","max","fit"]}],"max-w":[{"max-w":[We,t,"none","full","min","max","fit","prose",{screen:[xs]},xs]}],h:[{h:[We,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[We,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[We,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[We,t,"auto","min","max","fit"]}],"font-size":[{text:["base",xs,gs]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Dd]}],"font-family":[{font:[ho]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",We]}],"line-clamp":[{"line-clamp":["none",hi,Dd]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Yn,We]}],"list-image":[{"list-image":["none",We]}],"list-style-type":[{list:["none","disc","decimal",We]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[y]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[y]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...G(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Yn,gs]}],"underline-offset":[{"underline-offset":["auto",Yn,We]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:j()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",We]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",We]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[y]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...H(),RE]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",jE]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},IE]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[v]}],"gradient-via-pos":[{via:[v]}],"gradient-to-pos":[{to:[v]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[a]}],"rounded-s":[{"rounded-s":[a]}],"rounded-e":[{"rounded-e":[a]}],"rounded-t":[{"rounded-t":[a]}],"rounded-r":[{"rounded-r":[a]}],"rounded-b":[{"rounded-b":[a]}],"rounded-l":[{"rounded-l":[a]}],"rounded-ss":[{"rounded-ss":[a]}],"rounded-se":[{"rounded-se":[a]}],"rounded-ee":[{"rounded-ee":[a]}],"rounded-es":[{"rounded-es":[a]}],"rounded-tl":[{"rounded-tl":[a]}],"rounded-tr":[{"rounded-tr":[a]}],"rounded-br":[{"rounded-br":[a]}],"rounded-bl":[{"rounded-bl":[a]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[y]}],"border-style":[{border:[...G(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[y]}],"divide-style":[{divide:G()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...G()]}],"outline-offset":[{"outline-offset":[Yn,We]}],"outline-w":[{outline:[Yn,gs]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:V()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[y]}],"ring-offset-w":[{"ring-offset":[Yn,gs]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",xs,ME]}],"shadow-color":[{shadow:[ho]}],opacity:[{opacity:[y]}],"mix-blend":[{"mix-blend":[...q(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":q()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",xs,We]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[f]}],saturate:[{saturate:[_]}],sepia:[{sepia:[T]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[f]}],"backdrop-opacity":[{"backdrop-opacity":[y]}],"backdrop-saturate":[{"backdrop-saturate":[_]}],"backdrop-sepia":[{"backdrop-sepia":[T]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[i]}],"border-spacing-x":[{"border-spacing-x":[i]}],"border-spacing-y":[{"border-spacing-y":[i]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",We]}],duration:[{duration:oe()}],ease:[{ease:["linear","in","out","in-out",We]}],delay:[{delay:oe()}],animate:[{animate:["none","spin","ping","pulse","bounce",We]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[b]}],"scale-x":[{"scale-x":[b]}],"scale-y":[{"scale-y":[b]}],rotate:[{rotate:[fo,We]}],"translate-x":[{"translate-x":[E]}],"translate-y":[{"translate-y":[E]}],"skew-x":[{"skew-x":[k]}],"skew-y":[{"skew-y":[k]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",We]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",We]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":j()}],"scroll-mx":[{"scroll-mx":j()}],"scroll-my":[{"scroll-my":j()}],"scroll-ms":[{"scroll-ms":j()}],"scroll-me":[{"scroll-me":j()}],"scroll-mt":[{"scroll-mt":j()}],"scroll-mr":[{"scroll-mr":j()}],"scroll-mb":[{"scroll-mb":j()}],"scroll-ml":[{"scroll-ml":j()}],"scroll-p":[{"scroll-p":j()}],"scroll-px":[{"scroll-px":j()}],"scroll-py":[{"scroll-py":j()}],"scroll-ps":[{"scroll-ps":j()}],"scroll-pe":[{"scroll-pe":j()}],"scroll-pt":[{"scroll-pt":j()}],"scroll-pr":[{"scroll-pr":j()}],"scroll-pb":[{"scroll-pb":j()}],"scroll-pl":[{"scroll-pl":j()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",We]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Yn,gs,Dd]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},WE=bE($E);function Pe(...e){return WE(Wg(e))}function ji(e,t=""){return e==null||e==="NaN"||e===""?"-":typeof e=="number"?t.includes("Pct")||t.includes("Prob")||t==="ImpliedVolatility"||t==="Mean_Accuracy"||t==="AllMedianIV_Maximum100DaysToExp"||t==="TodayStockMedianIV_Maximum100DaysToExp"||t==="WorstHistoricalDecline"||t==="BadHistoricalDecline"||t==="ImpliedVolatilityUntilExpiry"||t==="Historical100DaysWorstDecline"||t==="Historical50DaysWorstDecline"||t==="2008_100DaysWorstDecline"||t==="2008_50DaysWorstDecline"?`${(e*100).toLocaleString("sv-SE",{minimumFractionDigits:2,maximumFractionDigits:2})}%`:t==="Premium"||t==="Underlying_Value"||t==="PotentialLossAtLowerBound"||t==="DaysToExpiry"||t==="X-Day"||t.includes("Number")||Math.abs(e)>=1e3?Math.round(e).toLocaleString("sv-SE"):t.includes("Loss")||t.includes("Price")||t.includes("Bid")||t.includes("Value")?e.toLocaleString("sv-SE",{minimumFractionDigits:2,maximumFractionDigits:2}):e.toLocaleString("sv-SE",{minimumFractionDigits:2,maximumFractionDigits:2}):String(e)}const UE=H2,Cx=m.forwardRef(({className:e,...t},r)=>l.jsx(cx,{ref:r,className:Pe("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));Cx.displayName=cx.displayName;const VE=bu("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),kx=m.forwardRef(({className:e,variant:t,...r},n)=>l.jsx(ux,{ref:n,className:Pe(VE({variant:t}),e),...r}));kx.displayName=ux.displayName;const HE=m.forwardRef(({className:e,...t},r)=>l.jsx(hx,{ref:r,className:Pe("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t}));HE.displayName=hx.displayName;const Px=m.forwardRef(({className:e,...t},r)=>l.jsx(mx,{ref:r,className:Pe("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:l.jsx(wx,{className:"h-4 w-4"})}));Px.displayName=mx.displayName;const Ax=m.forwardRef(({className:e,...t},r)=>l.jsx(dx,{ref:r,className:Pe("text-sm font-semibold",e),...t}));Ax.displayName=dx.displayName;const Nx=m.forwardRef(({className:e,...t},r)=>l.jsx(fx,{ref:r,className:Pe("text-sm opacity-90",e),...t}));Nx.displayName=fx.displayName;function zE(){const{toasts:e}=t2();return l.jsxs(UE,{children:[e.map(function({id:t,title:r,description:n,action:s,...a}){return l.jsxs(kx,{...a,children:[l.jsxs("div",{className:"grid gap-1",children:[r&&l.jsx(Ax,{children:r}),n&&l.jsx(Nx,{children:n})]}),s,l.jsx(Px,{})]},t)}),l.jsx(Cx,{})]})}var Rc=["light","dark"],kh="(prefers-color-scheme: dark)",GE=typeof window>"u",Ph=m.createContext(void 0),KE={setTheme:e=>{},themes:[]},Dx=()=>{var e;return(e=m.useContext(Ph))!=null?e:KE},YE=e=>m.useContext(Ph)?e.children:m.createElement(qE,{...e}),XE=["light","dark"],qE=({forcedTheme:e,disableTransitionOnChange:t=!1,enableSystem:r=!0,enableColorScheme:n=!0,storageKey:s="theme",themes:a=XE,defaultTheme:i=r?"system":"light",attribute:o="data-theme",value:c,children:u,nonce:d})=>{let[f,h]=m.useState(()=>cm(s,i)),[p,v]=m.useState(()=>cm(s)),g=c?Object.values(c):a,x=m.useCallback(b=>{let T=b;if(!T)return;b==="system"&&r&&(T=um());let k=c?c[T]:T,S=t?QE():null,E=document.documentElement;if(o==="class"?(E.classList.remove(...g),k&&E.classList.add(k)):k?E.setAttribute(o,k):E.removeAttribute(o),n){let C=Rc.includes(i)?i:null,L=Rc.includes(T)?T:C;E.style.colorScheme=L}S==null||S()},[]),y=m.useCallback(b=>{let T=typeof b=="function"?b(b):b;h(T);try{localStorage.setItem(s,T)}catch{}},[e]),w=m.useCallback(b=>{let T=um(b);v(T),f==="system"&&r&&!e&&x("system")},[f,e]);m.useEffect(()=>{let b=window.matchMedia(kh);return b.addListener(w),w(b),()=>b.removeListener(w)},[w]),m.useEffect(()=>{let b=T=>{if(T.key!==s)return;let k=T.newValue||i;y(k)};return window.addEventListener("storage",b),()=>window.removeEventListener("storage",b)},[y]),m.useEffect(()=>{x(e??f)},[e,f]);let _=m.useMemo(()=>({theme:f,setTheme:y,forcedTheme:e,resolvedTheme:f==="system"?p:f,themes:r?[...a,"system"]:a,systemTheme:r?p:void 0}),[f,y,e,p,r,a]);return m.createElement(Ph.Provider,{value:_},m.createElement(JE,{forcedTheme:e,disableTransitionOnChange:t,enableSystem:r,enableColorScheme:n,storageKey:s,themes:a,defaultTheme:i,attribute:o,value:c,children:u,attrs:g,nonce:d}),u)},JE=m.memo(({forcedTheme:e,storageKey:t,attribute:r,enableSystem:n,enableColorScheme:s,defaultTheme:a,value:i,attrs:o,nonce:c})=>{let u=a==="system",d=r==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${o.map(v=>`'${v}'`).join(",")})`};`:`var d=document.documentElement,n='${r}',s='setAttribute';`,f=s?Rc.includes(a)&&a?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${a}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",h=(v,g=!1,x=!0)=>{let y=i?i[v]:v,w=g?v+"|| ''":`'${y}'`,_="";return s&&x&&!g&&Rc.includes(v)&&(_+=`d.style.colorScheme = '${v}';`),r==="class"?g||y?_+=`c.add(${w})`:_+="null":y&&(_+=`d[s](n,${w})`),_},p=e?`!function(){${d}${h(e)}}()`:n?`!function(){try{${d}var e=localStorage.getItem('${t}');if('system'===e||(!e&&${u})){var t='${kh}',m=window.matchMedia(t);if(m.media!==t||m.matches){${h("dark")}}else{${h("light")}}}else if(e){${i?`var x=${JSON.stringify(i)};`:""}${h(i?"x[e]":"e",!0)}}${u?"":"else{"+h(a,!1,!1)+"}"}${f}}catch(e){}}()`:`!function(){try{${d}var e=localStorage.getItem('${t}');if(e){${i?`var x=${JSON.stringify(i)};`:""}${h(i?"x[e]":"e",!0)}}else{${h(a,!1,!1)};}${f}}catch(t){}}();`;return m.createElement("script",{nonce:c,dangerouslySetInnerHTML:{__html:p}})}),cm=(e,t)=>{if(GE)return;let r;try{r=localStorage.getItem(e)||void 0}catch{}return r||t},QE=()=>{let e=document.createElement("style");return e.appendChild(document.createTextNode("*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),document.head.appendChild(e),()=>{window.getComputedStyle(document.body),setTimeout(()=>{document.head.removeChild(e)},1)}},um=e=>(e||(e=window.matchMedia(kh)),e.matches?"dark":"light"),ZE=e=>{switch(e){case"success":return rT;case"info":return sT;case"warning":return nT;case"error":return aT;default:return null}},eT=Array(12).fill(0),tT=({visible:e})=>me.createElement("div",{className:"sonner-loading-wrapper","data-visible":e},me.createElement("div",{className:"sonner-spinner"},eT.map((t,r)=>me.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),rT=me.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},me.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),nT=me.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},me.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),sT=me.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},me.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),aT=me.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},me.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),iT=()=>{let[e,t]=me.useState(document.hidden);return me.useEffect(()=>{let r=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),e},Tf=1,oT=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;let{message:r,...n}=e,s=typeof(e==null?void 0:e.id)=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:Tf++,a=this.toasts.find(o=>o.id===s),i=e.dismissible===void 0?!0:e.dismissible;return a?this.toasts=this.toasts.map(o=>o.id===s?(this.publish({...o,...e,id:s,title:r}),{...o,...e,id:s,dismissible:i,title:r}):o):this.addToast({title:r,...n,dismissible:i,id:s}),s},this.dismiss=e=>(e||this.toasts.forEach(t=>{this.subscribers.forEach(r=>r({id:t.id,dismiss:!0}))}),this.subscribers.forEach(t=>t({id:e,dismiss:!0})),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let r;t.loading!==void 0&&(r=this.create({...t,promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));let n=e instanceof Promise?e:e(),s=r!==void 0;return n.then(async a=>{if(cT(a)&&!a.ok){s=!1;let i=typeof t.error=="function"?await t.error(`HTTP error! status: ${a.status}`):t.error,o=typeof t.description=="function"?await t.description(`HTTP error! status: ${a.status}`):t.description;this.create({id:r,type:"error",message:i,description:o})}else if(t.success!==void 0){s=!1;let i=typeof t.success=="function"?await t.success(a):t.success,o=typeof t.description=="function"?await t.description(a):t.description;this.create({id:r,type:"success",message:i,description:o})}}).catch(async a=>{if(t.error!==void 0){s=!1;let i=typeof t.error=="function"?await t.error(a):t.error,o=typeof t.description=="function"?await t.description(a):t.description;this.create({id:r,type:"error",message:i,description:o})}}).finally(()=>{var a;s&&(this.dismiss(r),r=void 0),(a=t.finally)==null||a.call(t)}),r},this.custom=(e,t)=>{let r=(t==null?void 0:t.id)||Tf++;return this.create({jsx:e(r),id:r,...t}),r},this.subscribers=[],this.toasts=[]}},Or=new oT,lT=(e,t)=>{let r=(t==null?void 0:t.id)||Tf++;return Or.addToast({title:e,...t,id:r}),r},cT=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",uT=lT,dT=()=>Or.toasts,Ir=Object.assign(uT,{success:Or.success,info:Or.info,warning:Or.warning,error:Or.error,custom:Or.custom,message:Or.message,promise:Or.promise,dismiss:Or.dismiss,loading:Or.loading},{getHistory:dT});function fT(e,{insertAt:t}={}){if(typeof document>"u")return;let r=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t==="top"&&r.firstChild?r.insertBefore(n,r.firstChild):r.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}fT(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999}:where([data-sonner-toaster][data-x-position="right"]){right:max(var(--offset),env(safe-area-inset-right))}:where([data-sonner-toaster][data-x-position="left"]){left:max(var(--offset),env(safe-area-inset-left))}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:max(var(--offset),env(safe-area-inset-top))}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:max(var(--offset),env(safe-area-inset-bottom))}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;background:var(--gray1);color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:0;right:0;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount, 0px));transition:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation:swipe-out .2s ease-out forwards}@keyframes swipe-out{0%{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount)));opacity:1}to{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount) + var(--lift) * -100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;--mobile-offset: 16px;right:var(--mobile-offset);left:var(--mobile-offset);width:100%}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset)}[data-sonner-toaster][data-y-position=bottom]{bottom:20px}[data-sonner-toaster][data-y-position=top]{top:20px}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset);right:var(--mobile-offset);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function Xl(e){return e.label!==void 0}var hT=3,mT="32px",pT=4e3,gT=356,xT=14,vT=20,yT=200;function wT(...e){return e.filter(Boolean).join(" ")}var _T=e=>{var t,r,n,s,a,i,o,c,u,d;let{invert:f,toast:h,unstyled:p,interacting:v,setHeights:g,visibleToasts:x,heights:y,index:w,toasts:_,expanded:b,removeToast:T,defaultRichColors:k,closeButton:S,style:E,cancelButtonStyle:C,actionButtonStyle:L,className:M="",descriptionClassName:j="",duration:V,position:A,gap:H,loadingIcon:G,expandByDefault:q,classNames:Y,icons:Q,closeButtonAriaLabel:fe="Close toast",pauseWhenPageIsHidden:oe,cn:X}=e,[le,D]=me.useState(!1),[K,U]=me.useState(!1),[I,ee]=me.useState(!1),[z,R]=me.useState(!1),[J,Z]=me.useState(0),[ge,ye]=me.useState(0),Ce=me.useRef(null),Ie=me.useRef(null),st=w===0,Se=w+1<=x,Le=h.type,de=h.dismissible!==!1,Fe=h.className||"",at=h.descriptionClassName||"",ke=me.useMemo(()=>y.findIndex(Oe=>Oe.toastId===h.id)||0,[y,h.id]),je=me.useMemo(()=>{var Oe;return(Oe=h.closeButton)!=null?Oe:S},[h.closeButton,S]),ht=me.useMemo(()=>h.duration||V||pT,[h.duration,V]),At=me.useRef(0),Ze=me.useRef(0),ct=me.useRef(0),tr=me.useRef(null),[Gr,Yt]=A.split("-"),Dr=me.useMemo(()=>y.reduce((Oe,it,nt)=>nt>=ke?Oe:Oe+it.height,0),[y,ke]),aa=iT(),Xa=h.invert||f,Tn=Le==="loading";Ze.current=me.useMemo(()=>ke*H+Dr,[ke,Dr]),me.useEffect(()=>{D(!0)},[]),me.useLayoutEffect(()=>{if(!le)return;let Oe=Ie.current,it=Oe.style.height;Oe.style.height="auto";let nt=Oe.getBoundingClientRect().height;Oe.style.height=it,ye(nt),g(_r=>_r.find(ut=>ut.toastId===h.id)?_r.map(ut=>ut.toastId===h.id?{...ut,height:nt}:ut):[{toastId:h.id,height:nt,position:h.position},..._r])},[le,h.title,h.description,g,h.id]);let jr=me.useCallback(()=>{U(!0),Z(Ze.current),g(Oe=>Oe.filter(it=>it.toastId!==h.id)),setTimeout(()=>{T(h)},yT)},[h,T,g,Ze]);me.useEffect(()=>{if(h.promise&&Le==="loading"||h.duration===1/0||h.type==="loading")return;let Oe,it=ht;return b||v||oe&&aa?(()=>{if(ct.current<At.current){let nt=new Date().getTime()-At.current;it=it-nt}ct.current=new Date().getTime()})():it!==1/0&&(At.current=new Date().getTime(),Oe=setTimeout(()=>{var nt;(nt=h.onAutoClose)==null||nt.call(h,h),jr()},it)),()=>clearTimeout(Oe)},[b,v,q,h,ht,jr,h.promise,Le,oe,aa]),me.useEffect(()=>{let Oe=Ie.current;if(Oe){let it=Oe.getBoundingClientRect().height;return ye(it),g(nt=>[{toastId:h.id,height:it,position:h.position},...nt]),()=>g(nt=>nt.filter(_r=>_r.toastId!==h.id))}},[g,h.id]),me.useEffect(()=>{h.delete&&jr()},[jr,h.delete]);function oo(){return Q!=null&&Q.loading?me.createElement("div",{className:"sonner-loader","data-visible":Le==="loading"},Q.loading):G?me.createElement("div",{className:"sonner-loader","data-visible":Le==="loading"},G):me.createElement(tT,{visible:Le==="loading"})}return me.createElement("li",{"aria-live":h.important?"assertive":"polite","aria-atomic":"true",role:"status",tabIndex:0,ref:Ie,className:X(M,Fe,Y==null?void 0:Y.toast,(t=h==null?void 0:h.classNames)==null?void 0:t.toast,Y==null?void 0:Y.default,Y==null?void 0:Y[Le],(r=h==null?void 0:h.classNames)==null?void 0:r[Le]),"data-sonner-toast":"","data-rich-colors":(n=h.richColors)!=null?n:k,"data-styled":!(h.jsx||h.unstyled||p),"data-mounted":le,"data-promise":!!h.promise,"data-removed":K,"data-visible":Se,"data-y-position":Gr,"data-x-position":Yt,"data-index":w,"data-front":st,"data-swiping":I,"data-dismissible":de,"data-type":Le,"data-invert":Xa,"data-swipe-out":z,"data-expanded":!!(b||q&&le),style:{"--index":w,"--toasts-before":w,"--z-index":_.length-w,"--offset":`${K?J:Ze.current}px`,"--initial-height":q?"auto":`${ge}px`,...E,...h.style},onPointerDown:Oe=>{Tn||!de||(Ce.current=new Date,Z(Ze.current),Oe.target.setPointerCapture(Oe.pointerId),Oe.target.tagName!=="BUTTON"&&(ee(!0),tr.current={x:Oe.clientX,y:Oe.clientY}))},onPointerUp:()=>{var Oe,it,nt,_r;if(z||!de)return;tr.current=null;let ut=Number(((Oe=Ie.current)==null?void 0:Oe.style.getPropertyValue("--swipe-amount").replace("px",""))||0),bt=new Date().getTime()-((it=Ce.current)==null?void 0:it.getTime()),Xt=Math.abs(ut)/bt;if(Math.abs(ut)>=vT||Xt>.11){Z(Ze.current),(nt=h.onDismiss)==null||nt.call(h,h),jr(),R(!0);return}(_r=Ie.current)==null||_r.style.setProperty("--swipe-amount","0px"),ee(!1)},onPointerMove:Oe=>{var it;if(!tr.current||!de)return;let nt=Oe.clientY-tr.current.y,_r=Oe.clientX-tr.current.x,ut=(Gr==="top"?Math.min:Math.max)(0,nt),bt=Oe.pointerType==="touch"?10:2;Math.abs(ut)>bt?(it=Ie.current)==null||it.style.setProperty("--swipe-amount",`${nt}px`):Math.abs(_r)>bt&&(tr.current=null)}},je&&!h.jsx?me.createElement("button",{"aria-label":fe,"data-disabled":Tn,"data-close-button":!0,onClick:Tn||!de?()=>{}:()=>{var Oe;jr(),(Oe=h.onDismiss)==null||Oe.call(h,h)},className:X(Y==null?void 0:Y.closeButton,(s=h==null?void 0:h.classNames)==null?void 0:s.closeButton)},me.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},me.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),me.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))):null,h.jsx||me.isValidElement(h.title)?h.jsx||h.title:me.createElement(me.Fragment,null,Le||h.icon||h.promise?me.createElement("div",{"data-icon":"",className:X(Y==null?void 0:Y.icon,(a=h==null?void 0:h.classNames)==null?void 0:a.icon)},h.promise||h.type==="loading"&&!h.icon?h.icon||oo():null,h.type!=="loading"?h.icon||(Q==null?void 0:Q[Le])||ZE(Le):null):null,me.createElement("div",{"data-content":"",className:X(Y==null?void 0:Y.content,(i=h==null?void 0:h.classNames)==null?void 0:i.content)},me.createElement("div",{"data-title":"",className:X(Y==null?void 0:Y.title,(o=h==null?void 0:h.classNames)==null?void 0:o.title)},h.title),h.description?me.createElement("div",{"data-description":"",className:X(j,at,Y==null?void 0:Y.description,(c=h==null?void 0:h.classNames)==null?void 0:c.description)},h.description):null),me.isValidElement(h.cancel)?h.cancel:h.cancel&&Xl(h.cancel)?me.createElement("button",{"data-button":!0,"data-cancel":!0,style:h.cancelButtonStyle||C,onClick:Oe=>{var it,nt;Xl(h.cancel)&&de&&((nt=(it=h.cancel).onClick)==null||nt.call(it,Oe),jr())},className:X(Y==null?void 0:Y.cancelButton,(u=h==null?void 0:h.classNames)==null?void 0:u.cancelButton)},h.cancel.label):null,me.isValidElement(h.action)?h.action:h.action&&Xl(h.action)?me.createElement("button",{"data-button":!0,"data-action":!0,style:h.actionButtonStyle||L,onClick:Oe=>{var it,nt;Xl(h.action)&&(Oe.defaultPrevented||((nt=(it=h.action).onClick)==null||nt.call(it,Oe),jr()))},className:X(Y==null?void 0:Y.actionButton,(d=h==null?void 0:h.classNames)==null?void 0:d.actionButton)},h.action.label):null))};function dm(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}var bT=e=>{let{invert:t,position:r="bottom-right",hotkey:n=["altKey","KeyT"],expand:s,closeButton:a,className:i,offset:o,theme:c="light",richColors:u,duration:d,style:f,visibleToasts:h=hT,toastOptions:p,dir:v=dm(),gap:g=xT,loadingIcon:x,icons:y,containerAriaLabel:w="Notifications",pauseWhenPageIsHidden:_,cn:b=wT}=e,[T,k]=me.useState([]),S=me.useMemo(()=>Array.from(new Set([r].concat(T.filter(oe=>oe.position).map(oe=>oe.position)))),[T,r]),[E,C]=me.useState([]),[L,M]=me.useState(!1),[j,V]=me.useState(!1),[A,H]=me.useState(c!=="system"?c:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),G=me.useRef(null),q=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),Y=me.useRef(null),Q=me.useRef(!1),fe=me.useCallback(oe=>{var X;(X=T.find(le=>le.id===oe.id))!=null&&X.delete||Or.dismiss(oe.id),k(le=>le.filter(({id:D})=>D!==oe.id))},[T]);return me.useEffect(()=>Or.subscribe(oe=>{if(oe.dismiss){k(X=>X.map(le=>le.id===oe.id?{...le,delete:!0}:le));return}setTimeout(()=>{vh.flushSync(()=>{k(X=>{let le=X.findIndex(D=>D.id===oe.id);return le!==-1?[...X.slice(0,le),{...X[le],...oe},...X.slice(le+1)]:[oe,...X]})})})}),[]),me.useEffect(()=>{if(c!=="system"){H(c);return}c==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?H("dark"):H("light")),typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",({matches:oe})=>{H(oe?"dark":"light")})},[c]),me.useEffect(()=>{T.length<=1&&M(!1)},[T]),me.useEffect(()=>{let oe=X=>{var le,D;n.every(K=>X[K]||X.code===K)&&(M(!0),(le=G.current)==null||le.focus()),X.code==="Escape"&&(document.activeElement===G.current||(D=G.current)!=null&&D.contains(document.activeElement))&&M(!1)};return document.addEventListener("keydown",oe),()=>document.removeEventListener("keydown",oe)},[n]),me.useEffect(()=>{if(G.current)return()=>{Y.current&&(Y.current.focus({preventScroll:!0}),Y.current=null,Q.current=!1)}},[G.current]),T.length?me.createElement("section",{"aria-label":`${w} ${q}`,tabIndex:-1},S.map((oe,X)=>{var le;let[D,K]=oe.split("-");return me.createElement("ol",{key:oe,dir:v==="auto"?dm():v,tabIndex:-1,ref:G,className:i,"data-sonner-toaster":!0,"data-theme":A,"data-y-position":D,"data-x-position":K,style:{"--front-toast-height":`${((le=E[0])==null?void 0:le.height)||0}px`,"--offset":typeof o=="number"?`${o}px`:o||mT,"--width":`${gT}px`,"--gap":`${g}px`,...f},onBlur:U=>{Q.current&&!U.currentTarget.contains(U.relatedTarget)&&(Q.current=!1,Y.current&&(Y.current.focus({preventScroll:!0}),Y.current=null))},onFocus:U=>{U.target instanceof HTMLElement&&U.target.dataset.dismissible==="false"||Q.current||(Q.current=!0,Y.current=U.relatedTarget)},onMouseEnter:()=>M(!0),onMouseMove:()=>M(!0),onMouseLeave:()=>{j||M(!1)},onPointerDown:U=>{U.target instanceof HTMLElement&&U.target.dataset.dismissible==="false"||V(!0)},onPointerUp:()=>V(!1)},T.filter(U=>!U.position&&X===0||U.position===oe).map((U,I)=>{var ee,z;return me.createElement(_T,{key:U.id,icons:y,index:I,toast:U,defaultRichColors:u,duration:(ee=p==null?void 0:p.duration)!=null?ee:d,className:p==null?void 0:p.className,descriptionClassName:p==null?void 0:p.descriptionClassName,invert:t,visibleToasts:h,closeButton:(z=p==null?void 0:p.closeButton)!=null?z:a,interacting:j,position:oe,style:p==null?void 0:p.style,unstyled:p==null?void 0:p.unstyled,classNames:p==null?void 0:p.classNames,cancelButtonStyle:p==null?void 0:p.cancelButtonStyle,actionButtonStyle:p==null?void 0:p.actionButtonStyle,removeToast:fe,toasts:T.filter(R=>R.position==U.position),heights:E.filter(R=>R.position==U.position),setHeights:C,expandByDefault:s,gap:g,loadingIcon:x,expanded:L,pauseWhenPageIsHidden:_,cn:b})}))})):null};const ST=({...e})=>{const{theme:t="system"}=Dx();return l.jsx(bT,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})};var ET=$g.useId||(()=>{}),TT=0;function tn(e){const[t,r]=m.useState(ET());return er(()=>{e||r(n=>n??String(TT++))},[e]),e||(t?`radix-${t}`:"")}const CT=["top","right","bottom","left"],Bs=Math.min,Fr=Math.max,Oc=Math.round,ql=Math.floor,$s=e=>({x:e,y:e}),kT={left:"right",right:"left",bottom:"top",top:"bottom"},PT={start:"end",end:"start"};function Cf(e,t,r){return Fr(e,Bs(t,r))}function cs(e,t){return typeof e=="function"?e(t):e}function us(e){return e.split("-")[0]}function Vi(e){return e.split("-")[1]}function Ah(e){return e==="x"?"y":"x"}function Nh(e){return e==="y"?"height":"width"}function Ws(e){return["top","bottom"].includes(us(e))?"y":"x"}function Dh(e){return Ah(Ws(e))}function AT(e,t,r){r===void 0&&(r=!1);const n=Vi(e),s=Dh(e),a=Nh(s);let i=s==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[a]>t.floating[a]&&(i=Ic(i)),[i,Ic(i)]}function NT(e){const t=Ic(e);return[kf(e),t,kf(t)]}function kf(e){return e.replace(/start|end/g,t=>PT[t])}function DT(e,t,r){const n=["left","right"],s=["right","left"],a=["top","bottom"],i=["bottom","top"];switch(e){case"top":case"bottom":return r?t?s:n:t?n:s;case"left":case"right":return t?a:i;default:return[]}}function jT(e,t,r,n){const s=Vi(e);let a=DT(us(e),r==="start",n);return s&&(a=a.map(i=>i+"-"+s),t&&(a=a.concat(a.map(kf)))),a}function Ic(e){return e.replace(/left|right|bottom|top/g,t=>kT[t])}function RT(e){return{top:0,right:0,bottom:0,left:0,...e}}function jx(e){return typeof e!="number"?RT(e):{top:e,right:e,bottom:e,left:e}}function Mc(e){const{x:t,y:r,width:n,height:s}=e;return{width:n,height:s,top:r,left:t,right:t+n,bottom:r+s,x:t,y:r}}function fm(e,t,r){let{reference:n,floating:s}=e;const a=Ws(t),i=Dh(t),o=Nh(i),c=us(t),u=a==="y",d=n.x+n.width/2-s.width/2,f=n.y+n.height/2-s.height/2,h=n[o]/2-s[o]/2;let p;switch(c){case"top":p={x:d,y:n.y-s.height};break;case"bottom":p={x:d,y:n.y+n.height};break;case"right":p={x:n.x+n.width,y:f};break;case"left":p={x:n.x-s.width,y:f};break;default:p={x:n.x,y:n.y}}switch(Vi(t)){case"start":p[i]-=h*(r&&u?-1:1);break;case"end":p[i]+=h*(r&&u?-1:1);break}return p}const OT=async(e,t,r)=>{const{placement:n="bottom",strategy:s="absolute",middleware:a=[],platform:i}=r,o=a.filter(Boolean),c=await(i.isRTL==null?void 0:i.isRTL(t));let u=await i.getElementRects({reference:e,floating:t,strategy:s}),{x:d,y:f}=fm(u,n,c),h=n,p={},v=0;for(let g=0;g<o.length;g++){const{name:x,fn:y}=o[g],{x:w,y:_,data:b,reset:T}=await y({x:d,y:f,initialPlacement:n,placement:h,strategy:s,middlewareData:p,rects:u,platform:i,elements:{reference:e,floating:t}});d=w??d,f=_??f,p={...p,[x]:{...p[x],...b}},T&&v<=50&&(v++,typeof T=="object"&&(T.placement&&(h=T.placement),T.rects&&(u=T.rects===!0?await i.getElementRects({reference:e,floating:t,strategy:s}):T.rects),{x:d,y:f}=fm(u,h,c)),g=-1)}return{x:d,y:f,placement:h,strategy:s,middlewareData:p}};async function Vo(e,t){var r;t===void 0&&(t={});const{x:n,y:s,platform:a,rects:i,elements:o,strategy:c}=e,{boundary:u="clippingAncestors",rootBoundary:d="viewport",elementContext:f="floating",altBoundary:h=!1,padding:p=0}=cs(t,e),v=jx(p),x=o[h?f==="floating"?"reference":"floating":f],y=Mc(await a.getClippingRect({element:(r=await(a.isElement==null?void 0:a.isElement(x)))==null||r?x:x.contextElement||await(a.getDocumentElement==null?void 0:a.getDocumentElement(o.floating)),boundary:u,rootBoundary:d,strategy:c})),w=f==="floating"?{x:n,y:s,width:i.floating.width,height:i.floating.height}:i.reference,_=await(a.getOffsetParent==null?void 0:a.getOffsetParent(o.floating)),b=await(a.isElement==null?void 0:a.isElement(_))?await(a.getScale==null?void 0:a.getScale(_))||{x:1,y:1}:{x:1,y:1},T=Mc(a.convertOffsetParentRelativeRectToViewportRelativeRect?await a.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:w,offsetParent:_,strategy:c}):w);return{top:(y.top-T.top+v.top)/b.y,bottom:(T.bottom-y.bottom+v.bottom)/b.y,left:(y.left-T.left+v.left)/b.x,right:(T.right-y.right+v.right)/b.x}}const IT=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:n,placement:s,rects:a,platform:i,elements:o,middlewareData:c}=t,{element:u,padding:d=0}=cs(e,t)||{};if(u==null)return{};const f=jx(d),h={x:r,y:n},p=Dh(s),v=Nh(p),g=await i.getDimensions(u),x=p==="y",y=x?"top":"left",w=x?"bottom":"right",_=x?"clientHeight":"clientWidth",b=a.reference[v]+a.reference[p]-h[p]-a.floating[v],T=h[p]-a.reference[p],k=await(i.getOffsetParent==null?void 0:i.getOffsetParent(u));let S=k?k[_]:0;(!S||!await(i.isElement==null?void 0:i.isElement(k)))&&(S=o.floating[_]||a.floating[v]);const E=b/2-T/2,C=S/2-g[v]/2-1,L=Bs(f[y],C),M=Bs(f[w],C),j=L,V=S-g[v]-M,A=S/2-g[v]/2+E,H=Cf(j,A,V),G=!c.arrow&&Vi(s)!=null&&A!==H&&a.reference[v]/2-(A<j?L:M)-g[v]/2<0,q=G?A<j?A-j:A-V:0;return{[p]:h[p]+q,data:{[p]:H,centerOffset:A-H-q,...G&&{alignmentOffset:q}},reset:G}}}),MT=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,n;const{placement:s,middlewareData:a,rects:i,initialPlacement:o,platform:c,elements:u}=t,{mainAxis:d=!0,crossAxis:f=!0,fallbackPlacements:h,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:v="none",flipAlignment:g=!0,...x}=cs(e,t);if((r=a.arrow)!=null&&r.alignmentOffset)return{};const y=us(s),w=Ws(o),_=us(o)===o,b=await(c.isRTL==null?void 0:c.isRTL(u.floating)),T=h||(_||!g?[Ic(o)]:NT(o)),k=v!=="none";!h&&k&&T.push(...jT(o,g,v,b));const S=[o,...T],E=await Vo(t,x),C=[];let L=((n=a.flip)==null?void 0:n.overflows)||[];if(d&&C.push(E[y]),f){const A=AT(s,i,b);C.push(E[A[0]],E[A[1]])}if(L=[...L,{placement:s,overflows:C}],!C.every(A=>A<=0)){var M,j;const A=(((M=a.flip)==null?void 0:M.index)||0)+1,H=S[A];if(H)return{data:{index:A,overflows:L},reset:{placement:H}};let G=(j=L.filter(q=>q.overflows[0]<=0).sort((q,Y)=>q.overflows[1]-Y.overflows[1])[0])==null?void 0:j.placement;if(!G)switch(p){case"bestFit":{var V;const q=(V=L.filter(Y=>{if(k){const Q=Ws(Y.placement);return Q===w||Q==="y"}return!0}).map(Y=>[Y.placement,Y.overflows.filter(Q=>Q>0).reduce((Q,fe)=>Q+fe,0)]).sort((Y,Q)=>Y[1]-Q[1])[0])==null?void 0:V[0];q&&(G=q);break}case"initialPlacement":G=o;break}if(s!==G)return{reset:{placement:G}}}return{}}}};function hm(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function mm(e){return CT.some(t=>e[t]>=0)}const FT=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r}=t,{strategy:n="referenceHidden",...s}=cs(e,t);switch(n){case"referenceHidden":{const a=await Vo(t,{...s,elementContext:"reference"}),i=hm(a,r.reference);return{data:{referenceHiddenOffsets:i,referenceHidden:mm(i)}}}case"escaped":{const a=await Vo(t,{...s,altBoundary:!0}),i=hm(a,r.floating);return{data:{escapedOffsets:i,escaped:mm(i)}}}default:return{}}}}};async function LT(e,t){const{placement:r,platform:n,elements:s}=e,a=await(n.isRTL==null?void 0:n.isRTL(s.floating)),i=us(r),o=Vi(r),c=Ws(r)==="y",u=["left","top"].includes(i)?-1:1,d=a&&c?-1:1,f=cs(t,e);let{mainAxis:h,crossAxis:p,alignmentAxis:v}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:f.mainAxis||0,crossAxis:f.crossAxis||0,alignmentAxis:f.alignmentAxis};return o&&typeof v=="number"&&(p=o==="end"?v*-1:v),c?{x:p*d,y:h*u}:{x:h*u,y:p*d}}const BT=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,n;const{x:s,y:a,placement:i,middlewareData:o}=t,c=await LT(t,e);return i===((r=o.offset)==null?void 0:r.placement)&&(n=o.arrow)!=null&&n.alignmentOffset?{}:{x:s+c.x,y:a+c.y,data:{...c,placement:i}}}}},$T=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:n,placement:s}=t,{mainAxis:a=!0,crossAxis:i=!1,limiter:o={fn:x=>{let{x:y,y:w}=x;return{x:y,y:w}}},...c}=cs(e,t),u={x:r,y:n},d=await Vo(t,c),f=Ws(us(s)),h=Ah(f);let p=u[h],v=u[f];if(a){const x=h==="y"?"top":"left",y=h==="y"?"bottom":"right",w=p+d[x],_=p-d[y];p=Cf(w,p,_)}if(i){const x=f==="y"?"top":"left",y=f==="y"?"bottom":"right",w=v+d[x],_=v-d[y];v=Cf(w,v,_)}const g=o.fn({...t,[h]:p,[f]:v});return{...g,data:{x:g.x-r,y:g.y-n,enabled:{[h]:a,[f]:i}}}}}},WT=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:n,placement:s,rects:a,middlewareData:i}=t,{offset:o=0,mainAxis:c=!0,crossAxis:u=!0}=cs(e,t),d={x:r,y:n},f=Ws(s),h=Ah(f);let p=d[h],v=d[f];const g=cs(o,t),x=typeof g=="number"?{mainAxis:g,crossAxis:0}:{mainAxis:0,crossAxis:0,...g};if(c){const _=h==="y"?"height":"width",b=a.reference[h]-a.floating[_]+x.mainAxis,T=a.reference[h]+a.reference[_]-x.mainAxis;p<b?p=b:p>T&&(p=T)}if(u){var y,w;const _=h==="y"?"width":"height",b=["top","left"].includes(us(s)),T=a.reference[f]-a.floating[_]+(b&&((y=i.offset)==null?void 0:y[f])||0)+(b?0:x.crossAxis),k=a.reference[f]+a.reference[_]+(b?0:((w=i.offset)==null?void 0:w[f])||0)-(b?x.crossAxis:0);v<T?v=T:v>k&&(v=k)}return{[h]:p,[f]:v}}}},UT=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,n;const{placement:s,rects:a,platform:i,elements:o}=t,{apply:c=()=>{},...u}=cs(e,t),d=await Vo(t,u),f=us(s),h=Vi(s),p=Ws(s)==="y",{width:v,height:g}=a.floating;let x,y;f==="top"||f==="bottom"?(x=f,y=h===(await(i.isRTL==null?void 0:i.isRTL(o.floating))?"start":"end")?"left":"right"):(y=f,x=h==="end"?"top":"bottom");const w=g-d.top-d.bottom,_=v-d.left-d.right,b=Bs(g-d[x],w),T=Bs(v-d[y],_),k=!t.middlewareData.shift;let S=b,E=T;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(E=_),(n=t.middlewareData.shift)!=null&&n.enabled.y&&(S=w),k&&!h){const L=Fr(d.left,0),M=Fr(d.right,0),j=Fr(d.top,0),V=Fr(d.bottom,0);p?E=v-2*(L!==0||M!==0?L+M:Fr(d.left,d.right)):S=g-2*(j!==0||V!==0?j+V:Fr(d.top,d.bottom))}await c({...t,availableWidth:E,availableHeight:S});const C=await i.getDimensions(o.floating);return v!==C.width||g!==C.height?{reset:{rects:!0}}:{}}}};function Su(){return typeof window<"u"}function Hi(e){return Rx(e)?(e.nodeName||"").toLowerCase():"#document"}function Hr(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Vn(e){var t;return(t=(Rx(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function Rx(e){return Su()?e instanceof Node||e instanceof Hr(e).Node:!1}function yn(e){return Su()?e instanceof Element||e instanceof Hr(e).Element:!1}function $n(e){return Su()?e instanceof HTMLElement||e instanceof Hr(e).HTMLElement:!1}function pm(e){return!Su()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Hr(e).ShadowRoot}function vl(e){const{overflow:t,overflowX:r,overflowY:n,display:s}=wn(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!["inline","contents"].includes(s)}function VT(e){return["table","td","th"].includes(Hi(e))}function Eu(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function jh(e){const t=Rh(),r=yn(e)?wn(e):e;return r.transform!=="none"||r.perspective!=="none"||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||["transform","perspective","filter"].some(n=>(r.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(r.contain||"").includes(n))}function HT(e){let t=Us(e);for(;$n(t)&&!Ri(t);){if(jh(t))return t;if(Eu(t))return null;t=Us(t)}return null}function Rh(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Ri(e){return["html","body","#document"].includes(Hi(e))}function wn(e){return Hr(e).getComputedStyle(e)}function Tu(e){return yn(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Us(e){if(Hi(e)==="html")return e;const t=e.assignedSlot||e.parentNode||pm(e)&&e.host||Vn(e);return pm(t)?t.host:t}function Ox(e){const t=Us(e);return Ri(t)?e.ownerDocument?e.ownerDocument.body:e.body:$n(t)&&vl(t)?t:Ox(t)}function Ho(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const s=Ox(e),a=s===((n=e.ownerDocument)==null?void 0:n.body),i=Hr(s);if(a){const o=Pf(i);return t.concat(i,i.visualViewport||[],vl(s)?s:[],o&&r?Ho(o):[])}return t.concat(s,Ho(s,[],r))}function Pf(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function Ix(e){const t=wn(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const s=$n(e),a=s?e.offsetWidth:r,i=s?e.offsetHeight:n,o=Oc(r)!==a||Oc(n)!==i;return o&&(r=a,n=i),{width:r,height:n,$:o}}function Oh(e){return yn(e)?e:e.contextElement}function mi(e){const t=Oh(e);if(!$n(t))return $s(1);const r=t.getBoundingClientRect(),{width:n,height:s,$:a}=Ix(t);let i=(a?Oc(r.width):r.width)/n,o=(a?Oc(r.height):r.height)/s;return(!i||!Number.isFinite(i))&&(i=1),(!o||!Number.isFinite(o))&&(o=1),{x:i,y:o}}const zT=$s(0);function Mx(e){const t=Hr(e);return!Rh()||!t.visualViewport?zT:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function GT(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==Hr(e)?!1:t}function Ca(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const s=e.getBoundingClientRect(),a=Oh(e);let i=$s(1);t&&(n?yn(n)&&(i=mi(n)):i=mi(e));const o=GT(a,r,n)?Mx(a):$s(0);let c=(s.left+o.x)/i.x,u=(s.top+o.y)/i.y,d=s.width/i.x,f=s.height/i.y;if(a){const h=Hr(a),p=n&&yn(n)?Hr(n):n;let v=h,g=Pf(v);for(;g&&n&&p!==v;){const x=mi(g),y=g.getBoundingClientRect(),w=wn(g),_=y.left+(g.clientLeft+parseFloat(w.paddingLeft))*x.x,b=y.top+(g.clientTop+parseFloat(w.paddingTop))*x.y;c*=x.x,u*=x.y,d*=x.x,f*=x.y,c+=_,u+=b,v=Hr(g),g=Pf(v)}}return Mc({width:d,height:f,x:c,y:u})}function KT(e){let{elements:t,rect:r,offsetParent:n,strategy:s}=e;const a=s==="fixed",i=Vn(n),o=t?Eu(t.floating):!1;if(n===i||o&&a)return r;let c={scrollLeft:0,scrollTop:0},u=$s(1);const d=$s(0),f=$n(n);if((f||!f&&!a)&&((Hi(n)!=="body"||vl(i))&&(c=Tu(n)),$n(n))){const h=Ca(n);u=mi(n),d.x=h.x+n.clientLeft,d.y=h.y+n.clientTop}return{width:r.width*u.x,height:r.height*u.y,x:r.x*u.x-c.scrollLeft*u.x+d.x,y:r.y*u.y-c.scrollTop*u.y+d.y}}function YT(e){return Array.from(e.getClientRects())}function Af(e,t){const r=Tu(e).scrollLeft;return t?t.left+r:Ca(Vn(e)).left+r}function XT(e){const t=Vn(e),r=Tu(e),n=e.ownerDocument.body,s=Fr(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),a=Fr(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let i=-r.scrollLeft+Af(e);const o=-r.scrollTop;return wn(n).direction==="rtl"&&(i+=Fr(t.clientWidth,n.clientWidth)-s),{width:s,height:a,x:i,y:o}}function qT(e,t){const r=Hr(e),n=Vn(e),s=r.visualViewport;let a=n.clientWidth,i=n.clientHeight,o=0,c=0;if(s){a=s.width,i=s.height;const u=Rh();(!u||u&&t==="fixed")&&(o=s.offsetLeft,c=s.offsetTop)}return{width:a,height:i,x:o,y:c}}function JT(e,t){const r=Ca(e,!0,t==="fixed"),n=r.top+e.clientTop,s=r.left+e.clientLeft,a=$n(e)?mi(e):$s(1),i=e.clientWidth*a.x,o=e.clientHeight*a.y,c=s*a.x,u=n*a.y;return{width:i,height:o,x:c,y:u}}function gm(e,t,r){let n;if(t==="viewport")n=qT(e,r);else if(t==="document")n=XT(Vn(e));else if(yn(t))n=JT(t,r);else{const s=Mx(e);n={...t,x:t.x-s.x,y:t.y-s.y}}return Mc(n)}function Fx(e,t){const r=Us(e);return r===t||!yn(r)||Ri(r)?!1:wn(r).position==="fixed"||Fx(r,t)}function QT(e,t){const r=t.get(e);if(r)return r;let n=Ho(e,[],!1).filter(o=>yn(o)&&Hi(o)!=="body"),s=null;const a=wn(e).position==="fixed";let i=a?Us(e):e;for(;yn(i)&&!Ri(i);){const o=wn(i),c=jh(i);!c&&o.position==="fixed"&&(s=null),(a?!c&&!s:!c&&o.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||vl(i)&&!c&&Fx(e,i))?n=n.filter(d=>d!==i):s=o,i=Us(i)}return t.set(e,n),n}function ZT(e){let{element:t,boundary:r,rootBoundary:n,strategy:s}=e;const i=[...r==="clippingAncestors"?Eu(t)?[]:QT(t,this._c):[].concat(r),n],o=i[0],c=i.reduce((u,d)=>{const f=gm(t,d,s);return u.top=Fr(f.top,u.top),u.right=Bs(f.right,u.right),u.bottom=Bs(f.bottom,u.bottom),u.left=Fr(f.left,u.left),u},gm(t,o,s));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function eC(e){const{width:t,height:r}=Ix(e);return{width:t,height:r}}function tC(e,t,r){const n=$n(t),s=Vn(t),a=r==="fixed",i=Ca(e,!0,a,t);let o={scrollLeft:0,scrollTop:0};const c=$s(0);if(n||!n&&!a)if((Hi(t)!=="body"||vl(s))&&(o=Tu(t)),n){const p=Ca(t,!0,a,t);c.x=p.x+t.clientLeft,c.y=p.y+t.clientTop}else s&&(c.x=Af(s));let u=0,d=0;if(s&&!n&&!a){const p=s.getBoundingClientRect();d=p.top+o.scrollTop,u=p.left+o.scrollLeft-Af(s,p)}const f=i.left+o.scrollLeft-c.x-u,h=i.top+o.scrollTop-c.y-d;return{x:f,y:h,width:i.width,height:i.height}}function jd(e){return wn(e).position==="static"}function xm(e,t){if(!$n(e)||wn(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return Vn(e)===r&&(r=r.ownerDocument.body),r}function Lx(e,t){const r=Hr(e);if(Eu(e))return r;if(!$n(e)){let s=Us(e);for(;s&&!Ri(s);){if(yn(s)&&!jd(s))return s;s=Us(s)}return r}let n=xm(e,t);for(;n&&VT(n)&&jd(n);)n=xm(n,t);return n&&Ri(n)&&jd(n)&&!jh(n)?r:n||HT(e)||r}const rC=async function(e){const t=this.getOffsetParent||Lx,r=this.getDimensions,n=await r(e.floating);return{reference:tC(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function nC(e){return wn(e).direction==="rtl"}const sC={convertOffsetParentRelativeRectToViewportRelativeRect:KT,getDocumentElement:Vn,getClippingRect:ZT,getOffsetParent:Lx,getElementRects:rC,getClientRects:YT,getDimensions:eC,getScale:mi,isElement:yn,isRTL:nC};function aC(e,t){let r=null,n;const s=Vn(e);function a(){var o;clearTimeout(n),(o=r)==null||o.disconnect(),r=null}function i(o,c){o===void 0&&(o=!1),c===void 0&&(c=1),a();const{left:u,top:d,width:f,height:h}=e.getBoundingClientRect();if(o||t(),!f||!h)return;const p=ql(d),v=ql(s.clientWidth-(u+f)),g=ql(s.clientHeight-(d+h)),x=ql(u),w={rootMargin:-p+"px "+-v+"px "+-g+"px "+-x+"px",threshold:Fr(0,Bs(1,c))||1};let _=!0;function b(T){const k=T[0].intersectionRatio;if(k!==c){if(!_)return i();k?i(!1,k):n=setTimeout(()=>{i(!1,1e-7)},1e3)}_=!1}try{r=new IntersectionObserver(b,{...w,root:s.ownerDocument})}catch{r=new IntersectionObserver(b,w)}r.observe(e)}return i(!0),a}function iC(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:s=!0,ancestorResize:a=!0,elementResize:i=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:c=!1}=n,u=Oh(e),d=s||a?[...u?Ho(u):[],...Ho(t)]:[];d.forEach(y=>{s&&y.addEventListener("scroll",r,{passive:!0}),a&&y.addEventListener("resize",r)});const f=u&&o?aC(u,r):null;let h=-1,p=null;i&&(p=new ResizeObserver(y=>{let[w]=y;w&&w.target===u&&p&&(p.unobserve(t),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var _;(_=p)==null||_.observe(t)})),r()}),u&&!c&&p.observe(u),p.observe(t));let v,g=c?Ca(e):null;c&&x();function x(){const y=Ca(e);g&&(y.x!==g.x||y.y!==g.y||y.width!==g.width||y.height!==g.height)&&r(),g=y,v=requestAnimationFrame(x)}return r(),()=>{var y;d.forEach(w=>{s&&w.removeEventListener("scroll",r),a&&w.removeEventListener("resize",r)}),f==null||f(),(y=p)==null||y.disconnect(),p=null,c&&cancelAnimationFrame(v)}}const oC=BT,lC=$T,cC=MT,uC=UT,dC=FT,vm=IT,fC=WT,hC=(e,t,r)=>{const n=new Map,s={platform:sC,...r},a={...s.platform,_c:n};return OT(e,t,{...s,platform:a})};var kc=typeof document<"u"?m.useLayoutEffect:m.useEffect;function Fc(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,s;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!Fc(e[n],t[n]))return!1;return!0}if(s=Object.keys(e),r=s.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,s[n]))return!1;for(n=r;n--!==0;){const a=s[n];if(!(a==="_owner"&&e.$$typeof)&&!Fc(e[a],t[a]))return!1}return!0}return e!==e&&t!==t}function Bx(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function ym(e,t){const r=Bx(e);return Math.round(t*r)/r}function Rd(e){const t=m.useRef(e);return kc(()=>{t.current=e}),t}function mC(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:s,elements:{reference:a,floating:i}={},transform:o=!0,whileElementsMounted:c,open:u}=e,[d,f]=m.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[h,p]=m.useState(n);Fc(h,n)||p(n);const[v,g]=m.useState(null),[x,y]=m.useState(null),w=m.useCallback(Y=>{Y!==k.current&&(k.current=Y,g(Y))},[]),_=m.useCallback(Y=>{Y!==S.current&&(S.current=Y,y(Y))},[]),b=a||v,T=i||x,k=m.useRef(null),S=m.useRef(null),E=m.useRef(d),C=c!=null,L=Rd(c),M=Rd(s),j=Rd(u),V=m.useCallback(()=>{if(!k.current||!S.current)return;const Y={placement:t,strategy:r,middleware:h};M.current&&(Y.platform=M.current),hC(k.current,S.current,Y).then(Q=>{const fe={...Q,isPositioned:j.current!==!1};A.current&&!Fc(E.current,fe)&&(E.current=fe,Vr.flushSync(()=>{f(fe)}))})},[h,t,r,M,j]);kc(()=>{u===!1&&E.current.isPositioned&&(E.current.isPositioned=!1,f(Y=>({...Y,isPositioned:!1})))},[u]);const A=m.useRef(!1);kc(()=>(A.current=!0,()=>{A.current=!1}),[]),kc(()=>{if(b&&(k.current=b),T&&(S.current=T),b&&T){if(L.current)return L.current(b,T,V);V()}},[b,T,V,L,C]);const H=m.useMemo(()=>({reference:k,floating:S,setReference:w,setFloating:_}),[w,_]),G=m.useMemo(()=>({reference:b,floating:T}),[b,T]),q=m.useMemo(()=>{const Y={position:r,left:0,top:0};if(!G.floating)return Y;const Q=ym(G.floating,d.x),fe=ym(G.floating,d.y);return o?{...Y,transform:"translate("+Q+"px, "+fe+"px)",...Bx(G.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:Q,top:fe}},[r,o,G.floating,d.x,d.y]);return m.useMemo(()=>({...d,update:V,refs:H,elements:G,floatingStyles:q}),[d,V,H,G,q])}const pC=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:n,padding:s}=typeof e=="function"?e(r):e;return n&&t(n)?n.current!=null?vm({element:n.current,padding:s}).fn(r):{}:n?vm({element:n,padding:s}).fn(r):{}}}},gC=(e,t)=>({...oC(e),options:[e,t]}),xC=(e,t)=>({...lC(e),options:[e,t]}),vC=(e,t)=>({...fC(e),options:[e,t]}),yC=(e,t)=>({...cC(e),options:[e,t]}),wC=(e,t)=>({...uC(e),options:[e,t]}),_C=(e,t)=>({...dC(e),options:[e,t]}),bC=(e,t)=>({...pC(e),options:[e,t]});var SC="Arrow",$x=m.forwardRef((e,t)=>{const{children:r,width:n=10,height:s=5,...a}=e;return l.jsx(Ne.svg,{...a,ref:t,width:n,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:l.jsx("polygon",{points:"0,0 30,0 15,10"})})});$x.displayName=SC;var EC=$x;function TC(e,t=[]){let r=[];function n(a,i){const o=m.createContext(i),c=r.length;r=[...r,i];function u(f){const{scope:h,children:p,...v}=f,g=(h==null?void 0:h[e][c])||o,x=m.useMemo(()=>v,Object.values(v));return l.jsx(g.Provider,{value:x,children:p})}function d(f,h){const p=(h==null?void 0:h[e][c])||o,v=m.useContext(p);if(v)return v;if(i!==void 0)return i;throw new Error(`\`${f}\` must be used within \`${a}\``)}return u.displayName=a+"Provider",[u,d]}const s=()=>{const a=r.map(i=>m.createContext(i));return function(o){const c=(o==null?void 0:o[e])||a;return m.useMemo(()=>({[`__scope${e}`]:{...o,[e]:c}}),[o,c])}};return s.scopeName=e,[n,CC(s,...t)]}function CC(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(a){const i=n.reduce((o,{useScope:c,scopeName:u})=>{const f=c(a)[`__scope${u}`];return{...o,...f}},{});return m.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return r.scopeName=t.scopeName,r}function Ih(e){const[t,r]=m.useState(void 0);return er(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const n=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const a=s[0];let i,o;if("borderBoxSize"in a){const c=a.borderBoxSize,u=Array.isArray(c)?c[0]:c;i=u.inlineSize,o=u.blockSize}else i=e.offsetWidth,o=e.offsetHeight;r({width:i,height:o})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}var Mh="Popper",[Wx,Qs]=TC(Mh),[kC,Ux]=Wx(Mh),Vx=e=>{const{__scopePopper:t,children:r}=e,[n,s]=m.useState(null);return l.jsx(kC,{scope:t,anchor:n,onAnchorChange:s,children:r})};Vx.displayName=Mh;var Hx="PopperAnchor",zx=m.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:n,...s}=e,a=Ux(Hx,r),i=m.useRef(null),o=Me(t,i);return m.useEffect(()=>{a.onAnchorChange((n==null?void 0:n.current)||i.current)}),n?null:l.jsx(Ne.div,{...s,ref:o})});zx.displayName=Hx;var Fh="PopperContent",[PC,AC]=Wx(Fh),Gx=m.forwardRef((e,t)=>{var I,ee,z,R,J,Z;const{__scopePopper:r,side:n="bottom",sideOffset:s=0,align:a="center",alignOffset:i=0,arrowPadding:o=0,avoidCollisions:c=!0,collisionBoundary:u=[],collisionPadding:d=0,sticky:f="partial",hideWhenDetached:h=!1,updatePositionStrategy:p="optimized",onPlaced:v,...g}=e,x=Ux(Fh,r),[y,w]=m.useState(null),_=Me(t,ge=>w(ge)),[b,T]=m.useState(null),k=Ih(b),S=(k==null?void 0:k.width)??0,E=(k==null?void 0:k.height)??0,C=n+(a!=="center"?"-"+a:""),L=typeof d=="number"?d:{top:0,right:0,bottom:0,left:0,...d},M=Array.isArray(u)?u:[u],j=M.length>0,V={padding:L,boundary:M.filter(DC),altBoundary:j},{refs:A,floatingStyles:H,placement:G,isPositioned:q,middlewareData:Y}=mC({strategy:"fixed",placement:C,whileElementsMounted:(...ge)=>iC(...ge,{animationFrame:p==="always"}),elements:{reference:x.anchor},middleware:[gC({mainAxis:s+E,alignmentAxis:i}),c&&xC({mainAxis:!0,crossAxis:!1,limiter:f==="partial"?vC():void 0,...V}),c&&yC({...V}),wC({...V,apply:({elements:ge,rects:ye,availableWidth:Ce,availableHeight:Ie})=>{const{width:st,height:Se}=ye.reference,Le=ge.floating.style;Le.setProperty("--radix-popper-available-width",`${Ce}px`),Le.setProperty("--radix-popper-available-height",`${Ie}px`),Le.setProperty("--radix-popper-anchor-width",`${st}px`),Le.setProperty("--radix-popper-anchor-height",`${Se}px`)}}),b&&bC({element:b,padding:o}),jC({arrowWidth:S,arrowHeight:E}),h&&_C({strategy:"referenceHidden",...V})]}),[Q,fe]=Xx(G),oe=Et(v);er(()=>{q&&(oe==null||oe())},[q,oe]);const X=(I=Y.arrow)==null?void 0:I.x,le=(ee=Y.arrow)==null?void 0:ee.y,D=((z=Y.arrow)==null?void 0:z.centerOffset)!==0,[K,U]=m.useState();return er(()=>{y&&U(window.getComputedStyle(y).zIndex)},[y]),l.jsx("div",{ref:A.setFloating,"data-radix-popper-content-wrapper":"",style:{...H,transform:q?H.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:K,"--radix-popper-transform-origin":[(R=Y.transformOrigin)==null?void 0:R.x,(J=Y.transformOrigin)==null?void 0:J.y].join(" "),...((Z=Y.hide)==null?void 0:Z.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:l.jsx(PC,{scope:r,placedSide:Q,onArrowChange:T,arrowX:X,arrowY:le,shouldHideArrow:D,children:l.jsx(Ne.div,{"data-side":Q,"data-align":fe,...g,ref:_,style:{...g.style,animation:q?void 0:"none"}})})})});Gx.displayName=Fh;var Kx="PopperArrow",NC={top:"bottom",right:"left",bottom:"top",left:"right"},Yx=m.forwardRef(function(t,r){const{__scopePopper:n,...s}=t,a=AC(Kx,n),i=NC[a.placedSide];return l.jsx("span",{ref:a.onArrowChange,style:{position:"absolute",left:a.arrowX,top:a.arrowY,[i]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[a.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[a.placedSide],visibility:a.shouldHideArrow?"hidden":void 0},children:l.jsx(EC,{...s,ref:r,style:{...s.style,display:"block"}})})});Yx.displayName=Kx;function DC(e){return e!==null}var jC=e=>({name:"transformOrigin",options:e,fn(t){var x,y,w;const{placement:r,rects:n,middlewareData:s}=t,i=((x=s.arrow)==null?void 0:x.centerOffset)!==0,o=i?0:e.arrowWidth,c=i?0:e.arrowHeight,[u,d]=Xx(r),f={start:"0%",center:"50%",end:"100%"}[d],h=(((y=s.arrow)==null?void 0:y.x)??0)+o/2,p=(((w=s.arrow)==null?void 0:w.y)??0)+c/2;let v="",g="";return u==="bottom"?(v=i?f:`${h}px`,g=`${-c}px`):u==="top"?(v=i?f:`${h}px`,g=`${n.floating.height+c}px`):u==="right"?(v=`${-c}px`,g=i?f:`${p}px`):u==="left"&&(v=`${n.floating.width+c}px`,g=i?f:`${p}px`),{data:{x:v,y:g}}}});function Xx(e){const[t,r="center"]=e.split("-");return[t,r]}var Cu=Vx,yl=zx,ku=Gx,Pu=Yx,[Au,mW]=bn("Tooltip",[Qs]),Nu=Qs(),qx="TooltipProvider",RC=700,Nf="tooltip.open",[OC,Lh]=Au(qx),Jx=e=>{const{__scopeTooltip:t,delayDuration:r=RC,skipDelayDuration:n=300,disableHoverableContent:s=!1,children:a}=e,[i,o]=m.useState(!0),c=m.useRef(!1),u=m.useRef(0);return m.useEffect(()=>{const d=u.current;return()=>window.clearTimeout(d)},[]),l.jsx(OC,{scope:t,isOpenDelayed:i,delayDuration:r,onOpen:m.useCallback(()=>{window.clearTimeout(u.current),o(!1)},[]),onClose:m.useCallback(()=>{window.clearTimeout(u.current),u.current=window.setTimeout(()=>o(!0),n)},[n]),isPointerInTransitRef:c,onPointerInTransitChange:m.useCallback(d=>{c.current=d},[]),disableHoverableContent:s,children:a})};Jx.displayName=qx;var Du="Tooltip",[IC,ju]=Au(Du),Qx=e=>{const{__scopeTooltip:t,children:r,open:n,defaultOpen:s=!1,onOpenChange:a,disableHoverableContent:i,delayDuration:o}=e,c=Lh(Du,e.__scopeTooltip),u=Nu(t),[d,f]=m.useState(null),h=tn(),p=m.useRef(0),v=i??c.disableHoverableContent,g=o??c.delayDuration,x=m.useRef(!1),[y=!1,w]=vn({prop:n,defaultProp:s,onChange:S=>{S?(c.onOpen(),document.dispatchEvent(new CustomEvent(Nf))):c.onClose(),a==null||a(S)}}),_=m.useMemo(()=>y?x.current?"delayed-open":"instant-open":"closed",[y]),b=m.useCallback(()=>{window.clearTimeout(p.current),p.current=0,x.current=!1,w(!0)},[w]),T=m.useCallback(()=>{window.clearTimeout(p.current),p.current=0,w(!1)},[w]),k=m.useCallback(()=>{window.clearTimeout(p.current),p.current=window.setTimeout(()=>{x.current=!0,w(!0),p.current=0},g)},[g,w]);return m.useEffect(()=>()=>{p.current&&(window.clearTimeout(p.current),p.current=0)},[]),l.jsx(Cu,{...u,children:l.jsx(IC,{scope:t,contentId:h,open:y,stateAttribute:_,trigger:d,onTriggerChange:f,onTriggerEnter:m.useCallback(()=>{c.isOpenDelayed?k():b()},[c.isOpenDelayed,k,b]),onTriggerLeave:m.useCallback(()=>{v?T():(window.clearTimeout(p.current),p.current=0)},[T,v]),onOpen:b,onClose:T,disableHoverableContent:v,children:r})})};Qx.displayName=Du;var Df="TooltipTrigger",Zx=m.forwardRef((e,t)=>{const{__scopeTooltip:r,...n}=e,s=ju(Df,r),a=Lh(Df,r),i=Nu(r),o=m.useRef(null),c=Me(t,o,s.onTriggerChange),u=m.useRef(!1),d=m.useRef(!1),f=m.useCallback(()=>u.current=!1,[]);return m.useEffect(()=>()=>document.removeEventListener("pointerup",f),[f]),l.jsx(yl,{asChild:!0,...i,children:l.jsx(Ne.button,{"aria-describedby":s.open?s.contentId:void 0,"data-state":s.stateAttribute,...n,ref:c,onPointerMove:he(e.onPointerMove,h=>{h.pointerType!=="touch"&&!d.current&&!a.isPointerInTransitRef.current&&(s.onTriggerEnter(),d.current=!0)}),onPointerLeave:he(e.onPointerLeave,()=>{s.onTriggerLeave(),d.current=!1}),onPointerDown:he(e.onPointerDown,()=>{u.current=!0,document.addEventListener("pointerup",f,{once:!0})}),onFocus:he(e.onFocus,()=>{u.current||s.onOpen()}),onBlur:he(e.onBlur,s.onClose),onClick:he(e.onClick,s.onClose)})})});Zx.displayName=Df;var MC="TooltipPortal",[pW,FC]=Au(MC,{forceMount:void 0}),Oi="TooltipContent",ev=m.forwardRef((e,t)=>{const r=FC(Oi,e.__scopeTooltip),{forceMount:n=r.forceMount,side:s="top",...a}=e,i=ju(Oi,e.__scopeTooltip);return l.jsx(Kt,{present:n||i.open,children:i.disableHoverableContent?l.jsx(tv,{side:s,...a,ref:t}):l.jsx(LC,{side:s,...a,ref:t})})}),LC=m.forwardRef((e,t)=>{const r=ju(Oi,e.__scopeTooltip),n=Lh(Oi,e.__scopeTooltip),s=m.useRef(null),a=Me(t,s),[i,o]=m.useState(null),{trigger:c,onClose:u}=r,d=s.current,{onPointerInTransitChange:f}=n,h=m.useCallback(()=>{o(null),f(!1)},[f]),p=m.useCallback((v,g)=>{const x=v.currentTarget,y={x:v.clientX,y:v.clientY},w=UC(y,x.getBoundingClientRect()),_=VC(y,w),b=HC(g.getBoundingClientRect()),T=GC([..._,...b]);o(T),f(!0)},[f]);return m.useEffect(()=>()=>h(),[h]),m.useEffect(()=>{if(c&&d){const v=x=>p(x,d),g=x=>p(x,c);return c.addEventListener("pointerleave",v),d.addEventListener("pointerleave",g),()=>{c.removeEventListener("pointerleave",v),d.removeEventListener("pointerleave",g)}}},[c,d,p,h]),m.useEffect(()=>{if(i){const v=g=>{const x=g.target,y={x:g.clientX,y:g.clientY},w=(c==null?void 0:c.contains(x))||(d==null?void 0:d.contains(x)),_=!zC(y,i);w?h():_&&(h(),u())};return document.addEventListener("pointermove",v),()=>document.removeEventListener("pointermove",v)}},[c,d,i,u,h]),l.jsx(tv,{...e,ref:a})}),[BC,$C]=Au(Du,{isInside:!1}),tv=m.forwardRef((e,t)=>{const{__scopeTooltip:r,children:n,"aria-label":s,onEscapeKeyDown:a,onPointerDownOutside:i,...o}=e,c=ju(Oi,r),u=Nu(r),{onClose:d}=c;return m.useEffect(()=>(document.addEventListener(Nf,d),()=>document.removeEventListener(Nf,d)),[d]),m.useEffect(()=>{if(c.trigger){const f=h=>{const p=h.target;p!=null&&p.contains(c.trigger)&&d()};return window.addEventListener("scroll",f,{capture:!0}),()=>window.removeEventListener("scroll",f,{capture:!0})}},[c.trigger,d]),l.jsx($a,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:a,onPointerDownOutside:i,onFocusOutside:f=>f.preventDefault(),onDismiss:d,children:l.jsxs(ku,{"data-state":c.stateAttribute,...u,...o,ref:t,style:{...o.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[l.jsx(Gg,{children:n}),l.jsx(BC,{scope:r,isInside:!0,children:l.jsx(C2,{id:c.contentId,role:"tooltip",children:s||n})})]})})});ev.displayName=Oi;var rv="TooltipArrow",WC=m.forwardRef((e,t)=>{const{__scopeTooltip:r,...n}=e,s=Nu(r);return $C(rv,r).isInside?null:l.jsx(Pu,{...s,...n,ref:t})});WC.displayName=rv;function UC(e,t){const r=Math.abs(t.top-e.y),n=Math.abs(t.bottom-e.y),s=Math.abs(t.right-e.x),a=Math.abs(t.left-e.x);switch(Math.min(r,n,s,a)){case a:return"left";case s:return"right";case r:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function VC(e,t,r=5){const n=[];switch(t){case"top":n.push({x:e.x-r,y:e.y+r},{x:e.x+r,y:e.y+r});break;case"bottom":n.push({x:e.x-r,y:e.y-r},{x:e.x+r,y:e.y-r});break;case"left":n.push({x:e.x+r,y:e.y-r},{x:e.x+r,y:e.y+r});break;case"right":n.push({x:e.x-r,y:e.y-r},{x:e.x-r,y:e.y+r});break}return n}function HC(e){const{top:t,right:r,bottom:n,left:s}=e;return[{x:s,y:t},{x:r,y:t},{x:r,y:n},{x:s,y:n}]}function zC(e,t){const{x:r,y:n}=e;let s=!1;for(let a=0,i=t.length-1;a<t.length;i=a++){const o=t[a].x,c=t[a].y,u=t[i].x,d=t[i].y;c>n!=d>n&&r<(u-o)*(n-c)/(d-c)+o&&(s=!s)}return s}function GC(e){const t=e.slice();return t.sort((r,n)=>r.x<n.x?-1:r.x>n.x?1:r.y<n.y?-1:r.y>n.y?1:0),KC(t)}function KC(e){if(e.length<=1)return e.slice();const t=[];for(let n=0;n<e.length;n++){const s=e[n];for(;t.length>=2;){const a=t[t.length-1],i=t[t.length-2];if((a.x-i.x)*(s.y-i.y)>=(a.y-i.y)*(s.x-i.x))t.pop();else break}t.push(s)}t.pop();const r=[];for(let n=e.length-1;n>=0;n--){const s=e[n];for(;r.length>=2;){const a=r[r.length-1],i=r[r.length-2];if((a.x-i.x)*(s.y-i.y)>=(a.y-i.y)*(s.x-i.x))r.pop();else break}r.push(s)}return r.pop(),t.length===1&&r.length===1&&t[0].x===r[0].x&&t[0].y===r[0].y?t:t.concat(r)}var YC=Jx,XC=Qx,qC=Zx,nv=ev;const zi=YC,zo=XC,Go=qC,Ii=m.forwardRef(({className:e,sideOffset:t=4,...r},n)=>l.jsx(nv,{ref:n,sideOffset:t,className:Pe("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r}));Ii.displayName=nv.displayName;var Ru=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Ou=typeof window>"u"||"Deno"in globalThis;function dn(){}function JC(e,t){return typeof e=="function"?e(t):e}function QC(e){return typeof e=="number"&&e>=0&&e!==1/0}function ZC(e,t){return Math.max(e+(t||0)-Date.now(),0)}function wm(e,t){return typeof e=="function"?e(t):e}function ek(e,t){return typeof e=="function"?e(t):e}function _m(e,t){const{type:r="all",exact:n,fetchStatus:s,predicate:a,queryKey:i,stale:o}=e;if(i){if(n){if(t.queryHash!==Bh(i,t.options))return!1}else if(!Yo(t.queryKey,i))return!1}if(r!=="all"){const c=t.isActive();if(r==="active"&&!c||r==="inactive"&&c)return!1}return!(typeof o=="boolean"&&t.isStale()!==o||s&&s!==t.state.fetchStatus||a&&!a(t))}function bm(e,t){const{exact:r,status:n,predicate:s,mutationKey:a}=e;if(a){if(!t.options.mutationKey)return!1;if(r){if(Ko(t.options.mutationKey)!==Ko(a))return!1}else if(!Yo(t.options.mutationKey,a))return!1}return!(n&&t.state.status!==n||s&&!s(t))}function Bh(e,t){return((t==null?void 0:t.queryKeyHashFn)||Ko)(e)}function Ko(e){return JSON.stringify(e,(t,r)=>jf(r)?Object.keys(r).sort().reduce((n,s)=>(n[s]=r[s],n),{}):r)}function Yo(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?!Object.keys(t).some(r=>!Yo(e[r],t[r])):!1}function sv(e,t){if(e===t)return e;const r=Sm(e)&&Sm(t);if(r||jf(e)&&jf(t)){const n=r?e:Object.keys(e),s=n.length,a=r?t:Object.keys(t),i=a.length,o=r?[]:{};let c=0;for(let u=0;u<i;u++){const d=r?u:a[u];(!r&&n.includes(d)||r)&&e[d]===void 0&&t[d]===void 0?(o[d]=void 0,c++):(o[d]=sv(e[d],t[d]),o[d]===e[d]&&e[d]!==void 0&&c++)}return s===i&&c===s?e:o}return t}function Sm(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function jf(e){if(!Em(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!Em(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function Em(e){return Object.prototype.toString.call(e)==="[object Object]"}function tk(e){return new Promise(t=>{setTimeout(t,e)})}function rk(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?sv(e,t):t}function nk(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function sk(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var $h=Symbol();function av(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===$h?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var ga,As,bi,jg,ak=(jg=class extends Ru{constructor(){super();ot(this,ga);ot(this,As);ot(this,bi);Ve(this,bi,t=>{if(!Ou&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){ue(this,As)||this.setEventListener(ue(this,bi))}onUnsubscribe(){var t;this.hasListeners()||((t=ue(this,As))==null||t.call(this),Ve(this,As,void 0))}setEventListener(t){var r;Ve(this,bi,t),(r=ue(this,As))==null||r.call(this),Ve(this,As,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){ue(this,ga)!==t&&(Ve(this,ga,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof ue(this,ga)=="boolean"?ue(this,ga):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},ga=new WeakMap,As=new WeakMap,bi=new WeakMap,jg),iv=new ak,Si,Ns,Ei,Rg,ik=(Rg=class extends Ru{constructor(){super();ot(this,Si,!0);ot(this,Ns);ot(this,Ei);Ve(this,Ei,t=>{if(!Ou&&window.addEventListener){const r=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){ue(this,Ns)||this.setEventListener(ue(this,Ei))}onUnsubscribe(){var t;this.hasListeners()||((t=ue(this,Ns))==null||t.call(this),Ve(this,Ns,void 0))}setEventListener(t){var r;Ve(this,Ei,t),(r=ue(this,Ns))==null||r.call(this),Ve(this,Ns,t(this.setOnline.bind(this)))}setOnline(t){ue(this,Si)!==t&&(Ve(this,Si,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return ue(this,Si)}},Si=new WeakMap,Ns=new WeakMap,Ei=new WeakMap,Rg),Lc=new ik;function ok(){let e,t;const r=new Promise((s,a)=>{e=s,t=a});r.status="pending",r.catch(()=>{});function n(s){Object.assign(r,s),delete r.resolve,delete r.reject}return r.resolve=s=>{n({status:"fulfilled",value:s}),e(s)},r.reject=s=>{n({status:"rejected",reason:s}),t(s)},r}function lk(e){return Math.min(1e3*2**e,3e4)}function ov(e){return(e??"online")==="online"?Lc.isOnline():!0}var lv=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function Od(e){return e instanceof lv}function cv(e){let t=!1,r=0,n=!1,s;const a=ok(),i=g=>{var x;n||(h(new lv(g)),(x=e.abort)==null||x.call(e))},o=()=>{t=!0},c=()=>{t=!1},u=()=>iv.isFocused()&&(e.networkMode==="always"||Lc.isOnline())&&e.canRun(),d=()=>ov(e.networkMode)&&e.canRun(),f=g=>{var x;n||(n=!0,(x=e.onSuccess)==null||x.call(e,g),s==null||s(),a.resolve(g))},h=g=>{var x;n||(n=!0,(x=e.onError)==null||x.call(e,g),s==null||s(),a.reject(g))},p=()=>new Promise(g=>{var x;s=y=>{(n||u())&&g(y)},(x=e.onPause)==null||x.call(e)}).then(()=>{var g;s=void 0,n||(g=e.onContinue)==null||g.call(e)}),v=()=>{if(n)return;let g;const x=r===0?e.initialPromise:void 0;try{g=x??e.fn()}catch(y){g=Promise.reject(y)}Promise.resolve(g).then(f).catch(y=>{var k;if(n)return;const w=e.retry??(Ou?0:3),_=e.retryDelay??lk,b=typeof _=="function"?_(r,y):_,T=w===!0||typeof w=="number"&&r<w||typeof w=="function"&&w(r,y);if(t||!T){h(y);return}r++,(k=e.onFail)==null||k.call(e,r,y),tk(b).then(()=>u()?void 0:p()).then(()=>{t?h(y):v()})})};return{promise:a,cancel:i,continue:()=>(s==null||s(),a),cancelRetry:o,continueRetry:c,canStart:d,start:()=>(d()?v():p().then(v),a)}}function ck(){let e=[],t=0,r=o=>{o()},n=o=>{o()},s=o=>setTimeout(o,0);const a=o=>{t?e.push(o):s(()=>{r(o)})},i=()=>{const o=e;e=[],o.length&&s(()=>{n(()=>{o.forEach(c=>{r(c)})})})};return{batch:o=>{let c;t++;try{c=o()}finally{t--,t||i()}return c},batchCalls:o=>(...c)=>{a(()=>{o(...c)})},schedule:a,setNotifyFunction:o=>{r=o},setBatchNotifyFunction:o=>{n=o},setScheduler:o=>{s=o}}}var hr=ck(),xa,Og,uv=(Og=class{constructor(){ot(this,xa)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),QC(this.gcTime)&&Ve(this,xa,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Ou?1/0:5*60*1e3))}clearGcTimeout(){ue(this,xa)&&(clearTimeout(ue(this,xa)),Ve(this,xa,void 0))}},xa=new WeakMap,Og),Ti,Ci,Xr,sr,hl,va,fn,Xn,Ig,uk=(Ig=class extends uv{constructor(t){super();ot(this,fn);ot(this,Ti);ot(this,Ci);ot(this,Xr);ot(this,sr);ot(this,hl);ot(this,va);Ve(this,va,!1),Ve(this,hl,t.defaultOptions),this.setOptions(t.options),this.observers=[],Ve(this,Xr,t.cache),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Ve(this,Ti,fk(this.options)),this.state=t.state??ue(this,Ti),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=ue(this,sr))==null?void 0:t.promise}setOptions(t){this.options={...ue(this,hl),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&ue(this,Xr).remove(this)}setData(t,r){const n=rk(this.state.data,t,this.options);return nr(this,fn,Xn).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(t,r){nr(this,fn,Xn).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var n,s;const r=(n=ue(this,sr))==null?void 0:n.promise;return(s=ue(this,sr))==null||s.cancel(t),r?r.then(dn).catch(dn):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(ue(this,Ti))}isActive(){return this.observers.some(t=>ek(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===$h||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(t=0){return this.state.isInvalidated||this.state.data===void 0||!ZC(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=ue(this,sr))==null||r.continue()}onOnline(){var r;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=ue(this,sr))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),ue(this,Xr).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(ue(this,sr)&&(ue(this,va)?ue(this,sr).cancel({revert:!0}):ue(this,sr).cancelRetry()),this.scheduleGc()),ue(this,Xr).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||nr(this,fn,Xn).call(this,{type:"invalidate"})}fetch(t,r){var c,u,d;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(ue(this,sr))return ue(this,sr).continueRetry(),ue(this,sr).promise}if(t&&this.setOptions(t),!this.options.queryFn){const f=this.observers.find(h=>h.options.queryFn);f&&this.setOptions(f.options)}const n=new AbortController,s=f=>{Object.defineProperty(f,"signal",{enumerable:!0,get:()=>(Ve(this,va,!0),n.signal)})},a=()=>{const f=av(this.options,r),h={queryKey:this.queryKey,meta:this.meta};return s(h),Ve(this,va,!1),this.options.persister?this.options.persister(f,h,this):f(h)},i={fetchOptions:r,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:a};s(i),(c=this.options.behavior)==null||c.onFetch(i,this),Ve(this,Ci,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((u=i.fetchOptions)==null?void 0:u.meta))&&nr(this,fn,Xn).call(this,{type:"fetch",meta:(d=i.fetchOptions)==null?void 0:d.meta});const o=f=>{var h,p,v,g;Od(f)&&f.silent||nr(this,fn,Xn).call(this,{type:"error",error:f}),Od(f)||((p=(h=ue(this,Xr).config).onError)==null||p.call(h,f,this),(g=(v=ue(this,Xr).config).onSettled)==null||g.call(v,this.state.data,f,this)),this.scheduleGc()};return Ve(this,sr,cv({initialPromise:r==null?void 0:r.initialPromise,fn:i.fetchFn,abort:n.abort.bind(n),onSuccess:f=>{var h,p,v,g;if(f===void 0){o(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(f)}catch(x){o(x);return}(p=(h=ue(this,Xr).config).onSuccess)==null||p.call(h,f,this),(g=(v=ue(this,Xr).config).onSettled)==null||g.call(v,f,this.state.error,this),this.scheduleGc()},onError:o,onFail:(f,h)=>{nr(this,fn,Xn).call(this,{type:"failed",failureCount:f,error:h})},onPause:()=>{nr(this,fn,Xn).call(this,{type:"pause"})},onContinue:()=>{nr(this,fn,Xn).call(this,{type:"continue"})},retry:i.options.retry,retryDelay:i.options.retryDelay,networkMode:i.options.networkMode,canRun:()=>!0})),ue(this,sr).start()}},Ti=new WeakMap,Ci=new WeakMap,Xr=new WeakMap,sr=new WeakMap,hl=new WeakMap,va=new WeakMap,fn=new WeakSet,Xn=function(t){const r=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...dk(n.data,this.options),fetchMeta:t.meta??null};case"success":return{...n,data:t.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const s=t.error;return Od(s)&&s.revert&&ue(this,Ci)?{...ue(this,Ci),fetchStatus:"idle"}:{...n,error:s,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:s,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=r(this.state),hr.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),ue(this,Xr).notify({query:this,type:"updated",action:t})})},Ig);function dk(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:ov(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function fk(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,n=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var Nn,Mg,hk=(Mg=class extends Ru{constructor(t={}){super();ot(this,Nn);this.config=t,Ve(this,Nn,new Map)}build(t,r,n){const s=r.queryKey,a=r.queryHash??Bh(s,r);let i=this.get(a);return i||(i=new uk({cache:this,queryKey:s,queryHash:a,options:t.defaultQueryOptions(r),state:n,defaultOptions:t.getQueryDefaults(s)}),this.add(i)),i}add(t){ue(this,Nn).has(t.queryHash)||(ue(this,Nn).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=ue(this,Nn).get(t.queryHash);r&&(t.destroy(),r===t&&ue(this,Nn).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){hr.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return ue(this,Nn).get(t)}getAll(){return[...ue(this,Nn).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(n=>_m(r,n))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(n=>_m(t,n)):r}notify(t){hr.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){hr.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){hr.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},Nn=new WeakMap,Mg),Dn,lr,ya,jn,ws,Fg,mk=(Fg=class extends uv{constructor(t){super();ot(this,jn);ot(this,Dn);ot(this,lr);ot(this,ya);this.mutationId=t.mutationId,Ve(this,lr,t.mutationCache),Ve(this,Dn,[]),this.state=t.state||pk(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){ue(this,Dn).includes(t)||(ue(this,Dn).push(t),this.clearGcTimeout(),ue(this,lr).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Ve(this,Dn,ue(this,Dn).filter(r=>r!==t)),this.scheduleGc(),ue(this,lr).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){ue(this,Dn).length||(this.state.status==="pending"?this.scheduleGc():ue(this,lr).remove(this))}continue(){var t;return((t=ue(this,ya))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var s,a,i,o,c,u,d,f,h,p,v,g,x,y,w,_,b,T,k,S;Ve(this,ya,cv({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(E,C)=>{nr(this,jn,ws).call(this,{type:"failed",failureCount:E,error:C})},onPause:()=>{nr(this,jn,ws).call(this,{type:"pause"})},onContinue:()=>{nr(this,jn,ws).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>ue(this,lr).canRun(this)}));const r=this.state.status==="pending",n=!ue(this,ya).canStart();try{if(!r){nr(this,jn,ws).call(this,{type:"pending",variables:t,isPaused:n}),await((a=(s=ue(this,lr).config).onMutate)==null?void 0:a.call(s,t,this));const C=await((o=(i=this.options).onMutate)==null?void 0:o.call(i,t));C!==this.state.context&&nr(this,jn,ws).call(this,{type:"pending",context:C,variables:t,isPaused:n})}const E=await ue(this,ya).start();return await((u=(c=ue(this,lr).config).onSuccess)==null?void 0:u.call(c,E,t,this.state.context,this)),await((f=(d=this.options).onSuccess)==null?void 0:f.call(d,E,t,this.state.context)),await((p=(h=ue(this,lr).config).onSettled)==null?void 0:p.call(h,E,null,this.state.variables,this.state.context,this)),await((g=(v=this.options).onSettled)==null?void 0:g.call(v,E,null,t,this.state.context)),nr(this,jn,ws).call(this,{type:"success",data:E}),E}catch(E){try{throw await((y=(x=ue(this,lr).config).onError)==null?void 0:y.call(x,E,t,this.state.context,this)),await((_=(w=this.options).onError)==null?void 0:_.call(w,E,t,this.state.context)),await((T=(b=ue(this,lr).config).onSettled)==null?void 0:T.call(b,void 0,E,this.state.variables,this.state.context,this)),await((S=(k=this.options).onSettled)==null?void 0:S.call(k,void 0,E,t,this.state.context)),E}finally{nr(this,jn,ws).call(this,{type:"error",error:E})}}finally{ue(this,lr).runNext(this)}}},Dn=new WeakMap,lr=new WeakMap,ya=new WeakMap,jn=new WeakSet,ws=function(t){const r=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),hr.batch(()=>{ue(this,Dn).forEach(n=>{n.onMutationUpdate(t)}),ue(this,lr).notify({mutation:this,type:"updated",action:t})})},Fg);function pk(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Rr,ml,Lg,gk=(Lg=class extends Ru{constructor(t={}){super();ot(this,Rr);ot(this,ml);this.config=t,Ve(this,Rr,new Map),Ve(this,ml,Date.now())}build(t,r,n){const s=new mk({mutationCache:this,mutationId:++Gl(this,ml)._,options:t.defaultMutationOptions(r),state:n});return this.add(s),s}add(t){const r=Jl(t),n=ue(this,Rr).get(r)??[];n.push(t),ue(this,Rr).set(r,n),this.notify({type:"added",mutation:t})}remove(t){var n;const r=Jl(t);if(ue(this,Rr).has(r)){const s=(n=ue(this,Rr).get(r))==null?void 0:n.filter(a=>a!==t);s&&(s.length===0?ue(this,Rr).delete(r):ue(this,Rr).set(r,s))}this.notify({type:"removed",mutation:t})}canRun(t){var n;const r=(n=ue(this,Rr).get(Jl(t)))==null?void 0:n.find(s=>s.state.status==="pending");return!r||r===t}runNext(t){var n;const r=(n=ue(this,Rr).get(Jl(t)))==null?void 0:n.find(s=>s!==t&&s.state.isPaused);return(r==null?void 0:r.continue())??Promise.resolve()}clear(){hr.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}getAll(){return[...ue(this,Rr).values()].flat()}find(t){const r={exact:!0,...t};return this.getAll().find(n=>bm(r,n))}findAll(t={}){return this.getAll().filter(r=>bm(t,r))}notify(t){hr.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return hr.batch(()=>Promise.all(t.map(r=>r.continue().catch(dn))))}},Rr=new WeakMap,ml=new WeakMap,Lg);function Jl(e){var t;return((t=e.options.scope)==null?void 0:t.id)??String(e.mutationId)}function Tm(e){return{onFetch:(t,r)=>{var d,f,h,p,v;const n=t.options,s=(h=(f=(d=t.fetchOptions)==null?void 0:d.meta)==null?void 0:f.fetchMore)==null?void 0:h.direction,a=((p=t.state.data)==null?void 0:p.pages)||[],i=((v=t.state.data)==null?void 0:v.pageParams)||[];let o={pages:[],pageParams:[]},c=0;const u=async()=>{let g=!1;const x=_=>{Object.defineProperty(_,"signal",{enumerable:!0,get:()=>(t.signal.aborted?g=!0:t.signal.addEventListener("abort",()=>{g=!0}),t.signal)})},y=av(t.options,t.fetchOptions),w=async(_,b,T)=>{if(g)return Promise.reject();if(b==null&&_.pages.length)return Promise.resolve(_);const k={queryKey:t.queryKey,pageParam:b,direction:T?"backward":"forward",meta:t.options.meta};x(k);const S=await y(k),{maxPages:E}=t.options,C=T?sk:nk;return{pages:C(_.pages,S,E),pageParams:C(_.pageParams,b,E)}};if(s&&a.length){const _=s==="backward",b=_?xk:Cm,T={pages:a,pageParams:i},k=b(n,T);o=await w(T,k,_)}else{const _=e??a.length;do{const b=c===0?i[0]??n.initialPageParam:Cm(n,o);if(c>0&&b==null)break;o=await w(o,b),c++}while(c<_)}return o};t.options.persister?t.fetchFn=()=>{var g,x;return(x=(g=t.options).persister)==null?void 0:x.call(g,u,{queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=u}}}function Cm(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function xk(e,{pages:t,pageParams:r}){var n;return t.length>0?(n=e.getPreviousPageParam)==null?void 0:n.call(e,t[0],t,r[0],r):void 0}var Ct,Ds,js,ki,Pi,Rs,Ai,Ni,Bg,vk=(Bg=class{constructor(e={}){ot(this,Ct);ot(this,Ds);ot(this,js);ot(this,ki);ot(this,Pi);ot(this,Rs);ot(this,Ai);ot(this,Ni);Ve(this,Ct,e.queryCache||new hk),Ve(this,Ds,e.mutationCache||new gk),Ve(this,js,e.defaultOptions||{}),Ve(this,ki,new Map),Ve(this,Pi,new Map),Ve(this,Rs,0)}mount(){Gl(this,Rs)._++,ue(this,Rs)===1&&(Ve(this,Ai,iv.subscribe(async e=>{e&&(await this.resumePausedMutations(),ue(this,Ct).onFocus())})),Ve(this,Ni,Lc.subscribe(async e=>{e&&(await this.resumePausedMutations(),ue(this,Ct).onOnline())})))}unmount(){var e,t;Gl(this,Rs)._--,ue(this,Rs)===0&&((e=ue(this,Ai))==null||e.call(this),Ve(this,Ai,void 0),(t=ue(this,Ni))==null||t.call(this),Ve(this,Ni,void 0))}isFetching(e){return ue(this,Ct).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return ue(this,Ds).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=ue(this,Ct).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.getQueryData(e.queryKey);if(t===void 0)return this.fetchQuery(e);{const r=this.defaultQueryOptions(e),n=ue(this,Ct).build(this,r);return e.revalidateIfStale&&n.isStaleByTime(wm(r.staleTime,n))&&this.prefetchQuery(r),Promise.resolve(t)}}getQueriesData(e){return ue(this,Ct).findAll(e).map(({queryKey:t,state:r})=>{const n=r.data;return[t,n]})}setQueryData(e,t,r){const n=this.defaultQueryOptions({queryKey:e}),s=ue(this,Ct).get(n.queryHash),a=s==null?void 0:s.state.data,i=JC(t,a);if(i!==void 0)return ue(this,Ct).build(this,n).setData(i,{...r,manual:!0})}setQueriesData(e,t,r){return hr.batch(()=>ue(this,Ct).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=ue(this,Ct).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=ue(this,Ct);hr.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=ue(this,Ct),n={type:"active",...e};return hr.batch(()=>(r.findAll(e).forEach(s=>{s.reset()}),this.refetchQueries(n,t)))}cancelQueries(e={},t={}){const r={revert:!0,...t},n=hr.batch(()=>ue(this,Ct).findAll(e).map(s=>s.cancel(r)));return Promise.all(n).then(dn).catch(dn)}invalidateQueries(e={},t={}){return hr.batch(()=>{if(ue(this,Ct).findAll(e).forEach(n=>{n.invalidate()}),e.refetchType==="none")return Promise.resolve();const r={...e,type:e.refetchType??e.type??"active"};return this.refetchQueries(r,t)})}refetchQueries(e={},t){const r={...t,cancelRefetch:(t==null?void 0:t.cancelRefetch)??!0},n=hr.batch(()=>ue(this,Ct).findAll(e).filter(s=>!s.isDisabled()).map(s=>{let a=s.fetch(void 0,r);return r.throwOnError||(a=a.catch(dn)),s.state.fetchStatus==="paused"?Promise.resolve():a}));return Promise.all(n).then(dn)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=ue(this,Ct).build(this,t);return r.isStaleByTime(wm(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(dn).catch(dn)}fetchInfiniteQuery(e){return e.behavior=Tm(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(dn).catch(dn)}ensureInfiniteQueryData(e){return e.behavior=Tm(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Lc.isOnline()?ue(this,Ds).resumePausedMutations():Promise.resolve()}getQueryCache(){return ue(this,Ct)}getMutationCache(){return ue(this,Ds)}getDefaultOptions(){return ue(this,js)}setDefaultOptions(e){Ve(this,js,e)}setQueryDefaults(e,t){ue(this,ki).set(Ko(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...ue(this,ki).values()];let r={};return t.forEach(n=>{Yo(e,n.queryKey)&&(r={...r,...n.defaultOptions})}),r}setMutationDefaults(e,t){ue(this,Pi).set(Ko(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...ue(this,Pi).values()];let r={};return t.forEach(n=>{Yo(e,n.mutationKey)&&(r={...r,...n.defaultOptions})}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...ue(this,js).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=Bh(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.enabled!==!0&&t.queryFn===$h&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...ue(this,js).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){ue(this,Ct).clear(),ue(this,Ds).clear()}},Ct=new WeakMap,Ds=new WeakMap,js=new WeakMap,ki=new WeakMap,Pi=new WeakMap,Rs=new WeakMap,Ai=new WeakMap,Ni=new WeakMap,Bg),yk=m.createContext(void 0),wk=({client:e,children:t})=>(m.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),l.jsx(yk.Provider,{value:e,children:t}));const _k="modulepreload",bk=function(e){return"/put-options-se/"+e},km={},wl=function(t,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));s=Promise.allSettled(r.map(c=>{if(c=bk(c),c in km)return;km[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":_k,u||(f.as="script"),f.crossOrigin="",f.href=c,o&&f.setAttribute("nonce",o),document.head.appendChild(f),u)return new Promise((h,p)=>{f.addEventListener("load",h),f.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function a(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return s.then(i=>{for(const o of i||[])o.status==="rejected"&&a(o.reason);return t().catch(a)})},Sk=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>wl(async()=>{const{default:n}=await Promise.resolve().then(()=>Gi);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class Wh extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class Ek extends Wh{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Pm extends Wh{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Am extends Wh{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Rf;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Rf||(Rf={}));var Tk=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(d){try{u(n.next(d))}catch(f){i(f)}}function c(d){try{u(n.throw(d))}catch(f){i(f)}}function u(d){d.done?a(d.value):s(d.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};class Ck{constructor(t,{headers:r={},customFetch:n,region:s=Rf.Any}={}){this.url=t,this.headers=r,this.region=s,this.fetch=Sk(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return Tk(this,void 0,void 0,function*(){try{const{headers:s,method:a,body:i}=r;let o={},{region:c}=r;c||(c=this.region);const u=new URL(`${this.url}/${t}`);c&&c!=="any"&&(o["x-region"]=c,u.searchParams.set("forceFunctionRegion",c));let d;i&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",d=i):typeof i=="string"?(o["Content-Type"]="text/plain",d=i):typeof FormData<"u"&&i instanceof FormData?d=i:(o["Content-Type"]="application/json",d=JSON.stringify(i)));const f=yield this.fetch(u.toString(),{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),s),body:d}).catch(g=>{throw new Ek(g)}),h=f.headers.get("x-relay-error");if(h&&h==="true")throw new Pm(f);if(!f.ok)throw new Am(f);let p=((n=f.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),v;return p==="application/json"?v=yield f.json():p==="application/octet-stream"?v=yield f.blob():p==="text/event-stream"?v=f:p==="multipart/form-data"?v=yield f.formData():v=yield f.text(),{data:v,error:null,response:f}}catch(s){return{data:null,error:s,response:s instanceof Am||s instanceof Pm?s.context:void 0}}})}}var Tr={},Uh={},Iu={},_l={},Mu={},Fu={},kk=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Mi=kk();const Pk=Mi.fetch,dv=Mi.fetch.bind(Mi),fv=Mi.Headers,Ak=Mi.Request,Nk=Mi.Response,Gi=Object.freeze(Object.defineProperty({__proto__:null,Headers:fv,Request:Ak,Response:Nk,default:dv,fetch:Pk},Symbol.toStringTag,{value:"Module"})),Dk=FS(Gi);var Lu={};Object.defineProperty(Lu,"__esModule",{value:!0});let jk=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};Lu.default=jk;var hv=nn&&nn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Fu,"__esModule",{value:!0});const Rk=hv(Dk),Ok=hv(Lu);let Ik=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=Rk.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=Object.assign({},this.headers),this.headers[t]=r,this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let s=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async a=>{var i,o,c;let u=null,d=null,f=null,h=a.status,p=a.statusText;if(a.ok){if(this.method!=="HEAD"){const y=await a.text();y===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?d=y:d=JSON.parse(y))}const g=(i=this.headers.Prefer)===null||i===void 0?void 0:i.match(/count=(exact|planned|estimated)/),x=(o=a.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");g&&x&&x.length>1&&(f=parseInt(x[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(d)&&(d.length>1?(u={code:"PGRST116",details:`Results contain ${d.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},d=null,f=null,h=406,p="Not Acceptable"):d.length===1?d=d[0]:d=null)}else{const g=await a.text();try{u=JSON.parse(g),Array.isArray(u)&&a.status===404&&(d=[],u=null,h=200,p="OK")}catch{a.status===404&&g===""?(h=204,p="No Content"):u={message:g}}if(u&&this.isMaybeSingle&&(!((c=u==null?void 0:u.details)===null||c===void 0)&&c.includes("0 rows"))&&(u=null,h=200,p="OK"),u&&this.shouldThrowOnError)throw new Ok.default(u)}return{error:u,data:d,count:f,status:h,statusText:p}});return this.shouldThrowOnError||(s=s.catch(a=>{var i,o,c;return{error:{message:`${(i=a==null?void 0:a.name)!==null&&i!==void 0?i:"FetchError"}: ${a==null?void 0:a.message}`,details:`${(o=a==null?void 0:a.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(c=a==null?void 0:a.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),s.then(t,r)}returns(){return this}overrideTypes(){return this}};Fu.default=Ik;var Mk=nn&&nn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Mu,"__esModule",{value:!0});const Fk=Mk(Fu);let Lk=class extends Fk.default{select(t){let r=!1;const n=(t??"*").split("").map(s=>/\s/.test(s)&&!r?"":(s==='"'&&(r=!r),s)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:s,referencedTable:a=s}={}){const i=a?`${a}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:s=n}={}){const a=typeof s>"u"?"offset":`${s}.offset`,i=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(a,`${t}`),this.url.searchParams.set(i,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:s=!1,wal:a=!1,format:i="text"}={}){var o;const c=[t?"analyze":null,r?"verbose":null,n?"settings":null,s?"buffers":null,a?"wal":null].filter(Boolean).join("|"),u=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${i}; for="${u}"; options=${c};`,i==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Mu.default=Lk;var Bk=nn&&nn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(_l,"__esModule",{value:!0});const $k=Bk(Mu);let Wk=class extends $k.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:s}={}){let a="";s==="plain"?a="pl":s==="phrase"?a="ph":s==="websearch"&&(a="w");const i=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${a}fts${i}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const s=n?`${n}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};_l.default=Wk;var Uk=nn&&nn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Iu,"__esModule",{value:!0});const mo=Uk(_l);let Vk=class{constructor(t,{headers:r={},schema:n,fetch:s}){this.url=t,this.headers=r,this.schema=n,this.fetch=s}select(t,{head:r=!1,count:n}={}){const s=r?"HEAD":"GET";let a=!1;const i=(t??"*").split("").map(o=>/\s/.test(o)&&!a?"":(o==='"'&&(a=!a),o)).join("");return this.url.searchParams.set("select",i),n&&(this.headers.Prefer=`count=${n}`),new mo.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:r,defaultToNull:n=!0}={}){const s="POST",a=[];if(this.headers.Prefer&&a.push(this.headers.Prefer),r&&a.push(`count=${r}`),n||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(t)){const i=t.reduce((o,c)=>o.concat(Object.keys(c)),[]);if(i.length>0){const o=[...new Set(i)].map(c=>`"${c}"`);this.url.searchParams.set("columns",o.join(","))}}return new mo.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:s,defaultToNull:a=!0}={}){const i="POST",o=[`resolution=${n?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&o.push(this.headers.Prefer),s&&o.push(`count=${s}`),a||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(t)){const c=t.reduce((u,d)=>u.concat(Object.keys(d)),[]);if(c.length>0){const u=[...new Set(c)].map(d=>`"${d}"`);this.url.searchParams.set("columns",u.join(","))}}return new mo.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:r}={}){const n="PATCH",s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),r&&s.push(`count=${r}`),this.headers.Prefer=s.join(","),new mo.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const r="DELETE",n=[];return t&&n.push(`count=${t}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new mo.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};Iu.default=Vk;var Bu={},$u={};Object.defineProperty($u,"__esModule",{value:!0});$u.version=void 0;$u.version="0.0.0-automated";Object.defineProperty(Bu,"__esModule",{value:!0});Bu.DEFAULT_HEADERS=void 0;const Hk=$u;Bu.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${Hk.version}`};var mv=nn&&nn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Uh,"__esModule",{value:!0});const zk=mv(Iu),Gk=mv(_l),Kk=Bu;let Yk=class pv{constructor(t,{headers:r={},schema:n,fetch:s}={}){this.url=t,this.headers=Object.assign(Object.assign({},Kk.DEFAULT_HEADERS),r),this.schemaName=n,this.fetch=s}from(t){const r=new URL(`${this.url}/${t}`);return new zk.default(r,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new pv(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:s=!1,count:a}={}){let i;const o=new URL(`${this.url}/rpc/${t}`);let c;n||s?(i=n?"HEAD":"GET",Object.entries(r).filter(([d,f])=>f!==void 0).map(([d,f])=>[d,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([d,f])=>{o.searchParams.append(d,f)})):(i="POST",c=r);const u=Object.assign({},this.headers);return a&&(u.Prefer=`count=${a}`),new Gk.default({method:i,url:o,headers:u,schema:this.schemaName,body:c,fetch:this.fetch,allowEmpty:!1})}};Uh.default=Yk;var Ki=nn&&nn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Tr,"__esModule",{value:!0});Tr.PostgrestError=Tr.PostgrestBuilder=Tr.PostgrestTransformBuilder=Tr.PostgrestFilterBuilder=Tr.PostgrestQueryBuilder=Tr.PostgrestClient=void 0;const gv=Ki(Uh);Tr.PostgrestClient=gv.default;const xv=Ki(Iu);Tr.PostgrestQueryBuilder=xv.default;const vv=Ki(_l);Tr.PostgrestFilterBuilder=vv.default;const yv=Ki(Mu);Tr.PostgrestTransformBuilder=yv.default;const wv=Ki(Fu);Tr.PostgrestBuilder=wv.default;const _v=Ki(Lu);Tr.PostgrestError=_v.default;var Xk=Tr.default={PostgrestClient:gv.default,PostgrestQueryBuilder:xv.default,PostgrestFilterBuilder:vv.default,PostgrestTransformBuilder:yv.default,PostgrestBuilder:wv.default,PostgrestError:_v.default};const{PostgrestClient:qk,PostgrestQueryBuilder:_W,PostgrestFilterBuilder:bW,PostgrestTransformBuilder:SW,PostgrestBuilder:EW,PostgrestError:TW}=Xk;class Jk{static dynamicRequire(t){try{return typeof process<"u"&&process.versions&&process.versions.node&&typeof require<"u"?require(t):null}catch{return null}}static detectEnvironment(){var t,r;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const n=parseInt(process.versions.node.split(".")[0]);if(n>=22)try{if(typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};const s=this.dynamicRequire("undici");if(s&&s.WebSocket)return{type:"native",constructor:s.WebSocket};throw new Error("undici not available")}catch{return{type:"unsupported",error:`Node.js ${n} detected but native WebSocket not found.`,workaround:'Install the "ws" package or check your Node.js installation.'}}try{const s=this.dynamicRequire("ws");if(s)return{type:"ws",constructor:(r=s.WebSocket)!==null&&r!==void 0?r:s};throw new Error("ws package not available")}catch{return{type:"unsupported",error:`Node.js ${n} detected without WebSocket support.`,workaround:'Install the "ws" package: npm install ws'}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const Qk="2.15.0",Zk=`realtime-js/${Qk}`,eP="1.0.0",Of=1e4,tP=1e3,rP=100;var Co;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Co||(Co={}));var Ft;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Ft||(Ft={}));var hn;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(hn||(hn={}));var If;(function(e){e.websocket="websocket"})(If||(If={}));var ha;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(ha||(ha={}));class nP{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const s=r.getUint8(1),a=r.getUint8(2);let i=this.HEADER_LENGTH+2;const o=n.decode(t.slice(i,i+s));i=i+s;const c=n.decode(t.slice(i,i+a));i=i+a;const u=JSON.parse(n.decode(t.slice(i,t.byteLength)));return{ref:null,topic:o,event:c,payload:u}}}class bv{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var mt;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(mt||(mt={}));const Nm=(e,t,r={})=>{var n;const s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((a,i)=>(a[i]=sP(i,e,t,s),a),{})},sP=(e,t,r,n)=>{const s=t.find(o=>o.name===e),a=s==null?void 0:s.type,i=r[e];return a&&!n.includes(a)?Sv(a,i):Mf(i)},Sv=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return lP(t,r)}switch(e){case mt.bool:return aP(t);case mt.float4:case mt.float8:case mt.int2:case mt.int4:case mt.int8:case mt.numeric:case mt.oid:return iP(t);case mt.json:case mt.jsonb:return oP(t);case mt.timestamp:return cP(t);case mt.abstime:case mt.date:case mt.daterange:case mt.int4range:case mt.int8range:case mt.money:case mt.reltime:case mt.text:case mt.time:case mt.timestamptz:case mt.timetz:case mt.tsrange:case mt.tstzrange:return Mf(t);default:return Mf(t)}},Mf=e=>e,aP=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},iP=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},oP=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},lP=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let a;const i=e.slice(1,r);try{a=JSON.parse("["+i+"]")}catch{a=i?i.split(","):[]}return a.map(o=>Sv(t,o))}return e},cP=e=>typeof e=="string"?e.replace(" ","T"):e,Ev=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class Id{constructor(t,r,n={},s=Of){this.channel=t,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Dm;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Dm||(Dm={}));class ko{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:a,onLeave:i,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ko.syncState(this.state,s,a,i),this.pendingDiffs.forEach(c=>{this.state=ko.syncDiff(this.state,c,a,i)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},s=>{const{onJoin:a,onLeave:i,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=ko.syncDiff(this.state,s,a,i),o())}),this.onJoin((s,a,i)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:a,newPresences:i})}),this.onLeave((s,a,i)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:a,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,s){const a=this.cloneDeep(t),i=this.transformState(r),o={},c={};return this.map(a,(u,d)=>{i[u]||(c[u]=d)}),this.map(i,(u,d)=>{const f=a[u];if(f){const h=d.map(x=>x.presence_ref),p=f.map(x=>x.presence_ref),v=d.filter(x=>p.indexOf(x.presence_ref)<0),g=f.filter(x=>h.indexOf(x.presence_ref)<0);v.length>0&&(o[u]=v),g.length>0&&(c[u]=g)}else o[u]=d}),this.syncDiff(a,{joins:o,leaves:c},n,s)}static syncDiff(t,r,n,s){const{joins:a,leaves:i}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(a,(o,c)=>{var u;const d=(u=t[o])!==null&&u!==void 0?u:[];if(t[o]=this.cloneDeep(c),d.length>0){const f=t[o].map(p=>p.presence_ref),h=d.filter(p=>f.indexOf(p.presence_ref)<0);t[o].unshift(...h)}n(o,d,c)}),this.map(i,(o,c)=>{let u=t[o];if(!u)return;const d=c.map(f=>f.presence_ref);u=u.filter(f=>d.indexOf(f.presence_ref)<0),t[o]=u,s(o,u,c),u.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const s=t[n];return"metas"in s?r[n]=s.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):r[n]=s,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var jm;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(jm||(jm={}));var Po;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Po||(Po={}));var Qn;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Qn||(Qn={}));class Vh{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Ft.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Id(this,hn.join,this.params,this.timeout),this.rejoinTimer=new bv(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ft.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ft.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Ft.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ft.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Ft.errored,this.rejoinTimer.scheduleTimeout())}),this._on(hn.reply,{},(s,a)=>{this._trigger(this._replyEventName(a),s)}),this.presence=new ko(this),this.broadcastEndpointURL=Ev(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,s;if(this.socket.isConnected()||this.socket.connect(),this.state==Ft.closed){const{config:{broadcast:a,presence:i,private:o}}=this.params,c=(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(h=>h.filter))!==null&&s!==void 0?s:[],u=!!this.bindings[Po.PRESENCE]&&this.bindings[Po.PRESENCE].length>0,d={},f={broadcast:a,presence:Object.assign(Object.assign({},i),{enabled:u}),postgres_changes:c,private:o};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this._onError(h=>t==null?void 0:t(Qn.CHANNEL_ERROR,h)),this._onClose(()=>t==null?void 0:t(Qn.CLOSED)),this.updateJoinPayload(Object.assign({config:f},d)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:h})=>{var p;if(this.socket.setAuth(),h===void 0){t==null||t(Qn.SUBSCRIBED);return}else{const v=this.bindings.postgres_changes,g=(p=v==null?void 0:v.length)!==null&&p!==void 0?p:0,x=[];for(let y=0;y<g;y++){const w=v[y],{filter:{event:_,schema:b,table:T,filter:k}}=w,S=h&&h[y];if(S&&S.event===_&&S.schema===b&&S.table===T&&S.filter===k)x.push(Object.assign(Object.assign({},w),{id:S.id}));else{this.unsubscribe(),this.state=Ft.errored,t==null||t(Qn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,t&&t(Qn.SUBSCRIBED);return}}).receive("error",h=>{this.state=Ft.errored,t==null||t(Qn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(h).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Qn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===Ft.joined&&t===Po.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}async send(t,r={}){var n,s;if(!this._canPush()&&t.type==="broadcast"){const{event:a,payload:i}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:i,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=u.body)===null||s===void 0?void 0:s.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var i,o,c;const u=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(o=(i=this.params)===null||i===void 0?void 0:i.config)===null||o===void 0?void 0:o.broadcast)===null||c===void 0)&&c.ack)&&a("ok"),u.receive("ok",()=>a("ok")),u.receive("error",()=>a("error")),u.receive("timeout",()=>a("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Ft.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(hn.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new Id(this,hn.leave,{},t),n.receive("ok",()=>{r(),s("ok")}).receive("timeout",()=>{r(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Ft.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const s=new AbortController,a=setTimeout(()=>s.abort(),n),i=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(a),i}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Id(this,t,r,n);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>rP){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var s,a;const i=t.toLocaleLowerCase(),{close:o,error:c,leave:u,join:d}=hn;if(n&&[o,c,u,d].indexOf(i)>=0&&n!==this._joinRef())return;let h=this._onMessage(i,r,n);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(p=>{var v,g,x;return((v=p.filter)===null||v===void 0?void 0:v.event)==="*"||((x=(g=p.filter)===null||g===void 0?void 0:g.event)===null||x===void 0?void 0:x.toLocaleLowerCase())===i}).map(p=>p.callback(h,n)):(a=this.bindings[i])===null||a===void 0||a.filter(p=>{var v,g,x,y,w,_;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in p){const b=p.id,T=(v=p.filter)===null||v===void 0?void 0:v.event;return b&&((g=r.ids)===null||g===void 0?void 0:g.includes(b))&&(T==="*"||(T==null?void 0:T.toLocaleLowerCase())===((x=r.data)===null||x===void 0?void 0:x.type.toLocaleLowerCase()))}else{const b=(w=(y=p==null?void 0:p.filter)===null||y===void 0?void 0:y.event)===null||w===void 0?void 0:w.toLocaleLowerCase();return b==="*"||b===((_=r==null?void 0:r.event)===null||_===void 0?void 0:_.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===i}).map(p=>{if(typeof h=="object"&&"ids"in h){const v=h.data,{schema:g,table:x,commit_timestamp:y,type:w,errors:_}=v;h=Object.assign(Object.assign({},{schema:g,table:x,commit_timestamp:y,eventType:w,new:{},old:{},errors:_}),this._getPayloadRecords(v))}p.callback(h,n)})}_isClosed(){return this.state===Ft.closed}_isJoined(){return this.state===Ft.joined}_isJoining(){return this.state===Ft.joining}_isLeaving(){return this.state===Ft.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const s=t.toLocaleLowerCase(),a={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(a):this.bindings[s]=[a],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(s=>{var a;return!(((a=s.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===n&&Vh.isEqual(s.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(hn.close,{},t)}_onError(t){this._on(hn.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ft.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Nm(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Nm(t.columns,t.old_record)),r}}const Rm=()=>{},Ql={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},uP=[1e3,2e3,5e3,1e4],dP=1e4,fP=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class hP{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Of,this.transport=null,this.heartbeatIntervalMs=Ql.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Rm,this.ref=0,this.reconnectTimer=null,this.logger=Rm,this.conn=null,this.sendBuffer=[],this.serializer=new nP,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>{let a;return s?a=s:typeof fetch>"u"?a=(...i)=>wl(async()=>{const{default:o}=await Promise.resolve().then(()=>Gi);return{default:o}},void 0).then(({default:o})=>o(...i)).catch(o=>{throw new Error(`Failed to load @supabase/node-fetch: ${o.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):a=fetch,(...i)=>a(...i)},!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${If.websocket}`,this.httpEndpoint=Ev(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Jk.createWebSocket(this.endpointURL())}catch(t){throw this._setConnectionState("disconnected"),new Error(`WebSocket not available: ${t.message}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:eP}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Co.connecting:return ha.Connecting;case Co.open:return ha.Open;case Co.closing:return ha.Closing;default:return ha.Closed}}isConnected(){return this.connectionState()===ha.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,s=this.getChannels().find(a=>a.topic===n);if(s)return s;{const a=new Vh(`realtime:${t}`,r,this);return this.channels.push(a),a}}push(t){const{topic:r,event:n,payload:s,ref:a}=t,i=()=>{this.encode(t,o=>{var c;(c=this.conn)===null||c===void 0||c.send(o)})};this.log("push",`${r} ${n} (${a})`,s),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(tP,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Ql.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{r.topic==="phoenix"&&r.event==="phx_reply"&&this.heartbeatCallback(r.payload.status==="ok"?"ok":"error"),r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:s,payload:a,ref:i}=r,o=i?`(${i})`:"",c=a.status||"";this.log("receive",`${c} ${n} ${s} ${o}`.trim(),a),this.channels.filter(u=>u._isMember(n)).forEach(u=>u._trigger(s,a,i)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(hn.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${t}${n}${s}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([fP],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const s={access_token:r,version:Zk};r&&n.updateJoinPayload(s),n.joinedOnce&&n._isJoined()&&n._push(hn.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(s){this.log("error",`error in ${t} callback`,s)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new bv(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Ql.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,s,a,i,o,c,u;if(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:Of,this.heartbeatIntervalMs=(s=t==null?void 0:t.heartbeatIntervalMs)!==null&&s!==void 0?s:Ql.HEARTBEAT_INTERVAL,this.worker=(a=t==null?void 0:t.worker)!==null&&a!==void 0?a:!1,this.accessToken=(i=t==null?void 0:t.accessToken)!==null&&i!==void 0?i:null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(o=t==null?void 0:t.reconnectAfterMs)!==null&&o!==void 0?o:d=>uP[d-1]||dP,this.encode=(c=t==null?void 0:t.encode)!==null&&c!==void 0?c:(d,f)=>f(JSON.stringify(d)),this.decode=(u=t==null?void 0:t.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class Hh extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Vt(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class mP extends Hh{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Ff extends Hh{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var pP=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(d){try{u(n.next(d))}catch(f){i(f)}}function c(d){try{u(n.throw(d))}catch(f){i(f)}}function u(d){d.done?a(d.value):s(d.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};const Tv=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>wl(async()=>{const{default:n}=await Promise.resolve().then(()=>Gi);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},gP=()=>pP(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield wl(()=>Promise.resolve().then(()=>Gi),void 0)).Response:Response}),Lf=e=>{if(Array.isArray(e))return e.map(r=>Lf(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const s=r.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));t[s]=Lf(n)}),t},xP=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var Wa=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(d){try{u(n.next(d))}catch(f){i(f)}}function c(d){try{u(n.throw(d))}catch(f){i(f)}}function u(d){d.done?a(d.value):s(d.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};const Md=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),vP=(e,t,r)=>Wa(void 0,void 0,void 0,function*(){const n=yield gP();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(s=>{const a=e.status||500,i=(s==null?void 0:s.statusCode)||a+"";t(new mP(Md(s),a,i))}).catch(s=>{t(new Ff(Md(s),s))}):t(new Ff(Md(e),e))}),yP=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?s:(xP(n)?(s.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),s.body=JSON.stringify(n)):s.body=n,Object.assign(Object.assign({},s),r))};function bl(e,t,r,n,s,a){return Wa(this,void 0,void 0,function*(){return new Promise((i,o)=>{e(r,yP(t,n,s,a)).then(c=>{if(!c.ok)throw c;return n!=null&&n.noResolveJson?c:c.json()}).then(c=>i(c)).catch(c=>vP(c,o,n))})})}function Bc(e,t,r,n){return Wa(this,void 0,void 0,function*(){return bl(e,"GET",t,r,n)})}function Zn(e,t,r,n,s){return Wa(this,void 0,void 0,function*(){return bl(e,"POST",t,n,s,r)})}function Bf(e,t,r,n,s){return Wa(this,void 0,void 0,function*(){return bl(e,"PUT",t,n,s,r)})}function wP(e,t,r,n){return Wa(this,void 0,void 0,function*(){return bl(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function Cv(e,t,r,n,s){return Wa(this,void 0,void 0,function*(){return bl(e,"DELETE",t,n,s,r)})}var Er=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(d){try{u(n.next(d))}catch(f){i(f)}}function c(d){try{u(n.throw(d))}catch(f){i(f)}}function u(d){d.done?a(d.value):s(d.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};const _P={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Om={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class bP{constructor(t,r={},n,s){this.url=t,this.headers=r,this.bucketId=n,this.fetch=Tv(s)}uploadOrUpdate(t,r,n,s){return Er(this,void 0,void 0,function*(){try{let a;const i=Object.assign(Object.assign({},Om),s);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(i.upsert)});const c=i.metadata;typeof Blob<"u"&&n instanceof Blob?(a=new FormData,a.append("cacheControl",i.cacheControl),c&&a.append("metadata",this.encodeMetadata(c)),a.append("",n)):typeof FormData<"u"&&n instanceof FormData?(a=n,a.append("cacheControl",i.cacheControl),c&&a.append("metadata",this.encodeMetadata(c))):(a=n,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,c&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),s!=null&&s.headers&&(o=Object.assign(Object.assign({},o),s.headers));const u=this._removeEmptyFolders(r),d=this._getFinalPath(u),f=yield(t=="PUT"?Bf:Zn)(this.fetch,`${this.url}/object/${d}`,a,Object.assign({headers:o},i!=null&&i.duplex?{duplex:i.duplex}:{}));return{data:{path:u,id:f.Id,fullPath:f.Key},error:null}}catch(a){if(Vt(a))return{data:null,error:a};throw a}})}upload(t,r,n){return Er(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,s){return Er(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(t),i=this._getFinalPath(a),o=new URL(this.url+`/object/upload/sign/${i}`);o.searchParams.set("token",r);try{let c;const u=Object.assign({upsert:Om.upsert},s),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",u.cacheControl)):(c=n,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType);const f=yield Bf(this.fetch,o.toString(),c,{headers:d});return{data:{path:a,fullPath:f.Key},error:null}}catch(c){if(Vt(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,r){return Er(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const s=Object.assign({},this.headers);r!=null&&r.upsert&&(s["x-upsert"]="true");const a=yield Zn(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),i=new URL(this.url+a.url),o=i.searchParams.get("token");if(!o)throw new Hh("No token returned by API");return{data:{signedUrl:i.toString(),path:t,token:o},error:null}}catch(n){if(Vt(n))return{data:null,error:n};throw n}})}update(t,r,n){return Er(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return Er(this,void 0,void 0,function*(){try{return{data:yield Zn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(Vt(s))return{data:null,error:s};throw s}})}copy(t,r,n){return Er(this,void 0,void 0,function*(){try{return{data:{path:(yield Zn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(Vt(s))return{data:null,error:s};throw s}})}createSignedUrl(t,r,n){return Er(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t),a=yield Zn(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${i}`)},{data:a,error:null}}catch(s){if(Vt(s))return{data:null,error:s};throw s}})}createSignedUrls(t,r,n){return Er(this,void 0,void 0,function*(){try{const s=yield Zn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),a=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${a}`):null})),error:null}}catch(s){if(Vt(s))return{data:null,error:s};throw s}})}download(t,r){return Er(this,void 0,void 0,function*(){const s=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),i=a?`?${a}`:"";try{const o=this._getFinalPath(t);return{data:yield(yield Bc(this.fetch,`${this.url}/${s}/${o}${i}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(Vt(o))return{data:null,error:o};throw o}})}info(t){return Er(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield Bc(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Lf(n),error:null}}catch(n){if(Vt(n))return{data:null,error:n};throw n}})}exists(t){return Er(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield wP(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(Vt(n)&&n instanceof Ff){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),s=[],a=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";a!==""&&s.push(a);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&s.push(c);let u=s.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${u}`)}}}remove(t){return Er(this,void 0,void 0,function*(){try{return{data:yield Cv(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(Vt(r))return{data:null,error:r};throw r}})}list(t,r,n){return Er(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},_P),r),{prefix:t||""});return{data:yield Zn(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(Vt(s))return{data:null,error:s};throw s}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const SP="2.10.4",EP={"X-Client-Info":`storage-js/${SP}`};var qa=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(d){try{u(n.next(d))}catch(f){i(f)}}function c(d){try{u(n.throw(d))}catch(f){i(f)}}function u(d){d.done?a(d.value):s(d.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};class TP{constructor(t,r={},n,s){const a=new URL(t);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href,this.headers=Object.assign(Object.assign({},EP),r),this.fetch=Tv(n)}listBuckets(){return qa(this,void 0,void 0,function*(){try{return{data:yield Bc(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(Vt(t))return{data:null,error:t};throw t}})}getBucket(t){return qa(this,void 0,void 0,function*(){try{return{data:yield Bc(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(Vt(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return qa(this,void 0,void 0,function*(){try{return{data:yield Zn(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Vt(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return qa(this,void 0,void 0,function*(){try{return{data:yield Bf(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Vt(n))return{data:null,error:n};throw n}})}emptyBucket(t){return qa(this,void 0,void 0,function*(){try{return{data:yield Zn(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(Vt(r))return{data:null,error:r};throw r}})}deleteBucket(t){return qa(this,void 0,void 0,function*(){try{return{data:yield Cv(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(Vt(r))return{data:null,error:r};throw r}})}}class CP extends TP{constructor(t,r={},n,s){super(t,r,n,s)}from(t){return new bP(this.url,this.headers,t,this.fetch)}}const kP="2.54.0";let _o="";typeof Deno<"u"?_o="deno":typeof document<"u"?_o="web":typeof navigator<"u"&&navigator.product==="ReactNative"?_o="react-native":_o="node";const PP={"X-Client-Info":`supabase-js-${_o}/${kP}`},AP={headers:PP},NP={schema:"public"},DP={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},jP={};var RP=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(d){try{u(n.next(d))}catch(f){i(f)}}function c(d){try{u(n.throw(d))}catch(f){i(f)}}function u(d){d.done?a(d.value):s(d.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};const OP=e=>{let t;return e?t=e:typeof fetch>"u"?t=dv:t=fetch,(...r)=>t(...r)},IP=()=>typeof Headers>"u"?fv:Headers,MP=(e,t,r)=>{const n=OP(r),s=IP();return(a,i)=>RP(void 0,void 0,void 0,function*(){var o;const c=(o=yield t())!==null&&o!==void 0?o:e;let u=new s(i==null?void 0:i.headers);return u.has("apikey")||u.set("apikey",e),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),n(a,Object.assign(Object.assign({},i),{headers:u}))})};var FP=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(d){try{u(n.next(d))}catch(f){i(f)}}function c(d){try{u(n.throw(d))}catch(f){i(f)}}function u(d){d.done?a(d.value):s(d.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};function LP(e){return e.endsWith("/")?e:e+"/"}function BP(e,t){var r,n;const{db:s,auth:a,realtime:i,global:o}=e,{db:c,auth:u,realtime:d,global:f}=t,h={db:Object.assign(Object.assign({},c),s),auth:Object.assign(Object.assign({},u),a),realtime:Object.assign(Object.assign({},d),i),storage:{},global:Object.assign(Object.assign(Object.assign({},f),o),{headers:Object.assign(Object.assign({},(r=f==null?void 0:f.headers)!==null&&r!==void 0?r:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>FP(this,void 0,void 0,function*(){return""})};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}const kv="2.71.1",ci=30*1e3,$f=3,Fd=$f*ci,$P="http://localhost:9999",WP="supabase.auth.token",UP={"X-Client-Info":`gotrue-js/${kv}`},Wf="X-Supabase-Api-Version",Pv={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},VP=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,HP=10*60*1e3;class zh extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function $e(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class zP extends zh{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function GP(e){return $e(e)&&e.name==="AuthApiError"}class Av extends zh{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Zs extends zh{constructor(t,r,n,s){super(t,n,s),this.name=r,this.status=n}}class _s extends Zs{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function KP(e){return $e(e)&&e.name==="AuthSessionMissingError"}class Zl extends Zs{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ec extends Zs{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class tc extends Zs{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function YP(e){return $e(e)&&e.name==="AuthImplicitGrantRedirectError"}class Im extends Zs{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Uf extends Zs{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Ld(e){return $e(e)&&e.name==="AuthRetryableFetchError"}class Mm extends Zs{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Vf extends Zs{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const $c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Fm=` 	
\r=`.split(""),XP=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Fm.length;t+=1)e[Fm[t].charCodeAt(0)]=-2;for(let t=0;t<$c.length;t+=1)e[$c[t].charCodeAt(0)]=t;return e})();function Lm(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r($c[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r($c[n]),t.queuedBits-=6}}function Nv(e,t,r){const n=XP[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Bm(e){const t=[],r=i=>{t.push(String.fromCodePoint(i))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},a=i=>{QP(i,n,r)};for(let i=0;i<e.length;i+=1)Nv(e.charCodeAt(i),s,a);return t.join("")}function qP(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function JP(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}qP(n,t)}}function QP(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function ZP(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)Nv(e.charCodeAt(s),r,n);return new Uint8Array(t)}function eA(e){const t=[];return JP(e,r=>t.push(r)),new Uint8Array(t)}function tA(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};return e.forEach(s=>Lm(s,r,n)),Lm(null,r,n),t.join("")}function rA(e){return Math.round(Date.now()/1e3)+e}function nA(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const cn=()=>typeof window<"u"&&typeof document<"u",ca={tested:!1,writable:!1},Dv=()=>{if(!cn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ca.tested)return ca.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),ca.tested=!0,ca.writable=!0}catch{ca.tested=!0,ca.writable=!1}return ca.writable};function sA(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,a)=>{t[a]=s})}catch{}return r.searchParams.forEach((n,s)=>{t[s]=n}),t}const jv=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>wl(async()=>{const{default:n}=await Promise.resolve().then(()=>Gi);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},aA=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",ui=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},ua=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},vs=async(e,t)=>{await e.removeItem(t)};class Wu{constructor(){this.promise=new Wu.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Wu.promiseConstructor=Promise;function Bd(e){const t=e.split(".");if(t.length!==3)throw new Vf("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!VP.test(t[n]))throw new Vf("JWT not in base64url format");return{header:JSON.parse(Bm(t[0])),payload:JSON.parse(Bm(t[1])),signature:ZP(t[2]),raw:{header:t[0],payload:t[1]}}}async function iA(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function oA(e,t){return new Promise((n,s)=>{(async()=>{for(let a=0;a<1/0;a++)try{const i=await e(a);if(!t(a,null,i)){n(i);return}}catch(i){if(!t(a,i)){s(i);return}}})()})}function lA(e){return("0"+e.toString(16)).substr(-2)}function cA(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let s="";for(let a=0;a<56;a++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(t),Array.from(t,lA).join("")}async function uA(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(n);return Array.from(s).map(a=>String.fromCharCode(a)).join("")}async function dA(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await uA(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ja(e,t,r=!1){const n=cA();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await ui(e,`${t}-code-verifier`,s);const a=await dA(n);return[a,n===a?"plain":"s256"]}const fA=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function hA(e){const t=e.headers.get(Wf);if(!t||!t.match(fA))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function mA(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function pA(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const gA=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Qa(e){if(!gA.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function $d(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function $m(e){return JSON.parse(JSON.stringify(e))}var xA=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};const da=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),vA=[502,503,504];async function Wm(e){var t;if(!aA(e))throw new Uf(da(e),0);if(vA.includes(e.status))throw new Uf(da(e),e.status);let r;try{r=await e.json()}catch(a){throw new Av(da(a),a)}let n;const s=hA(e);if(s&&s.getTime()>=Pv["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Mm(da(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new _s}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((a,i)=>a&&typeof i=="string",!0))throw new Mm(da(r),e.status,r.weak_password.reasons);throw new zP(da(r),e.status||500,n)}const yA=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function Xe(e,t,r,n){var s;const a=Object.assign({},n==null?void 0:n.headers);a[Wf]||(a[Wf]=Pv["2024-01-01"].name),n!=null&&n.jwt&&(a.Authorization=`Bearer ${n.jwt}`);const i=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(i.redirect_to=n.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",c=await wA(e,t,r+o,{headers:a,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(c):{data:Object.assign({},c),error:null}}async function wA(e,t,r,n,s,a){const i=yA(t,n,s,a);let o;try{o=await e(r,Object.assign({},i))}catch(c){throw console.error(c),new Uf(da(c),0)}if(o.ok||await Wm(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(c){await Wm(c)}}function qn(e){var t;let r=null;EA(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=rA(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function Um(e){const t=qn(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Ps(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function _A(e){return{data:e,error:null}}function bA(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:a}=e,i=xA(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:a},c=Object.assign({},i);return{data:{properties:o,user:c},error:null}}function SA(e){return e}function EA(e){return e.access_token&&e.refresh_token&&e.expires_in}const Wd=["global","local","others"];var TA=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};class CA{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=jv(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=Wd[0]){if(Wd.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Wd.join(", ")}`);try{return await Xe(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if($e(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Xe(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Ps})}catch(n){if($e(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=TA(t,["options"]),s=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await Xe(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:bA,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if($e(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Xe(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Ps})}catch(r){if($e(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,s,a,i,o,c;try{const u={nextPage:null,lastPage:0,total:0},d=await Xe(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(a=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:""},xform:SA});if(d.error)throw d.error;const f=await d.json(),h=(i=d.headers.get("x-total-count"))!==null&&i!==void 0?i:0,p=(c=(o=d.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(v=>{const g=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(v.split(";")[1].split("=")[1]);u[`${x}Page`]=g}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},f),u),error:null}}catch(u){if($e(u))return{data:{users:[]},error:u};throw u}}async getUserById(t){Qa(t);try{return await Xe(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Ps})}catch(r){if($e(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Qa(t);try{return await Xe(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Ps})}catch(n){if($e(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){Qa(t);try{return await Xe(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Ps})}catch(n){if($e(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){Qa(t.userId);try{const{data:r,error:n}=await Xe(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if($e(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Qa(t.userId),Qa(t.id);try{return{data:await Xe(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if($e(r))return{data:null,error:r};throw r}}}function Vm(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function kA(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Za={debug:!!(globalThis&&Dv()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Rv extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class PA extends Rv{}async function AA(e,t,r){Za.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Za.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){Za.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await r()}finally{Za.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw Za.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new PA(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Za.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}kA();const NA={url:$P,storageKey:WP,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:UP,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Hm(e,t,r){return await r()}const ei={};class Xo{constructor(t){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Xo.nextInstanceID,Xo.nextInstanceID+=1,this.instanceID>0&&cn()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},NA),t);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new CA({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=jv(s.fetch),this.lock=s.lock||Hm,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:cn()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=AA:this.lock=Hm,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:Dv()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Vm(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=Vm(this.memoryStorage)),cn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}get jwks(){var t,r;return(r=(t=ei[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){ei[this.storageKey]=Object.assign(Object.assign({},ei[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=ei[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){ei[this.storageKey]=Object.assign(Object.assign({},ei[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${kv}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=sA(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),cn()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:a}=await this._getSessionFromURL(r,n);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),YP(a)){const c=(t=a.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:i,redirectType:o}=s;return this._debug("#_initialize()","detected session in URL",i,"redirect type",o),await this._saveSession(i),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return $e(r)?{error:r}:{error:new Av("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,s;try{const a=await Xe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=t==null?void 0:t.options)===null||s===void 0?void 0:s.captchaToken}},xform:qn}),{data:i,error:o}=a;if(o||!i)return{data:{user:null,session:null},error:o};const c=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(a){if($e(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(t){var r,n,s;try{let a;if("email"in t){const{email:d,password:f,options:h}=t;let p=null,v=null;this.flowType==="pkce"&&([p,v]=await Ja(this.storage,this.storageKey)),a=await Xe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:d,password:f,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:p,code_challenge_method:v},xform:qn})}else if("phone"in t){const{phone:d,password:f,options:h}=t;a=await Xe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:f,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},channel:(s=h==null?void 0:h.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:qn})}else throw new ec("You must provide either an email or phone number and a password");const{data:i,error:o}=a;if(o||!i)return{data:{user:null,session:null},error:o};const c=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(a){if($e(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(t){try{let r;if("email"in t){const{email:a,password:i,options:o}=t;r=await Xe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Um})}else if("phone"in t){const{phone:a,password:i,options:o}=t;r=await Xe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Um})}else throw new ec("You must provide either an email or phone number and a password");const{data:n,error:s}=r;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Zl}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if($e(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,s,a;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(a=t.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;if(r==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(t){var r,n,s,a,i,o,c,u,d,f,h,p;let v,g;if("message"in t)v=t.message,g=t.signature;else{const{chain:x,wallet:y,statement:w,options:_}=t;let b;if(cn())if(typeof y=="object")b=y;else{const k=window;if("solana"in k&&typeof k.solana=="object"&&("signIn"in k.solana&&typeof k.solana.signIn=="function"||"signMessage"in k.solana&&typeof k.solana.signMessage=="function"))b=k.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(_!=null&&_.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");b=y}const T=new URL((r=_==null?void 0:_.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in b&&b.signIn){const k=await b.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},_==null?void 0:_.signInWithSolana),{version:"1",domain:T.host,uri:T.href}),w?{statement:w}:null));let S;if(Array.isArray(k)&&k[0]&&typeof k[0]=="object")S=k[0];else if(k&&typeof k=="object"&&"signedMessage"in k&&"signature"in k)S=k;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in S&&"signature"in S&&(typeof S.signedMessage=="string"||S.signedMessage instanceof Uint8Array)&&S.signature instanceof Uint8Array)v=typeof S.signedMessage=="string"?S.signedMessage:new TextDecoder().decode(S.signedMessage),g=S.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in b)||typeof b.signMessage!="function"||!("publicKey"in b)||typeof b!="object"||!b.publicKey||!("toBase58"in b.publicKey)||typeof b.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${T.host} wants you to sign in with your Solana account:`,b.publicKey.toBase58(),...w?["",w,""]:[""],"Version: 1",`URI: ${T.href}`,`Issued At: ${(s=(n=_==null?void 0:_.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((a=_==null?void 0:_.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${_.signInWithSolana.notBefore}`]:[],...!((i=_==null?void 0:_.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${_.signInWithSolana.expirationTime}`]:[],...!((o=_==null?void 0:_.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${_.signInWithSolana.chainId}`]:[],...!((c=_==null?void 0:_.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${_.signInWithSolana.nonce}`]:[],...!((u=_==null?void 0:_.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${_.signInWithSolana.requestId}`]:[],...!((f=(d=_==null?void 0:_.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||f===void 0)&&f.length?["Resources",..._.signInWithSolana.resources.map(S=>`- ${S}`)]:[]].join(`
`);const k=await b.signMessage(new TextEncoder().encode(v),"utf8");if(!k||!(k instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");g=k}}try{const{data:x,error:y}=await Xe(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:tA(g)},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(p=t.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:qn});if(y)throw y;return!x||!x.session||!x.user?{data:{user:null,session:null},error:new Zl}:(x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),{data:Object.assign({},x),error:y})}catch(x){if($e(x))return{data:{user:null,session:null},error:x};throw x}}async _exchangeCodeForSession(t){const r=await ua(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??"").split("/");try{const{data:a,error:i}=await Xe(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:qn});if(await vs(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!a||!a.session||!a.user?{data:{user:null,session:null,redirectType:null},error:new Zl}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign(Object.assign({},a),{redirectType:s??null}),error:i})}catch(a){if($e(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(t){try{const{options:r,provider:n,token:s,access_token:a,nonce:i}=t,o=await Xe(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:a,nonce:i,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:qn}),{data:c,error:u}=o;return u?{data:{user:null,session:null},error:u}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new Zl}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:u})}catch(r){if($e(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,s,a,i;try{if("email"in t){const{email:o,options:c}=t;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await Ja(this.storage,this.storageKey));const{error:f}=await Xe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(n=c==null?void 0:c.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in t){const{phone:o,options:c}=t,{data:u,error:d}=await Xe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(s=c==null?void 0:c.data)!==null&&s!==void 0?s:{},create_user:(a=c==null?void 0:c.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(i=c==null?void 0:c.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d}}throw new ec("You must provide either an email or phone number.")}catch(o){if($e(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(t){var r,n;try{let s,a;"options"in t&&(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo,a=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:i,error:o}=await Xe(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:a}}),redirectTo:s,xform:qn});if(o)throw o;if(!i)throw new Error("An error occurred on token verification.");const c=i.session,u=i.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(s){if($e(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(t){var r,n,s;try{let a=null,i=null;return this.flowType==="pkce"&&([a,i]=await Ja(this.storage,this.storageKey)),await Xe(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=t==null?void 0:t.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:i}),headers:this.headers,xform:_A})}catch(a){if($e(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new _s;const{error:s}=await Xe(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:s}})}catch(t){if($e(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:s,options:a}=t,{error:i}=await Xe(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in t){const{phone:n,type:s,options:a}=t,{data:i,error:o}=await Xe(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return{data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:o}}throw new ec("You must provide either an email or phone number and a type")}catch(r){if($e(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await ua(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<Fd:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const i=await ua(this.userStorage,this.storageKey+"-user");i!=null&&i.user?t.user=i.user:t.user=$d()}if(this.storage.isServer&&t.user){let i=this.suppressGetSessionWarning;t=new Proxy(t,{get:(c,u,d)=>(!i&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,u,d))})}return{data:{session:t},error:null}}const{session:s,error:a}=await this._callRefreshToken(t.refresh_token);return a?{data:{session:null},error:a}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Xe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Ps}):await this._useSession(async r=>{var n,s,a;const{data:i,error:o}=r;if(o)throw o;return!(!((n=i.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new _s}:await Xe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:void 0,xform:Ps})})}catch(r){if($e(r))return KP(r)&&(await this._removeSession(),await vs(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:s,error:a}=n;if(a)throw a;if(!s.session)throw new _s;const i=s.session;let o=null,c=null;this.flowType==="pkce"&&t.email!=null&&([o,c]=await Ja(this.storage,this.storageKey));const{data:u,error:d}=await Xe(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:c}),jwt:i.access_token,xform:Ps});if(d)throw d;return i.user=u.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(n){if($e(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new _s;const r=Date.now()/1e3;let n=r,s=!0,a=null;const{payload:i}=Bd(t.access_token);if(i.exp&&(n=i.exp,s=n<=r),s){const{session:o,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!o)return{data:{user:null,session:null},error:null};a=o}else{const{data:o,error:c}=await this._getUser(t.access_token);if(c)throw c;a={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(r){if($e(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:i,error:o}=r;if(o)throw o;t=(n=i.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new _s;const{session:s,error:a}=await this._callRefreshToken(t.refresh_token);return a?{data:{user:null,session:null},error:a}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if($e(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!cn())throw new tc("No browser detected.");if(t.error||t.error_description||t.error_code)throw new tc(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Im("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new tc("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Im("No code detected.");const{data:w,error:_}=await this._exchangeCodeForSession(t.code);if(_)throw _;const b=new URL(window.location.href);return b.searchParams.delete("code"),window.history.replaceState(window.history.state,"",b.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:a,refresh_token:i,expires_in:o,expires_at:c,token_type:u}=t;if(!a||!o||!i||!u)throw new tc("No session defined in URL");const d=Math.round(Date.now()/1e3),f=parseInt(o);let h=d+f;c&&(h=parseInt(c));const p=h-d;p*1e3<=ci&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${f}s`);const v=h-f;d-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,h,d):d-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,h,d);const{data:g,error:x}=await this._getUser(a);if(x)throw x;const y={provider_token:n,provider_refresh_token:s,access_token:a,expires_in:f,expires_at:h,refresh_token:i,token_type:u,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:y,redirectType:t.type},error:null}}catch(n){if($e(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await ua(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:s,error:a}=r;if(a)return{error:a};const i=(n=s.session)===null||n===void 0?void 0:n.access_token;if(i){const{error:o}=await this.admin.signOut(i,t);if(o&&!(GP(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return t!=="others"&&(await this._removeSession(),await vs(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=nA(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,s;try{const{data:{session:a},error:i}=r;if(i)throw i;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",t,"session",a)}catch(a){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",a),console.error(a)}})}async resetPasswordForEmail(t,r={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await Ja(this.storage,this.storageKey,!0));try{return await Xe(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(a){if($e(a))return{data:null,error:a};throw a}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if($e(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:s}=await this._useSession(async a=>{var i,o,c,u,d;const{data:f,error:h}=a;if(h)throw h;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(i=t.options)===null||i===void 0?void 0:i.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await Xe(this.fetch,"GET",p,{headers:this.headers,jwt:(d=(u=f.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(s)throw s;return cn()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if($e(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,s;const{data:a,error:i}=r;if(i)throw i;return await Xe(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if($e(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await oA(async s=>(s>0&&await iA(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await Xe(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:qn})),(s,a)=>{const i=200*Math.pow(2,s);return a&&Ld(a)&&Date.now()+i-n<ci})}catch(n){if(this._debug(r,"error",n),$e(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),cn()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const s=await ua(this.storage,this.storageKey);if(s&&this.userStorage){let i=await ua(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:s.user},await ui(this.userStorage,this.storageKey+"-user",i)),s.user=(t=i==null?void 0:i.user)!==null&&t!==void 0?t:$d()}else if(s&&!s.user&&!s.user){const i=await ua(this.storage,this.storageKey+"-user");i&&(i!=null&&i.user)?(s.user=i.user,await vs(this.storage,this.storageKey+"-user"),await ui(this.storage,this.storageKey,s)):s.user=$d()}if(this._debug(n,"session from storage",s),!this._isValidSession(s)){this._debug(n,"session is not valid"),s!==null&&await this._removeSession();return}const a=((r=s.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Fd;if(this._debug(n,`session has${a?"":" not"} expired with margin of ${Fd}s`),a){if(this.autoRefreshToken&&s.refresh_token){const{error:i}=await this._callRefreshToken(s.refresh_token);i&&(console.error(i),Ld(i)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:o}=await this._getUser(s.access_token);!o&&(i!=null&&i.user)?(s.user=i.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(n,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(n,"error",s),console.error(s);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new _s;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Wu;const{data:a,error:i}=await this._refreshAccessToken(t);if(i)throw i;if(!a.session)throw new _s;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const o={session:a.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(a){if(this._debug(s,"error",a),$e(a)){const i={session:null,error:a};return Ld(a)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(i),i}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(a),a}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,r,n=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const a=[],i=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(c){a.push(c)}});if(await Promise.all(i),a.length>0){for(let o=0;o<a.length;o+=1)console.error(a[o]);throw a[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await ui(this.userStorage,this.storageKey+"-user",{user:r.user});const s=Object.assign({},r);delete s.user;const a=$m(s);await ui(this.storage,this.storageKey,a)}else{const s=$m(r);await ui(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await vs(this.storage,this.storageKey),await vs(this.storage,this.storageKey+"-code-verifier"),await vs(this.storage,this.storageKey+"-user"),this.userStorage&&await vs(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&cn()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),ci);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-t)/ci);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${ci}ms, refresh threshold is ${$f} ticks`),s<=$f&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Rv)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!cn()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const s=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[a,i]=await Ja(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(i)}`});s.push(o.toString())}if(n!=null&&n.queryParams){const a=new URLSearchParams(n.queryParams);s.push(a.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:s,error:a}=r;return a?{data:null,error:a}:await Xe(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if($e(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,s;const{data:a,error:i}=r;if(i)return{data:null,error:i};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:c,error:u}=await Xe(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return u?{data:null,error:u}:(t.factorType==="totp"&&(!((s=c==null?void 0:c.totp)===null||s===void 0)&&s.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(r){if($e(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:a}=r;if(a)return{data:null,error:a};const{data:i,error:o}=await Xe(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:o})})}catch(r){if($e(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:a}=r;return a?{data:null,error:a}:await Xe(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if($e(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],s=n.filter(i=>i.factor_type==="totp"&&i.status==="verified"),a=n.filter(i=>i.factor_type==="phone"&&i.status==="verified");return{data:{all:n,totp:s,phone:a},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:s},error:a}=t;if(a)return{data:null,error:a};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=Bd(s.access_token);let o=null;i.aal&&(o=i.aal);let c=o;((n=(r=s.user.factors)===null||r===void 0?void 0:r.filter(f=>f.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(c="aal2");const d=i.amr||[];return{data:{currentLevel:o,nextLevel:c,currentAuthenticationMethods:d},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(o=>o.kid===t);if(n)return n;const s=Date.now();if(n=this.jwks.keys.find(o=>o.kid===t),n&&this.jwks_cached_at+HP>s)return n;const{data:a,error:i}=await Xe(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=s,n=a.keys.find(o=>o.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:p,error:v}=await this.getSession();if(v||!p.session)return{data:null,error:v};n=p.session.access_token}const{header:s,payload:a,signature:i,raw:{header:o,payload:c}}=Bd(n);r!=null&&r.allowExpired||mA(a.exp);const u=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!u){const{error:p}=await this.getUser(n);if(p)throw p;return{data:{claims:a,header:s,signature:i},error:null}}const d=pA(s.alg),f=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,f,i,eA(`${o}.${c}`)))throw new Vf("Invalid JWT signature");return{data:{claims:a,header:s,signature:i},error:null}}catch(n){if($e(n))return{data:null,error:n};throw n}}}Xo.nextInstanceID=0;const DA=Xo;class jA extends DA{constructor(t){super(t)}}var RA=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(d){try{u(n.next(d))}catch(f){i(f)}}function c(d){try{u(n.throw(d))}catch(f){i(f)}}function u(d){d.done?a(d.value):s(d.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};class OA{constructor(t,r,n){var s,a,i;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const o=LP(t),c=new URL(o);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const u=`sb-${c.hostname.split(".")[0]}-auth-token`,d={db:NP,realtime:jP,auth:Object.assign(Object.assign({},DP),{storageKey:u}),global:AP},f=BP(n??{},d);this.storageKey=(s=f.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(a=f.global.headers)!==null&&a!==void 0?a:{},f.accessToken?(this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(h,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=f.auth)!==null&&i!==void 0?i:{},this.headers,f.global.fetch),this.fetch=MP(r,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.rest=new qk(new URL("rest/v1",c).href,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),this.storage=new CP(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),f.accessToken||this._listenForAuthEvents()}get functions(){return new Ck(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return RA(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,storageKey:a,flowType:i,lock:o,debug:c},u,d){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new jA({url:this.authUrl.href,headers:Object.assign(Object.assign({},f),u),storageKey:a,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,flowType:i,lock:o,debug:c,fetch:d,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new hP(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const IA=(e,t,r)=>new OA(e,t,r);function MA(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}MA()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const FA="https://isaojcmuooftwhdnubhs.supabase.co",LA="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlzYW9qY211b29mdHdoZG51YmhzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ4MjE4MTgsImV4cCI6MjA3MDM5NzgxOH0.cexAMM2q1sLCAIpRUe2L-NUhKFV5RUVaT2tR8nt-PjQ",mr=IA(FA,LA,{auth:{storage:localStorage,persistSession:!0,autoRefreshToken:!0}}),Ov=m.createContext({user:null,session:null,loading:!0,signIn:async()=>({error:null}),signUp:async()=>({error:null}),signOut:async()=>{}}),BA=({children:e})=>{const[t,r]=m.useState(null),[n,s]=m.useState(null),[a,i]=m.useState(!0);console.log("AuthProvider render - user:",t,"session:",n,"loading:",a),m.useEffect(()=>{const{data:{subscription:d}}=mr.auth.onAuthStateChange((f,h)=>{s(h),r((h==null?void 0:h.user)??null)});return mr.auth.getSession().then(({data:{session:f}})=>{s(f),r((f==null?void 0:f.user)??null),i(!1)}),()=>d.unsubscribe()},[]);const o=async(d,f)=>{const{error:h}=await mr.auth.signInWithPassword({email:d,password:f});return{error:h}},c=async(d,f)=>{let h;window.location.hostname.includes("github.io")?h=`${window.location.origin}/put-options-se/#/auth/callback`:h=`${window.location.origin}/#/auth/callback`,console.log("SignUp redirect URL:",h);const{error:p}=await mr.auth.signUp({email:d,password:f,options:{emailRedirectTo:h}});return{error:p}},u=async()=>{await mr.auth.signOut()};return l.jsx(Ov.Provider,{value:{user:t,session:n,loading:a,signIn:o,signUp:c,signOut:u},children:e})},ea=()=>m.useContext(Ov),Uu=()=>{const{user:e}=ea(),[t,r]=m.useState([]),[n,s]=m.useState([]),[a,i]=m.useState({underlyingValue:1e5,transactionCost:150}),[o,c]=m.useState(!0);m.useEffect(()=>{if(!e){c(!1);return}u()},[e]);const u=async()=>{if(e)try{c(!0);const{data:p,error:v}=await mr.from("user_preferences").select("preference_type, preference_data").eq("user_id",e.id);if(v){console.error("Error loading preferences:",v);return}p==null||p.forEach(g=>{g.preference_type==="column_preferences"?r(g.preference_data):g.preference_type==="portfolio_column_preferences"?s(g.preference_data):g.preference_type==="calculation_settings"&&i(g.preference_data)})}catch(p){console.error("Error loading preferences:",p)}finally{c(!1)}};return{columnPreferences:t,portfolioColumnPreferences:n,calculationSettings:a,isLoading:o,saveColumnPreferences:async p=>{if(!e){console.log("User not authenticated, skipping column preferences save");return}try{const{error:v}=await mr.from("user_preferences").upsert({user_id:e.id,preference_type:"column_preferences",preference_data:p},{onConflict:"user_id,preference_type"});if(v){Ir.error("Failed to save column preferences"),console.error("Error saving column preferences:",v);return}r(p),Ir.success("Column preferences saved")}catch(v){Ir.error("Failed to save column preferences"),console.error("Error saving column preferences:",v)}},savePortfolioColumnPreferences:async p=>{if(!e){console.log("User not authenticated, skipping portfolio column preferences save");return}try{const{error:v}=await mr.from("user_preferences").upsert({user_id:e.id,preference_type:"portfolio_column_preferences",preference_data:p},{onConflict:"user_id,preference_type"});if(v){Ir.error("Failed to save portfolio column preferences"),console.error("Error saving portfolio column preferences:",v);return}s(p),Ir.success("Portfolio column preferences saved")}catch(v){Ir.error("Failed to save portfolio column preferences"),console.error("Error saving portfolio column preferences:",v)}},saveCalculationSettings:async p=>{if(!e){console.log("User not authenticated, skipping calculation settings save");return}try{const{error:v}=await mr.from("user_preferences").upsert({user_id:e.id,preference_type:"calculation_settings",preference_data:p},{onConflict:"user_id,preference_type"});if(v){Ir.error("Failed to save calculation settings"),console.error("Error saving calculation settings:",v);return}i(p),Ir.success("Calculation settings saved")}catch(v){Ir.error("Failed to save calculation settings"),console.error("Error saving calculation settings:",v)}},refreshPreferences:u}},Iv=m.createContext(void 0),Yi=()=>{const e=m.useContext(Iv);if(!e)throw new Error("useSettings must be used within a SettingsProvider");return e},$A=({children:e})=>{const{calculationSettings:t,saveCalculationSettings:r,isLoading:n}=Uu(),[s,a]=m.useState(1e5),[i,o]=m.useState(150),c=m.useRef(!1),u=m.useRef({underlyingValue:1e5,transactionCost:150}),d=m.useRef(!1);m.useEffect(()=>{if(!n&&(console.log("SettingsContext: useEffect running",{calculationSettings:t,underlyingValue:s,transactionCost:i,userUpdate:c.current,hasInitialized:d.current,lastUserValue:u.current}),!d.current||!c.current)){if(t.underlyingValue!==1e5||t.transactionCost!==150)t.underlyingValue!==s&&!c.current&&(console.log("SettingsContext: Initial sync - updating underlying value from DB:",t.underlyingValue),a(t.underlyingValue),u.current.underlyingValue=t.underlyingValue),t.transactionCost!==i&&!c.current&&(console.log("SettingsContext: Initial sync - updating transaction cost from DB:",t.transactionCost),o(t.transactionCost),u.current.transactionCost=t.transactionCost);else if(!d.current){const p=localStorage.getItem("underlyingValue");if(p){const g=parseInt(p,10);!isNaN(g)&&g>0&&g!==s&&(console.log("SettingsContext: Initial sync - updating underlying value from localStorage:",g),a(g),u.current.underlyingValue=g)}const v=localStorage.getItem("transactionCost");if(v){const g=parseInt(v,10);!isNaN(g)&&g>=0&&g!==i&&(console.log("SettingsContext: Initial sync - updating transaction cost from localStorage:",g),o(g),u.current.transactionCost=g)}}d.current=!0}},[t,n]);const f=p=>{console.log("SettingsContext: User setting underlying value to",p,"Previous value was:",s),c.current=!0,a(p),u.current.underlyingValue=p,localStorage.setItem("underlyingValue",p.toString()),r({underlyingValue:p,transactionCost:i}),console.log("SettingsContext: Updated both localStorage and database with underlying value:",p)},h=p=>{console.log("SettingsContext: User setting transaction cost to",p,"Previous value was:",i),c.current=!0,o(p),u.current.transactionCost=p,localStorage.setItem("transactionCost",p.toString()),r({underlyingValue:s,transactionCost:p}),console.log("SettingsContext: Updated both localStorage and database with transaction cost:",p)};return l.jsx(Iv.Provider,{value:{underlyingValue:s,setUnderlyingValue:f,transactionCost:i,setTransactionCost:h},children:e})},Sl=m.forwardRef(({className:e,...t},r)=>l.jsx("div",{className:"relative w-full overflow-auto",children:l.jsx("table",{ref:r,className:Pe("w-full caption-bottom text-sm",e),...t})}));Sl.displayName="Table";const El=m.forwardRef(({className:e,...t},r)=>l.jsx("thead",{ref:r,className:Pe("[&_tr]:border-b",e),...t}));El.displayName="TableHeader";const Tl=m.forwardRef(({className:e,...t},r)=>l.jsx("tbody",{ref:r,className:Pe("[&_tr:last-child]:border-0",e),...t}));Tl.displayName="TableBody";const WA=m.forwardRef(({className:e,...t},r)=>l.jsx("tfoot",{ref:r,className:Pe("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));WA.displayName="TableFooter";const ds=m.forwardRef(({className:e,...t},r)=>l.jsx("tr",{ref:r,className:Pe("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));ds.displayName="TableRow";const qr=m.forwardRef(({className:e,...t},r)=>l.jsx("th",{ref:r,className:Pe("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));qr.displayName="TableHead";const Dt=m.forwardRef(({className:e,...t},r)=>l.jsx("td",{ref:r,className:Pe("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));Dt.displayName="TableCell";const UA=m.forwardRef(({className:e,...t},r)=>l.jsx("caption",{ref:r,className:Pe("mt-4 text-sm text-muted-foreground",e),...t}));UA.displayName="TableCaption";var VA=m.createContext(void 0);function Xi(e){const t=m.useContext(VA);return e||t||"ltr"}function qo(e,[t,r]){return Math.min(r,Math.max(t,e))}function HA(e,t){return m.useReducer((r,n)=>t[r][n]??r,e)}var Gh="ScrollArea",[Mv,CW]=bn(Gh),[zA,sn]=Mv(Gh),Fv=m.forwardRef((e,t)=>{const{__scopeScrollArea:r,type:n="hover",dir:s,scrollHideDelay:a=600,...i}=e,[o,c]=m.useState(null),[u,d]=m.useState(null),[f,h]=m.useState(null),[p,v]=m.useState(null),[g,x]=m.useState(null),[y,w]=m.useState(0),[_,b]=m.useState(0),[T,k]=m.useState(!1),[S,E]=m.useState(!1),C=Me(t,M=>c(M)),L=Xi(s);return l.jsx(zA,{scope:r,type:n,dir:L,scrollHideDelay:a,scrollArea:o,viewport:u,onViewportChange:d,content:f,onContentChange:h,scrollbarX:p,onScrollbarXChange:v,scrollbarXEnabled:T,onScrollbarXEnabledChange:k,scrollbarY:g,onScrollbarYChange:x,scrollbarYEnabled:S,onScrollbarYEnabledChange:E,onCornerWidthChange:w,onCornerHeightChange:b,children:l.jsx(Ne.div,{dir:L,...i,ref:C,style:{position:"relative","--radix-scroll-area-corner-width":y+"px","--radix-scroll-area-corner-height":_+"px",...e.style}})})});Fv.displayName=Gh;var Lv="ScrollAreaViewport",Bv=m.forwardRef((e,t)=>{const{__scopeScrollArea:r,children:n,asChild:s,nonce:a,...i}=e,o=sn(Lv,r),c=m.useRef(null),u=Me(t,c,o.onViewportChange);return l.jsxs(l.Fragment,{children:[l.jsx("style",{dangerouslySetInnerHTML:{__html:`
[data-radix-scroll-area-viewport] {
  scrollbar-width: none;
  -ms-overflow-style: none;
  -webkit-overflow-scrolling: touch;
}
[data-radix-scroll-area-viewport]::-webkit-scrollbar {
  display: none;
}
:where([data-radix-scroll-area-viewport]) {
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
:where([data-radix-scroll-area-content]) {
  flex-grow: 1;
}
`},nonce:a}),l.jsx(Ne.div,{"data-radix-scroll-area-viewport":"",...i,asChild:s,ref:u,style:{overflowX:o.scrollbarXEnabled?"scroll":"hidden",overflowY:o.scrollbarYEnabled?"scroll":"hidden",...e.style},children:tN({asChild:s,children:n},d=>l.jsx("div",{"data-radix-scroll-area-content":"",ref:o.onContentChange,style:{minWidth:o.scrollbarXEnabled?"fit-content":void 0},children:d}))})]})});Bv.displayName=Lv;var Hn="ScrollAreaScrollbar",Kh=m.forwardRef((e,t)=>{const{forceMount:r,...n}=e,s=sn(Hn,e.__scopeScrollArea),{onScrollbarXEnabledChange:a,onScrollbarYEnabledChange:i}=s,o=e.orientation==="horizontal";return m.useEffect(()=>(o?a(!0):i(!0),()=>{o?a(!1):i(!1)}),[o,a,i]),s.type==="hover"?l.jsx(GA,{...n,ref:t,forceMount:r}):s.type==="scroll"?l.jsx(KA,{...n,ref:t,forceMount:r}):s.type==="auto"?l.jsx($v,{...n,ref:t,forceMount:r}):s.type==="always"?l.jsx(Yh,{...n,ref:t}):null});Kh.displayName=Hn;var GA=m.forwardRef((e,t)=>{const{forceMount:r,...n}=e,s=sn(Hn,e.__scopeScrollArea),[a,i]=m.useState(!1);return m.useEffect(()=>{const o=s.scrollArea;let c=0;if(o){const u=()=>{window.clearTimeout(c),i(!0)},d=()=>{c=window.setTimeout(()=>i(!1),s.scrollHideDelay)};return o.addEventListener("pointerenter",u),o.addEventListener("pointerleave",d),()=>{window.clearTimeout(c),o.removeEventListener("pointerenter",u),o.removeEventListener("pointerleave",d)}}},[s.scrollArea,s.scrollHideDelay]),l.jsx(Kt,{present:r||a,children:l.jsx($v,{"data-state":a?"visible":"hidden",...n,ref:t})})}),KA=m.forwardRef((e,t)=>{const{forceMount:r,...n}=e,s=sn(Hn,e.__scopeScrollArea),a=e.orientation==="horizontal",i=Hu(()=>c("SCROLL_END"),100),[o,c]=HA("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return m.useEffect(()=>{if(o==="idle"){const u=window.setTimeout(()=>c("HIDE"),s.scrollHideDelay);return()=>window.clearTimeout(u)}},[o,s.scrollHideDelay,c]),m.useEffect(()=>{const u=s.viewport,d=a?"scrollLeft":"scrollTop";if(u){let f=u[d];const h=()=>{const p=u[d];f!==p&&(c("SCROLL"),i()),f=p};return u.addEventListener("scroll",h),()=>u.removeEventListener("scroll",h)}},[s.viewport,a,c,i]),l.jsx(Kt,{present:r||o!=="hidden",children:l.jsx(Yh,{"data-state":o==="hidden"?"hidden":"visible",...n,ref:t,onPointerEnter:he(e.onPointerEnter,()=>c("POINTER_ENTER")),onPointerLeave:he(e.onPointerLeave,()=>c("POINTER_LEAVE"))})})}),$v=m.forwardRef((e,t)=>{const r=sn(Hn,e.__scopeScrollArea),{forceMount:n,...s}=e,[a,i]=m.useState(!1),o=e.orientation==="horizontal",c=Hu(()=>{if(r.viewport){const u=r.viewport.offsetWidth<r.viewport.scrollWidth,d=r.viewport.offsetHeight<r.viewport.scrollHeight;i(o?u:d)}},10);return Fi(r.viewport,c),Fi(r.content,c),l.jsx(Kt,{present:n||a,children:l.jsx(Yh,{"data-state":a?"visible":"hidden",...s,ref:t})})}),Yh=m.forwardRef((e,t)=>{const{orientation:r="vertical",...n}=e,s=sn(Hn,e.__scopeScrollArea),a=m.useRef(null),i=m.useRef(0),[o,c]=m.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),u=zv(o.viewport,o.content),d={...n,sizes:o,onSizesChange:c,hasThumb:u>0&&u<1,onThumbChange:h=>a.current=h,onThumbPointerUp:()=>i.current=0,onThumbPointerDown:h=>i.current=h};function f(h,p){return ZA(h,i.current,o,p)}return r==="horizontal"?l.jsx(YA,{...d,ref:t,onThumbPositionChange:()=>{if(s.viewport&&a.current){const h=s.viewport.scrollLeft,p=zm(h,o,s.dir);a.current.style.transform=`translate3d(${p}px, 0, 0)`}},onWheelScroll:h=>{s.viewport&&(s.viewport.scrollLeft=h)},onDragScroll:h=>{s.viewport&&(s.viewport.scrollLeft=f(h,s.dir))}}):r==="vertical"?l.jsx(XA,{...d,ref:t,onThumbPositionChange:()=>{if(s.viewport&&a.current){const h=s.viewport.scrollTop,p=zm(h,o);a.current.style.transform=`translate3d(0, ${p}px, 0)`}},onWheelScroll:h=>{s.viewport&&(s.viewport.scrollTop=h)},onDragScroll:h=>{s.viewport&&(s.viewport.scrollTop=f(h))}}):null}),YA=m.forwardRef((e,t)=>{const{sizes:r,onSizesChange:n,...s}=e,a=sn(Hn,e.__scopeScrollArea),[i,o]=m.useState(),c=m.useRef(null),u=Me(t,c,a.onScrollbarXChange);return m.useEffect(()=>{c.current&&o(getComputedStyle(c.current))},[c]),l.jsx(Uv,{"data-orientation":"horizontal",...s,ref:u,sizes:r,style:{bottom:0,left:a.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:a.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Vu(r)+"px",...e.style},onThumbPointerDown:d=>e.onThumbPointerDown(d.x),onDragScroll:d=>e.onDragScroll(d.x),onWheelScroll:(d,f)=>{if(a.viewport){const h=a.viewport.scrollLeft+d.deltaX;e.onWheelScroll(h),Kv(h,f)&&d.preventDefault()}},onResize:()=>{c.current&&a.viewport&&i&&n({content:a.viewport.scrollWidth,viewport:a.viewport.offsetWidth,scrollbar:{size:c.current.clientWidth,paddingStart:Uc(i.paddingLeft),paddingEnd:Uc(i.paddingRight)}})}})}),XA=m.forwardRef((e,t)=>{const{sizes:r,onSizesChange:n,...s}=e,a=sn(Hn,e.__scopeScrollArea),[i,o]=m.useState(),c=m.useRef(null),u=Me(t,c,a.onScrollbarYChange);return m.useEffect(()=>{c.current&&o(getComputedStyle(c.current))},[c]),l.jsx(Uv,{"data-orientation":"vertical",...s,ref:u,sizes:r,style:{top:0,right:a.dir==="ltr"?0:void 0,left:a.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Vu(r)+"px",...e.style},onThumbPointerDown:d=>e.onThumbPointerDown(d.y),onDragScroll:d=>e.onDragScroll(d.y),onWheelScroll:(d,f)=>{if(a.viewport){const h=a.viewport.scrollTop+d.deltaY;e.onWheelScroll(h),Kv(h,f)&&d.preventDefault()}},onResize:()=>{c.current&&a.viewport&&i&&n({content:a.viewport.scrollHeight,viewport:a.viewport.offsetHeight,scrollbar:{size:c.current.clientHeight,paddingStart:Uc(i.paddingTop),paddingEnd:Uc(i.paddingBottom)}})}})}),[qA,Wv]=Mv(Hn),Uv=m.forwardRef((e,t)=>{const{__scopeScrollArea:r,sizes:n,hasThumb:s,onThumbChange:a,onThumbPointerUp:i,onThumbPointerDown:o,onThumbPositionChange:c,onDragScroll:u,onWheelScroll:d,onResize:f,...h}=e,p=sn(Hn,r),[v,g]=m.useState(null),x=Me(t,C=>g(C)),y=m.useRef(null),w=m.useRef(""),_=p.viewport,b=n.content-n.viewport,T=Et(d),k=Et(c),S=Hu(f,10);function E(C){if(y.current){const L=C.clientX-y.current.left,M=C.clientY-y.current.top;u({x:L,y:M})}}return m.useEffect(()=>{const C=L=>{const M=L.target;(v==null?void 0:v.contains(M))&&T(L,b)};return document.addEventListener("wheel",C,{passive:!1}),()=>document.removeEventListener("wheel",C,{passive:!1})},[_,v,b,T]),m.useEffect(k,[n,k]),Fi(v,S),Fi(p.content,S),l.jsx(qA,{scope:r,scrollbar:v,hasThumb:s,onThumbChange:Et(a),onThumbPointerUp:Et(i),onThumbPositionChange:k,onThumbPointerDown:Et(o),children:l.jsx(Ne.div,{...h,ref:x,style:{position:"absolute",...h.style},onPointerDown:he(e.onPointerDown,C=>{C.button===0&&(C.target.setPointerCapture(C.pointerId),y.current=v.getBoundingClientRect(),w.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",p.viewport&&(p.viewport.style.scrollBehavior="auto"),E(C))}),onPointerMove:he(e.onPointerMove,E),onPointerUp:he(e.onPointerUp,C=>{const L=C.target;L.hasPointerCapture(C.pointerId)&&L.releasePointerCapture(C.pointerId),document.body.style.webkitUserSelect=w.current,p.viewport&&(p.viewport.style.scrollBehavior=""),y.current=null})})})}),Wc="ScrollAreaThumb",Vv=m.forwardRef((e,t)=>{const{forceMount:r,...n}=e,s=Wv(Wc,e.__scopeScrollArea);return l.jsx(Kt,{present:r||s.hasThumb,children:l.jsx(JA,{ref:t,...n})})}),JA=m.forwardRef((e,t)=>{const{__scopeScrollArea:r,style:n,...s}=e,a=sn(Wc,r),i=Wv(Wc,r),{onThumbPositionChange:o}=i,c=Me(t,f=>i.onThumbChange(f)),u=m.useRef(),d=Hu(()=>{u.current&&(u.current(),u.current=void 0)},100);return m.useEffect(()=>{const f=a.viewport;if(f){const h=()=>{if(d(),!u.current){const p=eN(f,o);u.current=p,o()}};return o(),f.addEventListener("scroll",h),()=>f.removeEventListener("scroll",h)}},[a.viewport,d,o]),l.jsx(Ne.div,{"data-state":i.hasThumb?"visible":"hidden",...s,ref:c,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...n},onPointerDownCapture:he(e.onPointerDownCapture,f=>{const p=f.target.getBoundingClientRect(),v=f.clientX-p.left,g=f.clientY-p.top;i.onThumbPointerDown({x:v,y:g})}),onPointerUp:he(e.onPointerUp,i.onThumbPointerUp)})});Vv.displayName=Wc;var Xh="ScrollAreaCorner",Hv=m.forwardRef((e,t)=>{const r=sn(Xh,e.__scopeScrollArea),n=!!(r.scrollbarX&&r.scrollbarY);return r.type!=="scroll"&&n?l.jsx(QA,{...e,ref:t}):null});Hv.displayName=Xh;var QA=m.forwardRef((e,t)=>{const{__scopeScrollArea:r,...n}=e,s=sn(Xh,r),[a,i]=m.useState(0),[o,c]=m.useState(0),u=!!(a&&o);return Fi(s.scrollbarX,()=>{var f;const d=((f=s.scrollbarX)==null?void 0:f.offsetHeight)||0;s.onCornerHeightChange(d),c(d)}),Fi(s.scrollbarY,()=>{var f;const d=((f=s.scrollbarY)==null?void 0:f.offsetWidth)||0;s.onCornerWidthChange(d),i(d)}),u?l.jsx(Ne.div,{...n,ref:t,style:{width:a,height:o,position:"absolute",right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function Uc(e){return e?parseInt(e,10):0}function zv(e,t){const r=e/t;return isNaN(r)?0:r}function Vu(e){const t=zv(e.viewport,e.content),r=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,n=(e.scrollbar.size-r)*t;return Math.max(n,18)}function ZA(e,t,r,n="ltr"){const s=Vu(r),a=s/2,i=t||a,o=s-i,c=r.scrollbar.paddingStart+i,u=r.scrollbar.size-r.scrollbar.paddingEnd-o,d=r.content-r.viewport,f=n==="ltr"?[0,d]:[d*-1,0];return Gv([c,u],f)(e)}function zm(e,t,r="ltr"){const n=Vu(t),s=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,a=t.scrollbar.size-s,i=t.content-t.viewport,o=a-n,c=r==="ltr"?[0,i]:[i*-1,0],u=qo(e,c);return Gv([0,i],[0,o])(u)}function Gv(e,t){return r=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const n=(t[1]-t[0])/(e[1]-e[0]);return t[0]+n*(r-e[0])}}function Kv(e,t){return e>0&&e<t}var eN=(e,t=()=>{})=>{let r={left:e.scrollLeft,top:e.scrollTop},n=0;return function s(){const a={left:e.scrollLeft,top:e.scrollTop},i=r.left!==a.left,o=r.top!==a.top;(i||o)&&t(),r=a,n=window.requestAnimationFrame(s)}(),()=>window.cancelAnimationFrame(n)};function Hu(e,t){const r=Et(e),n=m.useRef(0);return m.useEffect(()=>()=>window.clearTimeout(n.current),[]),m.useCallback(()=>{window.clearTimeout(n.current),n.current=window.setTimeout(r,t)},[r,t])}function Fi(e,t){const r=Et(t);er(()=>{let n=0;if(e){const s=new ResizeObserver(()=>{cancelAnimationFrame(n),n=window.requestAnimationFrame(r)});return s.observe(e),()=>{window.cancelAnimationFrame(n),s.unobserve(e)}}},[e,r])}function tN(e,t){const{asChild:r,children:n}=e;if(!r)return typeof t=="function"?t(n):t;const s=m.Children.only(n);return m.cloneElement(s,{children:typeof t=="function"?t(s.props.children):t})}var Yv=Fv,rN=Bv,nN=Hv;const zu=m.forwardRef(({className:e,children:t,...r},n)=>l.jsxs(Yv,{ref:n,className:Pe("relative overflow-hidden",e),...r,children:[l.jsx(rN,{className:"h-full w-full rounded-[inherit]",children:t}),l.jsx(Gu,{}),l.jsx(nN,{})]}));zu.displayName=Yv.displayName;const Gu=m.forwardRef(({className:e,orientation:t="vertical",...r},n)=>l.jsx(Kh,{ref:n,orientation:t,className:Pe("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...r,children:l.jsx(Vv,{className:"relative flex-1 rounded-full bg-border"})}));Gu.displayName=Kh.displayName;const sN=bu("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),Ee=m.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,...s},a)=>{const i=n?ls:"button";return l.jsx(i,{className:Pe(sN({variant:t,size:r,className:e})),ref:a,...s})});Ee.displayName="Button";const Rt=m.forwardRef(({className:e,type:t,...r},n)=>l.jsx("input",{type:t,className:Pe("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:n,...r}));Rt.displayName="Input";var Ud="focusScope.autoFocusOnMount",Vd="focusScope.autoFocusOnUnmount",Gm={bubbles:!1,cancelable:!0},aN="FocusScope",Cl=m.forwardRef((e,t)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:s,onUnmountAutoFocus:a,...i}=e,[o,c]=m.useState(null),u=Et(s),d=Et(a),f=m.useRef(null),h=Me(t,g=>c(g)),p=m.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;m.useEffect(()=>{if(n){let g=function(_){if(p.paused||!o)return;const b=_.target;o.contains(b)?f.current=b:bs(f.current,{select:!0})},x=function(_){if(p.paused||!o)return;const b=_.relatedTarget;b!==null&&(o.contains(b)||bs(f.current,{select:!0}))},y=function(_){if(document.activeElement===document.body)for(const T of _)T.removedNodes.length>0&&bs(o)};document.addEventListener("focusin",g),document.addEventListener("focusout",x);const w=new MutationObserver(y);return o&&w.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",g),document.removeEventListener("focusout",x),w.disconnect()}}},[n,o,p.paused]),m.useEffect(()=>{if(o){Ym.add(p);const g=document.activeElement;if(!o.contains(g)){const y=new CustomEvent(Ud,Gm);o.addEventListener(Ud,u),o.dispatchEvent(y),y.defaultPrevented||(iN(dN(Xv(o)),{select:!0}),document.activeElement===g&&bs(o))}return()=>{o.removeEventListener(Ud,u),setTimeout(()=>{const y=new CustomEvent(Vd,Gm);o.addEventListener(Vd,d),o.dispatchEvent(y),y.defaultPrevented||bs(g??document.body,{select:!0}),o.removeEventListener(Vd,d),Ym.remove(p)},0)}}},[o,u,d,p]);const v=m.useCallback(g=>{if(!r&&!n||p.paused)return;const x=g.key==="Tab"&&!g.altKey&&!g.ctrlKey&&!g.metaKey,y=document.activeElement;if(x&&y){const w=g.currentTarget,[_,b]=oN(w);_&&b?!g.shiftKey&&y===b?(g.preventDefault(),r&&bs(_,{select:!0})):g.shiftKey&&y===_&&(g.preventDefault(),r&&bs(b,{select:!0})):y===w&&g.preventDefault()}},[r,n,p.paused]);return l.jsx(Ne.div,{tabIndex:-1,...i,ref:h,onKeyDown:v})});Cl.displayName=aN;function iN(e,{select:t=!1}={}){const r=document.activeElement;for(const n of e)if(bs(n,{select:t}),document.activeElement!==r)return}function oN(e){const t=Xv(e),r=Km(t,e),n=Km(t.reverse(),e);return[r,n]}function Xv(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const s=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||s?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function Km(e,t){for(const r of e)if(!lN(r,{upTo:t}))return r}function lN(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function cN(e){return e instanceof HTMLInputElement&&"select"in e}function bs(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&cN(e)&&t&&e.select()}}var Ym=uN();function uN(){let e=[];return{add(t){const r=e[0];t!==r&&(r==null||r.pause()),e=Xm(e,t),e.unshift(t)},remove(t){var r;e=Xm(e,t),(r=e[0])==null||r.resume()}}}function Xm(e,t){const r=[...e],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function dN(e){return e.filter(t=>t.tagName!=="A")}var Hd=0;function Ku(){m.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??qm()),document.body.insertAdjacentElement("beforeend",e[1]??qm()),Hd++,()=>{Hd===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),Hd--}},[])}function qm(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var ar=function(){return ar=Object.assign||function(t){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t},ar.apply(this,arguments)};function qh(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r}function qv(e,t,r){if(r||arguments.length===2)for(var n=0,s=t.length,a;n<s;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}var Ao="right-scroll-bar-position",No="width-before-scroll-bar",fN="with-scroll-bars-hidden",hN="--removed-body-scroll-bar-size";function zd(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function mN(e,t){var r=m.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(n){var s=r.value;s!==n&&(r.value=n,r.callback(n,s))}}}})[0];return r.callback=t,r.facade}var pN=typeof window<"u"?m.useLayoutEffect:m.useEffect,Jm=new WeakMap;function Jv(e,t){var r=mN(null,function(n){return e.forEach(function(s){return zd(s,n)})});return pN(function(){var n=Jm.get(r);if(n){var s=new Set(n),a=new Set(e),i=r.current;s.forEach(function(o){a.has(o)||zd(o,null)}),a.forEach(function(o){s.has(o)||zd(o,i)})}Jm.set(r,e)},[e]),r}function gN(e){return e}function xN(e,t){t===void 0&&(t=gN);var r=[],n=!1,s={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(a){var i=t(a,n);return r.push(i),function(){r=r.filter(function(o){return o!==i})}},assignSyncMedium:function(a){for(n=!0;r.length;){var i=r;r=[],i.forEach(a)}r={push:function(o){return a(o)},filter:function(){return r}}},assignMedium:function(a){n=!0;var i=[];if(r.length){var o=r;r=[],o.forEach(a),i=r}var c=function(){var d=i;i=[],d.forEach(a)},u=function(){return Promise.resolve().then(c)};u(),r={push:function(d){i.push(d),u()},filter:function(d){return i=i.filter(d),r}}}};return s}function Qv(e){e===void 0&&(e={});var t=xN(null);return t.options=ar({async:!0,ssr:!1},e),t}var Zv=function(e){var t=e.sideCar,r=qh(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return m.createElement(n,ar({},r))};Zv.isSideCarExport=!0;function e1(e,t){return e.useMedium(t),Zv}var t1=Qv(),Gd=function(){},Yu=m.forwardRef(function(e,t){var r=m.useRef(null),n=m.useState({onScrollCapture:Gd,onWheelCapture:Gd,onTouchMoveCapture:Gd}),s=n[0],a=n[1],i=e.forwardProps,o=e.children,c=e.className,u=e.removeScrollBar,d=e.enabled,f=e.shards,h=e.sideCar,p=e.noIsolation,v=e.inert,g=e.allowPinchZoom,x=e.as,y=x===void 0?"div":x,w=e.gapMode,_=qh(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),b=h,T=Jv([r,t]),k=ar(ar({},_),s);return m.createElement(m.Fragment,null,d&&m.createElement(b,{sideCar:t1,removeScrollBar:u,shards:f,noIsolation:p,inert:v,setCallbacks:a,allowPinchZoom:!!g,lockRef:r,gapMode:w}),i?m.cloneElement(m.Children.only(o),ar(ar({},k),{ref:T})):m.createElement(y,ar({},k,{className:c,ref:T}),o))});Yu.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Yu.classNames={fullWidth:No,zeroRight:Ao};var vN=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function yN(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=vN();return t&&e.setAttribute("nonce",t),e}function wN(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function _N(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var bN=function(){var e=0,t=null;return{add:function(r){e==0&&(t=yN())&&(wN(t,r),_N(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},SN=function(){var e=bN();return function(t,r){m.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},Jh=function(){var e=SN(),t=function(r){var n=r.styles,s=r.dynamic;return e(n,s),null};return t},EN={left:0,top:0,right:0,gap:0},Kd=function(e){return parseInt(e||"",10)||0},TN=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],n=t[e==="padding"?"paddingTop":"marginTop"],s=t[e==="padding"?"paddingRight":"marginRight"];return[Kd(r),Kd(n),Kd(s)]},CN=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return EN;var t=TN(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}},kN=Jh(),pi="data-scroll-locked",PN=function(e,t,r,n){var s=e.left,a=e.top,i=e.right,o=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(fN,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(o,"px ").concat(n,`;
  }
  body[`).concat(pi,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(a,`px;
    padding-right: `).concat(i,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(o,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(o,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Ao,` {
    right: `).concat(o,"px ").concat(n,`;
  }
  
  .`).concat(No,` {
    margin-right: `).concat(o,"px ").concat(n,`;
  }
  
  .`).concat(Ao," .").concat(Ao,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(No," .").concat(No,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(pi,`] {
    `).concat(hN,": ").concat(o,`px;
  }
`)},Qm=function(){var e=parseInt(document.body.getAttribute(pi)||"0",10);return isFinite(e)?e:0},AN=function(){m.useEffect(function(){return document.body.setAttribute(pi,(Qm()+1).toString()),function(){var e=Qm()-1;e<=0?document.body.removeAttribute(pi):document.body.setAttribute(pi,e.toString())}},[])},r1=function(e){var t=e.noRelative,r=e.noImportant,n=e.gapMode,s=n===void 0?"margin":n;AN();var a=m.useMemo(function(){return CN(s)},[s]);return m.createElement(kN,{styles:PN(a,!t,s,r?"":"!important")})},Hf=!1;if(typeof window<"u")try{var rc=Object.defineProperty({},"passive",{get:function(){return Hf=!0,!0}});window.addEventListener("test",rc,rc),window.removeEventListener("test",rc,rc)}catch{Hf=!1}var ti=Hf?{passive:!1}:!1,NN=function(e){return e.tagName==="TEXTAREA"},n1=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!NN(e)&&r[t]==="visible")},DN=function(e){return n1(e,"overflowY")},jN=function(e){return n1(e,"overflowX")},Zm=function(e,t){var r=t.ownerDocument,n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var s=s1(e,n);if(s){var a=a1(e,n),i=a[1],o=a[2];if(i>o)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},RN=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},ON=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},s1=function(e,t){return e==="v"?DN(t):jN(t)},a1=function(e,t){return e==="v"?RN(t):ON(t)},IN=function(e,t){return e==="h"&&t==="rtl"?-1:1},MN=function(e,t,r,n,s){var a=IN(e,window.getComputedStyle(t).direction),i=a*n,o=r.target,c=t.contains(o),u=!1,d=i>0,f=0,h=0;do{var p=a1(e,o),v=p[0],g=p[1],x=p[2],y=g-x-a*v;(v||y)&&s1(e,o)&&(f+=y,h+=v),o instanceof ShadowRoot?o=o.host:o=o.parentNode}while(!c&&o!==document.body||c&&(t.contains(o)||t===o));return(d&&(Math.abs(f)<1||!s)||!d&&(Math.abs(h)<1||!s))&&(u=!0),u},nc=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},ep=function(e){return[e.deltaX,e.deltaY]},tp=function(e){return e&&"current"in e?e.current:e},FN=function(e,t){return e[0]===t[0]&&e[1]===t[1]},LN=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},BN=0,ri=[];function $N(e){var t=m.useRef([]),r=m.useRef([0,0]),n=m.useRef(),s=m.useState(BN++)[0],a=m.useState(Jh)[0],i=m.useRef(e);m.useEffect(function(){i.current=e},[e]),m.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(s));var g=qv([e.lockRef.current],(e.shards||[]).map(tp),!0).filter(Boolean);return g.forEach(function(x){return x.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),g.forEach(function(x){return x.classList.remove("allow-interactivity-".concat(s))})}}},[e.inert,e.lockRef.current,e.shards]);var o=m.useCallback(function(g,x){if("touches"in g&&g.touches.length===2||g.type==="wheel"&&g.ctrlKey)return!i.current.allowPinchZoom;var y=nc(g),w=r.current,_="deltaX"in g?g.deltaX:w[0]-y[0],b="deltaY"in g?g.deltaY:w[1]-y[1],T,k=g.target,S=Math.abs(_)>Math.abs(b)?"h":"v";if("touches"in g&&S==="h"&&k.type==="range")return!1;var E=Zm(S,k);if(!E)return!0;if(E?T=S:(T=S==="v"?"h":"v",E=Zm(S,k)),!E)return!1;if(!n.current&&"changedTouches"in g&&(_||b)&&(n.current=T),!T)return!0;var C=n.current||T;return MN(C,x,g,C==="h"?_:b,!0)},[]),c=m.useCallback(function(g){var x=g;if(!(!ri.length||ri[ri.length-1]!==a)){var y="deltaY"in x?ep(x):nc(x),w=t.current.filter(function(T){return T.name===x.type&&(T.target===x.target||x.target===T.shadowParent)&&FN(T.delta,y)})[0];if(w&&w.should){x.cancelable&&x.preventDefault();return}if(!w){var _=(i.current.shards||[]).map(tp).filter(Boolean).filter(function(T){return T.contains(x.target)}),b=_.length>0?o(x,_[0]):!i.current.noIsolation;b&&x.cancelable&&x.preventDefault()}}},[]),u=m.useCallback(function(g,x,y,w){var _={name:g,delta:x,target:y,should:w,shadowParent:WN(y)};t.current.push(_),setTimeout(function(){t.current=t.current.filter(function(b){return b!==_})},1)},[]),d=m.useCallback(function(g){r.current=nc(g),n.current=void 0},[]),f=m.useCallback(function(g){u(g.type,ep(g),g.target,o(g,e.lockRef.current))},[]),h=m.useCallback(function(g){u(g.type,nc(g),g.target,o(g,e.lockRef.current))},[]);m.useEffect(function(){return ri.push(a),e.setCallbacks({onScrollCapture:f,onWheelCapture:f,onTouchMoveCapture:h}),document.addEventListener("wheel",c,ti),document.addEventListener("touchmove",c,ti),document.addEventListener("touchstart",d,ti),function(){ri=ri.filter(function(g){return g!==a}),document.removeEventListener("wheel",c,ti),document.removeEventListener("touchmove",c,ti),document.removeEventListener("touchstart",d,ti)}},[]);var p=e.removeScrollBar,v=e.inert;return m.createElement(m.Fragment,null,v?m.createElement(a,{styles:LN(s)}):null,p?m.createElement(r1,{gapMode:e.gapMode}):null)}function WN(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const UN=e1(t1,$N);var kl=m.forwardRef(function(e,t){return m.createElement(Yu,ar({},e,{ref:t,sideCar:UN}))});kl.classNames=Yu.classNames;var VN=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},ni=new WeakMap,sc=new WeakMap,ac={},Yd=0,i1=function(e){return e&&(e.host||i1(e.parentNode))},HN=function(e,t){return t.map(function(r){if(e.contains(r))return r;var n=i1(r);return n&&e.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},zN=function(e,t,r,n){var s=HN(t,Array.isArray(e)?e:[e]);ac[r]||(ac[r]=new WeakMap);var a=ac[r],i=[],o=new Set,c=new Set(s),u=function(f){!f||o.has(f)||(o.add(f),u(f.parentNode))};s.forEach(u);var d=function(f){!f||c.has(f)||Array.prototype.forEach.call(f.children,function(h){if(o.has(h))d(h);else try{var p=h.getAttribute(n),v=p!==null&&p!=="false",g=(ni.get(h)||0)+1,x=(a.get(h)||0)+1;ni.set(h,g),a.set(h,x),i.push(h),g===1&&v&&sc.set(h,!0),x===1&&h.setAttribute(r,"true"),v||h.setAttribute(n,"true")}catch(y){console.error("aria-hidden: cannot operate on ",h,y)}})};return d(t),o.clear(),Yd++,function(){i.forEach(function(f){var h=ni.get(f)-1,p=a.get(f)-1;ni.set(f,h),a.set(f,p),h||(sc.has(f)||f.removeAttribute(n),sc.delete(f)),p||f.removeAttribute(r)}),Yd--,Yd||(ni=new WeakMap,ni=new WeakMap,sc=new WeakMap,ac={})}},Pl=function(e,t,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),s=VN(e);return s?(n.push.apply(n,Array.from(s.querySelectorAll("[aria-live]"))),zN(n,s,r,"aria-hidden")):function(){return null}},Qh="Dialog",[o1,kW]=bn(Qh),[GN,Sn]=o1(Qh),l1=e=>{const{__scopeDialog:t,children:r,open:n,defaultOpen:s,onOpenChange:a,modal:i=!0}=e,o=m.useRef(null),c=m.useRef(null),[u=!1,d]=vn({prop:n,defaultProp:s,onChange:a});return l.jsx(GN,{scope:t,triggerRef:o,contentRef:c,contentId:tn(),titleId:tn(),descriptionId:tn(),open:u,onOpenChange:d,onOpenToggle:m.useCallback(()=>d(f=>!f),[d]),modal:i,children:r})};l1.displayName=Qh;var c1="DialogTrigger",u1=m.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=Sn(c1,r),a=Me(t,s.triggerRef);return l.jsx(Ne.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":t0(s.open),...n,ref:a,onClick:he(e.onClick,s.onOpenToggle)})});u1.displayName=c1;var Zh="DialogPortal",[KN,d1]=o1(Zh,{forceMount:void 0}),f1=e=>{const{__scopeDialog:t,forceMount:r,children:n,container:s}=e,a=Sn(Zh,t);return l.jsx(KN,{scope:t,forceMount:r,children:m.Children.map(n,i=>l.jsx(Kt,{present:r||a.open,children:l.jsx(Wi,{asChild:!0,container:s,children:i})}))})};f1.displayName=Zh;var Vc="DialogOverlay",h1=m.forwardRef((e,t)=>{const r=d1(Vc,e.__scopeDialog),{forceMount:n=r.forceMount,...s}=e,a=Sn(Vc,e.__scopeDialog);return a.modal?l.jsx(Kt,{present:n||a.open,children:l.jsx(YN,{...s,ref:t})}):null});h1.displayName=Vc;var YN=m.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=Sn(Vc,r);return l.jsx(kl,{as:ls,allowPinchZoom:!0,shards:[s.contentRef],children:l.jsx(Ne.div,{"data-state":t0(s.open),...n,ref:t,style:{pointerEvents:"auto",...n.style}})})}),ka="DialogContent",m1=m.forwardRef((e,t)=>{const r=d1(ka,e.__scopeDialog),{forceMount:n=r.forceMount,...s}=e,a=Sn(ka,e.__scopeDialog);return l.jsx(Kt,{present:n||a.open,children:a.modal?l.jsx(XN,{...s,ref:t}):l.jsx(qN,{...s,ref:t})})});m1.displayName=ka;var XN=m.forwardRef((e,t)=>{const r=Sn(ka,e.__scopeDialog),n=m.useRef(null),s=Me(t,r.contentRef,n);return m.useEffect(()=>{const a=n.current;if(a)return Pl(a)},[]),l.jsx(p1,{...e,ref:s,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:he(e.onCloseAutoFocus,a=>{var i;a.preventDefault(),(i=r.triggerRef.current)==null||i.focus()}),onPointerDownOutside:he(e.onPointerDownOutside,a=>{const i=a.detail.originalEvent,o=i.button===0&&i.ctrlKey===!0;(i.button===2||o)&&a.preventDefault()}),onFocusOutside:he(e.onFocusOutside,a=>a.preventDefault())})}),qN=m.forwardRef((e,t)=>{const r=Sn(ka,e.__scopeDialog),n=m.useRef(!1),s=m.useRef(!1);return l.jsx(p1,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:a=>{var i,o;(i=e.onCloseAutoFocus)==null||i.call(e,a),a.defaultPrevented||(n.current||(o=r.triggerRef.current)==null||o.focus(),a.preventDefault()),n.current=!1,s.current=!1},onInteractOutside:a=>{var c,u;(c=e.onInteractOutside)==null||c.call(e,a),a.defaultPrevented||(n.current=!0,a.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const i=a.target;((u=r.triggerRef.current)==null?void 0:u.contains(i))&&a.preventDefault(),a.detail.originalEvent.type==="focusin"&&s.current&&a.preventDefault()}})}),p1=m.forwardRef((e,t)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:s,onCloseAutoFocus:a,...i}=e,o=Sn(ka,r),c=m.useRef(null),u=Me(t,c);return Ku(),l.jsxs(l.Fragment,{children:[l.jsx(Cl,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:s,onUnmountAutoFocus:a,children:l.jsx($a,{role:"dialog",id:o.contentId,"aria-describedby":o.descriptionId,"aria-labelledby":o.titleId,"data-state":t0(o.open),...i,ref:u,onDismiss:()=>o.onOpenChange(!1)})}),l.jsxs(l.Fragment,{children:[l.jsx(JN,{titleId:o.titleId}),l.jsx(ZN,{contentRef:c,descriptionId:o.descriptionId})]})]})}),e0="DialogTitle",g1=m.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=Sn(e0,r);return l.jsx(Ne.h2,{id:s.titleId,...n,ref:t})});g1.displayName=e0;var x1="DialogDescription",v1=m.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=Sn(x1,r);return l.jsx(Ne.p,{id:s.descriptionId,...n,ref:t})});v1.displayName=x1;var y1="DialogClose",w1=m.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=Sn(y1,r);return l.jsx(Ne.button,{type:"button",...n,ref:t,onClick:he(e.onClick,()=>s.onOpenChange(!1))})});w1.displayName=y1;function t0(e){return e?"open":"closed"}var _1="DialogTitleWarning",[PW,b1]=l2(_1,{contentName:ka,titleName:e0,docsSlug:"dialog"}),JN=({titleId:e})=>{const t=b1(_1),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return m.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},QN="DialogDescriptionWarning",ZN=({contentRef:e,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${b1(QN).contentName}}.`;return m.useEffect(()=>{var a;const s=(a=e.current)==null?void 0:a.getAttribute("aria-describedby");t&&s&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},eD=l1,tD=u1,rD=f1,S1=h1,E1=m1,T1=g1,C1=v1,nD=w1;const Al=eD,Nl=tD,sD=rD,k1=m.forwardRef(({className:e,...t},r)=>l.jsx(S1,{ref:r,className:Pe("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));k1.displayName=S1.displayName;const qi=m.forwardRef(({className:e,children:t,...r},n)=>l.jsxs(sD,{children:[l.jsx(k1,{}),l.jsxs(E1,{ref:n,className:Pe("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...r,children:[t,l.jsxs(nD,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[l.jsx(wx,{className:"h-4 w-4"}),l.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));qi.displayName=E1.displayName;const Xu=({className:e,...t})=>l.jsx("div",{className:Pe("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});Xu.displayName="DialogHeader";const qu=m.forwardRef(({className:e,...t},r)=>l.jsx(T1,{ref:r,className:Pe("text-lg font-semibold leading-none tracking-tight",e),...t}));qu.displayName=T1.displayName;const aD=m.forwardRef(({className:e,...t},r)=>l.jsx(C1,{ref:r,className:Pe("text-sm text-muted-foreground",e),...t}));aD.displayName=C1.displayName;function r0(e){const t=m.useRef({value:e,previous:e});return m.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var n0="Checkbox",[iD,AW]=bn(n0),[oD,lD]=iD(n0),P1=m.forwardRef((e,t)=>{const{__scopeCheckbox:r,name:n,checked:s,defaultChecked:a,required:i,disabled:o,value:c="on",onCheckedChange:u,form:d,...f}=e,[h,p]=m.useState(null),v=Me(t,b=>p(b)),g=m.useRef(!1),x=h?d||!!h.closest("form"):!0,[y=!1,w]=vn({prop:s,defaultProp:a,onChange:u}),_=m.useRef(y);return m.useEffect(()=>{const b=h==null?void 0:h.form;if(b){const T=()=>w(_.current);return b.addEventListener("reset",T),()=>b.removeEventListener("reset",T)}},[h,w]),l.jsxs(oD,{scope:r,state:y,disabled:o,children:[l.jsx(Ne.button,{type:"button",role:"checkbox","aria-checked":Ms(y)?"mixed":y,"aria-required":i,"data-state":D1(y),"data-disabled":o?"":void 0,disabled:o,value:c,...f,ref:v,onKeyDown:he(e.onKeyDown,b=>{b.key==="Enter"&&b.preventDefault()}),onClick:he(e.onClick,b=>{w(T=>Ms(T)?!0:!T),x&&(g.current=b.isPropagationStopped(),g.current||b.stopPropagation())})}),x&&l.jsx(cD,{control:h,bubbles:!g.current,name:n,value:c,checked:y,required:i,disabled:o,form:d,style:{transform:"translateX(-100%)"},defaultChecked:Ms(a)?!1:a})]})});P1.displayName=n0;var A1="CheckboxIndicator",N1=m.forwardRef((e,t)=>{const{__scopeCheckbox:r,forceMount:n,...s}=e,a=lD(A1,r);return l.jsx(Kt,{present:n||Ms(a.state)||a.state===!0,children:l.jsx(Ne.span,{"data-state":D1(a.state),"data-disabled":a.disabled?"":void 0,...s,ref:t,style:{pointerEvents:"none",...e.style}})})});N1.displayName=A1;var cD=e=>{const{control:t,checked:r,bubbles:n=!0,defaultChecked:s,...a}=e,i=m.useRef(null),o=r0(r),c=Ih(t);m.useEffect(()=>{const d=i.current,f=window.HTMLInputElement.prototype,p=Object.getOwnPropertyDescriptor(f,"checked").set;if(o!==r&&p){const v=new Event("click",{bubbles:n});d.indeterminate=Ms(r),p.call(d,Ms(r)?!1:r),d.dispatchEvent(v)}},[o,r,n]);const u=m.useRef(Ms(r)?!1:r);return l.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:s??u.current,...a,tabIndex:-1,ref:i,style:{...e.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function Ms(e){return e==="indeterminate"}function D1(e){return Ms(e)?"indeterminate":e?"checked":"unchecked"}var j1=P1,uD=N1;const Lr=m.forwardRef(({className:e,...t},r)=>l.jsx(j1,{ref:r,className:Pe("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:l.jsx(uD,{className:Pe("flex items-center justify-center text-current"),children:l.jsx(pr,{className:"h-4 w-4"})})}));Lr.displayName=j1.displayName;const dD=bu("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Pa({className:e,variant:t,...r}){return l.jsx("div",{className:Pe(dD({variant:t}),e),...r})}function fD(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return m.useMemo(()=>n=>{t.forEach(s=>s(n))},t)}const Ju=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Ji(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function s0(e){return"nodeType"in e}function Ar(e){var t,r;return e?Ji(e)?e:s0(e)&&(t=(r=e.ownerDocument)==null?void 0:r.defaultView)!=null?t:window:window}function a0(e){const{Document:t}=Ar(e);return e instanceof t}function Dl(e){return Ji(e)?!1:e instanceof Ar(e).HTMLElement}function R1(e){return e instanceof Ar(e).SVGElement}function Qi(e){return e?Ji(e)?e.document:s0(e)?a0(e)?e:Dl(e)||R1(e)?e.ownerDocument:document:document:document}const Wn=Ju?m.useLayoutEffect:m.useEffect;function i0(e){const t=m.useRef(e);return Wn(()=>{t.current=e}),m.useCallback(function(){for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return t.current==null?void 0:t.current(...n)},[])}function hD(){const e=m.useRef(null),t=m.useCallback((n,s)=>{e.current=setInterval(n,s)},[]),r=m.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,r]}function Jo(e,t){t===void 0&&(t=[e]);const r=m.useRef(e);return Wn(()=>{r.current!==e&&(r.current=e)},t),r}function jl(e,t){const r=m.useRef();return m.useMemo(()=>{const n=e(r.current);return r.current=n,n},[...t])}function Hc(e){const t=i0(e),r=m.useRef(null),n=m.useCallback(s=>{s!==r.current&&(t==null||t(s,r.current)),r.current=s},[]);return[r,n]}function zf(e){const t=m.useRef();return m.useEffect(()=>{t.current=e},[e]),t.current}let Xd={};function Rl(e,t){return m.useMemo(()=>{if(t)return t;const r=Xd[e]==null?0:Xd[e]+1;return Xd[e]=r,e+"-"+r},[e,t])}function O1(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];return n.reduce((a,i)=>{const o=Object.entries(i);for(const[c,u]of o){const d=a[c];d!=null&&(a[c]=d+e*u)}return a},{...t})}}const gi=O1(1),Qo=O1(-1);function mD(e){return"clientX"in e&&"clientY"in e}function o0(e){if(!e)return!1;const{KeyboardEvent:t}=Ar(e.target);return t&&e instanceof t}function pD(e){if(!e)return!1;const{TouchEvent:t}=Ar(e.target);return t&&e instanceof t}function Gf(e){if(pD(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:r}=e.touches[0];return{x:t,y:r}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:r}=e.changedTouches[0];return{x:t,y:r}}}return mD(e)?{x:e.clientX,y:e.clientY}:null}const Li=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:r}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:r}=e;return"scaleX("+t+") scaleY("+r+")"}},Transform:{toString(e){if(e)return[Li.Translate.toString(e),Li.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:r,easing:n}=e;return t+" "+r+"ms "+n}}}),rp="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function gD(e){return e.matches(rp)?e:e.querySelector(rp)}const xD={display:"none"};function vD(e){let{id:t,value:r}=e;return me.createElement("div",{id:t,style:xD},r)}function yD(e){let{id:t,announcement:r,ariaLiveType:n="assertive"}=e;const s={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return me.createElement("div",{id:t,style:s,role:"status","aria-live":n,"aria-atomic":!0},r)}function wD(){const[e,t]=m.useState("");return{announce:m.useCallback(n=>{n!=null&&t(n)},[]),announcement:e}}const I1=m.createContext(null);function _D(e){const t=m.useContext(I1);m.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function bD(){const[e]=m.useState(()=>new Set),t=m.useCallback(n=>(e.add(n),()=>e.delete(n)),[e]);return[m.useCallback(n=>{let{type:s,event:a}=n;e.forEach(i=>{var o;return(o=i[s])==null?void 0:o.call(i,a)})},[e]),t]}const SD={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},ED={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was moved over droppable area "+r.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was dropped over droppable area "+r.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function TD(e){let{announcements:t=ED,container:r,hiddenTextDescribedById:n,screenReaderInstructions:s=SD}=e;const{announce:a,announcement:i}=wD(),o=Rl("DndLiveRegion"),[c,u]=m.useState(!1);if(m.useEffect(()=>{u(!0)},[]),_D(m.useMemo(()=>({onDragStart(f){let{active:h}=f;a(t.onDragStart({active:h}))},onDragMove(f){let{active:h,over:p}=f;t.onDragMove&&a(t.onDragMove({active:h,over:p}))},onDragOver(f){let{active:h,over:p}=f;a(t.onDragOver({active:h,over:p}))},onDragEnd(f){let{active:h,over:p}=f;a(t.onDragEnd({active:h,over:p}))},onDragCancel(f){let{active:h,over:p}=f;a(t.onDragCancel({active:h,over:p}))}}),[a,t])),!c)return null;const d=me.createElement(me.Fragment,null,me.createElement(vD,{id:n,value:s.draggable}),me.createElement(yD,{id:o,announcement:i}));return r?Vr.createPortal(d,r):d}var Bt;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(Bt||(Bt={}));function zc(){}function Gc(e,t){return m.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function M1(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return m.useMemo(()=>[...t].filter(n=>n!=null),[...t])}const _n=Object.freeze({x:0,y:0});function F1(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function L1(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return r-n}function CD(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return n-r}function np(e){let{left:t,top:r,height:n,width:s}=e;return[{x:t,y:r},{x:t+s,y:r},{x:t,y:r+n},{x:t+s,y:r+n}]}function B1(e,t){if(!e||e.length===0)return null;const[r]=e;return r[t]}function sp(e,t,r){return t===void 0&&(t=e.left),r===void 0&&(r=e.top),{x:t+e.width*.5,y:r+e.height*.5}}const $1=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const s=sp(t,t.left,t.top),a=[];for(const i of n){const{id:o}=i,c=r.get(o);if(c){const u=F1(sp(c),s);a.push({id:o,data:{droppableContainer:i,value:u}})}}return a.sort(L1)},kD=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const s=np(t),a=[];for(const i of n){const{id:o}=i,c=r.get(o);if(c){const u=np(c),d=s.reduce((h,p,v)=>h+F1(u[v],p),0),f=Number((d/4).toFixed(4));a.push({id:o,data:{droppableContainer:i,value:f}})}}return a.sort(L1)};function PD(e,t){const r=Math.max(t.top,e.top),n=Math.max(t.left,e.left),s=Math.min(t.left+t.width,e.left+e.width),a=Math.min(t.top+t.height,e.top+e.height),i=s-n,o=a-r;if(n<s&&r<a){const c=t.width*t.height,u=e.width*e.height,d=i*o,f=d/(c+u-d);return Number(f.toFixed(4))}return 0}const AD=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const s=[];for(const a of n){const{id:i}=a,o=r.get(i);if(o){const c=PD(o,t);c>0&&s.push({id:i,data:{droppableContainer:a,value:c}})}}return s.sort(CD)};function ND(e,t,r){return{...e,scaleX:t&&r?t.width/r.width:1,scaleY:t&&r?t.height/r.height:1}}function W1(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:_n}function DD(e){return function(r){for(var n=arguments.length,s=new Array(n>1?n-1:0),a=1;a<n;a++)s[a-1]=arguments[a];return s.reduce((i,o)=>({...i,top:i.top+e*o.y,bottom:i.bottom+e*o.y,left:i.left+e*o.x,right:i.right+e*o.x}),{...r})}}const jD=DD(1);function RD(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function OD(e,t,r){const n=RD(t);if(!n)return e;const{scaleX:s,scaleY:a,x:i,y:o}=n,c=e.left-i-(1-s)*parseFloat(r),u=e.top-o-(1-a)*parseFloat(r.slice(r.indexOf(" ")+1)),d=s?e.width/s:e.width,f=a?e.height/a:e.height;return{width:d,height:f,top:u,right:c+d,bottom:u+f,left:c}}const ID={ignoreTransform:!1};function Zi(e,t){t===void 0&&(t=ID);let r=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:u,transformOrigin:d}=Ar(e).getComputedStyle(e);u&&(r=OD(r,u,d))}const{top:n,left:s,width:a,height:i,bottom:o,right:c}=r;return{top:n,left:s,width:a,height:i,bottom:o,right:c}}function ap(e){return Zi(e,{ignoreTransform:!0})}function MD(e){const t=e.innerWidth,r=e.innerHeight;return{top:0,left:0,right:t,bottom:r,width:t,height:r}}function FD(e,t){return t===void 0&&(t=Ar(e).getComputedStyle(e)),t.position==="fixed"}function LD(e,t){t===void 0&&(t=Ar(e).getComputedStyle(e));const r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(s=>{const a=t[s];return typeof a=="string"?r.test(a):!1})}function Qu(e,t){const r=[];function n(s){if(t!=null&&r.length>=t||!s)return r;if(a0(s)&&s.scrollingElement!=null&&!r.includes(s.scrollingElement))return r.push(s.scrollingElement),r;if(!Dl(s)||R1(s)||r.includes(s))return r;const a=Ar(e).getComputedStyle(s);return s!==e&&LD(s,a)&&r.push(s),FD(s,a)?r:n(s.parentNode)}return e?n(e):r}function U1(e){const[t]=Qu(e,1);return t??null}function qd(e){return!Ju||!e?null:Ji(e)?e:s0(e)?a0(e)||e===Qi(e).scrollingElement?window:Dl(e)?e:null:null}function V1(e){return Ji(e)?e.scrollX:e.scrollLeft}function H1(e){return Ji(e)?e.scrollY:e.scrollTop}function Kf(e){return{x:V1(e),y:H1(e)}}var zt;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(zt||(zt={}));function z1(e){return!Ju||!e?!1:e===document.scrollingElement}function G1(e){const t={x:0,y:0},r=z1(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},n={x:e.scrollWidth-r.width,y:e.scrollHeight-r.height},s=e.scrollTop<=t.y,a=e.scrollLeft<=t.x,i=e.scrollTop>=n.y,o=e.scrollLeft>=n.x;return{isTop:s,isLeft:a,isBottom:i,isRight:o,maxScroll:n,minScroll:t}}const BD={x:.2,y:.2};function $D(e,t,r,n,s){let{top:a,left:i,right:o,bottom:c}=r;n===void 0&&(n=10),s===void 0&&(s=BD);const{isTop:u,isBottom:d,isLeft:f,isRight:h}=G1(e),p={x:0,y:0},v={x:0,y:0},g={height:t.height*s.y,width:t.width*s.x};return!u&&a<=t.top+g.height?(p.y=zt.Backward,v.y=n*Math.abs((t.top+g.height-a)/g.height)):!d&&c>=t.bottom-g.height&&(p.y=zt.Forward,v.y=n*Math.abs((t.bottom-g.height-c)/g.height)),!h&&o>=t.right-g.width?(p.x=zt.Forward,v.x=n*Math.abs((t.right-g.width-o)/g.width)):!f&&i<=t.left+g.width&&(p.x=zt.Backward,v.x=n*Math.abs((t.left+g.width-i)/g.width)),{direction:p,speed:v}}function WD(e){if(e===document.scrollingElement){const{innerWidth:a,innerHeight:i}=window;return{top:0,left:0,right:a,bottom:i,width:a,height:i}}const{top:t,left:r,right:n,bottom:s}=e.getBoundingClientRect();return{top:t,left:r,right:n,bottom:s,width:e.clientWidth,height:e.clientHeight}}function K1(e){return e.reduce((t,r)=>gi(t,Kf(r)),_n)}function UD(e){return e.reduce((t,r)=>t+V1(r),0)}function VD(e){return e.reduce((t,r)=>t+H1(r),0)}function HD(e,t){if(t===void 0&&(t=Zi),!e)return;const{top:r,left:n,bottom:s,right:a}=t(e);U1(e)&&(s<=0||a<=0||r>=window.innerHeight||n>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const zD=[["x",["left","right"],UD],["y",["top","bottom"],VD]];class l0{constructor(t,r){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=Qu(r),s=K1(n);this.rect={...t},this.width=t.width,this.height=t.height;for(const[a,i,o]of zD)for(const c of i)Object.defineProperty(this,c,{get:()=>{const u=o(n),d=s[a]-u;return this.rect[c]+d},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Do{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(r=>{var n;return(n=this.target)==null?void 0:n.removeEventListener(...r)})},this.target=t}add(t,r,n){var s;(s=this.target)==null||s.addEventListener(t,r,n),this.listeners.push([t,r,n])}}function GD(e){const{EventTarget:t}=Ar(e);return e instanceof t?e:Qi(e)}function Jd(e,t){const r=Math.abs(e.x),n=Math.abs(e.y);return typeof t=="number"?Math.sqrt(r**2+n**2)>t:"x"in t&&"y"in t?r>t.x&&n>t.y:"x"in t?r>t.x:"y"in t?n>t.y:!1}var Qr;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(Qr||(Qr={}));function ip(e){e.preventDefault()}function KD(e){e.stopPropagation()}var Qe;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(Qe||(Qe={}));const Y1={start:[Qe.Space,Qe.Enter],cancel:[Qe.Esc],end:[Qe.Space,Qe.Enter,Qe.Tab]},YD=(e,t)=>{let{currentCoordinates:r}=t;switch(e.code){case Qe.Right:return{...r,x:r.x+25};case Qe.Left:return{...r,x:r.x-25};case Qe.Down:return{...r,y:r.y+25};case Qe.Up:return{...r,y:r.y-25}}};class Zu{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:r}}=t;this.props=t,this.listeners=new Do(Qi(r)),this.windowListeners=new Do(Ar(r)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Qr.Resize,this.handleCancel),this.windowListeners.add(Qr.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Qr.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:r}=this.props,n=t.node.current;n&&HD(n),r(_n)}handleKeyDown(t){if(o0(t)){const{active:r,context:n,options:s}=this.props,{keyboardCodes:a=Y1,coordinateGetter:i=YD,scrollBehavior:o="smooth"}=s,{code:c}=t;if(a.end.includes(c)){this.handleEnd(t);return}if(a.cancel.includes(c)){this.handleCancel(t);return}const{collisionRect:u}=n.current,d=u?{x:u.left,y:u.top}:_n;this.referenceCoordinates||(this.referenceCoordinates=d);const f=i(t,{active:r,context:n.current,currentCoordinates:d});if(f){const h=Qo(f,d),p={x:0,y:0},{scrollableAncestors:v}=n.current;for(const g of v){const x=t.code,{isTop:y,isRight:w,isLeft:_,isBottom:b,maxScroll:T,minScroll:k}=G1(g),S=WD(g),E={x:Math.min(x===Qe.Right?S.right-S.width/2:S.right,Math.max(x===Qe.Right?S.left:S.left+S.width/2,f.x)),y:Math.min(x===Qe.Down?S.bottom-S.height/2:S.bottom,Math.max(x===Qe.Down?S.top:S.top+S.height/2,f.y))},C=x===Qe.Right&&!w||x===Qe.Left&&!_,L=x===Qe.Down&&!b||x===Qe.Up&&!y;if(C&&E.x!==f.x){const M=g.scrollLeft+h.x,j=x===Qe.Right&&M<=T.x||x===Qe.Left&&M>=k.x;if(j&&!h.y){g.scrollTo({left:M,behavior:o});return}j?p.x=g.scrollLeft-M:p.x=x===Qe.Right?g.scrollLeft-T.x:g.scrollLeft-k.x,p.x&&g.scrollBy({left:-p.x,behavior:o});break}else if(L&&E.y!==f.y){const M=g.scrollTop+h.y,j=x===Qe.Down&&M<=T.y||x===Qe.Up&&M>=k.y;if(j&&!h.x){g.scrollTo({top:M,behavior:o});return}j?p.y=g.scrollTop-M:p.y=x===Qe.Down?g.scrollTop-T.y:g.scrollTop-k.y,p.y&&g.scrollBy({top:-p.y,behavior:o});break}}this.handleMove(t,gi(Qo(f,this.referenceCoordinates),p))}}}handleMove(t,r){const{onMove:n}=this.props;t.preventDefault(),n(r)}handleEnd(t){const{onEnd:r}=this.props;t.preventDefault(),this.detach(),r()}handleCancel(t){const{onCancel:r}=this.props;t.preventDefault(),this.detach(),r()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}Zu.activators=[{eventName:"onKeyDown",handler:(e,t,r)=>{let{keyboardCodes:n=Y1,onActivation:s}=t,{active:a}=r;const{code:i}=e.nativeEvent;if(n.start.includes(i)){const o=a.activatorNode.current;return o&&e.target!==o?!1:(e.preventDefault(),s==null||s({event:e.nativeEvent}),!0)}return!1}}];function op(e){return!!(e&&"distance"in e)}function lp(e){return!!(e&&"delay"in e)}class c0{constructor(t,r,n){var s;n===void 0&&(n=GD(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=r;const{event:a}=t,{target:i}=a;this.props=t,this.events=r,this.document=Qi(i),this.documentListeners=new Do(this.document),this.listeners=new Do(n),this.windowListeners=new Do(Ar(i)),this.initialCoordinates=(s=Gf(a))!=null?s:_n,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:r,bypassActivationConstraint:n}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(Qr.Resize,this.handleCancel),this.windowListeners.add(Qr.DragStart,ip),this.windowListeners.add(Qr.VisibilityChange,this.handleCancel),this.windowListeners.add(Qr.ContextMenu,ip),this.documentListeners.add(Qr.Keydown,this.handleKeydown),r){if(n!=null&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(lp(r)){this.timeoutId=setTimeout(this.handleStart,r.delay),this.handlePending(r);return}if(op(r)){this.handlePending(r);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,r){const{active:n,onPending:s}=this.props;s(n,t,this.initialCoordinates,r)}handleStart(){const{initialCoordinates:t}=this,{onStart:r}=this.props;t&&(this.activated=!0,this.documentListeners.add(Qr.Click,KD,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Qr.SelectionChange,this.removeTextSelection),r(t))}handleMove(t){var r;const{activated:n,initialCoordinates:s,props:a}=this,{onMove:i,options:{activationConstraint:o}}=a;if(!s)return;const c=(r=Gf(t))!=null?r:_n,u=Qo(s,c);if(!n&&o){if(op(o)){if(o.tolerance!=null&&Jd(u,o.tolerance))return this.handleCancel();if(Jd(u,o.distance))return this.handleStart()}if(lp(o)&&Jd(u,o.tolerance))return this.handleCancel();this.handlePending(o,u);return}t.cancelable&&t.preventDefault(),i(c)}handleEnd(){const{onAbort:t,onEnd:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleCancel(){const{onAbort:t,onCancel:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleKeydown(t){t.code===Qe.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const XD={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class ed extends c0{constructor(t){const{event:r}=t,n=Qi(r.target);super(t,XD,n)}}ed.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return!r.isPrimary||r.button!==0?!1:(n==null||n({event:r}),!0)}}];const qD={move:{name:"mousemove"},end:{name:"mouseup"}};var Yf;(function(e){e[e.RightClick=2]="RightClick"})(Yf||(Yf={}));class JD extends c0{constructor(t){super(t,qD,Qi(t.event.target))}}JD.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return r.button===Yf.RightClick?!1:(n==null||n({event:r}),!0)}}];const Qd={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class QD extends c0{constructor(t){super(t,Qd)}static setup(){return window.addEventListener(Qd.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(Qd.move.name,t)};function t(){}}}QD.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;const{touches:s}=r;return s.length>1?!1:(n==null||n({event:r}),!0)}}];var jo;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(jo||(jo={}));var Kc;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(Kc||(Kc={}));function ZD(e){let{acceleration:t,activator:r=jo.Pointer,canScroll:n,draggingRect:s,enabled:a,interval:i=5,order:o=Kc.TreeOrder,pointerCoordinates:c,scrollableAncestors:u,scrollableAncestorRects:d,delta:f,threshold:h}=e;const p=tj({delta:f,disabled:!a}),[v,g]=hD(),x=m.useRef({x:0,y:0}),y=m.useRef({x:0,y:0}),w=m.useMemo(()=>{switch(r){case jo.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case jo.DraggableRect:return s}},[r,s,c]),_=m.useRef(null),b=m.useCallback(()=>{const k=_.current;if(!k)return;const S=x.current.x*y.current.x,E=x.current.y*y.current.y;k.scrollBy(S,E)},[]),T=m.useMemo(()=>o===Kc.TreeOrder?[...u].reverse():u,[o,u]);m.useEffect(()=>{if(!a||!u.length||!w){g();return}for(const k of T){if((n==null?void 0:n(k))===!1)continue;const S=u.indexOf(k),E=d[S];if(!E)continue;const{direction:C,speed:L}=$D(k,E,w,t,h);for(const M of["x","y"])p[M][C[M]]||(L[M]=0,C[M]=0);if(L.x>0||L.y>0){g(),_.current=k,v(b,i),x.current=L,y.current=C;return}}x.current={x:0,y:0},y.current={x:0,y:0},g()},[t,b,n,g,a,i,JSON.stringify(w),JSON.stringify(p),v,u,T,d,JSON.stringify(h)])}const ej={x:{[zt.Backward]:!1,[zt.Forward]:!1},y:{[zt.Backward]:!1,[zt.Forward]:!1}};function tj(e){let{delta:t,disabled:r}=e;const n=zf(t);return jl(s=>{if(r||!n||!s)return ej;const a={x:Math.sign(t.x-n.x),y:Math.sign(t.y-n.y)};return{x:{[zt.Backward]:s.x[zt.Backward]||a.x===-1,[zt.Forward]:s.x[zt.Forward]||a.x===1},y:{[zt.Backward]:s.y[zt.Backward]||a.y===-1,[zt.Forward]:s.y[zt.Forward]||a.y===1}}},[r,t,n])}function rj(e,t){const r=t!=null?e.get(t):void 0,n=r?r.node.current:null;return jl(s=>{var a;return t==null?null:(a=n??s)!=null?a:null},[n,t])}function nj(e,t){return m.useMemo(()=>e.reduce((r,n)=>{const{sensor:s}=n,a=s.activators.map(i=>({eventName:i.eventName,handler:t(i.handler,n)}));return[...r,...a]},[]),[e,t])}var Zo;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(Zo||(Zo={}));var Xf;(function(e){e.Optimized="optimized"})(Xf||(Xf={}));const cp=new Map;function sj(e,t){let{dragging:r,dependencies:n,config:s}=t;const[a,i]=m.useState(null),{frequency:o,measure:c,strategy:u}=s,d=m.useRef(e),f=x(),h=Jo(f),p=m.useCallback(function(y){y===void 0&&(y=[]),!h.current&&i(w=>w===null?y:w.concat(y.filter(_=>!w.includes(_))))},[h]),v=m.useRef(null),g=jl(y=>{if(f&&!r)return cp;if(!y||y===cp||d.current!==e||a!=null){const w=new Map;for(let _ of e){if(!_)continue;if(a&&a.length>0&&!a.includes(_.id)&&_.rect.current){w.set(_.id,_.rect.current);continue}const b=_.node.current,T=b?new l0(c(b),b):null;_.rect.current=T,T&&w.set(_.id,T)}return w}return y},[e,a,r,f,c]);return m.useEffect(()=>{d.current=e},[e]),m.useEffect(()=>{f||p()},[r,f]),m.useEffect(()=>{a&&a.length>0&&i(null)},[JSON.stringify(a)]),m.useEffect(()=>{f||typeof o!="number"||v.current!==null||(v.current=setTimeout(()=>{p(),v.current=null},o))},[o,f,p,...n]),{droppableRects:g,measureDroppableContainers:p,measuringScheduled:a!=null};function x(){switch(u){case Zo.Always:return!1;case Zo.BeforeDragging:return r;default:return!r}}}function X1(e,t){return jl(r=>e?r||(typeof t=="function"?t(e):e):null,[t,e])}function aj(e,t){return X1(e,t)}function ij(e){let{callback:t,disabled:r}=e;const n=i0(t),s=m.useMemo(()=>{if(r||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:a}=window;return new a(n)},[n,r]);return m.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function td(e){let{callback:t,disabled:r}=e;const n=i0(t),s=m.useMemo(()=>{if(r||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:a}=window;return new a(n)},[r]);return m.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function oj(e){return new l0(Zi(e),e)}function up(e,t,r){t===void 0&&(t=oj);const[n,s]=m.useState(null);function a(){s(c=>{if(!e)return null;if(e.isConnected===!1){var u;return(u=c??r)!=null?u:null}const d=t(e);return JSON.stringify(c)===JSON.stringify(d)?c:d})}const i=ij({callback(c){if(e)for(const u of c){const{type:d,target:f}=u;if(d==="childList"&&f instanceof HTMLElement&&f.contains(e)){a();break}}}}),o=td({callback:a});return Wn(()=>{a(),e?(o==null||o.observe(e),i==null||i.observe(document.body,{childList:!0,subtree:!0})):(o==null||o.disconnect(),i==null||i.disconnect())},[e]),n}function lj(e){const t=X1(e);return W1(e,t)}const dp=[];function cj(e){const t=m.useRef(e),r=jl(n=>e?n&&n!==dp&&e&&t.current&&e.parentNode===t.current.parentNode?n:Qu(e):dp,[e]);return m.useEffect(()=>{t.current=e},[e]),r}function uj(e){const[t,r]=m.useState(null),n=m.useRef(e),s=m.useCallback(a=>{const i=qd(a.target);i&&r(o=>o?(o.set(i,Kf(i)),new Map(o)):null)},[]);return m.useEffect(()=>{const a=n.current;if(e!==a){i(a);const o=e.map(c=>{const u=qd(c);return u?(u.addEventListener("scroll",s,{passive:!0}),[u,Kf(u)]):null}).filter(c=>c!=null);r(o.length?new Map(o):null),n.current=e}return()=>{i(e),i(a)};function i(o){o.forEach(c=>{const u=qd(c);u==null||u.removeEventListener("scroll",s)})}},[s,e]),m.useMemo(()=>e.length?t?Array.from(t.values()).reduce((a,i)=>gi(a,i),_n):K1(e):_n,[e,t])}function fp(e,t){t===void 0&&(t=[]);const r=m.useRef(null);return m.useEffect(()=>{r.current=null},t),m.useEffect(()=>{const n=e!==_n;n&&!r.current&&(r.current=e),!n&&r.current&&(r.current=null)},[e]),r.current?Qo(e,r.current):_n}function dj(e){m.useEffect(()=>{if(!Ju)return;const t=e.map(r=>{let{sensor:n}=r;return n.setup==null?void 0:n.setup()});return()=>{for(const r of t)r==null||r()}},e.map(t=>{let{sensor:r}=t;return r}))}function fj(e,t){return m.useMemo(()=>e.reduce((r,n)=>{let{eventName:s,handler:a}=n;return r[s]=i=>{a(i,t)},r},{}),[e,t])}function q1(e){return m.useMemo(()=>e?MD(e):null,[e])}const hp=[];function hj(e,t){t===void 0&&(t=Zi);const[r]=e,n=q1(r?Ar(r):null),[s,a]=m.useState(hp);function i(){a(()=>e.length?e.map(c=>z1(c)?n:new l0(t(c),c)):hp)}const o=td({callback:i});return Wn(()=>{o==null||o.disconnect(),i(),e.forEach(c=>o==null?void 0:o.observe(c))},[e]),s}function mj(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Dl(t)?t:e}function pj(e){let{measure:t}=e;const[r,n]=m.useState(null),s=m.useCallback(u=>{for(const{target:d}of u)if(Dl(d)){n(f=>{const h=t(d);return f?{...f,width:h.width,height:h.height}:h});break}},[t]),a=td({callback:s}),i=m.useCallback(u=>{const d=mj(u);a==null||a.disconnect(),d&&(a==null||a.observe(d)),n(d?t(d):null)},[t,a]),[o,c]=Hc(i);return m.useMemo(()=>({nodeRef:o,rect:r,setRef:c}),[r,o,c])}const gj=[{sensor:ed,options:{}},{sensor:Zu,options:{}}],xj={current:{}},Pc={draggable:{measure:ap},droppable:{measure:ap,strategy:Zo.WhileDragging,frequency:Xf.Optimized},dragOverlay:{measure:Zi}};class Ro extends Map{get(t){var r;return t!=null&&(r=super.get(t))!=null?r:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:r}=t;return!r})}getNodeFor(t){var r,n;return(r=(n=this.get(t))==null?void 0:n.node.current)!=null?r:void 0}}const vj={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Ro,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:zc},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Pc,measureDroppableContainers:zc,windowRect:null,measuringScheduled:!1},yj={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:zc,draggableNodes:new Map,over:null,measureDroppableContainers:zc},rd=m.createContext(yj),J1=m.createContext(vj);function wj(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Ro}}}function _j(e,t){switch(t.type){case Bt.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case Bt.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case Bt.DragEnd:case Bt.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Bt.RegisterDroppable:{const{element:r}=t,{id:n}=r,s=new Ro(e.droppable.containers);return s.set(n,r),{...e,droppable:{...e.droppable,containers:s}}}case Bt.SetDroppableDisabled:{const{id:r,key:n,disabled:s}=t,a=e.droppable.containers.get(r);if(!a||n!==a.key)return e;const i=new Ro(e.droppable.containers);return i.set(r,{...a,disabled:s}),{...e,droppable:{...e.droppable,containers:i}}}case Bt.UnregisterDroppable:{const{id:r,key:n}=t,s=e.droppable.containers.get(r);if(!s||n!==s.key)return e;const a=new Ro(e.droppable.containers);return a.delete(r),{...e,droppable:{...e.droppable,containers:a}}}default:return e}}function bj(e){let{disabled:t}=e;const{active:r,activatorEvent:n,draggableNodes:s}=m.useContext(rd),a=zf(n),i=zf(r==null?void 0:r.id);return m.useEffect(()=>{if(!t&&!n&&a&&i!=null){if(!o0(a)||document.activeElement===a.target)return;const o=s.get(i);if(!o)return;const{activatorNode:c,node:u}=o;if(!c.current&&!u.current)return;requestAnimationFrame(()=>{for(const d of[c.current,u.current]){if(!d)continue;const f=gD(d);if(f){f.focus();break}}})}},[n,t,s,i,a]),null}function Sj(e,t){let{transform:r,...n}=t;return e!=null&&e.length?e.reduce((s,a)=>a({transform:s,...n}),r):r}function Ej(e){return m.useMemo(()=>({draggable:{...Pc.draggable,...e==null?void 0:e.draggable},droppable:{...Pc.droppable,...e==null?void 0:e.droppable},dragOverlay:{...Pc.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function Tj(e){let{activeNode:t,measure:r,initialRect:n,config:s=!0}=e;const a=m.useRef(!1),{x:i,y:o}=typeof s=="boolean"?{x:s,y:s}:s;Wn(()=>{if(!i&&!o||!t){a.current=!1;return}if(a.current||!n)return;const u=t==null?void 0:t.node.current;if(!u||u.isConnected===!1)return;const d=r(u),f=W1(d,n);if(i||(f.x=0),o||(f.y=0),a.current=!0,Math.abs(f.x)>0||Math.abs(f.y)>0){const h=U1(u);h&&h.scrollBy({top:f.y,left:f.x})}},[t,i,o,n,r])}const Q1=m.createContext({..._n,scaleX:1,scaleY:1});var Ts;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Ts||(Ts={}));const Z1=m.memo(function(t){var r,n,s,a;let{id:i,accessibility:o,autoScroll:c=!0,children:u,sensors:d=gj,collisionDetection:f=AD,measuring:h,modifiers:p,...v}=t;const g=m.useReducer(_j,void 0,wj),[x,y]=g,[w,_]=bD(),[b,T]=m.useState(Ts.Uninitialized),k=b===Ts.Initialized,{draggable:{active:S,nodes:E,translate:C},droppable:{containers:L}}=x,M=S!=null?E.get(S):null,j=m.useRef({initial:null,translated:null}),V=m.useMemo(()=>{var ut;return S!=null?{id:S,data:(ut=M==null?void 0:M.data)!=null?ut:xj,rect:j}:null},[S,M]),A=m.useRef(null),[H,G]=m.useState(null),[q,Y]=m.useState(null),Q=Jo(v,Object.values(v)),fe=Rl("DndDescribedBy",i),oe=m.useMemo(()=>L.getEnabled(),[L]),X=Ej(h),{droppableRects:le,measureDroppableContainers:D,measuringScheduled:K}=sj(oe,{dragging:k,dependencies:[C.x,C.y],config:X.droppable}),U=rj(E,S),I=m.useMemo(()=>q?Gf(q):null,[q]),ee=_r(),z=aj(U,X.draggable.measure);Tj({activeNode:S!=null?E.get(S):null,config:ee.layoutShiftCompensation,initialRect:z,measure:X.draggable.measure});const R=up(U,X.draggable.measure,z),J=up(U?U.parentElement:null),Z=m.useRef({activatorEvent:null,active:null,activeNode:U,collisionRect:null,collisions:null,droppableRects:le,draggableNodes:E,draggingNode:null,draggingNodeRect:null,droppableContainers:L,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),ge=L.getNodeFor((r=Z.current.over)==null?void 0:r.id),ye=pj({measure:X.dragOverlay.measure}),Ce=(n=ye.nodeRef.current)!=null?n:U,Ie=k?(s=ye.rect)!=null?s:R:null,st=!!(ye.nodeRef.current&&ye.rect),Se=lj(st?null:R),Le=q1(Ce?Ar(Ce):null),de=cj(k?ge??U:null),Fe=hj(de),at=Sj(p,{transform:{x:C.x-Se.x,y:C.y-Se.y,scaleX:1,scaleY:1},activatorEvent:q,active:V,activeNodeRect:R,containerNodeRect:J,draggingNodeRect:Ie,over:Z.current.over,overlayNodeRect:ye.rect,scrollableAncestors:de,scrollableAncestorRects:Fe,windowRect:Le}),ke=I?gi(I,C):null,je=uj(de),ht=fp(je),At=fp(je,[R]),Ze=gi(at,ht),ct=Ie?jD(Ie,at):null,tr=V&&ct?f({active:V,collisionRect:ct,droppableRects:le,droppableContainers:oe,pointerCoordinates:ke}):null,Gr=B1(tr,"id"),[Yt,Dr]=m.useState(null),aa=st?at:gi(at,At),Xa=ND(aa,(a=Yt==null?void 0:Yt.rect)!=null?a:null,R),Tn=m.useRef(null),jr=m.useCallback((ut,bt)=>{let{sensor:Xt,options:Cn}=bt;if(A.current==null)return;const br=E.get(A.current);if(!br)return;const or=ut.nativeEvent,Kr=new Xt({active:A.current,activeNode:br,event:or,options:Cn,context:Z,onAbort(Mt){if(!E.get(Mt))return;const{onDragAbort:Sr}=Q.current,ln={id:Mt};Sr==null||Sr(ln),w({type:"onDragAbort",event:ln})},onPending(Mt,kn,Sr,ln){if(!E.get(Mt))return;const{onDragPending:oa}=Q.current,P={id:Mt,constraint:kn,initialCoordinates:Sr,offset:ln};oa==null||oa(P),w({type:"onDragPending",event:P})},onStart(Mt){const kn=A.current;if(kn==null)return;const Sr=E.get(kn);if(!Sr)return;const{onDragStart:ln}=Q.current,ia={activatorEvent:or,active:{id:kn,data:Sr.data,rect:j}};Vr.unstable_batchedUpdates(()=>{ln==null||ln(ia),T(Ts.Initializing),y({type:Bt.DragStart,initialCoordinates:Mt,active:kn}),w({type:"onDragStart",event:ia}),G(Tn.current),Y(or)})},onMove(Mt){y({type:Bt.DragMove,coordinates:Mt})},onEnd:ps(Bt.DragEnd),onCancel:ps(Bt.DragCancel)});Tn.current=Kr;function ps(Mt){return async function(){const{active:Sr,collisions:ln,over:ia,scrollAdjustedTranslate:oa}=Z.current;let P=null;if(Sr&&oa){const{cancelDrop:F}=Q.current;P={activatorEvent:or,active:Sr,collisions:ln,delta:oa,over:ia},Mt===Bt.DragEnd&&typeof F=="function"&&await Promise.resolve(F(P))&&(Mt=Bt.DragCancel)}A.current=null,Vr.unstable_batchedUpdates(()=>{y({type:Mt}),T(Ts.Uninitialized),Dr(null),G(null),Y(null),Tn.current=null;const F=Mt===Bt.DragEnd?"onDragEnd":"onDragCancel";if(P){const N=Q.current[F];N==null||N(P),w({type:F,event:P})}})}}},[E]),oo=m.useCallback((ut,bt)=>(Xt,Cn)=>{const br=Xt.nativeEvent,or=E.get(Cn);if(A.current!==null||!or||br.dndKit||br.defaultPrevented)return;const Kr={active:or};ut(Xt,bt.options,Kr)===!0&&(br.dndKit={capturedBy:bt.sensor},A.current=Cn,jr(Xt,bt))},[E,jr]),Oe=nj(d,oo);dj(d),Wn(()=>{R&&b===Ts.Initializing&&T(Ts.Initialized)},[R,b]),m.useEffect(()=>{const{onDragMove:ut}=Q.current,{active:bt,activatorEvent:Xt,collisions:Cn,over:br}=Z.current;if(!bt||!Xt)return;const or={active:bt,activatorEvent:Xt,collisions:Cn,delta:{x:Ze.x,y:Ze.y},over:br};Vr.unstable_batchedUpdates(()=>{ut==null||ut(or),w({type:"onDragMove",event:or})})},[Ze.x,Ze.y]),m.useEffect(()=>{const{active:ut,activatorEvent:bt,collisions:Xt,droppableContainers:Cn,scrollAdjustedTranslate:br}=Z.current;if(!ut||A.current==null||!bt||!br)return;const{onDragOver:or}=Q.current,Kr=Cn.get(Gr),ps=Kr&&Kr.rect.current?{id:Kr.id,rect:Kr.rect.current,data:Kr.data,disabled:Kr.disabled}:null,Mt={active:ut,activatorEvent:bt,collisions:Xt,delta:{x:br.x,y:br.y},over:ps};Vr.unstable_batchedUpdates(()=>{Dr(ps),or==null||or(Mt),w({type:"onDragOver",event:Mt})})},[Gr]),Wn(()=>{Z.current={activatorEvent:q,active:V,activeNode:U,collisionRect:ct,collisions:tr,droppableRects:le,draggableNodes:E,draggingNode:Ce,draggingNodeRect:Ie,droppableContainers:L,over:Yt,scrollableAncestors:de,scrollAdjustedTranslate:Ze},j.current={initial:Ie,translated:ct}},[V,U,tr,ct,E,Ce,Ie,le,L,Yt,de,Ze]),ZD({...ee,delta:C,draggingRect:ct,pointerCoordinates:ke,scrollableAncestors:de,scrollableAncestorRects:Fe});const it=m.useMemo(()=>({active:V,activeNode:U,activeNodeRect:R,activatorEvent:q,collisions:tr,containerNodeRect:J,dragOverlay:ye,draggableNodes:E,droppableContainers:L,droppableRects:le,over:Yt,measureDroppableContainers:D,scrollableAncestors:de,scrollableAncestorRects:Fe,measuringConfiguration:X,measuringScheduled:K,windowRect:Le}),[V,U,R,q,tr,J,ye,E,L,le,Yt,D,de,Fe,X,K,Le]),nt=m.useMemo(()=>({activatorEvent:q,activators:Oe,active:V,activeNodeRect:R,ariaDescribedById:{draggable:fe},dispatch:y,draggableNodes:E,over:Yt,measureDroppableContainers:D}),[q,Oe,V,R,y,fe,E,Yt,D]);return me.createElement(I1.Provider,{value:_},me.createElement(rd.Provider,{value:nt},me.createElement(J1.Provider,{value:it},me.createElement(Q1.Provider,{value:Xa},u)),me.createElement(bj,{disabled:(o==null?void 0:o.restoreFocus)===!1})),me.createElement(TD,{...o,hiddenTextDescribedById:fe}));function _r(){const ut=(H==null?void 0:H.autoScrollEnabled)===!1,bt=typeof c=="object"?c.enabled===!1:c===!1,Xt=k&&!ut&&!bt;return typeof c=="object"?{...c,enabled:Xt}:{enabled:Xt}}}),Cj=m.createContext(null),mp="button",kj="Draggable";function Pj(e){let{id:t,data:r,disabled:n=!1,attributes:s}=e;const a=Rl(kj),{activators:i,activatorEvent:o,active:c,activeNodeRect:u,ariaDescribedById:d,draggableNodes:f,over:h}=m.useContext(rd),{role:p=mp,roleDescription:v="draggable",tabIndex:g=0}=s??{},x=(c==null?void 0:c.id)===t,y=m.useContext(x?Q1:Cj),[w,_]=Hc(),[b,T]=Hc(),k=fj(i,t),S=Jo(r);Wn(()=>(f.set(t,{id:t,key:a,node:w,activatorNode:b,data:S}),()=>{const C=f.get(t);C&&C.key===a&&f.delete(t)}),[f,t]);const E=m.useMemo(()=>({role:p,tabIndex:g,"aria-disabled":n,"aria-pressed":x&&p===mp?!0:void 0,"aria-roledescription":v,"aria-describedby":d.draggable}),[n,p,g,x,v,d.draggable]);return{active:c,activatorEvent:o,activeNodeRect:u,attributes:E,isDragging:x,listeners:n?void 0:k,node:w,over:h,setNodeRef:_,setActivatorNodeRef:T,transform:y}}function Aj(){return m.useContext(J1)}const Nj="Droppable",Dj={timeout:25};function jj(e){let{data:t,disabled:r=!1,id:n,resizeObserverConfig:s}=e;const a=Rl(Nj),{active:i,dispatch:o,over:c,measureDroppableContainers:u}=m.useContext(rd),d=m.useRef({disabled:r}),f=m.useRef(!1),h=m.useRef(null),p=m.useRef(null),{disabled:v,updateMeasurementsFor:g,timeout:x}={...Dj,...s},y=Jo(g??n),w=m.useCallback(()=>{if(!f.current){f.current=!0;return}p.current!=null&&clearTimeout(p.current),p.current=setTimeout(()=>{u(Array.isArray(y.current)?y.current:[y.current]),p.current=null},x)},[x]),_=td({callback:w,disabled:v||!i}),b=m.useCallback((E,C)=>{_&&(C&&(_.unobserve(C),f.current=!1),E&&_.observe(E))},[_]),[T,k]=Hc(b),S=Jo(t);return m.useEffect(()=>{!_||!T.current||(_.disconnect(),f.current=!1,_.observe(T.current))},[T,_]),m.useEffect(()=>(o({type:Bt.RegisterDroppable,element:{id:n,key:a,disabled:r,node:T,rect:h,data:S}}),()=>o({type:Bt.UnregisterDroppable,key:a,id:n})),[n]),m.useEffect(()=>{r!==d.current.disabled&&(o({type:Bt.SetDroppableDisabled,id:n,key:a,disabled:r}),d.current.disabled=r)},[n,a,r,o]),{active:i,rect:h,isOver:(c==null?void 0:c.id)===n,node:T,over:c,setNodeRef:k}}function nd(e,t,r){const n=e.slice();return n.splice(r<0?n.length+r:r,0,n.splice(t,1)[0]),n}function Rj(e,t){return e.reduce((r,n,s)=>{const a=t.get(n);return a&&(r[s]=a),r},Array(e.length))}function ic(e){return e!==null&&e>=0}function Oj(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function Ij(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const ey=e=>{let{rects:t,activeIndex:r,overIndex:n,index:s}=e;const a=nd(t,n,r),i=t[s],o=a[s];return!o||!i?null:{x:o.left-i.left,y:o.top-i.top,scaleX:o.width/i.width,scaleY:o.height/i.height}},oc={scaleX:1,scaleY:1},ty=e=>{var t;let{activeIndex:r,activeNodeRect:n,index:s,rects:a,overIndex:i}=e;const o=(t=a[r])!=null?t:n;if(!o)return null;if(s===r){const u=a[i];return u?{x:0,y:r<i?u.top+u.height-(o.top+o.height):u.top-o.top,...oc}:null}const c=Mj(a,s,r);return s>r&&s<=i?{x:0,y:-o.height-c,...oc}:s<r&&s>=i?{x:0,y:o.height+c,...oc}:{x:0,y:0,...oc}};function Mj(e,t,r){const n=e[t],s=e[t-1],a=e[t+1];return n?r<t?s?n.top-(s.top+s.height):a?a.top-(n.top+n.height):0:a?a.top-(n.top+n.height):s?n.top-(s.top+s.height):0:0}const ry="Sortable",ny=me.createContext({activeIndex:-1,containerId:ry,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:ey,disabled:{draggable:!1,droppable:!1}});function sy(e){let{children:t,id:r,items:n,strategy:s=ey,disabled:a=!1}=e;const{active:i,dragOverlay:o,droppableRects:c,over:u,measureDroppableContainers:d}=Aj(),f=Rl(ry,r),h=o.rect!==null,p=m.useMemo(()=>n.map(k=>typeof k=="object"&&"id"in k?k.id:k),[n]),v=i!=null,g=i?p.indexOf(i.id):-1,x=u?p.indexOf(u.id):-1,y=m.useRef(p),w=!Oj(p,y.current),_=x!==-1&&g===-1||w,b=Ij(a);Wn(()=>{w&&v&&d(p)},[w,p,v,d]),m.useEffect(()=>{y.current=p},[p]);const T=m.useMemo(()=>({activeIndex:g,containerId:f,disabled:b,disableTransforms:_,items:p,overIndex:x,useDragOverlay:h,sortedRects:Rj(p,c),strategy:s}),[g,f,b.draggable,b.droppable,_,p,x,c,h,s]);return me.createElement(ny.Provider,{value:T},t)}const Fj=e=>{let{id:t,items:r,activeIndex:n,overIndex:s}=e;return nd(r,n,s).indexOf(t)},Lj=e=>{let{containerId:t,isSorting:r,wasDragging:n,index:s,items:a,newIndex:i,previousItems:o,previousContainerId:c,transition:u}=e;return!u||!n||o!==a&&s===i?!1:r?!0:i!==s&&t===c},Bj={duration:200,easing:"ease"},ay="transform",$j=Li.Transition.toString({property:ay,duration:0,easing:"linear"}),Wj={roleDescription:"sortable"};function Uj(e){let{disabled:t,index:r,node:n,rect:s}=e;const[a,i]=m.useState(null),o=m.useRef(r);return Wn(()=>{if(!t&&r!==o.current&&n.current){const c=s.current;if(c){const u=Zi(n.current,{ignoreTransform:!0}),d={x:c.left-u.left,y:c.top-u.top,scaleX:c.width/u.width,scaleY:c.height/u.height};(d.x||d.y)&&i(d)}}r!==o.current&&(o.current=r)},[t,r,n,s]),m.useEffect(()=>{a&&i(null)},[a]),a}function iy(e){let{animateLayoutChanges:t=Lj,attributes:r,disabled:n,data:s,getNewIndex:a=Fj,id:i,strategy:o,resizeObserverConfig:c,transition:u=Bj}=e;const{items:d,containerId:f,activeIndex:h,disabled:p,disableTransforms:v,sortedRects:g,overIndex:x,useDragOverlay:y,strategy:w}=m.useContext(ny),_=Vj(n,p),b=d.indexOf(i),T=m.useMemo(()=>({sortable:{containerId:f,index:b,items:d},...s}),[f,s,b,d]),k=m.useMemo(()=>d.slice(d.indexOf(i)),[d,i]),{rect:S,node:E,isOver:C,setNodeRef:L}=jj({id:i,data:T,disabled:_.droppable,resizeObserverConfig:{updateMeasurementsFor:k,...c}}),{active:M,activatorEvent:j,activeNodeRect:V,attributes:A,setNodeRef:H,listeners:G,isDragging:q,over:Y,setActivatorNodeRef:Q,transform:fe}=Pj({id:i,data:T,attributes:{...Wj,...r},disabled:_.draggable}),oe=fD(L,H),X=!!M,le=X&&!v&&ic(h)&&ic(x),D=!y&&q,K=D&&le?fe:null,I=le?K??(o??w)({rects:g,activeNodeRect:V,activeIndex:h,overIndex:x,index:b}):null,ee=ic(h)&&ic(x)?a({id:i,items:d,activeIndex:h,overIndex:x}):b,z=M==null?void 0:M.id,R=m.useRef({activeId:z,items:d,newIndex:ee,containerId:f}),J=d!==R.current.items,Z=t({active:M,containerId:f,isDragging:q,isSorting:X,id:i,index:b,items:d,newIndex:R.current.newIndex,previousItems:R.current.items,previousContainerId:R.current.containerId,transition:u,wasDragging:R.current.activeId!=null}),ge=Uj({disabled:!Z,index:b,node:E,rect:S});return m.useEffect(()=>{X&&R.current.newIndex!==ee&&(R.current.newIndex=ee),f!==R.current.containerId&&(R.current.containerId=f),d!==R.current.items&&(R.current.items=d)},[X,ee,f,d]),m.useEffect(()=>{if(z===R.current.activeId)return;if(z!=null&&R.current.activeId==null){R.current.activeId=z;return}const Ce=setTimeout(()=>{R.current.activeId=z},50);return()=>clearTimeout(Ce)},[z]),{active:M,activeIndex:h,attributes:A,data:T,rect:S,index:b,newIndex:ee,items:d,isOver:C,isSorting:X,isDragging:q,listeners:G,node:E,overIndex:x,over:Y,setNodeRef:oe,setActivatorNodeRef:Q,setDroppableNodeRef:L,setDraggableNodeRef:H,transform:ge??I,transition:ye()};function ye(){if(ge||J&&R.current.newIndex===b)return $j;if(!(D&&!o0(j)||!u)&&(X||Z))return Li.Transition.toString({...u,property:ay})}}function Vj(e,t){var r,n;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(r=e==null?void 0:e.draggable)!=null?r:t.draggable,droppable:(n=e==null?void 0:e.droppable)!=null?n:t.droppable}}function Yc(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const Hj=[Qe.Down,Qe.Right,Qe.Up,Qe.Left],oy=(e,t)=>{let{context:{active:r,collisionRect:n,droppableRects:s,droppableContainers:a,over:i,scrollableAncestors:o}}=t;if(Hj.includes(e.code)){if(e.preventDefault(),!r||!n)return;const c=[];a.getEnabled().forEach(f=>{if(!f||f!=null&&f.disabled)return;const h=s.get(f.id);if(h)switch(e.code){case Qe.Down:n.top<h.top&&c.push(f);break;case Qe.Up:n.top>h.top&&c.push(f);break;case Qe.Left:n.left>h.left&&c.push(f);break;case Qe.Right:n.left<h.left&&c.push(f);break}});const u=kD({active:r,collisionRect:n,droppableRects:s,droppableContainers:c,pointerCoordinates:null});let d=B1(u,"id");if(d===(i==null?void 0:i.id)&&u.length>1&&(d=u[1].id),d!=null){const f=a.get(r.id),h=a.get(d),p=h?s.get(h.id):null,v=h==null?void 0:h.node.current;if(v&&p&&f&&h){const x=Qu(v).some((k,S)=>o[S]!==k),y=ly(f,h),w=zj(f,h),_=x||!y?{x:0,y:0}:{x:w?n.width-p.width:0,y:w?n.height-p.height:0},b={x:p.left,y:p.top};return _.x&&_.y?b:Qo(b,_)}}}};function ly(e,t){return!Yc(e)||!Yc(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function zj(e,t){return!Yc(e)||!Yc(t)||!ly(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const Gj=({column:e,onVisibilityChange:t})=>{const{attributes:r,listeners:n,setNodeRef:s,transform:a,transition:i,isDragging:o}=iy({id:e.key}),c={transform:Li.Transform.toString(a),transition:i,opacity:o?.5:1},u=d=>d.replace(/([A-Z])/g," $1").replace(/^./,f=>f.toUpperCase()).replace(/_/g," ");return l.jsxs("div",{ref:s,style:c,className:"flex items-center space-x-3 p-3 bg-card rounded-lg border hover:bg-accent transition-colors",children:[l.jsx("div",{...r,...n,className:"cursor-grab active:cursor-grabbing p-1 hover:bg-muted rounded",children:l.jsx(xx,{className:"h-4 w-4 text-muted-foreground"})}),l.jsx(Lr,{checked:e.visible,onCheckedChange:d=>t(!!d),className:"data-[state=checked]:bg-primary data-[state=checked]:border-primary"}),l.jsx("span",{className:"flex-1 text-sm font-medium",children:u(e.key)}),l.jsx(Pa,{variant:e.visible?"default":"secondary",className:"text-xs",children:e.visible?"Visible":"Hidden"})]})},Kj=({visibleColumns:e,onVisibilityChange:t,onColumnOrderChange:r})=>{const[n,s]=m.useState(!1),{columnPreferences:a,saveColumnPreferences:i,isLoading:o}=Uu(),[c,u]=m.useState([]),d=M1(Gc(ed),Gc(Zu,{coordinateGetter:oy})),f=["StockName","OptionName","ExpiryDate","DaysToExpiry","StrikePrice","Premium","NumberOfContractsBasedOnLimit","1_2_3_ProbOfWorthless_Weighted"],h=()=>["StockName","OptionName","ExpiryDate","FinancialReport","X-Day","Premium","PoW_Simulation_Mean_Earnings","100k_Invested_Loss_Mean","1_2_3_ProbOfWorthless_Weighted","ProbWorthless_Bayesian_IsoCal","1_ProbOfWorthless_Original","2_ProbOfWorthless_Calibrated","3_ProbOfWorthless_Historical_IV","Lower_Bound_at_Accuracy","LossAtBadDecline","LossAtWorstDecline","PoW_Stats_MedianLossPct","PoW_Stats_WorstLossPct","PoW_Stats_MedianLoss","PoW_Stats_WorstLoss","PoW_Stats_MedianProbOfWorthless","PoW_Stats_MinProbOfWorthless","PoW_Stats_MaxProbOfWorthless","LossAt100DayWorstDecline","LossAt_2008_100DayWorstDecline","Mean_Accuracy","Lower_Bound_HistMedianIV_at_Accuracy","Lower_Bound","Lower_Bound_HistMedianIV","Bid_Ask_Mid_Price","Option_Price_Min","NumberOfContractsBasedOnLimit","Bid","ProfitLossPctLeastBad","Loss_Least_Bad","IV_AllMedianIV_Maximum100DaysToExp_Ratio","StockPrice","DaysToExpiry","AskBidSpread","Underlying_Value","StrikePrice","StockPrice_After_2008_100DayWorstDecline","LossAt50DayWorstDecline","LossAt_2008_50DayWorstDecline","ProfitLossPctBad","ProfitLossPctWorst","ProfitLossPct100DayWorst","ImpliedVolatility","TodayStockMedianIV_Maximum100DaysToExp","AllMedianIV_Maximum100DaysToExp","ExpiryDate_Lower_Bound_Minus_Pct_Based_on_Accuracy","StrikeBelowLowerAtAcc","Ask","WorstHistoricalDecline","BadHistoricalDecline","ImpliedVolatilityUntilExpiry","StockPrice_After_100DayWorstDecline","StockPrice_After_50DayWorstDecline","StockPrice_After_2008_50DayWorstDecline","100DayMaxPrice","100DayMaxPriceDate","50DayMaxPrice","50DayMaxPriceDate","Historical100DaysWorstDecline","Historical50DaysWorstDecline","2008_100DaysWorstDecline","2008_50DaysWorstDecline","IV_ClosestToStrike","IV_UntilExpiryClosestToStrike","LowerBoundClosestToStrike","LowerBoundDistanceFromCurrentPrice","LowerBoundDistanceFromStrike","ImpliedDownPct","ToStrikePct","SafetyMultiple","SigmasToStrike","ProbAssignment","SafetyCategory","CushionMinusIVPct","PotentialLossAtLowerBound"];m.useEffect(()=>{const y=h(),w=new Map(a.map(b=>[b.key,b])),_=y.map((b,T)=>w.get(b)||{key:b,visible:f.includes(b),order:w.size+T});_.sort((b,T)=>{const k=w.has(b.key),S=w.has(T.key);return k&&S?b.order-T.order:k?-1:S?1:b.order-T.order}),u(_)},[a]);const p=y=>{const{active:w,over:_}=y;w.id!==(_==null?void 0:_.id)&&u(b=>{const T=b.findIndex(E=>E.key===w.id),k=b.findIndex(E=>E.key===(_==null?void 0:_.id));return nd(b,T,k).map((E,C)=>({...E,order:C}))})},v=(y,w)=>{u(_=>_.map(b=>b.key===y?{...b,visible:w}:b))},g=async()=>{await i(c);const y=c.filter(w=>w.visible).sort((w,_)=>w.order-_.order).map(w=>w.key);r(y),s(!1)},x=c.filter(y=>y.visible).length;return l.jsxs(Al,{open:n,onOpenChange:s,children:[l.jsx(Nl,{asChild:!0,children:l.jsxs(Ee,{variant:"outline",size:"sm",className:"ml-2",children:[l.jsx(xl,{className:"h-4 w-4 mr-1"}),"Columns (",x,")"]})}),l.jsxs(qi,{className:"max-w-2xl max-h-[80vh] overflow-hidden flex flex-col",children:[l.jsxs(Xu,{children:[l.jsx(qu,{children:"Manage Table Columns"}),l.jsx("p",{className:"text-sm text-muted-foreground",children:"Drag to reorder columns and check/uncheck to show/hide them. Click Save to persist your preferences."})]}),l.jsx("div",{className:"flex-1 overflow-y-auto space-y-2 pr-2",children:!o&&c.length>0&&l.jsx(Z1,{sensors:d,collisionDetection:$1,onDragEnd:p,children:l.jsx(sy,{items:c.map(y=>y.key),strategy:ty,children:c.sort((y,w)=>y.order-w.order).map(y=>l.jsx(Gj,{column:y,onVisibilityChange:w=>v(y.key,w)},y.key))})})}),l.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[l.jsxs("p",{className:"text-sm text-muted-foreground",children:[x," of ",c.length," columns visible"]}),l.jsxs("div",{className:"flex space-x-2",children:[l.jsx(Ee,{variant:"outline",onClick:()=>s(!1),children:"Cancel"}),l.jsxs(Ee,{onClick:g,disabled:o,children:[l.jsx(vx,{className:"h-4 w-4 mr-1"}),"Save Preferences"]})]})]})]})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Xc={};Xc.version="0.19.3";var ts=1200,po,el=function(e){ts=e};function Yj(){el(1200)}var lc=function(t){return String.fromCharCode(t)},pp=function(t){return String.fromCharCode(t)},en="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function qc(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),a=r>>2,n=e.charCodeAt(u++),i=(r&3)<<4|n>>4,s=e.charCodeAt(u++),o=(n&15)<<2|s>>6,c=s&63,isNaN(n)?o=c=64:isNaN(s)&&(c=64),t+=en.charAt(a)+en.charAt(i)+en.charAt(o)+en.charAt(c);return t}function Xj(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),r>255&&(r=95),a=r>>2,n=e.charCodeAt(u++),n>255&&(n=95),i=(r&3)<<4|n>>4,s=e.charCodeAt(u++),s>255&&(s=95),o=(n&15)<<2|s>>6,c=s&63,isNaN(n)?o=c=64:isNaN(s)&&(c=64),t+=en.charAt(a)+en.charAt(i)+en.charAt(o)+en.charAt(c);return t}function Vs(e){var t="",r=0,n=0,s=0,a=0,i=0,o=0,c=0;e=e.replace(/^data:([^\/]+\/[^\/]+)?;base64\,/,"").replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)a=en.indexOf(e.charAt(u++)),i=en.indexOf(e.charAt(u++)),r=a<<2|i>>4,t+=String.fromCharCode(r),o=en.indexOf(e.charAt(u++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),c=en.indexOf(e.charAt(u++)),s=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(s));return t}var lt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),zn=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}(),Jc=function(){if(typeof Buffer>"u")return!1;var e=zn([65,0]);if(!e)return!1;var t=e.toString("utf16le");return t.length==1}();function Aa(e){return lt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function gp(e){return lt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Br=function(t){return lt?zn(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function sd(e){if(typeof ArrayBuffer>"u")return Br(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Na(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function qj(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var $t=lt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:zn(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)s=e[t].length,e[t]instanceof Uint8Array?n.set(e[t],r):typeof e[t]=="string"?n.set(new Uint8Array(Br(e[t])),r):n.set(new Uint8Array(e[t]),r);return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function Jj(e){for(var t=[],r=0,n=e.length+250,s=Aa(e.length+255),a=0;a<e.length;++a){var i=e.charCodeAt(a);if(i<128)s[r++]=i;else if(i<2048)s[r++]=192|i>>6&31,s[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++a)&1023;s[r++]=240|i>>8&7,s[r++]=128|i>>2&63,s[r++]=128|o>>6&15|(i&3)<<4,s[r++]=128|o&63}else s[r++]=224|i>>12&15,s[r++]=128|i>>6&63,s[r++]=128|i&63;r>n&&(t.push(s.slice(0,r)),r=0,s=Aa(65535),n=65530)}return t.push(s.slice(0,r)),$t(t)}var Oo=/\u0000/g,cc=/[\u0001-\u0006]/g;function xi(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function gn(e,t){var r=""+e;return r.length>=t?r:kt("0",t-r.length)+r}function u0(e,t){var r=""+e;return r.length>=t?r:kt(" ",t-r.length)+r}function Qc(e,t){var r=""+e;return r.length>=t?r:r+kt(" ",t-r.length)}function Qj(e,t){var r=""+Math.round(e);return r.length>=t?r:kt("0",t-r.length)+r}function Zj(e,t){var r=""+e;return r.length>=t?r:kt("0",t-r.length)+r}var xp=Math.pow(2,32);function si(e,t){if(e>xp||e<-xp)return Qj(e,t);var r=Math.round(e);return Zj(r,t)}function Zc(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var vp=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Zd=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function eR(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var Pt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},yp={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},tR={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function eu(e,t,r){for(var n=e<0?-1:1,s=e*n,a=0,i=1,o=0,c=1,u=0,d=0,f=Math.floor(s);u<t&&(f=Math.floor(s),o=f*i+a,d=f*u+c,!(s-f<5e-8));)s=1/(s-f),a=i,i=o,c=u,u=d;if(d>t&&(u>t?(d=c,o=a):(d=u,o=i)),!r)return[0,n*o,d];var h=Math.floor(n*o/d);return[h,n*o-h*d,d]}function uc(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),a=0,i=[],o={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),i=[c.getFullYear(),c.getMonth()+1,c.getDate()],a=c.getDay(),n<60&&(a=(a+6)%7),r&&(a=lR(c,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=a,o}var cy=new Date(1899,11,31,0,0,0),rR=cy.getTime(),nR=new Date(1900,2,1,0,0,0);function uy(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=nR&&(r+=24*60*60*1e3),(r-(rR+(e.getTimezoneOffset()-cy.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function d0(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function sR(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function aR(e){var t=e<0?12:11,r=d0(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function iR(e){var t=d0(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function oR(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=aR(e):t===10?r=e.toFixed(10).substr(0,12):r=iR(e),d0(sR(r.toUpperCase()))}function qf(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):oR(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return fs(14,uy(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function lR(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function cR(e,t,r,n){var s="",a=0,i=0,o=r.y,c,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,u=2;break;default:c=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return Zd[r.m-1][1];case 5:return Zd[r.m-1][0];default:return Zd[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return vp[r.q][0];default:return vp[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?gn(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,a=Math.round(i*(r.S+r.u)),a>=60*i&&(a=0),t==="s"?a===0?"0":""+a/i:(s=gn(a,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=o,u=1;break}var d=u>0?gn(c,u):"";return d}function Os(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var dy=/%/g;function uR(e,t,r){var n=t.replace(dy,""),s=t.length-n.length;return as(e,n,r*Math.pow(10,2*s))+kt("%",s)}function dR(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return as(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function fy(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+fy(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(s+a)%s)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var hy=/# (\?+)( ?)\/( ?)(\d+)/;function fR(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),a=Math.floor(s/n),i=s-a*n,o=n;return r+(a===0?"":""+a)+" "+(i===0?kt(" ",e[1].length+1+e[4].length):u0(i,e[1].length)+e[2]+"/"+e[3]+gn(o,e[4].length))}function hR(e,t,r){return r+(t===0?"":""+t)+kt(" ",e[1].length+2+e[4].length)}var my=/^#*0*\.([0#]+)/,py=/\).*[0#]/,gy=/\(###\) ###\\?-####/;function ur(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function wp(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function _p(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function mR(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function pR(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Yr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(py)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Yr("n",n,r):"("+Yr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return dR(e,t,r);if(t.indexOf("%")!==-1)return uR(e,t,r);if(t.indexOf("E")!==-1)return fy(t,r);if(t.charCodeAt(0)===36)return"$"+Yr(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+si(c,t.length);if(t.match(/^[#?]+$/))return s=si(r,0),s==="0"&&(s=""),s.length>t.length?s:ur(t.substr(0,t.length-s.length))+s;if(a=t.match(hy))return fR(a,c,u);if(t.match(/^#+0+$/))return u+si(c,t.length-t.indexOf("0"));if(a=t.match(my))return s=wp(r,a[1].length).replace(/^([^\.]+)$/,"$1."+ur(a[1])).replace(/\.$/,"."+ur(a[1])).replace(/\.(\d*)$/,function(v,g){return"."+g+kt("0",ur(a[1]).length-g.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+wp(c,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+Os(si(c,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Yr(e,t,-r):Os(""+(Math.floor(r)+mR(r,a[1].length)))+"."+gn(_p(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return Yr(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=xi(Yr(e,t.replace(/[\\-]/g,""),r)),i=0,xi(xi(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return i<s.length?s.charAt(i++):v==="0"?"0":""}));if(t.match(gy))return s=Yr(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=eu(c,Math.pow(10,i)-1,!1),s=""+u,d=as("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+a[2]+"/"+a[3],d=Qc(o[2],i),d.length<a[4].length&&(d=ur(a[4].substr(a[4].length-d.length))+d),s+=d,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=eu(c,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?u0(o[1],i)+a[2]+"/"+a[3]+Qc(o[2],i):kt(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=si(r,0),t.length<=s.length?s:ur(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var f=t.indexOf(".")-i,h=t.length-s.length-f;return ur(t.substr(0,f)+s+t.substr(t.length-h))}if(a=t.match(/^00,000\.([#0]*0)$/))return i=_p(r,a[1].length),r<0?"-"+Yr(e,t,-r):Os(pR(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?gn(0,3-v.length):"")+v})+"."+gn(i,a[1].length);switch(t){case"###,##0.00":return Yr(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=Os(si(c,0));return p!=="0"?u+p:"";case"###,###.00":return Yr(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Yr(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function gR(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return as(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function xR(e,t,r){var n=t.replace(dy,""),s=t.length-n.length;return as(e,n,r*Math.pow(10,2*s))+kt("%",s)}function xy(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+xy(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(s+a)%s)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Pn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(py)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Pn("n",n,r):"("+Pn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return gR(e,t,r);if(t.indexOf("%")!==-1)return xR(e,t,r);if(t.indexOf("E")!==-1)return xy(t,r);if(t.charCodeAt(0)===36)return"$"+Pn(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+gn(c,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:ur(t.substr(0,t.length-s.length))+s;if(a=t.match(hy))return hR(a,c,u);if(t.match(/^#+0+$/))return u+gn(c,t.length-t.indexOf("0"));if(a=t.match(my))return s=(""+r).replace(/^([^\.]+)$/,"$1."+ur(a[1])).replace(/\.$/,"."+ur(a[1])),s=s.replace(/\.(\d*)$/,function(v,g){return"."+g+kt("0",ur(a[1]).length-g.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+Os(""+c);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Pn(e,t,-r):Os(""+r)+"."+kt("0",a[1].length);if(a=t.match(/^#,#*,#0/))return Pn(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=xi(Pn(e,t.replace(/[\\-]/g,""),r)),i=0,xi(xi(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return i<s.length?s.charAt(i++):v==="0"?"0":""}));if(t.match(gy))return s=Pn(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=eu(c,Math.pow(10,i)-1,!1),s=""+u,d=as("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+a[2]+"/"+a[3],d=Qc(o[2],i),d.length<a[4].length&&(d=ur(a[4].substr(a[4].length-d.length))+d),s+=d,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=eu(c,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?u0(o[1],i)+a[2]+"/"+a[3]+Qc(o[2],i):kt(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:ur(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var f=t.indexOf(".")-i,h=t.length-s.length-f;return ur(t.substr(0,f)+s+t.substr(t.length-h))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Pn(e,t,-r):Os(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?gn(0,3-v.length):"")+v})+"."+gn(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=Os(""+c);return p!=="0"?u+p:"";default:if(t.match(/\.[0#?]*$/))return Pn(e,t.slice(0,t.lastIndexOf(".")),r)+ur(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function as(e,t,r){return(r|0)===r?Pn(e,t,r):Yr(e,t,r)}function vR(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var vy=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function f0(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Zc(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(vy))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function yR(e,t,r,n){for(var s=[],a="",i=0,o="",c="t",u,d,f,h="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!Zc(e,i))throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"G",v:"General"},i+=7;break;case'"':for(a="";(f=e.charCodeAt(++i))!==34&&i<e.length;)a+=String.fromCharCode(f);s[s.length]={t:"t",v:a},++i;break;case"\\":var p=e.charAt(++i),v=p==="("||p===")"?p:"t";s[s.length]={t:v,v:p},++i;break;case"_":s[s.length]={t:"t",v:" "},i+=2;break;case"@":s[s.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(u==null&&(u=uc(t,r,e.charAt(i+1)==="2"),u==null))return"";s[s.length]={t:"X",v:e.substr(i,2)},c=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=uc(t,r),u==null))return"";for(a=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)a+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),s[s.length]={t:o,v:a},c=o;break;case"A":case"a":case"上":var g={t:o,v:o};if(u==null&&(u=uc(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(u!=null&&(g.v=u.H>=12?e.charAt(i+2):o),g.t="T",h="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(u!=null&&(g.v=u.H>=12?"PM":"AM"),g.t="T",i+=5,h="h"):e.substr(i,5).toUpperCase()==="上午/下午"?(u!=null&&(g.v=u.H>=12?"下午":"上午"),g.t="T",i+=5,h="h"):(g.t="t",++i),u==null&&g.t==="T")return"";s[s.length]=g,c=o;break;case"[":for(a=o;e.charAt(i++)!=="]"&&i<e.length;)a+=e.charAt(i);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(vy)){if(u==null&&(u=uc(t,r),u==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},c=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",f0(e)||(s[s.length]={t:"t",v:a}));break;case".":if(u!=null){for(a=o;++i<e.length&&(o=e.charAt(i))==="0";)a+=o;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)a+=o;s[s.length]={t:"n",v:a};break;case"?":for(a=o;e.charAt(++i)===o;)a+=o;s[s.length]={t:o,v:a},c=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)a+=e.charAt(i);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:o,v:o},++i;break;case"$":s[s.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"t",v:o},++i;break}var x=0,y=0,w;for(i=s.length-1,c="t";i>=0;--i)switch(s[i].t){case"h":case"H":s[i].t=h,c="h",x<1&&(x=1);break;case"s":(w=s[i].v.match(/\.0+$/))&&(y=Math.max(y,w[0].length-1)),x<3&&(x=3);case"d":case"y":case"M":case"e":c=s[i].t;break;case"m":c==="s"&&(s[i].t="M",x<2&&(x=2));break;case"X":break;case"Z":x<1&&s[i].v.match(/[Hh]/)&&(x=1),x<2&&s[i].v.match(/[Mm]/)&&(x=2),x<3&&s[i].v.match(/[Ss]/)&&(x=3)}switch(x){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var _="",b;for(i=0;i<s.length;++i)switch(s[i].t){case"t":case"T":case" ":case"D":break;case"X":s[i].v="",s[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[i].v=cR(s[i].t.charCodeAt(0),s[i].v,u,y),s[i].t="t";break;case"n":case"?":for(b=i+1;s[b]!=null&&((o=s[b].t)==="?"||o==="D"||(o===" "||o==="t")&&s[b+1]!=null&&(s[b+1].t==="?"||s[b+1].t==="t"&&s[b+1].v==="/")||s[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[b].v==="/"||s[b].v===" "&&s[b+1]!=null&&s[b+1].t=="?"));)s[i].v+=s[b].v,s[b]={v:"",t:";"},++b;_+=s[i].v,i=b-1;break;case"G":s[i].t="t",s[i].v=qf(t,r);break}var T="",k,S;if(_.length>0){_.charCodeAt(0)==40?(k=t<0&&_.charCodeAt(0)===45?-t:t,S=as("n",_,k)):(k=t<0&&n>1?-t:t,S=as("n",_,k),k<0&&s[0]&&s[0].t=="t"&&(S=S.substr(1),s[0].v="-"+s[0].v)),b=S.length-1;var E=s.length;for(i=0;i<s.length;++i)if(s[i]!=null&&s[i].t!="t"&&s[i].v.indexOf(".")>-1){E=i;break}var C=s.length;if(E===s.length&&S.indexOf("E")===-1){for(i=s.length-1;i>=0;--i)s[i]==null||"n?".indexOf(s[i].t)===-1||(b>=s[i].v.length-1?(b-=s[i].v.length,s[i].v=S.substr(b+1,s[i].v.length)):b<0?s[i].v="":(s[i].v=S.substr(0,b+1),b=-1),s[i].t="t",C=i);b>=0&&C<s.length&&(s[C].v=S.substr(0,b+1)+s[C].v)}else if(E!==s.length&&S.indexOf("E")===-1){for(b=S.indexOf(".")-1,i=E;i>=0;--i)if(!(s[i]==null||"n?".indexOf(s[i].t)===-1)){for(d=s[i].v.indexOf(".")>-1&&i===E?s[i].v.indexOf(".")-1:s[i].v.length-1,T=s[i].v.substr(d+1);d>=0;--d)b>=0&&(s[i].v.charAt(d)==="0"||s[i].v.charAt(d)==="#")&&(T=S.charAt(b--)+T);s[i].v=T,s[i].t="t",C=i}for(b>=0&&C<s.length&&(s[C].v=S.substr(0,b+1)+s[C].v),b=S.indexOf(".")+1,i=E;i<s.length;++i)if(!(s[i]==null||"n?(".indexOf(s[i].t)===-1&&i!==E)){for(d=s[i].v.indexOf(".")>-1&&i===E?s[i].v.indexOf(".")+1:0,T=s[i].v.substr(0,d);d<s[i].v.length;++d)b<S.length&&(T+=S.charAt(b++));s[i].v=T,s[i].t="t",C=i}}}for(i=0;i<s.length;++i)s[i]!=null&&"n?".indexOf(s[i].t)>-1&&(k=n>1&&t<0&&i>0&&s[i-1].v==="-"?-t:t,s[i].v=as(s[i].t,s[i].v,k),s[i].t="t");var L="";for(i=0;i!==s.length;++i)s[i]!=null&&(L+=s[i].v);return L}var bp=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Sp(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function wR(e,t){var r=vR(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(bp),o=r[1].match(bp);return Sp(t,i)?[n,r[0]]:Sp(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,a]}function fs(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Pt)[e],n==null&&(n=r.table&&r.table[yp[e]]||Pt[yp[e]]),n==null&&(n=tR[e]||"General");break}if(Zc(n,0))return qf(t,r);t instanceof Date&&(t=uy(t,r.date1904));var s=wR(n,t);if(Zc(s[1]))return qf(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return yR(s[1],t,r,s[0])}function yy(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Pt[r]==null){t<0&&(t=r);continue}if(Pt[r]==e){t=r;break}}t<0&&(t=391)}return Pt[t]=e,t}function ad(e){for(var t=0;t!=392;++t)e[t]!==void 0&&yy(e[t],t)}function id(){Pt=eR()}var wy=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function _R(e){var t=typeof e=="number"?Pt[e]:e;return t=t.replace(wy,"(\\d+)"),new RegExp("^"+t+"$")}function bR(e,t,r){var n=-1,s=-1,a=-1,i=-1,o=-1,c=-1;(t.match(wy)||[]).forEach(function(f,h){var p=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=p;break;case"d":a=p;break;case"h":i=p;break;case"s":c=p;break;case"m":i>=0?o=p:s=p;break}}),c>=0&&o==-1&&s>=0&&(o=s,s=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return i==-1&&o==-1&&c==-1?u:n==-1&&s==-1&&a==-1?d:u+"T"+d}var SR={"d.m":"d\\.m"};function ER(e,t){return yy(SR[e]||e,t)}var Ep=function(){var e={};e.version="1.2.0";function t(){for(var S=0,E=new Array(256),C=0;C!=256;++C)S=C,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,E[C]=S;return typeof Int32Array<"u"?new Int32Array(E):E}var r=t();function n(S){var E=0,C=0,L=0,M=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(L=0;L!=256;++L)M[L]=S[L];for(L=0;L!=256;++L)for(C=S[L],E=256+L;E<4096;E+=256)C=M[E]=C>>>8^S[C&255];var j=[];for(L=1;L!=16;++L)j[L-1]=typeof Int32Array<"u"&&typeof M.subarray=="function"?M.subarray(L*256,L*256+256):M.slice(L*256,L*256+256);return j}var s=n(r),a=s[0],i=s[1],o=s[2],c=s[3],u=s[4],d=s[5],f=s[6],h=s[7],p=s[8],v=s[9],g=s[10],x=s[11],y=s[12],w=s[13],_=s[14];function b(S,E){for(var C=E^-1,L=0,M=S.length;L<M;)C=C>>>8^r[(C^S.charCodeAt(L++))&255];return~C}function T(S,E){for(var C=E^-1,L=S.length-15,M=0;M<L;)C=_[S[M++]^C&255]^w[S[M++]^C>>8&255]^y[S[M++]^C>>16&255]^x[S[M++]^C>>>24]^g[S[M++]]^v[S[M++]]^p[S[M++]]^h[S[M++]]^f[S[M++]]^d[S[M++]]^u[S[M++]]^c[S[M++]]^o[S[M++]]^i[S[M++]]^a[S[M++]]^r[S[M++]];for(L+=15;M<L;)C=C>>>8^r[(C^S[M++])&255];return~C}function k(S,E){for(var C=E^-1,L=0,M=S.length,j=0,V=0;L<M;)j=S.charCodeAt(L++),j<128?C=C>>>8^r[(C^j)&255]:j<2048?(C=C>>>8^r[(C^(192|j>>6&31))&255],C=C>>>8^r[(C^(128|j&63))&255]):j>=55296&&j<57344?(j=(j&1023)+64,V=S.charCodeAt(L++)&1023,C=C>>>8^r[(C^(240|j>>8&7))&255],C=C>>>8^r[(C^(128|j>>2&63))&255],C=C>>>8^r[(C^(128|V>>6&15|(j&3)<<4))&255],C=C>>>8^r[(C^(128|V&63))&255]):(C=C>>>8^r[(C^(224|j>>12&15))&255],C=C>>>8^r[(C^(128|j>>6&63))&255],C=C>>>8^r[(C^(128|j&63))&255]);return~C}return e.table=r,e.bstr=b,e.buf=T,e.str=k,e}(),pt=function(){var t={};t.version="1.2.2";function r(P,F){for(var N=P.split("/"),O=F.split("/"),B=0,W=0,re=Math.min(N.length,O.length);B<re;++B){if(W=N[B].length-O[B].length)return W;if(N[B]!=O[B])return N[B]<O[B]?-1:1}return N.length-O.length}function n(P){if(P.charAt(P.length-1)=="/")return P.slice(0,-1).indexOf("/")===-1?P:n(P.slice(0,-1));var F=P.lastIndexOf("/");return F===-1?P:P.slice(0,F+1)}function s(P){if(P.charAt(P.length-1)=="/")return s(P.slice(0,-1));var F=P.lastIndexOf("/");return F===-1?P:P.slice(F+1)}function a(P,F){typeof F=="string"&&(F=new Date(F));var N=F.getHours();N=N<<6|F.getMinutes(),N=N<<5|F.getSeconds()>>>1,P.write_shift(2,N);var O=F.getFullYear()-1980;O=O<<4|F.getMonth()+1,O=O<<5|F.getDate(),P.write_shift(2,O)}function i(P){var F=P.read_shift(2)&65535,N=P.read_shift(2)&65535,O=new Date,B=N&31;N>>>=5;var W=N&15;N>>>=4,O.setMilliseconds(0),O.setFullYear(N+1980),O.setMonth(W-1),O.setDate(B);var re=F&31;F>>>=5;var ie=F&63;return F>>>=6,O.setHours(F),O.setMinutes(ie),O.setSeconds(re<<1),O}function o(P){fr(P,0);for(var F={},N=0;P.l<=P.length-4;){var O=P.read_shift(2),B=P.read_shift(2),W=P.l+B,re={};switch(O){case 21589:N=P.read_shift(1),N&1&&(re.mtime=P.read_shift(4)),B>5&&(N&2&&(re.atime=P.read_shift(4)),N&4&&(re.ctime=P.read_shift(4))),re.mtime&&(re.mt=new Date(re.mtime*1e3));break;case 1:{var ie=P.read_shift(4),te=P.read_shift(4);re.usz=te*Math.pow(2,32)+ie,ie=P.read_shift(4),te=P.read_shift(4),re.csz=te*Math.pow(2,32)+ie}break}P.l=W,F[O]=re}return F}var c;function u(){return c||(c=TR)}function d(P,F){if(P[0]==80&&P[1]==75)return nt(P,F);if((P[0]|32)==109&&(P[1]|32)==105)return ps(P,F);if(P.length<512)throw new Error("CFB file size "+P.length+" < 512");var N=3,O=512,B=0,W=0,re=0,ie=0,te=0,se=[],ne=P.slice(0,512);fr(ne,0);var pe=f(ne);switch(N=pe[0],N){case 3:O=512;break;case 4:O=4096;break;case 0:if(pe[1]==0)return nt(P,F);default:throw new Error("Major Version: Expected 3 or 4 saw "+N)}O!==512&&(ne=P.slice(0,O),fr(ne,28));var _e=P.slice(0,O);h(ne,N);var Te=ne.read_shift(4,"i");if(N===3&&Te!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Te);ne.l+=4,re=ne.read_shift(4,"i"),ne.l+=4,ne.chk("00100000","Mini Stream Cutoff Size: "),ie=ne.read_shift(4,"i"),B=ne.read_shift(4,"i"),te=ne.read_shift(4,"i"),W=ne.read_shift(4,"i");for(var xe=-1,be=0;be<109&&(xe=ne.read_shift(4,"i"),!(xe<0));++be)se[be]=xe;var Be=p(P,O);x(te,W,Be,O,se);var wt=w(Be,re,se,O);re<wt.length&&(wt[re].name="!Directory"),B>0&&ie!==V&&(wt[ie].name="!MiniFAT"),wt[se[0]].name="!FAT",wt.fat_addrs=se,wt.ssz=O;var St={},rr=[],lo=[],co=[];_(re,wt,Be,rr,B,St,lo,ie),v(lo,co,rr),rr.shift();var uo={FileIndex:lo,FullPaths:co};return F&&F.raw&&(uo.raw={header:_e,sectors:Be}),uo}function f(P){if(P[P.l]==80&&P[P.l+1]==75)return[0,0];P.chk(A,"Header Signature: "),P.l+=16;var F=P.read_shift(2,"u");return[P.read_shift(2,"u"),F]}function h(P,F){var N=9;switch(P.l+=2,N=P.read_shift(2)){case 9:if(F!=3)throw new Error("Sector Shift: Expected 9 saw "+N);break;case 12:if(F!=4)throw new Error("Sector Shift: Expected 12 saw "+N);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+N)}P.chk("0600","Mini Sector Shift: "),P.chk("000000000000","Reserved: ")}function p(P,F){for(var N=Math.ceil(P.length/F)-1,O=[],B=1;B<N;++B)O[B-1]=P.slice(B*F,(B+1)*F);return O[N-1]=P.slice(N*F),O}function v(P,F,N){for(var O=0,B=0,W=0,re=0,ie=0,te=N.length,se=[],ne=[];O<te;++O)se[O]=ne[O]=O,F[O]=N[O];for(;ie<ne.length;++ie)O=ne[ie],B=P[O].L,W=P[O].R,re=P[O].C,se[O]===O&&(B!==-1&&se[B]!==B&&(se[O]=se[B]),W!==-1&&se[W]!==W&&(se[O]=se[W])),re!==-1&&(se[re]=O),B!==-1&&O!=se[O]&&(se[B]=se[O],ne.lastIndexOf(B)<ie&&ne.push(B)),W!==-1&&O!=se[O]&&(se[W]=se[O],ne.lastIndexOf(W)<ie&&ne.push(W));for(O=1;O<te;++O)se[O]===O&&(W!==-1&&se[W]!==W?se[O]=se[W]:B!==-1&&se[B]!==B&&(se[O]=se[B]));for(O=1;O<te;++O)if(P[O].type!==0){if(ie=O,ie!=se[ie])do ie=se[ie],F[O]=F[ie]+"/"+F[O];while(ie!==0&&se[ie]!==-1&&ie!=se[ie]);se[O]=-1}for(F[0]+="/",O=1;O<te;++O)P[O].type!==2&&(F[O]+="/")}function g(P,F,N){for(var O=P.start,B=P.size,W=[],re=O;N&&B>0&&re>=0;)W.push(F.slice(re*j,re*j+j)),B-=j,re=ma(N,re*4);return W.length===0?ae(0):$t(W).slice(0,P.size)}function x(P,F,N,O,B){var W=V;if(P===V){if(F!==0)throw new Error("DIFAT chain shorter than expected")}else if(P!==-1){var re=N[P],ie=(O>>>2)-1;if(!re)return;for(var te=0;te<ie&&(W=ma(re,te*4))!==V;++te)B.push(W);F>=1&&x(ma(re,O-4),F-1,N,O,B)}}function y(P,F,N,O,B){var W=[],re=[];B||(B=[]);var ie=O-1,te=0,se=0;for(te=F;te>=0;){B[te]=!0,W[W.length]=te,re.push(P[te]);var ne=N[Math.floor(te*4/O)];if(se=te*4&ie,O<4+se)throw new Error("FAT boundary crossed: "+te+" 4 "+O);if(!P[ne])break;te=ma(P[ne],se)}return{nodes:W,data:Rp([re])}}function w(P,F,N,O){var B=P.length,W=[],re=[],ie=[],te=[],se=O-1,ne=0,pe=0,_e=0,Te=0;for(ne=0;ne<B;++ne)if(ie=[],_e=ne+F,_e>=B&&(_e-=B),!re[_e]){te=[];var xe=[];for(pe=_e;pe>=0;){xe[pe]=!0,re[pe]=!0,ie[ie.length]=pe,te.push(P[pe]);var be=N[Math.floor(pe*4/O)];if(Te=pe*4&se,O<4+Te)throw new Error("FAT boundary crossed: "+pe+" 4 "+O);if(!P[be]||(pe=ma(P[be],Te),xe[pe]))break}W[_e]={nodes:ie,data:Rp([te])}}return W}function _(P,F,N,O,B,W,re,ie){for(var te=0,se=O.length?2:0,ne=F[P].data,pe=0,_e=0,Te;pe<ne.length;pe+=128){var xe=ne.slice(pe,pe+128);fr(xe,64),_e=xe.read_shift(2),Te=v0(xe,0,_e-se),O.push(Te);var be={name:Te,type:xe.read_shift(1),color:xe.read_shift(1),L:xe.read_shift(4,"i"),R:xe.read_shift(4,"i"),C:xe.read_shift(4,"i"),clsid:xe.read_shift(16),state:xe.read_shift(4,"i"),start:0,size:0},Be=xe.read_shift(2)+xe.read_shift(2)+xe.read_shift(2)+xe.read_shift(2);Be!==0&&(be.ct=b(xe,xe.l-8));var wt=xe.read_shift(2)+xe.read_shift(2)+xe.read_shift(2)+xe.read_shift(2);wt!==0&&(be.mt=b(xe,xe.l-8)),be.start=xe.read_shift(4,"i"),be.size=xe.read_shift(4,"i"),be.size<0&&be.start<0&&(be.size=be.type=0,be.start=V,be.name=""),be.type===5?(te=be.start,B>0&&te!==V&&(F[te].name="!StreamData")):be.size>=4096?(be.storage="fat",F[be.start]===void 0&&(F[be.start]=y(N,be.start,F.fat_addrs,F.ssz)),F[be.start].name=be.name,be.content=F[be.start].data.slice(0,be.size)):(be.storage="minifat",be.size<0?be.size=0:te!==V&&be.start!==V&&F[te]&&(be.content=g(be,F[te].data,(F[ie]||{}).data))),be.content&&fr(be.content,0),W[Te]=be,re.push(be)}}function b(P,F){return new Date((Wr(P,F+4)/1e7*Math.pow(2,32)+Wr(P,F)/1e7-11644473600)*1e3)}function T(P,F){return u(),d(c.readFileSync(P),F)}function k(P,F){var N=F&&F.type;switch(N||lt&&Buffer.isBuffer(P)&&(N="buffer"),N||"base64"){case"file":return T(P,F);case"base64":return d(Br(Vs(P)),F);case"binary":return d(Br(P),F)}return d(P,F)}function S(P,F){var N=F||{},O=N.root||"Root Entry";if(P.FullPaths||(P.FullPaths=[]),P.FileIndex||(P.FileIndex=[]),P.FullPaths.length!==P.FileIndex.length)throw new Error("inconsistent CFB structure");P.FullPaths.length===0&&(P.FullPaths[0]=O+"/",P.FileIndex[0]={name:O,type:5}),N.CLSID&&(P.FileIndex[0].clsid=N.CLSID),E(P)}function E(P){var F="Sh33tJ5";if(!pt.find(P,"/"+F)){var N=ae(4);N[0]=55,N[1]=N[3]=50,N[2]=54,P.FileIndex.push({name:F,type:2,content:N,size:4,L:69,R:69,C:69}),P.FullPaths.push(P.FullPaths[0]+F),C(P)}}function C(P,F){S(P);for(var N=!1,O=!1,B=P.FullPaths.length-1;B>=0;--B){var W=P.FileIndex[B];switch(W.type){case 0:O?N=!0:(P.FileIndex.pop(),P.FullPaths.pop());break;case 1:case 2:case 5:O=!0,isNaN(W.R*W.L*W.C)&&(N=!0),W.R>-1&&W.L>-1&&W.R==W.L&&(N=!0);break;default:N=!0;break}}if(!(!N&&!F)){var re=new Date(1987,1,19),ie=0,te=Object.create?Object.create(null):{},se=[];for(B=0;B<P.FullPaths.length;++B)te[P.FullPaths[B]]=!0,P.FileIndex[B].type!==0&&se.push([P.FullPaths[B],P.FileIndex[B]]);for(B=0;B<se.length;++B){var ne=n(se[B][0]);for(O=te[ne];!O;){for(;n(ne)&&!te[n(ne)];)ne=n(ne);se.push([ne,{name:s(ne).replace("/",""),type:1,clsid:G,ct:re,mt:re,content:null}]),te[ne]=!0,ne=n(se[B][0]),O=te[ne]}}for(se.sort(function(Te,xe){return r(Te[0],xe[0])}),P.FullPaths=[],P.FileIndex=[],B=0;B<se.length;++B)P.FullPaths[B]=se[B][0],P.FileIndex[B]=se[B][1];for(B=0;B<se.length;++B){var pe=P.FileIndex[B],_e=P.FullPaths[B];if(pe.name=s(_e).replace("/",""),pe.L=pe.R=pe.C=-(pe.color=1),pe.size=pe.content?pe.content.length:0,pe.start=0,pe.clsid=pe.clsid||G,B===0)pe.C=se.length>1?1:-1,pe.size=0,pe.type=5;else if(_e.slice(-1)=="/"){for(ie=B+1;ie<se.length&&n(P.FullPaths[ie])!=_e;++ie);for(pe.C=ie>=se.length?-1:ie,ie=B+1;ie<se.length&&n(P.FullPaths[ie])!=n(_e);++ie);pe.R=ie>=se.length?-1:ie,pe.type=1}else n(P.FullPaths[B+1]||"")==n(_e)&&(pe.R=B+1),pe.type=2}}}function L(P,F){var N=F||{};if(N.fileType=="mad")return Mt(P,N);switch(C(P),N.fileType){case"zip":return ut(P,N)}var O=function(Te){for(var xe=0,be=0,Be=0;Be<Te.FileIndex.length;++Be){var wt=Te.FileIndex[Be];if(wt.content){var St=wt.content.length;St>0&&(St<4096?xe+=St+63>>6:be+=St+511>>9)}}for(var rr=Te.FullPaths.length+3>>2,lo=xe+7>>3,co=xe+127>>7,uo=lo+be+rr+co,la=uo+127>>7,Cd=la<=109?0:Math.ceil((la-109)/127);uo+la+Cd+127>>7>la;)Cd=++la<=109?0:Math.ceil((la-109)/127);var Gn=[1,Cd,la,co,rr,be,xe,0];return Te.FileIndex[0].size=xe<<6,Gn[7]=(Te.FileIndex[0].start=Gn[0]+Gn[1]+Gn[2]+Gn[3]+Gn[4]+Gn[5])+(Gn[6]+7>>3),Gn}(P),B=ae(O[7]<<9),W=0,re=0;{for(W=0;W<8;++W)B.write_shift(1,H[W]);for(W=0;W<8;++W)B.write_shift(2,0);for(B.write_shift(2,62),B.write_shift(2,3),B.write_shift(2,65534),B.write_shift(2,9),B.write_shift(2,6),W=0;W<3;++W)B.write_shift(2,0);for(B.write_shift(4,0),B.write_shift(4,O[2]),B.write_shift(4,O[0]+O[1]+O[2]+O[3]-1),B.write_shift(4,0),B.write_shift(4,4096),B.write_shift(4,O[3]?O[0]+O[1]+O[2]-1:V),B.write_shift(4,O[3]),B.write_shift(-4,O[1]?O[0]-1:V),B.write_shift(4,O[1]),W=0;W<109;++W)B.write_shift(-4,W<O[2]?O[1]+W:-1)}if(O[1])for(re=0;re<O[1];++re){for(;W<236+re*127;++W)B.write_shift(-4,W<O[2]?O[1]+W:-1);B.write_shift(-4,re===O[1]-1?V:re+1)}var ie=function(Te){for(re+=Te;W<re-1;++W)B.write_shift(-4,W+1);Te&&(++W,B.write_shift(-4,V))};for(re=W=0,re+=O[1];W<re;++W)B.write_shift(-4,q.DIFSECT);for(re+=O[2];W<re;++W)B.write_shift(-4,q.FATSECT);ie(O[3]),ie(O[4]);for(var te=0,se=0,ne=P.FileIndex[0];te<P.FileIndex.length;++te)ne=P.FileIndex[te],ne.content&&(se=ne.content.length,!(se<4096)&&(ne.start=re,ie(se+511>>9)));for(ie(O[6]+7>>3);B.l&511;)B.write_shift(-4,q.ENDOFCHAIN);for(re=W=0,te=0;te<P.FileIndex.length;++te)ne=P.FileIndex[te],ne.content&&(se=ne.content.length,!(!se||se>=4096)&&(ne.start=re,ie(se+63>>6)));for(;B.l&511;)B.write_shift(-4,q.ENDOFCHAIN);for(W=0;W<O[4]<<2;++W){var pe=P.FullPaths[W];if(!pe||pe.length===0){for(te=0;te<17;++te)B.write_shift(4,0);for(te=0;te<3;++te)B.write_shift(4,-1);for(te=0;te<12;++te)B.write_shift(4,0);continue}ne=P.FileIndex[W],W===0&&(ne.start=ne.size?ne.start-1:V);var _e=W===0&&N.root||ne.name;if(_e.length>32&&(console.error("Name "+_e+" will be truncated to "+_e.slice(0,32)),_e=_e.slice(0,32)),se=2*(_e.length+1),B.write_shift(64,_e,"utf16le"),B.write_shift(2,se),B.write_shift(1,ne.type),B.write_shift(1,ne.color),B.write_shift(-4,ne.L),B.write_shift(-4,ne.R),B.write_shift(-4,ne.C),ne.clsid)B.write_shift(16,ne.clsid,"hex");else for(te=0;te<4;++te)B.write_shift(4,0);B.write_shift(4,ne.state||0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,0),B.write_shift(4,ne.start),B.write_shift(4,ne.size),B.write_shift(4,0)}for(W=1;W<P.FileIndex.length;++W)if(ne=P.FileIndex[W],ne.size>=4096)if(B.l=ne.start+1<<9,lt&&Buffer.isBuffer(ne.content))ne.content.copy(B,B.l,0,ne.size),B.l+=ne.size+511&-512;else{for(te=0;te<ne.size;++te)B.write_shift(1,ne.content[te]);for(;te&511;++te)B.write_shift(1,0)}for(W=1;W<P.FileIndex.length;++W)if(ne=P.FileIndex[W],ne.size>0&&ne.size<4096)if(lt&&Buffer.isBuffer(ne.content))ne.content.copy(B,B.l,0,ne.size),B.l+=ne.size+63&-64;else{for(te=0;te<ne.size;++te)B.write_shift(1,ne.content[te]);for(;te&63;++te)B.write_shift(1,0)}if(lt)B.l=B.length;else for(;B.l<B.length;)B.write_shift(1,0);return B}function M(P,F){var N=P.FullPaths.map(function(te){return te.toUpperCase()}),O=N.map(function(te){var se=te.split("/");return se[se.length-(te.slice(-1)=="/"?2:1)]}),B=!1;F.charCodeAt(0)===47?(B=!0,F=N[0].slice(0,-1)+F):B=F.indexOf("/")!==-1;var W=F.toUpperCase(),re=B===!0?N.indexOf(W):O.indexOf(W);if(re!==-1)return P.FileIndex[re];var ie=!W.match(cc);for(W=W.replace(Oo,""),ie&&(W=W.replace(cc,"!")),re=0;re<N.length;++re)if((ie?N[re].replace(cc,"!"):N[re]).replace(Oo,"")==W||(ie?O[re].replace(cc,"!"):O[re]).replace(Oo,"")==W)return P.FileIndex[re];return null}var j=64,V=-2,A="d0cf11e0a1b11ae1",H=[208,207,17,224,161,177,26,225],G="00000000000000000000000000000000",q={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:V,FREESECT:-1,HEADER_SIGNATURE:A,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:G,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Y(P,F,N){u();var O=L(P,N);c.writeFileSync(F,O)}function Q(P){for(var F=new Array(P.length),N=0;N<P.length;++N)F[N]=String.fromCharCode(P[N]);return F.join("")}function fe(P,F){var N=L(P,F);switch(F&&F.type||"buffer"){case"file":return u(),c.writeFileSync(F.filename,N),N;case"binary":return typeof N=="string"?N:Q(N);case"base64":return qc(typeof N=="string"?N:Q(N));case"buffer":if(lt)return Buffer.isBuffer(N)?N:zn(N);case"array":return typeof N=="string"?Br(N):N}return N}var oe;function X(P){try{var F=P.InflateRaw,N=new F;if(N._processChunk(new Uint8Array([3,0]),N._finishFlushFlag),N.bytesRead)oe=P;else throw new Error("zlib does not expose bytesRead")}catch(O){console.error("cannot use native zlib: "+(O.message||O))}}function le(P,F){if(!oe)return Oe(P,F);var N=oe.InflateRaw,O=new N,B=O._processChunk(P.slice(P.l),O._finishFlushFlag);return P.l+=O.bytesRead,B}function D(P){return oe?oe.deflateRawSync(P):Gr(P)}var K=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],U=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],I=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ee(P){var F=(P<<1|P<<11)&139536|(P<<5|P<<15)&558144;return(F>>16|F>>8|F)&255}for(var z=typeof Uint8Array<"u",R=z?new Uint8Array(256):[],J=0;J<256;++J)R[J]=ee(J);function Z(P,F){var N=R[P&255];return F<=8?N>>>8-F:(N=N<<8|R[P>>8&255],F<=16?N>>>16-F:(N=N<<8|R[P>>16&255],N>>>24-F))}function ge(P,F){var N=F&7,O=F>>>3;return(P[O]|(N<=6?0:P[O+1]<<8))>>>N&3}function ye(P,F){var N=F&7,O=F>>>3;return(P[O]|(N<=5?0:P[O+1]<<8))>>>N&7}function Ce(P,F){var N=F&7,O=F>>>3;return(P[O]|(N<=4?0:P[O+1]<<8))>>>N&15}function Ie(P,F){var N=F&7,O=F>>>3;return(P[O]|(N<=3?0:P[O+1]<<8))>>>N&31}function st(P,F){var N=F&7,O=F>>>3;return(P[O]|(N<=1?0:P[O+1]<<8))>>>N&127}function Se(P,F,N){var O=F&7,B=F>>>3,W=(1<<N)-1,re=P[B]>>>O;return N<8-O||(re|=P[B+1]<<8-O,N<16-O)||(re|=P[B+2]<<16-O,N<24-O)||(re|=P[B+3]<<24-O),re&W}function Le(P,F,N){var O=F&7,B=F>>>3;return O<=5?P[B]|=(N&7)<<O:(P[B]|=N<<O&255,P[B+1]=(N&7)>>8-O),F+3}function de(P,F,N){var O=F&7,B=F>>>3;return N=(N&1)<<O,P[B]|=N,F+1}function Fe(P,F,N){var O=F&7,B=F>>>3;return N<<=O,P[B]|=N&255,N>>>=8,P[B+1]=N,F+8}function at(P,F,N){var O=F&7,B=F>>>3;return N<<=O,P[B]|=N&255,N>>>=8,P[B+1]=N&255,P[B+2]=N>>>8,F+16}function ke(P,F){var N=P.length,O=2*N>F?2*N:F+5,B=0;if(N>=F)return P;if(lt){var W=gp(O);if(P.copy)P.copy(W);else for(;B<P.length;++B)W[B]=P[B];return W}else if(z){var re=new Uint8Array(O);if(re.set)re.set(P);else for(;B<N;++B)re[B]=P[B];return re}return P.length=O,P}function je(P){for(var F=new Array(P),N=0;N<P;++N)F[N]=0;return F}function ht(P,F,N){var O=1,B=0,W=0,re=0,ie=0,te=P.length,se=z?new Uint16Array(32):je(32);for(W=0;W<32;++W)se[W]=0;for(W=te;W<N;++W)P[W]=0;te=P.length;var ne=z?new Uint16Array(te):je(te);for(W=0;W<te;++W)se[B=P[W]]++,O<B&&(O=B),ne[W]=0;for(se[0]=0,W=1;W<=O;++W)se[W+16]=ie=ie+se[W-1]<<1;for(W=0;W<te;++W)ie=P[W],ie!=0&&(ne[W]=se[ie+16]++);var pe=0;for(W=0;W<te;++W)if(pe=P[W],pe!=0)for(ie=Z(ne[W],O)>>O-pe,re=(1<<O+4-pe)-1;re>=0;--re)F[ie|re<<pe]=pe&15|W<<4;return O}var At=z?new Uint16Array(512):je(512),Ze=z?new Uint16Array(32):je(32);if(!z){for(var ct=0;ct<512;++ct)At[ct]=0;for(ct=0;ct<32;++ct)Ze[ct]=0}(function(){for(var P=[],F=0;F<32;F++)P.push(5);ht(P,Ze,32);var N=[];for(F=0;F<=143;F++)N.push(8);for(;F<=255;F++)N.push(9);for(;F<=279;F++)N.push(7);for(;F<=287;F++)N.push(8);ht(N,At,288)})();var tr=function(){for(var F=z?new Uint8Array(32768):[],N=0,O=0;N<I.length-1;++N)for(;O<I[N+1];++O)F[O]=N;for(;O<32768;++O)F[O]=29;var B=z?new Uint8Array(259):[];for(N=0,O=0;N<U.length-1;++N)for(;O<U[N+1];++O)B[O]=N;function W(ie,te){for(var se=0;se<ie.length;){var ne=Math.min(65535,ie.length-se),pe=se+ne==ie.length;for(te.write_shift(1,+pe),te.write_shift(2,ne),te.write_shift(2,~ne&65535);ne-- >0;)te[te.l++]=ie[se++]}return te.l}function re(ie,te){for(var se=0,ne=0,pe=z?new Uint16Array(32768):[];ne<ie.length;){var _e=Math.min(65535,ie.length-ne);if(_e<10){for(se=Le(te,se,+(ne+_e==ie.length)),se&7&&(se+=8-(se&7)),te.l=se/8|0,te.write_shift(2,_e),te.write_shift(2,~_e&65535);_e-- >0;)te[te.l++]=ie[ne++];se=te.l*8;continue}se=Le(te,se,+(ne+_e==ie.length)+2);for(var Te=0;_e-- >0;){var xe=ie[ne];Te=(Te<<5^xe)&32767;var be=-1,Be=0;if((be=pe[Te])&&(be|=ne&-32768,be>ne&&(be-=32768),be<ne))for(;ie[be+Be]==ie[ne+Be]&&Be<250;)++Be;if(Be>2){xe=B[Be],xe<=22?se=Fe(te,se,R[xe+1]>>1)-1:(Fe(te,se,3),se+=5,Fe(te,se,R[xe-23]>>5),se+=3);var wt=xe<8?0:xe-4>>2;wt>0&&(at(te,se,Be-U[xe]),se+=wt),xe=F[ne-be],se=Fe(te,se,R[xe]>>3),se-=3;var St=xe<4?0:xe-2>>1;St>0&&(at(te,se,ne-be-I[xe]),se+=St);for(var rr=0;rr<Be;++rr)pe[Te]=ne&32767,Te=(Te<<5^ie[ne])&32767,++ne;_e-=Be-1}else xe<=143?xe=xe+48:se=de(te,se,1),se=Fe(te,se,R[xe]),pe[Te]=ne&32767,++ne}se=Fe(te,se,0)-1}return te.l=(se+7)/8|0,te.l}return function(te,se){return te.length<8?W(te,se):re(te,se)}}();function Gr(P){var F=ae(50+Math.floor(P.length*1.1)),N=tr(P,F);return F.slice(0,N)}var Yt=z?new Uint16Array(32768):je(32768),Dr=z?new Uint16Array(32768):je(32768),aa=z?new Uint16Array(128):je(128),Xa=1,Tn=1;function jr(P,F){var N=Ie(P,F)+257;F+=5;var O=Ie(P,F)+1;F+=5;var B=Ce(P,F)+4;F+=4;for(var W=0,re=z?new Uint8Array(19):je(19),ie=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],te=1,se=z?new Uint8Array(8):je(8),ne=z?new Uint8Array(8):je(8),pe=re.length,_e=0;_e<B;++_e)re[K[_e]]=W=ye(P,F),te<W&&(te=W),se[W]++,F+=3;var Te=0;for(se[0]=0,_e=1;_e<=te;++_e)ne[_e]=Te=Te+se[_e-1]<<1;for(_e=0;_e<pe;++_e)(Te=re[_e])!=0&&(ie[_e]=ne[Te]++);var xe=0;for(_e=0;_e<pe;++_e)if(xe=re[_e],xe!=0){Te=R[ie[_e]]>>8-xe;for(var be=(1<<7-xe)-1;be>=0;--be)aa[Te|be<<xe]=xe&7|_e<<3}var Be=[];for(te=1;Be.length<N+O;)switch(Te=aa[st(P,F)],F+=Te&7,Te>>>=3){case 16:for(W=3+ge(P,F),F+=2,Te=Be[Be.length-1];W-- >0;)Be.push(Te);break;case 17:for(W=3+ye(P,F),F+=3;W-- >0;)Be.push(0);break;case 18:for(W=11+st(P,F),F+=7;W-- >0;)Be.push(0);break;default:Be.push(Te),te<Te&&(te=Te);break}var wt=Be.slice(0,N),St=Be.slice(N);for(_e=N;_e<286;++_e)wt[_e]=0;for(_e=O;_e<30;++_e)St[_e]=0;return Xa=ht(wt,Yt,286),Tn=ht(St,Dr,30),F}function oo(P,F){if(P[0]==3&&!(P[1]&3))return[Aa(F),2];for(var N=0,O=0,B=gp(F||1<<18),W=0,re=B.length>>>0,ie=0,te=0;!(O&1);){if(O=ye(P,N),N+=3,O>>>1)O>>1==1?(ie=9,te=5):(N=jr(P,N),ie=Xa,te=Tn);else{N&7&&(N+=8-(N&7));var se=P[N>>>3]|P[(N>>>3)+1]<<8;if(N+=32,se>0)for(!F&&re<W+se&&(B=ke(B,W+se),re=B.length);se-- >0;)B[W++]=P[N>>>3],N+=8;continue}for(;;){!F&&re<W+32767&&(B=ke(B,W+32767),re=B.length);var ne=Se(P,N,ie),pe=O>>>1==1?At[ne]:Yt[ne];if(N+=pe&15,pe>>>=4,!(pe>>>8&255))B[W++]=pe;else{if(pe==256)break;pe-=257;var _e=pe<8?0:pe-4>>2;_e>5&&(_e=0);var Te=W+U[pe];_e>0&&(Te+=Se(P,N,_e),N+=_e),ne=Se(P,N,te),pe=O>>>1==1?Ze[ne]:Dr[ne],N+=pe&15,pe>>>=4;var xe=pe<4?0:pe-2>>1,be=I[pe];for(xe>0&&(be+=Se(P,N,xe),N+=xe),!F&&re<Te&&(B=ke(B,Te+100),re=B.length);W<Te;)B[W]=B[W-be],++W}}}return F?[B,N+7>>>3]:[B.slice(0,W),N+7>>>3]}function Oe(P,F){var N=P.slice(P.l||0),O=oo(N,F);return P.l+=O[1],O[0]}function it(P,F){if(P)typeof console<"u"&&console.error(F);else throw new Error(F)}function nt(P,F){var N=P;fr(N,0);var O=[],B=[],W={FileIndex:O,FullPaths:B};S(W,{root:F.root});for(var re=N.length-4;(N[re]!=80||N[re+1]!=75||N[re+2]!=5||N[re+3]!=6)&&re>=0;)--re;N.l=re+4,N.l+=4;var ie=N.read_shift(2);N.l+=6;var te=N.read_shift(4);for(N.l=te,re=0;re<ie;++re){N.l+=20;var se=N.read_shift(4),ne=N.read_shift(4),pe=N.read_shift(2),_e=N.read_shift(2),Te=N.read_shift(2);N.l+=8;var xe=N.read_shift(4),be=o(N.slice(N.l+pe,N.l+pe+_e));N.l+=pe+_e+Te;var Be=N.l;N.l=xe+4,be&&be[1]&&((be[1]||{}).usz&&(ne=be[1].usz),(be[1]||{}).csz&&(se=be[1].csz)),_r(N,se,ne,W,be),N.l=Be}return W}function _r(P,F,N,O,B){P.l+=2;var W=P.read_shift(2),re=P.read_shift(2),ie=i(P);if(W&8257)throw new Error("Unsupported ZIP encryption");for(var te=P.read_shift(4),se=P.read_shift(4),ne=P.read_shift(4),pe=P.read_shift(2),_e=P.read_shift(2),Te="",xe=0;xe<pe;++xe)Te+=String.fromCharCode(P[P.l++]);if(_e){var be=o(P.slice(P.l,P.l+_e));(be[21589]||{}).mt&&(ie=be[21589].mt),(be[1]||{}).usz&&(ne=be[1].usz),(be[1]||{}).csz&&(se=be[1].csz),B&&((B[21589]||{}).mt&&(ie=B[21589].mt),(B[1]||{}).usz&&(ne=be[1].usz),(B[1]||{}).csz&&(se=be[1].csz))}P.l+=_e;var Be=P.slice(P.l,P.l+se);switch(re){case 8:Be=le(P,ne);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+re)}var wt=!1;W&8&&(te=P.read_shift(4),te==134695760&&(te=P.read_shift(4),wt=!0),se=P.read_shift(4),ne=P.read_shift(4)),se!=F&&it(wt,"Bad compressed size: "+F+" != "+se),ne!=N&&it(wt,"Bad uncompressed size: "+N+" != "+ne),Sr(O,Te,Be,{unsafe:!0,mt:ie})}function ut(P,F){var N=F||{},O=[],B=[],W=ae(1),re=N.compression?8:0,ie=0,te=0,se=0,ne=0,pe=0,_e=P.FullPaths[0],Te=_e,xe=P.FileIndex[0],be=[],Be=0;for(te=1;te<P.FullPaths.length;++te)if(Te=P.FullPaths[te].slice(_e.length),xe=P.FileIndex[te],!(!xe.size||!xe.content||Te=="Sh33tJ5")){var wt=ne,St=ae(Te.length);for(se=0;se<Te.length;++se)St.write_shift(1,Te.charCodeAt(se)&127);St=St.slice(0,St.l),be[pe]=typeof xe.content=="string"?Ep.bstr(xe.content,0):Ep.buf(xe.content,0);var rr=typeof xe.content=="string"?Br(xe.content):xe.content;re==8&&(rr=D(rr)),W=ae(30),W.write_shift(4,67324752),W.write_shift(2,20),W.write_shift(2,ie),W.write_shift(2,re),xe.mt?a(W,xe.mt):W.write_shift(4,0),W.write_shift(-4,be[pe]),W.write_shift(4,rr.length),W.write_shift(4,xe.content.length),W.write_shift(2,St.length),W.write_shift(2,0),ne+=W.length,O.push(W),ne+=St.length,O.push(St),ne+=rr.length,O.push(rr),W=ae(46),W.write_shift(4,33639248),W.write_shift(2,0),W.write_shift(2,20),W.write_shift(2,ie),W.write_shift(2,re),W.write_shift(4,0),W.write_shift(-4,be[pe]),W.write_shift(4,rr.length),W.write_shift(4,xe.content.length),W.write_shift(2,St.length),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(4,0),W.write_shift(4,wt),Be+=W.l,B.push(W),Be+=St.length,B.push(St),++pe}return W=ae(22),W.write_shift(4,101010256),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(2,pe),W.write_shift(2,pe),W.write_shift(4,Be),W.write_shift(4,ne),W.write_shift(2,0),$t([$t(O),$t(B),W])}var bt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Xt(P,F){if(P.ctype)return P.ctype;var N=P.name||"",O=N.match(/\.([^\.]+)$/);return O&&bt[O[1]]||F&&(O=(N=F).match(/[\.\\]([^\.\\])+$/),O&&bt[O[1]])?bt[O[1]]:"application/octet-stream"}function Cn(P){for(var F=qc(P),N=[],O=0;O<F.length;O+=76)N.push(F.slice(O,O+76));return N.join(`\r
`)+`\r
`}function br(P){var F=P.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(se){var ne=se.charCodeAt(0).toString(16).toUpperCase();return"="+(ne.length==1?"0"+ne:ne)});F=F.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),F.charAt(0)==`
`&&(F="=0D"+F.slice(1)),F=F.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var N=[],O=F.split(`\r
`),B=0;B<O.length;++B){var W=O[B];if(W.length==0){N.push("");continue}for(var re=0;re<W.length;){var ie=76,te=W.slice(re,re+ie);te.charAt(ie-1)=="="?ie--:te.charAt(ie-2)=="="?ie-=2:te.charAt(ie-3)=="="&&(ie-=3),te=W.slice(re,re+ie),re+=ie,re<W.length&&(te+="="),N.push(te)}}return N.join(`\r
`)}function or(P){for(var F=[],N=0;N<P.length;++N){for(var O=P[N];N<=P.length&&O.charAt(O.length-1)=="=";)O=O.slice(0,O.length-1)+P[++N];F.push(O)}for(var B=0;B<F.length;++B)F[B]=F[B].replace(/[=][0-9A-Fa-f]{2}/g,function(W){return String.fromCharCode(parseInt(W.slice(1),16))});return Br(F.join(`\r
`))}function Kr(P,F,N){for(var O="",B="",W="",re,ie=0;ie<10;++ie){var te=F[ie];if(!te||te.match(/^\s*$/))break;var se=te.match(/^(.*?):\s*([^\s].*)$/);if(se)switch(se[1].toLowerCase()){case"content-location":O=se[2].trim();break;case"content-type":W=se[2].trim();break;case"content-transfer-encoding":B=se[2].trim();break}}switch(++ie,B.toLowerCase()){case"base64":re=Br(Vs(F.slice(ie).join("")));break;case"quoted-printable":re=or(F.slice(ie));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+B)}var ne=Sr(P,O.slice(N.length),re,{unsafe:!0});W&&(ne.ctype=W)}function ps(P,F){if(Q(P.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var N=F&&F.root||"",O=(lt&&Buffer.isBuffer(P)?P.toString("binary"):Q(P)).split(`\r
`),B=0,W="";for(B=0;B<O.length;++B)if(W=O[B],!!/^Content-Location:/i.test(W)&&(W=W.slice(W.indexOf("file")),N||(N=W.slice(0,W.lastIndexOf("/")+1)),W.slice(0,N.length)!=N))for(;N.length>0&&(N=N.slice(0,N.length-1),N=N.slice(0,N.lastIndexOf("/")+1),W.slice(0,N.length)!=N););var re=(O[1]||"").match(/boundary="(.*?)"/);if(!re)throw new Error("MAD cannot find boundary");var ie="--"+(re[1]||""),te=[],se=[],ne={FileIndex:te,FullPaths:se};S(ne);var pe,_e=0;for(B=0;B<O.length;++B){var Te=O[B];Te!==ie&&Te!==ie+"--"||(_e++&&Kr(ne,O.slice(pe,B),N),pe=B)}return ne}function Mt(P,F){var N=F||{},O=N.boundary||"SheetJS";O="------="+O;for(var B=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+O.slice(2)+'"',"","",""],W=P.FullPaths[0],re=W,ie=P.FileIndex[0],te=1;te<P.FullPaths.length;++te)if(re=P.FullPaths[te].slice(W.length),ie=P.FileIndex[te],!(!ie.size||!ie.content||re=="Sh33tJ5")){re=re.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Be){return"_x"+Be.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Be){return"_u"+Be.charCodeAt(0).toString(16)+"_"});for(var se=ie.content,ne=lt&&Buffer.isBuffer(se)?se.toString("binary"):Q(se),pe=0,_e=Math.min(1024,ne.length),Te=0,xe=0;xe<=_e;++xe)(Te=ne.charCodeAt(xe))>=32&&Te<128&&++pe;var be=pe>=_e*4/5;B.push(O),B.push("Content-Location: "+(N.root||"file:///C:/SheetJS/")+re),B.push("Content-Transfer-Encoding: "+(be?"quoted-printable":"base64")),B.push("Content-Type: "+Xt(ie,re)),B.push(""),B.push(be?br(ne):Cn(ne))}return B.push(O+`--\r
`),B.join(`\r
`)}function kn(P){var F={};return S(F,P),F}function Sr(P,F,N,O){var B=O&&O.unsafe;B||S(P);var W=!B&&pt.find(P,F);if(!W){var re=P.FullPaths[0];F.slice(0,re.length)==re?re=F:(re.slice(-1)!="/"&&(re+="/"),re=(re+F).replace("//","/")),W={name:s(F),type:2},P.FileIndex.push(W),P.FullPaths.push(re),B||pt.utils.cfb_gc(P)}return W.content=N,W.size=N?N.length:0,O&&(O.CLSID&&(W.clsid=O.CLSID),O.mt&&(W.mt=O.mt),O.ct&&(W.ct=O.ct)),W}function ln(P,F){S(P);var N=pt.find(P,F);if(N){for(var O=0;O<P.FileIndex.length;++O)if(P.FileIndex[O]==N)return P.FileIndex.splice(O,1),P.FullPaths.splice(O,1),!0}return!1}function ia(P,F,N){S(P);var O=pt.find(P,F);if(O){for(var B=0;B<P.FileIndex.length;++B)if(P.FileIndex[B]==O)return P.FileIndex[B].name=s(N),P.FullPaths[B]=N,!0}return!1}function oa(P){C(P,!0)}return t.find=M,t.read=k,t.parse=d,t.write=fe,t.writeFile=Y,t.utils={cfb_new:kn,cfb_add:Sr,cfb_del:ln,cfb_mov:ia,cfb_gc:oa,ReadShift:Io,CheckField:Ly,prep_blob:fr,bconcat:$t,use_zlib:X,_deflateRaw:Gr,_inflateRaw:Oe,consts:q},t}(),TR;function CR(e){return typeof e=="string"?sd(e):Array.isArray(e)?qj(e):e}function Ol(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=sd(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?rl(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([CR(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=e,i.href=a,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Na(t)),o.write(t),o.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function Ut(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Tp(e,t){for(var r=[],n=Ut(e),s=0;s!==n.length;++s)r[e[n[s]][t]]==null&&(r[e[n[s]][t]]=n[s]);return r}function h0(e){for(var t=[],r=Ut(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function od(e){for(var t=[],r=Ut(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function kR(e){for(var t=[],r=Ut(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var tu=new Date(1899,11,30,0,0,0);function vr(e,t){var r=e.getTime();t&&(r-=1462*24*60*60*1e3);var n=tu.getTime()+(e.getTimezoneOffset()-tu.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var _y=new Date,PR=tu.getTime()+(_y.getTimezoneOffset()-tu.getTimezoneOffset())*6e4,Cp=_y.getTimezoneOffset();function by(e){var t=new Date;return t.setTime(e*24*60*60*1e3+PR),t.getTimezoneOffset()!==Cp&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Cp)*6e4),t}var kp=new Date("2017-02-19T19:06:09.000Z"),Sy=isNaN(kp.getFullYear())?new Date("2/19/17"):kp,AR=Sy.getFullYear()==2017;function Pr(e,t){var r=new Date(e);if(AR)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(Sy.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function m0(e,t){if(lt&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function yr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=yr(e[r]));return t}function kt(e,t){for(var r="";r.length<t;)r+=e;return r}function is(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var NR=/^(0?\d|1[0-2])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))\s+([ap])m?$/;function DR(e){return e[2]?e[3]?e[4]?new Date(1899,11,30,+e[1]%12+(e[7]=="p"?12:0),+e[2],+e[4],parseFloat(e[3])*1e3):new Date(1899,11,30,e[7]=="p"?12:0,+e[1],+e[2],parseFloat(e[3])*1e3):e[5]?new Date(1899,11,30,+e[1]%12+(e[7]=="p"?12:0),+e[2],+e[5],e[6]?parseFloat(e[6])*1e3:0):new Date(1899,11,30,+e[1]%12+(e[7]=="p"?12:0),+e[2],0,0):new Date(1899,11,30,+e[1]%12+(e[7]=="p"?12:0),0,0,0)}var jR=["january","february","march","april","may","june","july","august","september","october","november","december"];function tl(e){var t=e.toLowerCase(),r=t.replace(/\s+/g," ").trim(),n=r.match(NR);if(n)return DR(n);var s=new Date(e),a=new Date(NaN),i=s.getYear();s.getMonth();var o=s.getDate();if(isNaN(o))return a;if(t.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(t=t.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),t.length>3&&jR.indexOf(t)==-1)return a}else if(t.replace(/[ap]m?/,"").match(/[a-z]/))return a;return i<0||i>8099||e.match(/[^-0-9:,\/\\]/)?a:s}function He(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return lt?n=zn(r):n=Jj(r),pt.utils.cfb_add(e,t,n)}pt.utils.cfb_add(e,t,r)}else e.file(t,r)}function p0(){return pt.utils.cfb_new()}var It=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,RR={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},g0=h0(RR),x0=/[&<>'"]/g,OR=/[\u0000-\u0008\u000b-\u001f\uFFFE-\uFFFF]/g;function Ue(e){var t=e+"";return t.replace(x0,function(r){return g0[r]}).replace(OR,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Pp(e){return Ue(e).replace(/ /g,"_x0020_")}var Ey=/[\u0000-\u001f]/g;function Ap(e){var t=e+"";return t.replace(x0,function(r){return g0[r]}).replace(/\n/g,"<br/>").replace(Ey,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function IR(e){var t=e+"";return t.replace(x0,function(r){return g0[r]}).replace(Ey,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function MR(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function FR(e){switch(e){case 1:case!0:case"1":case"true":return!0;case 0:case!1:case"0":case"false":return!1}return!1}function ef(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=s&63,t+=String.fromCharCode(i);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(a&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function Np(e){var t=Aa(2*e.length),r,n,s=1,a=0,i=0,o;for(n=0;n<e.length;n+=s)s=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[a++]=i&255,t[a++]=i>>>8,i=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function Dp(e){return zn(e,"binary").toString("utf8")}var dc="foo bar bazâð£",vi=lt&&(Dp(dc)==ef(dc)&&Dp||Np(dc)==ef(dc)&&Np)||ef,rl=lt?function(e){return zn(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},LR=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}}(),Ty=/(^\s|\s$|\n)/;function Qt(e,t){return"<"+e+(t.match(Ty)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function nl(e){return Ut(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function ve(e,t,r){return"<"+e+(r!=null?nl(r):"")+(t!=null?(t.match(Ty)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Jf(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function BR(e,t){switch(typeof e){case"string":var r=ve("vt:lpwstr",Ue(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return ve((e|0)==e?"vt:i4":"vt:r8",Ue(String(e)));case"boolean":return ve("vt:bool",e?"true":"false")}if(e instanceof Date)return ve("vt:filetime",Jf(e));throw new Error("Unable to serialize "+e)}var Gt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},eo=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],$r={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function $R(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,a=5;a>=0;--a)s=s*256+e[t+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function WR(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,a=0,i=n?-t:t;isFinite(i)?i==0?s=a=0:(s=Math.floor(Math.log(i)/Math.LN2),a=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)e[r+o]=a&255;e[r+6]=(s&15)<<4|a&15,e[r+7]=s>>4|n}var jp=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,a=e[0][n].length;s<a;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},Rp=lt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:zn(t)})):jp(e)}:jp,Op=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(bo(e,s)));return n.join("").replace(Oo,"")},v0=lt?function(e,t,r){return!Buffer.isBuffer(e)||!Jc?Op(e,t,r):e.toString("utf16le",t,r).replace(Oo,"")}:Op,Ip=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},Cy=lt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Ip(e,t,r)}:Ip,Mp=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(di(e,s)));return n.join("")},Il=lt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Mp(t,r,n)}:Mp,ky=function(e,t){var r=Wr(e,t);return r>0?Il(e,t+4,t+4+r-1):""},Py=ky,Ay=function(e,t){var r=Wr(e,t);return r>0?Il(e,t+4,t+4+r-1):""},Ny=Ay,Dy=function(e,t){var r=2*Wr(e,t);return r>0?Il(e,t+4,t+4+r-1):""},jy=Dy,Ry=function(t,r){var n=Wr(t,r);return n>0?v0(t,r+4,r+4+n):""},Oy=Ry,Iy=function(e,t){var r=Wr(e,t);return r>0?Il(e,t+4,t+4+r):""},My=Iy,Fy=function(e,t){return $R(e,t)},ru=Fy,y0=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};lt&&(Py=function(t,r){if(!Buffer.isBuffer(t))return ky(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Ny=function(t,r){if(!Buffer.isBuffer(t))return Ay(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},jy=function(t,r){if(!Buffer.isBuffer(t)||!Jc)return Dy(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},Oy=function(t,r){if(!Buffer.isBuffer(t)||!Jc)return Ry(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},My=function(t,r){if(!Buffer.isBuffer(t))return Iy(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},ru=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Fy(t,r)},y0=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var di=function(e,t){return e[t]},bo=function(e,t){return e[t+1]*256+e[t]},UR=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Wr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},ma=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},VR=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Io(e,t){var r="",n,s,a=[],i,o,c,u;switch(t){case"dbcs":if(u=this.l,lt&&Buffer.isBuffer(this)&&Jc)r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(bo(this,u)),u+=2;e*=2;break;case"utf8":r=Il(this,this.l,this.l+e);break;case"utf16le":e*=2,r=v0(this,this.l,this.l+e);break;case"wstr":return Io.call(this,e,"dbcs");case"lpstr-ansi":r=Py(this,this.l),e=4+Wr(this,this.l);break;case"lpstr-cp":r=Ny(this,this.l),e=4+Wr(this,this.l);break;case"lpwstr":r=jy(this,this.l),e=4+2*Wr(this,this.l);break;case"lpp4":e=4+Wr(this,this.l),r=Oy(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Wr(this,this.l),r=My(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=di(this,this.l+e++))!==0;)a.push(lc(i));r=a.join("");break;case"_wstr":for(e=0,r="";(i=bo(this,this.l+e))!==0;)a.push(lc(i)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return i=di(this,u),this.l=u+1,o=Io.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(lc(bo(this,u))),u+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return i=di(this,u),this.l=u+1,o=Io.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(lc(di(this,u))),u+=1}r=a.join("");break;default:switch(e){case 1:return n=di(this,this.l),this.l++,n;case 2:return n=(t==="i"?UR:bo)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?ma:VR)(this,this.l),this.l+=4,n):(s=Wr(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=ru(this,this.l):s=ru([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=Cy(this,this.l,e);break}}return this.l+=e,r}var HR=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},zR=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},GR=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function KR(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)GR(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"||r=="cpstr"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var i=t.charCodeAt(s);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,HR(this,t,this.l);break;case 8:if(n=8,r==="f"){WR(this,t,this.l);break}case 16:break;case-4:n=4,zR(this,t,this.l);break}return this.l+=n,this}function Ly(e,t){var r=Cy(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function fr(e,t){e.l=t,e.read_shift=Io,e.chk=Ly,e.write_shift=KR}function Un(e,t){e.l+=t}function ae(e){var t=Aa(e);return fr(t,0),t}function kr(){var e=[],t=lt?256:2048,r=function(u){var d=ae(u);return fr(d,0),d},n=r(t),s=function(){n&&(n.l&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n)),n=null)},a=function(u){return n&&u<n.length-n.l?n:(s(),n=r(Math.max(u+1,t)))},i=function(){return s(),$t(e)},o=function(u){s(),n=u,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:o,end:i,_bufs:e}}function ce(e,t,r,n){var s=+t,a;if(!isNaN(s)){n||(n=r3[s].p||(r||[]).length||0),a=1+(s>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var i=e.next(a);s<=127?i.write_shift(1,s):(i.write_shift(1,(s&127)+128),i.write_shift(1,s>>7));for(var o=0;o!=4;++o)if(n>=128)i.write_shift(1,(n&127)+128),n>>=7;else{i.write_shift(1,n);break}n>0&&y0(r)&&e.push(r)}}function Mo(e,t,r){var n=yr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Fp(e,t,r){var n=yr(e);return n.s=Mo(n.s,t.s,r),n.e=Mo(n.e,t.s,r),n}function Fo(e,t){if(e.cRel&&e.c<0)for(e=yr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=yr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Tt(e);return!e.cRel&&e.cRel!=null&&(r=qR(r)),!e.rRel&&e.rRel!=null&&(r=YR(r)),r}function tf(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+xt(e.s.c)+":"+(e.e.cRel?"":"$")+xt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+gt(e.s.r)+":"+(e.e.rRel?"":"$")+gt(e.e.r):Fo(e.s,t.biff)+":"+Fo(e.e,t.biff)}function w0(e){return parseInt(XR(e),10)-1}function gt(e){return""+(e+1)}function YR(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function XR(e){return e.replace(/\$(\d+)$/,"$1")}function _0(e){for(var t=JR(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function xt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function qR(e){return e.replace(/^([A-Z])/,"$$$1")}function JR(e){return e.replace(/^\$([A-Z])/,"$1")}function QR(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function _t(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function Tt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Zt(e){var t=e.indexOf(":");return t==-1?{s:_t(e),e:_t(e)}:{s:_t(e.slice(0,t)),e:_t(e.slice(t+1))}}function Ot(e,t){return typeof t>"u"||typeof t=="number"?Ot(e.s,e.e):(typeof e!="string"&&(e=Tt(e)),typeof t!="string"&&(t=Tt(t)),e==t?e:e+":"+t)}function sl(e){var t=Zt(e);return"$"+xt(t.s.c)+"$"+gt(t.s.r)+":$"+xt(t.e.c)+"$"+gt(t.e.r)}function al(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e.replace(/'/g,"''")+"'":e}function yt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=e.length;for(r=0;n<a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===a||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function Lp(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=fs(e.z,r?vr(t):t)}catch{}try{return e.w=fs((e.XF||{}).numFmtId||(r?14:0),r?vr(t):t)}catch{return""+t}}function hs(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Ml[e.v]||e.v:t==null?Lp(e,e.v):Lp(e,t))}function to(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function By(e,t,r){var n=r||{},s=e?e["!data"]!=null:n.dense,a=e||{};s&&!a["!data"]&&(a["!data"]=[]);var i=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?_t(n.origin):n.origin;i=c.r,o=c.c}a["!ref"]||(a["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var d=yt(a["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),i==-1&&(u.e.r=i=d.e.r+1)}for(var f=[],h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");var p=i+h,v=""+(p+1);s&&(a["!data"][p]||(a["!data"][p]=[]),f=a["!data"][p]);for(var g=0;g!=t[h].length;++g)if(!(typeof t[h][g]>"u")){var x={v:t[h][g]},y=o+g;if(u.s.r>p&&(u.s.r=p),u.s.c>y&&(u.s.c=y),u.e.r<p&&(u.e.r=p),u.e.c<y&&(u.e.c=y),t[h][g]&&typeof t[h][g]=="object"&&!Array.isArray(t[h][g])&&!(t[h][g]instanceof Date))x=t[h][g];else if(Array.isArray(x.v)&&(x.f=t[h][g][1],x.v=x.v[0]),x.v===null)if(x.f)x.t="n";else if(n.nullError)x.t="e",x.v=0;else if(n.sheetStubs)x.t="z";else continue;else typeof x.v=="number"?x.t="n":typeof x.v=="boolean"?x.t="b":x.v instanceof Date?(x.z=n.dateNF||Pt[14],n.cellDates?(x.t="d",x.w=fs(x.z,vr(x.v,n.date1904))):(x.t="n",x.v=vr(x.v,n.date1904),x.w=fs(x.z,x.v))):x.t="s";if(s)f[y]&&f[y].z&&(x.z=f[y].z),f[y]=x;else{var w=xt(y)+v;a[w]&&a[w].z&&(x.z=a[w].z),a[w]=x}}}return u.s.c<1e7&&(a["!ref"]=Ot(u)),a}function ro(e,t){return By(null,e,t)}function ZR(e){return e.read_shift(4,"i")}function xn(e,t){return t||(t=ae(4)),t.write_shift(4,e),t}function ir(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Wt(e,t){var r=!1;return t==null&&(r=!0,t=ae(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function e4(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function t4(e,t){return t||(t=ae(4)),t.write_shift(2,0),t.write_shift(2,0),t}function b0(e,t){var r=e.l,n=e.read_shift(1),s=ir(e),a=[],i={t:s,h:s};if(n&1){for(var o=e.read_shift(4),c=0;c!=o;++c)a.push(e4(e));i.r=a}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}function r4(e,t){var r=!1;return t==null&&(r=!0,t=ae(15+4*e.t.length)),t.write_shift(1,0),Wt(e.t,t),r?t.slice(0,t.l):t}var n4=b0;function s4(e,t){var r=!1;return t==null&&(r=!0,t=ae(23+4*e.t.length)),t.write_shift(1,1),Wt(e.t,t),t.write_shift(4,1),t4({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function an(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Ua(e,t){return t==null&&(t=ae(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Va(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Ha(e,t){return t==null&&(t=ae(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var a4=ir,$y=Wt;function S0(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function il(e,t){var r=!1;return t==null&&(r=!0,t=ae(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var i4=ir,Qf=S0,E0=il;function Wy(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?ru([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):ma(t,0)>>2;return r?s/100:s}function Uy(e,t){t==null&&(t=ae(4));var r=0,n=0,s=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?n=1:s==(s|0)&&s>=-(1<<29)&&s<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function Vy(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function o4(e,t){return t||(t=ae(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var za=Vy,no=o4;function so(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Da(e,t){return(t||ae(8)).write_shift(8,e,"f")}function l4(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),a=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var u=x4[s];u&&(t.rgb=qp(u));break;case 2:t.rgb=qp([i,o,c]);break;case 3:t.theme=s;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function nu(e,t){if(t||(t=ae(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function c4(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function u4(e,t){t||(t=ae(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var Hy=2,Mr=3,fc=11,su=19,hc=64,d4=65,f4=71,h4=4108,m4=4126,qt=80,Bp={1:{n:"CodePage",t:Hy},2:{n:"Category",t:qt},3:{n:"PresentationFormat",t:qt},4:{n:"ByteCount",t:Mr},5:{n:"LineCount",t:Mr},6:{n:"ParagraphCount",t:Mr},7:{n:"SlideCount",t:Mr},8:{n:"NoteCount",t:Mr},9:{n:"HiddenCount",t:Mr},10:{n:"MultimediaClipCount",t:Mr},11:{n:"ScaleCrop",t:fc},12:{n:"HeadingPairs",t:h4},13:{n:"TitlesOfParts",t:m4},14:{n:"Manager",t:qt},15:{n:"Company",t:qt},16:{n:"LinksUpToDate",t:fc},17:{n:"CharacterCount",t:Mr},19:{n:"SharedDoc",t:fc},22:{n:"HyperlinksChanged",t:fc},23:{n:"AppVersion",t:Mr,p:"version"},24:{n:"DigSig",t:d4},26:{n:"ContentType",t:qt},27:{n:"ContentStatus",t:qt},28:{n:"Language",t:qt},29:{n:"Version",t:qt},255:{},2147483648:{n:"Locale",t:su},2147483651:{n:"Behavior",t:su},1919054434:{}},$p={1:{n:"CodePage",t:Hy},2:{n:"Title",t:qt},3:{n:"Subject",t:qt},4:{n:"Author",t:qt},5:{n:"Keywords",t:qt},6:{n:"Comments",t:qt},7:{n:"Template",t:qt},8:{n:"LastAuthor",t:qt},9:{n:"RevNumber",t:qt},10:{n:"EditTime",t:hc},11:{n:"LastPrinted",t:hc},12:{n:"CreatedDate",t:hc},13:{n:"ModifiedDate",t:hc},14:{n:"PageCount",t:Mr},15:{n:"WordCount",t:Mr},16:{n:"CharCount",t:Mr},17:{n:"Thumbnail",t:f4},18:{n:"Application",t:qt},19:{n:"DocSecurity",t:Mr},255:{},2147483648:{n:"Locale",t:su},2147483651:{n:"Behavior",t:su},1919054434:{}};function p4(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var g4=p4([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,0,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),x4=yr(g4),Ml={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},v4={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},y4=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"],w4={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},mc={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function zy(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Gy(e,t,r){var n=kR(w4),s=[],a;s[s.length]=It,s[s.length]=ve("Types",null,{xmlns:Gt.CT,"xmlns:xsd":Gt.xsd,"xmlns:xsi":Gt.xsi}),s=s.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(u){return ve("Default",null,{Extension:u[0],ContentType:u[1]})}));var i=function(u){e[u]&&e[u].length>0&&(a=e[u][0],s[s.length]=ve("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:mc[u][t.bookType]||mc[u].xlsx}))},o=function(u){(e[u]||[]).forEach(function(d){s[s.length]=ve("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:mc[u][t.bookType]||mc[u].xlsx})})},c=function(u){(e[u]||[]).forEach(function(d){s[s.length]=ve("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:n[u][0]})})};return i("workbooks"),o("sheets"),o("charts"),c("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),o("metadata"),c("people"),s.length>2&&(s[s.length]="</Types>",s[1]=s[1].replace("/>",">")),s.join("")}var tt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",CONN:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/connections",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Ky(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function yi(e){var t=[It,ve("Relationships",null,{xmlns:Gt.RELS})];return Ut(e["!id"]).forEach(function(r){t[t.length]=ve("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function ft(e,t,r,n,s,a){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=n,s.Target=r,[tt.HLINK,tt.XPATH,tt.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}function _4(e){var t=[It];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Wp(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function b4(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function S4(e){var t=[It];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Wp(e[r][0],e[r][1])),t.push(b4("",e[r][0]));return t.push(Wp("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function Yy(e,t){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Xc.version+"</meta:generator></office:meta></office:document-meta>"}var wa=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function rf(e,t,r,n,s){s[e]!=null||t==null||t===""||(s[e]=t,t=Ue(t),n[n.length]=r?ve(e,t,r):Qt(e,t))}function Xy(e,t){var r=t||{},n=[It,ve("cp:coreProperties",null,{"xmlns:cp":Gt.CORE_PROPS,"xmlns:dc":Gt.dc,"xmlns:dcterms":Gt.dcterms,"xmlns:dcmitype":Gt.dcmitype,"xmlns:xsi":Gt.xsi})],s={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&rf("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Jf(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&rf("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Jf(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var a=0;a!=wa.length;++a){var i=wa[a],o=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:e?e[i[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&rf(i[0],o,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var wi=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],qy=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Jy(e){var t=[],r=ve;return e||(e={}),e.Application="SheetJS",t[t.length]=It,t[t.length]=ve("Properties",null,{xmlns:Gt.EXT_PROPS,"xmlns:vt":Gt.vt}),wi.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=Ue(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(n[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Ue(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function Qy(e){var t=[It,ve("Properties",null,{xmlns:Gt.CUST_PROPS,"xmlns:vt":Gt.vt})];if(!e)return t.join("");var r=1;return Ut(e).forEach(function(s){++r,t[t.length]=ve("property",BR(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Ue(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Up={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function E4(e,t){var r=[];return Ut(Up).map(function(n){for(var s=0;s<wa.length;++s)if(wa[s][1]==n)return wa[s];for(s=0;s<wi.length;++s)if(wi[s][1]==n)return wi[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(Qt(Up[n[1]]||n[1],s))}}),ve("DocumentProperties",r.join(""),{xmlns:$r.o})}function T4(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&Ut(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)){for(var i=0;i<wa.length;++i)if(a==wa[i][1])return;for(i=0;i<wi.length;++i)if(a==wi[i][1])return;for(i=0;i<r.length;++i)if(a==r[i])return;var o=e[a],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),s.push(ve(Pp(a),o,{"dt:dt":c}))}}),t&&Ut(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)&&!(e&&Object.prototype.hasOwnProperty.call(e,a))){var i=t[a],o="string";typeof i=="number"?(o="float",i=String(i)):i===!0||i===!1?(o="boolean",i=i?"1":"0"):i instanceof Date?(o="dateTime.tz",i=i.toISOString()):i=String(i),s.push(ve(Pp(a),i,{"dt:dt":o}))}}),"<"+n+' xmlns="'+$r.o+'">'+s.join("")+"</"+n+">"}function C4(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),s+=a);var i=ae(8);return i.write_shift(4,n),i.write_shift(4,s),i}function Vp(e,t){var r=ae(4),n=ae(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=ae(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=C4(t);break;case 31:case 80:for(n=ae(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return $t([r,n])}var Zy=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function k4(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Hp(e,t,r){var n=ae(8),s=[],a=[],i=8,o=0,c=ae(8),u=ae(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),a.push(c),s.push(u),i+=8+c.length,!t){u=ae(8),u.write_shift(4,0),s.unshift(u);var d=[ae(4)];for(d[0].write_shift(4,e.length),o=0;o<e.length;++o){var f=e[o][0];for(c=ae(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=$t(d),a.unshift(c),i+=8+c.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(Zy.indexOf(e[o][0])>-1||qy.indexOf(e[o][0])>-1)&&e[o][1]!=null){var h=e[o][1],p=0;if(t){p=+t[e[o][0]];var v=r[p];if(v.p=="version"&&typeof h=="string"){var g=h.split(".");h=(+g[0]<<16)+(+g[1]||0)}c=Vp(v.t,h)}else{var x=k4(h);x==-1&&(x=31,h=String(h)),c=Vp(x,h)}a.push(c),u=ae(8),u.write_shift(4,t?p:2+o),s.push(u),i+=8+c.length}var y=8*(a.length+1);for(o=0;o<a.length;++o)s[o].write_shift(4,y),y+=a[o].length;return n.write_shift(4,i),n.write_shift(4,a.length),$t([n].concat(s).concat(a))}function zp(e,t,r,n,s,a){var i=ae(s?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,pt.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,s?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,s?68:48);var c=Hp(e,r,n);if(o.push(c),s){var u=Hp(s,null,null);i.write_shift(16,a,"hex"),i.write_shift(4,68+c.length),o.push(u)}return $t(o)}function P4(e,t){t||(t=ae(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function A4(e,t){return e.read_shift(t)===1}function dr(e,t){return t||(t=ae(2)),t.write_shift(2,+!!e),t}function Zf(e){return e.read_shift(2,"u")}function Jr(e,t){return t||(t=ae(2)),t.write_shift(2,e),t}function ew(e,t,r){return r||(r=ae(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function tw(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont",a=ts;if(r&&r.biff>=8&&(ts=1200),!r||r.biff==8){var i=e.read_shift(1);i&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var o=n?e.read_shift(n,s):"";return ts=a,o}function N4(e){var t=e.t||"",r=ae(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=ae(2*t.length);n.write_shift(2*t.length,t,"utf16le");var s=[r,n];return $t(s)}function D4(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function j4(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):D4(e,n,r)}function R4(e,t,r){if(r.biff>5)return j4(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function rw(e,t,r){return r||(r=ae(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function Gp(e,t){t||(t=ae(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function O4(e){var t=ae(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),a=s>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}t.write_shift(4,2),t.write_shift(4,a);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(a==28)n=n.slice(1),Gp(n,t);else if(a&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var o=s>-1?n.slice(0,s):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),a&8&&Gp(s>-1?n.slice(s+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function ja(e,t,r,n){return n||(n=ae(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function I4(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),a=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[s,a,i]}function M4(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function nw(e,t){return t||(t=ae(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function T0(e,t,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=ae(s);return a.write_shift(2,n),a.write_shift(2,t),s>4&&a.write_shift(2,29282),s>6&&a.write_shift(2,1997),s>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function F4(e,t){var r=!t||t.biff==8,n=ae(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function L4(e,t){var r=!t||t.biff>=8?2:1,n=ae(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function B4(e,t){var r=ae(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=N4(e[s]);var a=$t([r].concat(n));return a.parts=[r.length].concat(n.map(function(i){return i.length})),a}function $4(){var e=ae(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function W4(e){var t=ae(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function U4(e,t){var r=e.name||"Arial",n=t&&t.biff==5,s=n?15+r.length:16+2*r.length,a=ae(s);return a.write_shift(2,(e.sz||12)*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),a}function V4(e,t,r,n){var s=ae(10);return ja(e,t,n,s),s.write_shift(4,r),s}function H4(e,t,r,n,s){var a=!s||s.biff==8,i=ae(8+ +a+(1+a)*r.length);return ja(e,t,n,i),i.write_shift(2,r.length),a&&i.write_shift(1,1),i.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),i}function z4(e,t,r,n){var s=r&&r.biff==5;n||(n=ae(s?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(s?1:2,t.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}function G4(e,t){var r=t.biff==8||!t.biff?4:2,n=ae(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function Kp(e,t,r,n){var s=r&&r.biff==5;n||(n=ae(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var a=0;return e.numFmtId>0&&s&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function K4(e){var t=ae(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Y4(e,t,r,n,s,a){var i=ae(8);return ja(e,t,n,i),ew(r,a,i),i}function X4(e,t,r,n){var s=ae(14);return ja(e,t,n,s),Da(r,s),s}function q4(e,t,r){if(r.biff<8||!(r.biff>8)&&t==e[e.l]+(e[e.l+1]==3?1:0)+1)return Yp(e,t,r);for(var n=[],s=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(I4(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function Yp(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=tw(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function J4(e){var t=ae(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)nw(e[r],t);return t}function Q4(e){var t=ae(24),r=_t(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(n[s],16));return $t([t,O4(e[1])])}function Z4(e){var t=e[1].Tooltip,r=ae(10+2*(t.length+1));r.write_shift(2,2048);var n=_t(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function eO(e){return e||(e=ae(4)),e.write_shift(2,1),e.write_shift(2,1),e}function tO(e,t,r){if(!r.cellStyles)return Un(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),a=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var u={s,e:a,w:i,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function rO(e,t){var r=ae(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function nO(e){for(var t=ae(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function sO(e,t,r){var n=ae(15);return Ll(n,e,t),n.write_shift(8,r,"f"),n}function aO(e,t,r){var n=ae(9);return Ll(n,e,t),n.write_shift(2,r),n}var iO=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=h0({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var u=[],d=Aa(1);switch(c.type){case"base64":d=Br(Vs(o));break;case"binary":d=Br(o);break;case"buffer":case"array":d=o;break}fr(d,0);var f=d.read_shift(1),h=!!(f&136),p=!1,v=!1;switch(f){case 2:break;case 3:break;case 48:p=!0,h=!0;break;case 49:p=!0,h=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var g=0,x=521;f==2&&(g=d.read_shift(2)),d.l+=3,f!=2&&(g=d.read_shift(4)),g>1048576&&(g=1e6),f!=2&&(x=d.read_shift(2));var y=d.read_shift(2);c.codepage,f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&e[d[d.l]],d.l+=1,d.l+=2),v&&(d.l+=36);for(var w=[],_={},b=Math.min(d.length,f==2?521:x-10-(p?264:0)),T=v?32:11;d.l<b&&d[d.l]!=13;)switch(_={},_.name=Na(d.slice(d.l,d.l+T)).replace(/[\u0000\r\n].*$/g,""),d.l+=T,_.type=String.fromCharCode(d.read_shift(1)),f!=2&&!v&&(_.offset=d.read_shift(4)),_.len=d.read_shift(1),f==2&&(_.offset=d.read_shift(2)),_.dec=d.read_shift(1),_.name.length&&w.push(_),f!=2&&(d.l+=v?13:14),_.type){case"B":(!p||_.len!=8)&&c.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+_.type)}if(d[d.l]!==13&&(d.l=x-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=x;var k=0,S=0;for(u[0]=[],S=0;S!=w.length;++S)u[0][S]=w[S].name;for(;g-- >0;){if(d[d.l]===42){d.l+=y;continue}for(++d.l,u[++k]=[],S=0,S=0;S!=w.length;++S){var E=d.slice(d.l,d.l+w[S].len);d.l+=w[S].len,fr(E,0);var C=Na(E);switch(w[S].type){case"C":C.trim().length&&(u[k][S]=C.replace(/\s+$/,""));break;case"D":C.length===8?u[k][S]=new Date(+C.slice(0,4),+C.slice(4,6)-1,+C.slice(6,8)):u[k][S]=C;break;case"F":u[k][S]=parseFloat(C.trim());break;case"+":case"I":u[k][S]=v?E.read_shift(-4,"i")^2147483648:E.read_shift(4,"i");break;case"L":switch(C.trim().toUpperCase()){case"Y":case"T":u[k][S]=!0;break;case"N":case"F":u[k][S]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+C+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[k][S]="##MEMO##"+(v?parseInt(C.trim(),10):E.read_shift(4));break;case"N":C=C.replace(/\u0000/g,"").trim(),C&&C!="."&&(u[k][S]=+C||0);break;case"@":u[k][S]=new Date(E.read_shift(-8,"f")-621356832e5);break;case"T":u[k][S]=new Date((E.read_shift(4)-2440588)*864e5+E.read_shift(4));break;case"Y":u[k][S]=E.read_shift(4,"i")/1e4+E.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[k][S]=-E.read_shift(-8,"f");break;case"B":if(p&&w[S].len==8){u[k][S]=E.read_shift(8,"f");break}case"G":case"P":E.l+=w[S].len;break;case"0":if(w[S].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[S].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=w,u}function n(o,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=ro(r(o,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function s(o,c){try{var u=to(n(o,c),c);return u.bookType="dbf",u}catch(d){if(c&&c.WTF)throw d}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,c){var u=c||{},d=ts;if(+u.codepage>=0&&el(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var f=kr(),h=fu(o,{header:1,raw:!0,cellDates:!0}),p=h[0],v=h.slice(1),g=o["!cols"]||[],x=0,y=0,w=0,_=1;for(x=0;x<p.length;++x){if(((g[x]||{}).DBF||{}).name){p[x]=g[x].DBF.name,++w;continue}if(p[x]!=null){if(++w,typeof p[x]=="number"&&(p[x]=p[x].toString(10)),typeof p[x]!="string")throw new Error("DBF Invalid column name "+p[x]+" |"+typeof p[x]+"|");if(p.indexOf(p[x])!==x){for(y=0;y<1024;++y)if(p.indexOf(p[x]+"_"+y)==-1){p[x]+="_"+y;break}}}}var b=yt(o["!ref"]),T=[],k=[],S=[];for(x=0;x<=b.e.c-b.s.c;++x){var E="",C="",L=0,M=[];for(y=0;y<v.length;++y)v[y][x]!=null&&M.push(v[y][x]);if(M.length==0||p[x]==null){T[x]="?";continue}for(y=0;y<M.length;++y){switch(typeof M[y]){case"number":C="B";break;case"string":C="C";break;case"boolean":C="L";break;case"object":C=M[y]instanceof Date?"D":"C";break;default:C="C"}L=Math.max(L,String(M[y]).length),E=E&&E!=C?"C":C}L>250&&(L=250),C=((g[x]||{}).DBF||{}).type,C=="C"&&g[x].DBF.len>L&&(L=g[x].DBF.len),E=="B"&&C=="N"&&(E="N",S[x]=g[x].DBF.dec,L=g[x].DBF.len),k[x]=E=="C"||C=="N"?L:a[E]||0,_+=k[x],T[x]=E}var j=f.next(32);for(j.write_shift(4,318902576),j.write_shift(4,v.length),j.write_shift(2,296+32*w),j.write_shift(2,_),x=0;x<4;++x)j.write_shift(4,0);var V=+t[ts]||3;for(j.write_shift(4,0|V<<8),e[V]!=+u.codepage&&(u.codepage&&console.error("DBF Unsupported codepage "+ts+", using 1252"),ts=1252),x=0,y=0;x<p.length;++x)if(p[x]!=null){var A=f.next(32),H=(p[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);A.write_shift(1,H,"sbcs"),A.write_shift(1,T[x]=="?"?"C":T[x],"sbcs"),A.write_shift(4,y),A.write_shift(1,k[x]||a[T[x]]||0),A.write_shift(1,S[x]||0),A.write_shift(1,2),A.write_shift(4,0),A.write_shift(1,0),A.write_shift(4,0),A.write_shift(4,0),y+=k[x]||a[T[x]]||0}var G=f.next(264);for(G.write_shift(4,13),x=0;x<65;++x)G.write_shift(4,0);for(x=0;x<v.length;++x){var q=f.next(_);for(q.write_shift(1,0),y=0;y<p.length;++y)if(p[y]!=null)switch(T[y]){case"L":q.write_shift(1,v[x][y]==null?63:v[x][y]?84:70);break;case"B":q.write_shift(8,v[x][y]||0,"f");break;case"N":var Y="0";for(typeof v[x][y]=="number"&&(Y=v[x][y].toFixed(S[y]||0)),Y.length>k[y]&&(Y=Y.slice(0,k[y])),w=0;w<k[y]-Y.length;++w)q.write_shift(1,32);q.write_shift(1,Y,"sbcs");break;case"D":v[x][y]?(q.write_shift(4,("0000"+v[x][y].getFullYear()).slice(-4),"sbcs"),q.write_shift(2,("00"+(v[x][y].getMonth()+1)).slice(-2),"sbcs"),q.write_shift(2,("00"+v[x][y].getDate()).slice(-2),"sbcs")):q.write_shift(8,"00000000","sbcs");break;case"C":var Q=q.l,fe=String(v[x][y]!=null?v[x][y]:"").slice(0,k[y]);for(q.write_shift(1,fe,"cpstr"),Q+=k[y]-q.l,w=0;w<Q;++w)q.write_shift(1,32);break}}return ts=d,f.next(1).write_shift(1,26),f.end()}return{to_workbook:s,to_sheet:n,from_sheet:i}}(),oO=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Ut(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(f,h){var p=e[h];return typeof p=="number"?pp(p):p},n=function(f,h,p){var v=h.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return v==59?f:pp(v)};e["|"]=254;function s(f,h){switch(h.type){case"base64":return a(Vs(f),h);case"binary":return a(f,h);case"buffer":return a(lt&&Buffer.isBuffer(f)?f.toString("binary"):Na(f),h);case"array":return a(m0(f),h)}throw new Error("Unrecognized type "+h.type)}function a(f,h){var p=f.split(/[\n\r]+/),v=-1,g=-1,x=0,y=0,w=[],_=[],b=null,T={},k=[],S=[],E=[],C=0,L,M={Workbook:{WBProps:{},Names:[]}};for(+h.codepage>=0&&el(+h.codepage);x!==p.length;++x){C=0;var j=p[x].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),V=j.replace(/;;/g,"\0").split(";").map(function(ee){return ee.replace(/\u0000/g,";")}),A=V[0],H;if(j.length>0)switch(A){case"ID":break;case"E":break;case"B":break;case"O":for(y=1;y<V.length;++y)switch(V[y].charAt(0)){case"V":{var G=parseInt(V[y].slice(1),10);G>=1&&G<=4&&(M.Workbook.WBProps.date1904=!0)}break}break;case"W":break;case"P":switch(V[1].charAt(0)){case"P":_.push(j.slice(3).replace(/;;/g,";"));break}break;case"NN":{var q={Sheet:0};for(y=1;y<V.length;++y)switch(V[y].charAt(0)){case"N":q.Name=V[y].slice(1);break;case"E":q.Ref=(h&&h.sheet||"Sheet1")+"!"+Qp(V[y].slice(1));break}M.Workbook.Names.push(q)}break;case"C":var Y=!1,Q=!1,fe=!1,oe=!1,X=-1,le=-1,D="",K="z";for(y=1;y<V.length;++y)switch(V[y].charAt(0)){case"A":break;case"X":g=parseInt(V[y].slice(1),10)-1,Q=!0;break;case"Y":for(v=parseInt(V[y].slice(1),10)-1,Q||(g=0),L=w.length;L<=v;++L)w[L]=[];break;case"K":H=V[y].slice(1),H.charAt(0)==='"'?(H=H.slice(1,H.length-1),K="s"):H==="TRUE"||H==="FALSE"?(H=H==="TRUE",K="b"):isNaN(is(H))?isNaN(tl(H).getDate())||(H=Pr(H),K="d",h.cellDates||(K="n",H=vr(H,M.Workbook.WBProps.date1904))):(H=is(H),K="n",b!==null&&f0(b)&&h.cellDates&&(H=by(M.Workbook.WBProps.date1904?H+1462:H),K="d")),Y=!0;break;case"E":oe=!0,D=Qp(V[y].slice(1),{r:v,c:g});break;case"S":fe=!0;break;case"G":break;case"R":X=parseInt(V[y].slice(1),10)-1;break;case"C":le=parseInt(V[y].slice(1),10)-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+j)}if(Y&&(w[v][g]?(w[v][g].t=K,w[v][g].v=H):w[v][g]={t:K,v:H},b&&(w[v][g].z=b),h.cellText!==!1&&b&&(w[v][g].w=fs(w[v][g].z,w[v][g].v,{date1904:M.Workbook.WBProps.date1904})),b=null),fe){if(oe)throw new Error("SYLK shared formula cannot have own formula");var U=X>-1&&w[X][le];if(!U||!U[1])throw new Error("SYLK shared formula cannot find base");D=dI(U[1],{r:v-X,c:g-le})}D&&(w[v][g]?w[v][g].f=D:w[v][g]={t:"n",f:D});break;case"F":var I=0;for(y=1;y<V.length;++y)switch(V[y].charAt(0)){case"X":g=parseInt(V[y].slice(1),10)-1,++I;break;case"Y":for(v=parseInt(V[y].slice(1),10)-1,L=w.length;L<=v;++L)w[L]=[];break;case"M":C=parseInt(V[y].slice(1),10)/20;break;case"F":break;case"G":break;case"P":b=_[parseInt(V[y].slice(1),10)];break;case"S":break;case"D":break;case"N":break;case"W":for(E=V[y].slice(1).split(" "),L=parseInt(E[0],10);L<=parseInt(E[1],10);++L)C=parseInt(E[2],10),S[L-1]=C===0?{hidden:!0}:{wch:C};break;case"C":g=parseInt(V[y].slice(1),10)-1,S[g]||(S[g]={});break;case"R":v=parseInt(V[y].slice(1),10)-1,k[v]||(k[v]={}),C>0?(k[v].hpt=C,k[v].hpx=ow(C)):C===0&&(k[v].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+j)}I<1&&(b=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+j)}}return k.length>0&&(T["!rows"]=k),S.length>0&&(T["!cols"]=S),S.forEach(function(ee){C0(ee)}),h&&h.sheetRows&&(w=w.slice(0,h.sheetRows)),[w,T,M]}function i(f,h){var p=s(f,h),v=p[0],g=p[1],x=p[2],y=yr(h);y.date1904=(((x||{}).Workbook||{}).WBProps||{}).date1904;var w=ro(v,y);Ut(g).forEach(function(b){w[b]=g[b]});var _=to(w,h);return Ut(x).forEach(function(b){_[b]=x[b]}),_.bookType="sylk",_}function o(f,h,p,v){var g="C;Y"+(p+1)+";X"+(v+1)+";K";switch(f.t){case"n":g+=f.v||0,f.f&&!f.F&&(g+=";E"+ld(f.f,{r:p,c:v}));break;case"b":g+=f.v?"TRUE":"FALSE";break;case"e":g+=f.w||f.v;break;case"d":g+='"'+(f.w||f.v)+'"';break;case"s":g+='"'+(f.v==null?"":String(f.v)).replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function c(f,h){h.forEach(function(p,v){var g="F;W"+(v+1)+" "+(v+1)+" ";p.hidden?g+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=au(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=iu(p.wpx)),typeof p.wch=="number"&&(g+=Math.round(p.wch))),g.charAt(g.length-1)!=" "&&f.push(g)})}function u(f,h){h.forEach(function(p,v){var g="F;";p.hidden?g+="M0;":p.hpt?g+="M"+20*p.hpt+";":p.hpx&&(g+="M"+20*ou(p.hpx)+";"),g.length>2&&f.push(g+"R"+(v+1))})}function d(f,h,p){var v=["ID;PSheetJS;N;E"],g=[],x=yt(f["!ref"]),y,w=f["!data"]!=null,_=`\r
`,b=(((p||{}).Workbook||{}).WBProps||{}).date1904;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),f["!cols"]&&c(v,f["!cols"]),f["!rows"]&&u(v,f["!rows"]),v.push("B;Y"+(x.e.r-x.s.r+1)+";X"+(x.e.c-x.s.c+1)+";D"+[x.s.c,x.s.r,x.e.c,x.e.r].join(" ")),v.push("O;L;D;B"+(b?";V4":"")+";K47;G100 0.001");for(var T=x.s.r;T<=x.e.r;++T)if(!(w&&!f["!data"][T])){for(var k=[],S=x.s.c;S<=x.e.c;++S)y=w?f["!data"][T][S]:f[xt(S)+gt(T)],!(!y||y.v==null&&(!y.f||y.F))&&k.push(o(y,f,T,S));g.push(k.join(_))}return v.join(_)+_+g.join(_)+_+"E"+_}return{to_workbook:i,from_sheet:d}}(),lO=function(){function e(o,c){switch(c.type){case"base64":return t(Vs(o),c);case"binary":return t(o,c);case"buffer":return t(lt&&Buffer.isBuffer(o)?o.toString("binary"):Na(o),c);case"array":return t(m0(o),c)}throw new Error("Unrecognized type "+c.type)}function t(o,c){for(var u=o.split(`
`),d=-1,f=-1,h=0,p=[];h!==u.length;++h){if(u[h].trim()==="BOT"){p[++d]=[],f=0;continue}if(!(d<0)){var v=u[h].trim().split(","),g=v[0],x=v[1];++h;for(var y=u[h]||"";(y.match(/["]/g)||[]).length&1&&h<u.length-1;)y+=`
`+u[++h];switch(y=y.trim(),+g){case-1:if(y==="BOT"){p[++d]=[],f=0;continue}else if(y!=="EOD")throw new Error("Unrecognized DIF special command "+y);break;case 0:y==="TRUE"?p[d][f]=!0:y==="FALSE"?p[d][f]=!1:isNaN(is(x))?isNaN(tl(x).getDate())?p[d][f]=x:p[d][f]=Pr(x):p[d][f]=is(x),++f;break;case 1:y=y.slice(1,y.length-1),y=y.replace(/""/g,'"'),y&&y.match(/^=".*"$/)&&(y=y.slice(2,-1)),p[d][f++]=y!==""?y:null;break}if(y==="EOD")break}}return c&&c.sheetRows&&(p=p.slice(0,c.sheetRows)),p}function r(o,c){return ro(e(o,c),c)}function n(o,c){var u=to(r(o,c),c);return u.bookType="dif",u}function s(o,c){return"0,"+String(o)+`\r
`+c}function a(o){return`1,0\r
"`+o.replace(/"/g,'""')+'"'}function i(o){for(var c=yt(o["!ref"]),u=o["!data"]!=null,d=[`TABLE\r
0,1\r
"sheetjs"\r
`,`VECTORS\r
0,`+(c.e.r-c.s.r+1)+`\r
""\r
`,`TUPLES\r
0,`+(c.e.c-c.s.c+1)+`\r
""\r
`,`DATA\r
0,0\r
""\r
`],f=c.s.r;f<=c.e.r;++f){for(var h=u?o["!data"][f]:[],p=`-1,0\r
BOT\r
`,v=c.s.c;v<=c.e.c;++v){var g=u?h&&h[v]:o[Tt({r:f,c:v})];if(g==null){p+=`1,0\r
""\r
`;continue}switch(g.t){case"n":g.w!=null?p+="0,"+g.w+`\r
V`:g.v!=null?p+=s(g.v,"V"):g.f!=null&&!g.F?p+=a("="+g.f):p+=`1,0\r
""`;break;case"b":p+=g.v?s(1,"TRUE"):s(0,"FALSE");break;case"s":p+=a(isNaN(+g.v)?g.v:'="'+g.v+'"');break;case"d":g.w||(g.w=fs(g.z||Pt[14],vr(Pr(g.v)))),p+=s(g.w,"V");break;default:p+=`1,0\r
""`}p+=`\r
`}d.push(p)}return d.join("")+`-1,0\r
EOD`}return{to_workbook:n,to_sheet:r,from_sheet:i}}(),sw=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var p=f.split(`
`),v=-1,g=-1,x=0,y=[];x!==p.length;++x){var w=p[x].trim().split(":");if(w[0]==="cell"){var _=_t(w[1]);if(y.length<=_.r)for(v=y.length;v<=_.r;++v)y[v]||(y[v]=[]);switch(v=_.r,g=_.c,w[2]){case"t":y[v][g]=e(w[3]);break;case"v":y[v][g]=+w[3];break;case"vtf":var b=w[w.length-1];case"vtc":switch(w[3]){case"nl":y[v][g]=!!+w[4];break;default:y[v][g]=+w[4];break}w[2]=="vtf"&&(y[v][g]=[y[v][g],b])}}}return h&&h.sheetRows&&(y=y.slice(0,h.sheetRows)),y}function n(f,h){return ro(r(f,h),h)}function s(f,h){return to(n(f,h),h)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var h=[],p=[],v,g="",x=Zt(f["!ref"]),y=f["!data"]!=null,w=x.s.r;w<=x.e.r;++w)for(var _=x.s.c;_<=x.e.c;++_)if(g=Tt({r:w,c:_}),v=y?(f["!data"][w]||[])[_]:f[g],!(!v||v.v==null||v.t==="z")){switch(p=["cell",g,"t"],v.t){case"s":case"str":p.push(t(v.v));break;case"n":v.f?(p[2]="vtf",p[3]="n",p[4]=v.v,p[5]=t(v.f)):(p[2]="v",p[3]=v.v);break;case"b":p[2]="vt"+(v.f?"f":"c"),p[3]="nl",p[4]=v.v?"1":"0",p[5]=t(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var b=vr(Pr(v.v));p[2]="vtc",p[3]="nd",p[4]=""+b,p[5]=v.w||fs(v.z||Pt[14],b);break;case"e":continue}h.push(p.join(":"))}return h.push("sheet:c:"+(x.e.c-x.s.c+1)+":r:"+(x.e.r-x.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function d(f){return[a,i,o,i,u(f),c].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:d}}(),cO=function(){function e(d,f,h,p,v){v.raw?f[h][p]=d:d===""||(d==="TRUE"?f[h][p]=!0:d==="FALSE"?f[h][p]=!1:isNaN(is(d))?isNaN(tl(d).getDate())?f[h][p]=d:f[h][p]=Pr(d):f[h][p]=is(d))}function t(d,f){var h=f||{},p=[];if(!d||d.length===0)return p;for(var v=d.split(/[\r\n]/),g=v.length-1;g>=0&&v[g].length===0;)--g;for(var x=10,y=0,w=0;w<=g;++w)y=v[w].indexOf(" "),y==-1?y=v[w].length:y++,x=Math.max(x,y);for(w=0;w<=g;++w){p[w]=[];var _=0;for(e(v[w].slice(0,x).trim(),p,w,_,h),_=1;_<=(v[w].length-x)/10+1;++_)e(v[w].slice(x+(_-1)*10,x+_*10).trim(),p,w,_,h)}return h.sheetRows&&(p=p.slice(0,h.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(d){for(var f={},h=!1,p=0,v=0;p<d.length;++p)(v=d.charCodeAt(p))==34?h=!h:!h&&v in r&&(f[v]=(f[v]||0)+1);v=[];for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&v.push([f[p],p]);if(!v.length){f=n;for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&v.push([f[p],p])}return v.sort(function(g,x){return g[0]-x[0]||n[g[1]]-n[x[1]]}),r[v.pop()[1]]||44}function a(d,f){var h=f||{},p="",v={};h.dense&&(v["!data"]=[]);var g={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(p=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(p=d.charAt(4),d=d.slice(6)):p=s(d.slice(0,1024)):h&&h.FS?p=h.FS:p=s(d.slice(0,1024));var x=0,y=0,w=0,_=0,b=0,T=p.charCodeAt(0),k=!1,S=0,E=d.charCodeAt(0),C=h.dateNF!=null?_R(h.dateNF):null;function L(){var M=d.slice(_,b);M.slice(-1)=="\r"&&(M=M.slice(0,-1));var j={};if(M.charAt(0)=='"'&&M.charAt(M.length-1)=='"'&&(M=M.slice(1,-1).replace(/""/g,'"')),M.length===0)j.t="z";else if(h.raw)j.t="s",j.v=M;else if(M.trim().length===0)j.t="s",j.v=M;else if(M.charCodeAt(0)==61)M.charCodeAt(1)==34&&M.charCodeAt(M.length-1)==34?(j.t="s",j.v=M.slice(2,-1).replace(/""/g,'"')):fI(M)?(j.t="n",j.f=M.slice(1)):(j.t="s",j.v=M);else if(M=="TRUE")j.t="b",j.v=!0;else if(M=="FALSE")j.t="b",j.v=!1;else if(!isNaN(w=is(M)))j.t="n",h.cellText!==!1&&(j.w=M),j.v=w;else if(!isNaN((w=tl(M)).getDate())||C&&M.match(C)){j.z=h.dateNF||Pt[14];var V=0;C&&M.match(C)&&(M=bR(M,h.dateNF,M.match(C)||[]),V=1,w=Pr(M,V)),h.cellDates?(j.t="d",j.v=w):(j.t="n",j.v=vr(w)),h.cellText!==!1&&(j.w=fs(j.z,j.v instanceof Date?vr(j.v):j.v)),h.cellNF||delete j.z}else j.t="s",j.v=M;if(j.t=="z"||(h.dense?(v["!data"][x]||(v["!data"][x]=[]),v["!data"][x][y]=j):v[Tt({c:y,r:x})]=j),_=b+1,E=d.charCodeAt(_),g.e.c<y&&(g.e.c=y),g.e.r<x&&(g.e.r=x),S==T)++y;else if(y=0,++x,h.sheetRows&&h.sheetRows<=x)return!0}e:for(;b<d.length;++b)switch(S=d.charCodeAt(b)){case 34:E===34&&(k=!k);break;case 13:if(k)break;d.charCodeAt(b+1)==10&&++b;case T:case 10:if(!k&&L())break e;break}return b-_>0&&L(),v["!ref"]=Ot(g),v}function i(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?a(d,f):ro(t(d,f),f)}function o(d,f){var h="",p=f.type=="string"?[0,0,0,0]:L3(d,f);switch(f.type){case"base64":h=Vs(d);break;case"binary":h=d;break;case"buffer":f.codepage==65001?h=d.toString("utf8"):f.codepage&&typeof po<"u"?h=po.utils.decode(f.codepage,d):h=lt&&Buffer.isBuffer(d)?d.toString("binary"):Na(d);break;case"array":h=m0(d);break;case"string":h=d;break;default:throw new Error("Unrecognized type "+f.type)}return p[0]==239&&p[1]==187&&p[2]==191?h=vi(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=vi(h):f.type=="binary"&&typeof po<"u"&&f.codepage&&(h=po.utils.decode(f.codepage,po.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?sw.to_sheet(f.type=="string"?h:vi(h),f):i(h,f)}function c(d,f){return to(o(d,f),f)}function u(d){for(var f=[],h=yt(d["!ref"]),p,v=d["!data"]!=null,g=h.s.r;g<=h.e.r;++g){for(var x=[],y=h.s.c;y<=h.e.c;++y){var w=Tt({r:g,c:y});if(p=v?(d["!data"][g]||[])[y]:d[w],!p||p.v==null){x.push("          ");continue}for(var _=(p.w||(hs(p),p.w)||"").slice(0,10);_.length<10;)_+=" ";x.push(_+(y===0?" ":""))}f.push(x.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:u}}(),Xp=function(){function e(D,K,U){if(D){fr(D,D.l||0);for(var I=U.Enum||oe;D.l<D.length;){var ee=D.read_shift(2),z=I[ee]||I[65535],R=D.read_shift(2),J=D.l+R,Z=z.f&&z.f(D,R,U);if(D.l=J,K(Z,z,ee))return}}}function t(D,K){switch(K.type){case"base64":return r(Br(Vs(D)),K);case"binary":return r(Br(D),K);case"buffer":case"array":return r(D,K)}throw"Unsupported type "+K.type}function r(D,K){if(!D)return D;var U=K||{},I={},ee="Sheet1",z="",R=0,J={},Z=[],ge=[],ye=[];U.dense&&(ye=I["!data"]=[]);var Ce={s:{r:0,c:0},e:{r:0,c:0}},Ie=U.sheetRows||0;if(D[4]==81&&D[5]==80&&D[6]==87)return le(D,K);if(D[2]==0&&(D[3]==8||D[3]==9)&&D.length>=16&&D[14]==5&&D[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(D[2]==2)U.Enum=oe,e(D,function(de,Fe,at){switch(at){case 0:U.vers=de,de>=4096&&(U.qpro=!0);break;case 255:U.vers=de,U.works=!0;break;case 6:Ce=de;break;case 204:de&&(z=de);break;case 222:z=de;break;case 15:case 51:(!U.qpro&&!U.works||at==51)&&de[1].v.charCodeAt(0)<48&&(de[1].v=de[1].v.slice(1)),(U.works||U.works2)&&(de[1].v=de[1].v.replace(/\r\n/g,`
`));case 13:case 14:case 16:at==14&&(de[2]&112)==112&&(de[2]&15)>1&&(de[2]&15)<15&&(de[1].z=U.dateNF||Pt[14],U.cellDates&&(de[1].t="d",de[1].v=by(de[1].v))),U.qpro&&de[3]>R&&(I["!ref"]=Ot(Ce),J[ee]=I,Z.push(ee),I={},U.dense&&(ye=I["!data"]=[]),Ce={s:{r:0,c:0},e:{r:0,c:0}},R=de[3],ee=z||"Sheet"+(R+1),z="");var ke=U.dense?(ye[de[0].r]||[])[de[0].c]:I[Tt(de[0])];if(ke){ke.t=de[1].t,ke.v=de[1].v,de[1].z!=null&&(ke.z=de[1].z),de[1].f!=null&&(ke.f=de[1].f);break}U.dense?(ye[de[0].r]||(ye[de[0].r]=[]),ye[de[0].r][de[0].c]=de[1]):I[Tt(de[0])]=de[1];break;case 21509:U.works2=!0;break}},U);else if(D[2]==26||D[2]==14)U.Enum=X,D[2]==14&&(U.qpro=!0,D.l=0),e(D,function(de,Fe,at){switch(at){case 204:ee=de;break;case 22:de[1].v.charCodeAt(0)<48&&(de[1].v=de[1].v.slice(1)),de[1].v=de[1].v.replace(/\x0F./g,function(ke){return String.fromCharCode(ke.charCodeAt(1)-32)}).replace(/\r\n/g,`
`);case 23:case 24:case 25:case 37:case 39:case 40:if(de[3]>R&&(I["!ref"]=Ot(Ce),J[ee]=I,Z.push(ee),I={},U.dense&&(ye=I["!data"]=[]),Ce={s:{r:0,c:0},e:{r:0,c:0}},R=de[3],ee="Sheet"+(R+1)),Ie>0&&de[0].r>=Ie)break;U.dense?(ye[de[0].r]||(ye[de[0].r]=[]),ye[de[0].r][de[0].c]=de[1]):I[Tt(de[0])]=de[1],Ce.e.c<de[0].c&&(Ce.e.c=de[0].c),Ce.e.r<de[0].r&&(Ce.e.r=de[0].r);break;case 27:de[14e3]&&(ge[de[14e3][0]]=de[14e3][1]);break;case 1537:ge[de[0]]=de[1],de[0]==R&&(ee=de[1]);break}},U);else throw new Error("Unrecognized LOTUS BOF "+D[2]);if(I["!ref"]=Ot(Ce),J[z||ee]=I,Z.push(z||ee),!ge.length)return{SheetNames:Z,Sheets:J};for(var st={},Se=[],Le=0;Le<ge.length;++Le)J[Z[Le]]?(Se.push(ge[Le]||Z[Le]),st[ge[Le]]=J[ge[Le]]||J[Z[Le]]):(Se.push(ge[Le]),st[ge[Le]]={"!ref":"A1"});return{SheetNames:Se,Sheets:st}}function n(D,K){var U=K||{};if(+U.codepage>=0&&el(+U.codepage),U.type=="string")throw new Error("Cannot write WK1 to JS string");var I=kr(),ee=yt(D["!ref"]),z=D["!data"]!=null,R=[];we(I,0,a(1030)),we(I,6,c(ee));for(var J=Math.min(ee.e.r,8191),Z=ee.s.c;Z<=ee.e.c;++Z)R[Z]=xt(Z);for(var ge=ee.s.r;ge<=J;++ge){var ye=gt(ge);for(Z=ee.s.c;Z<=ee.e.c;++Z){var Ce=z?(D["!data"][ge]||[])[Z]:D[R[Z]+ye];if(!(!Ce||Ce.t=="z"))if(Ce.t=="n")(Ce.v|0)==Ce.v&&Ce.v>=-32768&&Ce.v<=32767?we(I,13,v(ge,Z,Ce.v)):we(I,14,x(ge,Z,Ce.v));else{var Ie=hs(Ce);we(I,15,f(ge,Z,Ie.slice(0,239)))}}}return we(I,1),I.end()}function s(D,K){var U=K||{};if(+U.codepage>=0&&el(+U.codepage),U.type=="string")throw new Error("Cannot write WK3 to JS string");var I=kr();we(I,0,i(D));for(var ee=0,z=0;ee<D.SheetNames.length;++ee)(D.Sheets[D.SheetNames[ee]]||{})["!ref"]&&we(I,27,fe(D.SheetNames[ee],z++));var R=0;for(ee=0;ee<D.SheetNames.length;++ee){var J=D.Sheets[D.SheetNames[ee]];if(!(!J||!J["!ref"])){for(var Z=yt(J["!ref"]),ge=J["!data"]!=null,ye=[],Ce=Math.min(Z.e.r,8191),Ie=Z.s.r;Ie<=Ce;++Ie)for(var st=gt(Ie),Se=Z.s.c;Se<=Z.e.c;++Se){Ie===Z.s.r&&(ye[Se]=xt(Se));var Le=ye[Se]+st,de=ge?(J["!data"][Ie]||[])[Se]:J[Le];if(!(!de||de.t=="z"))if(de.t=="n")we(I,23,M(Ie,Se,R,de.v));else{var Fe=hs(de);we(I,22,E(Ie,Se,R,Fe.slice(0,239)))}}++R}}return we(I,1),I.end()}function a(D){var K=ae(2);return K.write_shift(2,D),K}function i(D){var K=ae(26);K.write_shift(2,4096),K.write_shift(2,4),K.write_shift(4,0);for(var U=0,I=0,ee=0,z=0;z<D.SheetNames.length;++z){var R=D.SheetNames[z],J=D.Sheets[R];if(!(!J||!J["!ref"])){++ee;var Z=Zt(J["!ref"]);U<Z.e.r&&(U=Z.e.r),I<Z.e.c&&(I=Z.e.c)}}return U>8191&&(U=8191),K.write_shift(2,U),K.write_shift(1,ee),K.write_shift(1,I),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(1,1),K.write_shift(1,2),K.write_shift(4,0),K.write_shift(4,0),K}function o(D,K,U){var I={s:{c:0,r:0},e:{c:0,r:0}};return K==8&&U.qpro?(I.s.c=D.read_shift(1),D.l++,I.s.r=D.read_shift(2),I.e.c=D.read_shift(1),D.l++,I.e.r=D.read_shift(2),I):(I.s.c=D.read_shift(2),I.s.r=D.read_shift(2),K==12&&U.qpro&&(D.l+=2),I.e.c=D.read_shift(2),I.e.r=D.read_shift(2),K==12&&U.qpro&&(D.l+=2),I.s.c==65535&&(I.s.c=I.e.c=I.s.r=I.e.r=0),I)}function c(D){var K=ae(8);return K.write_shift(2,D.s.c),K.write_shift(2,D.s.r),K.write_shift(2,D.e.c),K.write_shift(2,D.e.r),K}function u(D,K,U){var I=[{c:0,r:0},{t:"n",v:0},0,0];return U.qpro&&U.vers!=20768?(I[0].c=D.read_shift(1),I[3]=D.read_shift(1),I[0].r=D.read_shift(2),D.l+=2):U.works?(I[0].c=D.read_shift(2),I[0].r=D.read_shift(2),I[2]=D.read_shift(2)):(I[2]=D.read_shift(1),I[0].c=D.read_shift(2),I[0].r=D.read_shift(2)),I}function d(D,K,U){var I=D.l+K,ee=u(D,K,U);if(ee[1].t="s",U.vers==20768){D.l++;var z=D.read_shift(1);return ee[1].v=D.read_shift(z,"utf8"),ee}return U.qpro&&D.l++,ee[1].v=D.read_shift(I-D.l,"cstr"),ee}function f(D,K,U){var I=ae(7+U.length);I.write_shift(1,255),I.write_shift(2,K),I.write_shift(2,D),I.write_shift(1,39);for(var ee=0;ee<I.length;++ee){var z=U.charCodeAt(ee);I.write_shift(1,z>=128?95:z)}return I.write_shift(1,0),I}function h(D,K,U){var I=D.l+K,ee=u(D,K,U);if(ee[1].t="s",U.vers==20768){var z=D.read_shift(1);return ee[1].v=D.read_shift(z,"utf8"),ee}return ee[1].v=D.read_shift(I-D.l,"cstr"),ee}function p(D,K,U){var I=u(D,K,U);return I[1].v=D.read_shift(2,"i"),I}function v(D,K,U){var I=ae(7);return I.write_shift(1,255),I.write_shift(2,K),I.write_shift(2,D),I.write_shift(2,U,"i"),I}function g(D,K,U){var I=u(D,K,U);return I[1].v=D.read_shift(8,"f"),I}function x(D,K,U){var I=ae(13);return I.write_shift(1,255),I.write_shift(2,K),I.write_shift(2,D),I.write_shift(8,U,"f"),I}function y(D,K,U){var I=D.l+K,ee=u(D,K,U);if(ee[1].v=D.read_shift(8,"f"),U.qpro)D.l=I;else{var z=D.read_shift(2);T(D.slice(D.l,D.l+z),ee),D.l+=z}return ee}function w(D,K,U){var I=K&32768;return K&=-32769,K=(I?D:0)+(K>=8192?K-16384:K),(I?"":"$")+(U?xt(K):gt(K))}var _={31:["NA",0],33:["ABS",1],34:["TRUNC",1],35:["SQRT",1],36:["LOG",1],37:["LN",1],38:["PI",0],39:["SIN",1],40:["COS",1],41:["TAN",1],42:["ATAN2",2],43:["ATAN",1],44:["ASIN",1],45:["ACOS",1],46:["EXP",1],47:["MOD",2],49:["ISNA",1],50:["ISERR",1],51:["FALSE",0],52:["TRUE",0],53:["RAND",0],63:["ROUND",2],68:["ISNUMBER",1],69:["ISTEXT",1],70:["LEN",1],71:["VALUE",1],73:["MID",3],74:["CHAR",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],102:["UPPER",1],103:["LOWER",1],107:["PROPER",1],109:["TRIM",1],111:["T",1]},b=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function T(D,K){fr(D,0);for(var U=[],I=0,ee="",z="",R="",J="";D.l<D.length;){var Z=D[D.l++];switch(Z){case 0:U.push(D.read_shift(8,"f"));break;case 1:z=w(K[0].c,D.read_shift(2),!0),ee=w(K[0].r,D.read_shift(2),!1),U.push(z+ee);break;case 2:{var ge=w(K[0].c,D.read_shift(2),!0),ye=w(K[0].r,D.read_shift(2),!1);z=w(K[0].c,D.read_shift(2),!0),ee=w(K[0].r,D.read_shift(2),!1),U.push(ge+ye+":"+z+ee)}break;case 3:if(D.l<D.length){console.error("WK1 premature formula end");return}break;case 4:U.push("("+U.pop()+")");break;case 5:U.push(D.read_shift(2));break;case 6:{for(var Ce="";Z=D[D.l++];)Ce+=String.fromCharCode(Z);U.push('"'+Ce.replace(/"/g,'""')+'"')}break;case 8:U.push("-"+U.pop());break;case 23:U.push("+"+U.pop());break;case 22:U.push("NOT("+U.pop()+")");break;case 20:case 21:J=U.pop(),R=U.pop(),U.push(["AND","OR"][Z-20]+"("+R+","+J+")");break;default:if(Z<32&&b[Z])J=U.pop(),R=U.pop(),U.push(R+b[Z]+J);else if(_[Z]){if(I=_[Z][1],I==69&&(I=D[D.l++]),I>U.length){console.error("WK1 bad formula parse 0x"+Z.toString(16)+":|"+U.join("|")+"|");return}var Ie=U.slice(-I);U.length-=I,U.push(_[Z][0]+"("+Ie.join(",")+")")}else return Z<=7?console.error("WK1 invalid opcode "+Z.toString(16)):Z<=24?console.error("WK1 unsupported op "+Z.toString(16)):Z<=30?console.error("WK1 invalid opcode "+Z.toString(16)):Z<=115?console.error("WK1 unsupported function opcode "+Z.toString(16)):console.error("WK1 unrecognized opcode "+Z.toString(16))}}U.length==1?K[1].f=""+U[0]:console.error("WK1 bad formula parse |"+U.join("|")+"|")}function k(D){var K=[{c:0,r:0},{t:"n",v:0},0];return K[0].r=D.read_shift(2),K[3]=D[D.l++],K[0].c=D[D.l++],K}function S(D,K){var U=k(D);return U[1].t="s",U[1].v=D.read_shift(K-4,"cstr"),U}function E(D,K,U,I){var ee=ae(6+I.length);ee.write_shift(2,D),ee.write_shift(1,U),ee.write_shift(1,K),ee.write_shift(1,39);for(var z=0;z<I.length;++z){var R=I.charCodeAt(z);ee.write_shift(1,R>=128?95:R)}return ee.write_shift(1,0),ee}function C(D,K){var U=k(D);U[1].v=D.read_shift(2);var I=U[1].v>>1;if(U[1].v&1)switch(I&7){case 0:I=(I>>3)*5e3;break;case 1:I=(I>>3)*500;break;case 2:I=(I>>3)/20;break;case 3:I=(I>>3)/200;break;case 4:I=(I>>3)/2e3;break;case 5:I=(I>>3)/2e4;break;case 6:I=(I>>3)/16;break;case 7:I=(I>>3)/64;break}return U[1].v=I,U}function L(D,K){var U=k(D),I=D.read_shift(4),ee=D.read_shift(4),z=D.read_shift(2);if(z==65535)return I===0&&ee===3221225472?(U[1].t="e",U[1].v=15):I===0&&ee===3489660928?(U[1].t="e",U[1].v=42):U[1].v=0,U;var R=z&32768;return z=(z&32767)-16446,U[1].v=(1-R*2)*(ee*Math.pow(2,z+32)+I*Math.pow(2,z)),U}function M(D,K,U,I){var ee=ae(14);if(ee.write_shift(2,D),ee.write_shift(1,U),ee.write_shift(1,K),I==0)return ee.write_shift(4,0),ee.write_shift(4,0),ee.write_shift(2,65535),ee;var z=0,R=0,J=0,Z=0;return I<0&&(z=1,I=-I),R=Math.log2(I)|0,I/=Math.pow(2,R-31),Z=I>>>0,Z&2147483648||(I/=2,++R,Z=I>>>0),I-=Z,Z|=2147483648,Z>>>=0,I*=Math.pow(2,32),J=I>>>0,ee.write_shift(4,J),ee.write_shift(4,Z),R+=16383+(z?32768:0),ee.write_shift(2,R),ee}function j(D,K){var U=L(D);return D.l+=K-14,U}function V(D,K){var U=k(D),I=D.read_shift(4);return U[1].v=I>>6,U}function A(D,K){var U=k(D),I=D.read_shift(8,"f");return U[1].v=I,U}function H(D,K){var U=A(D);return D.l+=K-12,U}function G(D,K){return D[D.l+K-1]==0?D.read_shift(K,"cstr"):""}function q(D,K){var U=D[D.l++];U>K-1&&(U=K-1);for(var I="";I.length<U;)I+=String.fromCharCode(D[D.l++]);return I}function Y(D,K,U){if(!(!U.qpro||K<21)){var I=D.read_shift(1);D.l+=17,D.l+=1,D.l+=2;var ee=D.read_shift(K-21,"cstr");return[I,ee]}}function Q(D,K){for(var U={},I=D.l+K;D.l<I;){var ee=D.read_shift(2);if(ee==14e3){for(U[ee]=[0,""],U[ee][0]=D.read_shift(2);D[D.l];)U[ee][1]+=String.fromCharCode(D[D.l]),D.l++;D.l++}}return U}function fe(D,K){var U=ae(5+D.length);U.write_shift(2,14e3),U.write_shift(2,K);for(var I=0;I<D.length;++I){var ee=D.charCodeAt(I);U[U.l++]=ee>127?95:ee}return U[U.l++]=0,U}var oe={0:{n:"BOF",f:Zf},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:G},222:{n:"SHEETNAMELP",f:q},255:{n:"BOF",f:Zf},65535:{n:""}},X={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:S},23:{n:"NUMBER17",f:L},24:{n:"NUMBER18",f:C},25:{n:"FORMULA19",f:j},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Q},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:V},38:{n:"??"},39:{n:"NUMBER27",f:A},40:{n:"FORMULA28",f:H},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:G},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Y},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};function le(D,K){fr(D,0);var U=K||{},I={};U.dense&&(I["!data"]=[]);var ee=[],z="",R={s:{r:-1,c:-1},e:{r:-1,c:-1}},J=0,Z=0,ge=0,ye=0,Ce={SheetNames:[],Sheets:{}};e:for(;D.l<D.length;){var Ie=D.read_shift(2),st=D.read_shift(2),Se=D.slice(D.l,D.l+st);switch(fr(Se,0),Ie){case 1:if(Se.read_shift(4)!=962023505)throw"Bad QPW9 BOF!";break;case 2:break e;case 1025:break;case 1026:break;case 1031:for(Se.l+=12;Se.l<Se.length;)J=Se.read_shift(2),Z=Se.read_shift(1),ee.push(Se.read_shift(J,"cstr"));break;case 1032:break;case 1537:{var Le=Se.read_shift(2);I={},U.dense&&(I["!data"]=[]),R.s.c=Se.read_shift(2),R.e.c=Se.read_shift(2),R.s.r=Se.read_shift(4),R.e.r=Se.read_shift(4),Se.l+=4,Se.l+2<Se.length&&(J=Se.read_shift(2),Z=Se.read_shift(1),z=J==0?"":Se.read_shift(J,"cstr")),z||(z=xt(Le))}break;case 1538:{if(R.s.c>255||R.s.r>999999)break;R.e.c<R.s.c&&(R.e.c=R.s.c),R.e.r<R.s.r&&(R.e.r=R.s.r),I["!ref"]=Ot(R),Ow(Ce,I,z)}break;case 2561:ge=Se.read_shift(2),R.e.c<ge&&(R.e.c=ge),R.s.c>ge&&(R.s.c=ge),ye=Se.read_shift(4),R.s.r>ye&&(R.s.r=ye),ye=Se.read_shift(4),R.e.r<ye&&(R.e.r=ye);break;case 3073:{ye=Se.read_shift(4),J=Se.read_shift(4),R.s.r>ye&&(R.s.r=ye),R.e.r<ye+J-1&&(R.e.r=ye+J-1);for(var de=xt(ge);Se.l<Se.length;){var Fe={t:"z"},at=Se.read_shift(1);at&128&&(Se.l+=2);var ke=at&64?Se.read_shift(2)-1:0;switch(at&31){case 1:break;case 2:Fe={t:"n",v:Se.read_shift(2)};break;case 3:Fe={t:"n",v:Se.read_shift(2,"i")};break;case 5:Fe={t:"n",v:Se.read_shift(8,"f")};break;case 7:Fe={t:"s",v:ee[Z=Se.read_shift(4)-1]};break;case 8:Fe={t:"n",v:Se.read_shift(8,"f")},Se.l+=2,Se.l+=4;break;default:throw"Unrecognized QPW cell type "+(at&31)}var je=0;if(at&32)switch(at&31){case 2:je=Se.read_shift(2);break;case 3:je=Se.read_shift(2,"i");break;case 7:je=Se.read_shift(2);break;default:throw"Unsupported delta for QPW cell type "+(at&31)}for(!U.sheetStubs&&Fe.t=="z"||(I["!data"]!=null?(I["!data"][ye]||(I["!data"][ye]=[]),I["!data"][ye][ge]=Fe):I[de+gt(ye)]=Fe),++ye,--J;ke-- >0&&J>=0;){if(at&32)switch(at&31){case 2:Fe={t:"n",v:Fe.v+je&65535};break;case 3:Fe={t:"n",v:Fe.v+je&65535},Fe.v>32767&&(Fe.v-=65536);break;case 7:Fe={t:"s",v:ee[Z=Z+je>>>0]};break;default:throw"Cannot apply delta for QPW cell type "+(at&31)}else switch(at&31){case 1:Fe={t:"z"};break;case 2:Fe={t:"n",v:Se.read_shift(2)};break;case 7:Fe={t:"s",v:ee[Z=Se.read_shift(4)-1]};break;default:throw"Cannot apply repeat for QPW cell type "+(at&31)}!U.sheetStubs&&Fe.t=="z"||(I["!data"]!=null?(I["!data"][ye]||(I["!data"][ye]=[]),I["!data"][ye][ge]=Fe):I[de+gt(ye)]=Fe),++ye,--J}}}break}D.l+=st}return Ce}return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}}(),uO=/^\s|\s$|[\t\n\r]/;function dO(e,t){if(!t.bookSST)return"";var r=[It];r[r.length]=ve("sst",null,{xmlns:eo[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],a="<si>";s.r?a+=s.r:(a+="<t",s.t||(s.t=""),typeof s.t!="string"&&(s.t=String(s.t)),s.t.match(uO)&&(a+=' xml:space="preserve"'),a+=">"+Ue(s.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function fO(e){return[e.read_shift(4),e.read_shift(4)]}function hO(e,t){return t||(t=ae(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var mO=r4;function pO(e){var t=kr();ce(t,159,hO(e));for(var r=0;r<e.length;++r)ce(t,19,mO(e[r]));return ce(t,160),t.end()}function gO(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function aw(e){var t=0,r,n=gO(e),s=n.length+1,a,i,o,c,u;for(r=Aa(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)i=r[a],o=t&16384?1:0,c=t<<1&32767,u=o|c,t=u^i;return t^52811}function xO(e,t){var r=["{\\rtf1\\ansi"];if(!e["!ref"])return r[0]+"}";for(var n=yt(e["!ref"]),s,a=e["!data"]!=null,i=[],o=n.s.r;o<=n.e.r;++o){r.push("\\trowd\\trautofit1");for(var c=n.s.c;c<=n.e.c;++c)r.push("\\cellx"+(c+1));for(r.push("\\pard\\intbl"),a&&(i=e["!data"][o]||[]),c=n.s.c;c<=n.e.c;++c){var u=Tt({r:o,c});if(s=a?i[c]:e[u],!s||s.v==null&&(!s.f||s.F)){r.push(" \\cell");continue}r.push(" "+(s.w||(hs(s),s.w)||"").replace(/[\r\n]/g,"\\par ")),r.push("\\cell")}r.push("\\pard\\intbl\\row")}return r.join("")+"}"}function qp(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var vO=6,os=vO;function au(e){return Math.floor((e+Math.round(128/os)/256)*os)}function iu(e){return Math.floor((e-5)/os*100+.5)/100}function eh(e){return Math.round((e*os+5)/os*256)/256}function C0(e){e.width?(e.wpx=au(e.width),e.wch=iu(e.wpx),e.MDW=os):e.wpx?(e.wch=iu(e.wpx),e.width=eh(e.wch),e.MDW=os):typeof e.wch=="number"&&(e.width=eh(e.wch),e.wpx=au(e.width),e.MDW=os),e.customWidth&&delete e.customWidth}var yO=96,iw=yO;function ou(e){return e*96/iw}function ow(e){return e*iw/96}function wO(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=ve("numFmt",null,{numFmtId:n,formatCode:Ue(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=ve("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function _O(e){var t=[];return t[t.length]=ve("cellXfs",null),e.forEach(function(r){t[t.length]=ve("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=ve("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function bO(e,t){var r=[It,ve("styleSheet",null,{xmlns:eo[0],"xmlns:vt":Gt.vt})],n;return e.SSF&&(n=wO(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=_O(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function SO(e,t){var r=e.read_shift(2),n=ir(e);return[r,n]}function EO(e,t,r){r||(r=ae(6+4*t.length)),r.write_shift(2,e),Wt(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function TO(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=c4(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=l4(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=ir(e),n}function CO(e,t){t||(t=ae(25+4*32)),t.write_shift(2,e.sz*20),u4(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),nu(e.color,t);var n=0;return e.scheme=="major"&&(n=1),e.scheme=="minor"&&(n=2),t.write_shift(1,n),Wt(e.name,t),t.length>t.l?t.slice(0,t.l):t}var kO=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],nf,PO=Un;function Jp(e,t){t||(t=ae(4*3+8*7+16*1)),nf||(nf=h0(kO));var r=nf[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(nu({auto:1},t),nu({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function AO(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}function lw(e,t,r){r||(r=ae(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function go(e,t){return t||(t=ae(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var NO=Un;function DO(e,t){return t||(t=ae(51)),t.write_shift(1,0),go(null,t),go(null,t),go(null,t),go(null,t),go(null,t),t.length>t.l?t.slice(0,t.l):t}function jO(e,t){return t||(t=ae(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),il(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function RO(e,t,r){var n=ae(2052);return n.write_shift(4,e),il(t,n),il(r,n),n.length>n.l?n.slice(0,n.l):n}function OO(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&++r}),r!=0&&(ce(e,615,xn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&ce(e,44,EO(s,t[s]))}),ce(e,616))}}function IO(e){var t=1;ce(e,611,xn(t)),ce(e,43,CO({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),ce(e,612)}function MO(e){var t=2;ce(e,603,xn(t)),ce(e,45,Jp({patternType:"none"})),ce(e,45,Jp({patternType:"gray125"})),ce(e,604)}function FO(e){var t=1;ce(e,613,xn(t)),ce(e,46,DO()),ce(e,614)}function LO(e){var t=1;ce(e,626,xn(t)),ce(e,47,lw({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),ce(e,627)}function BO(e,t){ce(e,617,xn(t.length)),t.forEach(function(r){ce(e,47,lw(r,0))}),ce(e,618)}function $O(e){var t=1;ce(e,619,xn(t)),ce(e,48,jO({xfId:0,builtinId:0,name:"Normal"})),ce(e,620)}function WO(e){var t=0;ce(e,505,xn(t)),ce(e,506)}function UO(e){var t=0;ce(e,508,RO(t,"TableStyleMedium9","PivotStyleMedium4")),ce(e,509)}function VO(e,t){var r=kr();return ce(r,278),OO(r,e.SSF),IO(r),MO(r),FO(r),LO(r),BO(r,t.cellXfs),$O(r),WO(r),UO(r),ce(r,279),r.end()}function cw(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[It];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function HO(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:ir(e)}}function zO(e){var t=ae(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Wt(e.name,t),t.slice(0,t.l)}function GO(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function KO(e){var t=ae(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function YO(e,t){var r=ae(8+2*t.length);return r.write_shift(4,e),Wt(t,r),r.slice(0,r.l)}function XO(e){return e.l+=4,e.read_shift(4)!=0}function qO(e,t){var r=ae(8);return r.write_shift(4,e),r.write_shift(4,1),r}function JO(){var e=kr();return ce(e,332),ce(e,334,xn(1)),ce(e,335,zO({name:"XLDAPR",version:12e4,flags:3496657072})),ce(e,336),ce(e,339,YO(1,"XLDAPR")),ce(e,52),ce(e,35,xn(514)),ce(e,4096,xn(0)),ce(e,4097,Jr(1)),ce(e,36),ce(e,53),ce(e,340),ce(e,337,qO(1)),ce(e,51,KO([[1,0]])),ce(e,338),ce(e,333),e.end()}function QO(){var e=[It];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function ZO(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Tt(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function uw(e,t){var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[ve("xml",null,{"xmlns:v":$r.v,"xmlns:o":$r.o,"xmlns:x":$r.x,"xmlns:mv":$r.mv}).replace(/\/>/,">"),ve("o:shapelayout",ve("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"})],a=65536*e,i=t||[];return i.length>0&&s.push(ve("v:shapetype",[ve("v:stroke",null,{joinstyle:"miter"}),ve("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202",coordsize:r.join(","),"o:spt":202,path:n})),i.forEach(function(o){++a,s.push(eI(o,a))}),s.push("</xml>"),s.join("")}function eI(e,t){var r=_t(e[0]),n={color2:"#BEFF82",type:"gradient"};n.type=="gradient"&&(n.angle="-180");var s=n.type=="gradient"?ve("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,a=ve("v:fill",s,n),i={on:"t",obscured:"t"};return["<v:shape"+nl({id:"_x0000_s"+t,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",a,ve("v:shadow",null,i),ve("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Qt("x:Anchor",[r.c+1,0,r.r+1,0,r.c+3,20,r.r+5,20].join(",")),Qt("x:AutoFill","False"),Qt("x:Row",String(r.r)),Qt("x:Column",String(r.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"].join("")}function tI(e){var t=[It,ve("comments",null,{xmlns:eo[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var a=Ue(s.a);r.indexOf(a)==-1&&(r.push(a),t.push("<author>"+a+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var s=0,a=[],i=0;if(n[1][0]&&n[1][0].T&&n[1][0].ID&&(s=r.indexOf("tc="+n[1][0].ID)),n[1].forEach(function(u){u.a&&(s=r.indexOf(Ue(u.a))),u.T&&++i,a.push(u.t==null?"":Ue(u.t))}),i===0)n[1].forEach(function(u){t.push('<comment ref="'+n[0]+'" authorId="'+r.indexOf(Ue(u.a))+'"><text>'),t.push(Qt("t",u.t==null?"":Ue(u.t))),t.push("</text></comment>")});else{t.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>');for(var o=`Comment:
    `+a[0]+`
`,c=1;c<a.length;++c)o+=`Reply:
    `+a[c]+`
`;t.push(Qt("t",Ue(o))),t.push("</text></comment>")}}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function rI(e,t,r){var n=[It,ve("ThreadedComments",null,{xmlns:Gt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var a="";(s[1]||[]).forEach(function(i,o){if(!i.T){delete i.ID;return}i.a&&t.indexOf(i.a)==-1&&t.push(i.a);var c={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?a=c.id:c.parentId=a,i.ID=c.id,i.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),n.push(ve("threadedComment",Qt("text",i.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function nI(e){var t=[It,ve("personList",null,{xmlns:Gt.TCMNT,"xmlns:x":eo[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(ve("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function sI(e){var t={};t.iauthor=e.read_shift(4);var r=za(e);return t.rfx=r.s,t.ref=Tt(r.s),e.l+=16,t}function aI(e,t){return t==null&&(t=ae(36)),t.write_shift(4,e[1].iauthor),no(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var iI=ir;function oI(e){return Wt(e.slice(0,54))}function lI(e){var t=kr(),r=[];return ce(t,628),ce(t,630),e.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),ce(t,632,oI(s.a)))})}),ce(t,631),ce(t,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var a={s:_t(n[0]),e:_t(n[0])};ce(t,635,aI([a,s])),s.t&&s.t.length>0&&ce(t,637,s4(s)),ce(t,636),delete s.iauthor})}),ce(t,634),ce(t,629),t.end()}function cI(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&pt.utils.cfb_add(e,s,t.FileIndex[n].content)}})}var uI=["xlsb","xlsm","xlam","biff8","xla"],Qp=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,a,i){var o=!1,c=!1;a.length==0?c=!0:a.charAt(0)=="["&&(c=!0,a=a.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var u=a.length>0?parseInt(a,10)|0:0,d=i.length>0?parseInt(i,10)|0:0;return o?d+=t.c:--d,c?u+=t.r:--u,s+(o?"":"$")+xt(d)+(c?"":"$")+gt(u)}return function(s,a){return t=a,s.replace(e,r)}}(),k0=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,ld=function(){return function(t,r){return t.replace(k0,function(n,s,a,i,o,c){var u=_0(i)-(a?0:r.c),d=w0(c)-(o?0:r.r),f=o=="$"?d+1:d==0?"":"["+d+"]",h=a=="$"?u+1:u==0?"":"["+u+"]";return s+"R"+f+"C"+h})}}();function dI(e,t){return e.replace(k0,function(r,n,s,a,i,o){return n+(s=="$"?s+a:xt(_0(a)+t.c))+(i=="$"?i+o:gt(w0(o)+t.r))})}function fI(e){return e.length!=1}function Nt(e){e.l+=1}function Hs(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function dw(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return fw(e);r.biff==12&&(n=4)}var s=e.read_shift(n),a=e.read_shift(n),i=Hs(e),o=Hs(e);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function fw(e){var t=Hs(e),r=Hs(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function hI(e,t,r){if(r.biff<8)return fw(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),a=Hs(e),i=Hs(e);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}function hw(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return mI(e);var n=e.read_shift(r&&r.biff==12?4:2),s=Hs(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function mI(e){var t=Hs(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function pI(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function gI(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return xI(e);var s=e.read_shift(n>=12?4:2),a=e.read_shift(2),i=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;s>524287;)s-=1048576;if(i==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:i,rRel:o}}function xI(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function vI(e,t,r){var n=(e[e.l++]&96)>>5,s=dw(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function yI(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var i=dw(e,a,r);return[n,s,i]}function wI(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function _I(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,s]}function bI(e,t,r){var n=(e[e.l++]&96)>>5,s=hI(e,t-1,r);return[n,s]}function SI(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Zp(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function EI(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function TI(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function CI(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function kI(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function PI(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function mw(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function AI(e){return e.read_shift(2),mw(e)}function NI(e){return e.read_shift(2),mw(e)}function DI(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=hw(e,0,r);return[n,s]}function jI(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=gI(e,0,r);return[n,s]}function RI(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=hw(e,0,r);return[n,s,a]}function OI(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[zM[s],xw[s],n]}function II(e,t,r){var n=e[e.l++],s=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:MI(e);return[s,(a[0]===0?xw:HM)[a[1]]]}function MI(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function FI(e,t,r){e.l+=r&&r.biff==2?3:4}function LI(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function BI(e){return e.l++,Ml[e.read_shift(1)]}function $I(e){return e.l++,e.read_shift(2)}function WI(e){return e.l++,e.read_shift(1)!==0}function UI(e){return e.l++,so(e)}function VI(e,t,r){return e.l++,tw(e,t-1,r)}function HI(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=A4(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Ml[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=so(e);break;case 2:r[1]=R4(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function zI(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?za:M4)(e));return s}function GI(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,i=[];a!=n&&(i[a]=[]);++a)for(var o=0;o!=s;++o)i[a][o]=HI(e,r.biff);return i}function KI(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function YI(e,t,r){if(r.biff==5)return XI(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),a=e.read_shift(4);return[n,s,a]}function XI(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function qI(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function JI(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function QI(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function ZI(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,s]}var eM=Un,tM=Un,rM=Un;function Fl(e,t,r){return e.l+=2,[pI(e)]}function P0(e){return e.l+=6,[]}var nM=Fl,sM=P0,aM=P0,iM=Fl;function pw(e){return e.l+=2,[Zf(e),e.read_shift(2)&1]}var oM=Fl,lM=pw,cM=P0,uM=Fl,dM=Fl,fM=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function hM(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),a=e.read_shift(2),i=fM[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:s,C:a}}function mM(e){return e.l+=2,[e.read_shift(4)]}function pM(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function gM(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function xM(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function vM(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function yM(e){return e.l+=4,[0,0]}var eg={1:{n:"PtgExp",f:LI},2:{n:"PtgTbl",f:rM},3:{n:"PtgAdd",f:Nt},4:{n:"PtgSub",f:Nt},5:{n:"PtgMul",f:Nt},6:{n:"PtgDiv",f:Nt},7:{n:"PtgPower",f:Nt},8:{n:"PtgConcat",f:Nt},9:{n:"PtgLt",f:Nt},10:{n:"PtgLe",f:Nt},11:{n:"PtgEq",f:Nt},12:{n:"PtgGe",f:Nt},13:{n:"PtgGt",f:Nt},14:{n:"PtgNe",f:Nt},15:{n:"PtgIsect",f:Nt},16:{n:"PtgUnion",f:Nt},17:{n:"PtgRange",f:Nt},18:{n:"PtgUplus",f:Nt},19:{n:"PtgUminus",f:Nt},20:{n:"PtgPercent",f:Nt},21:{n:"PtgParen",f:Nt},22:{n:"PtgMissArg",f:Nt},23:{n:"PtgStr",f:VI},26:{n:"PtgSheet",f:pM},27:{n:"PtgEndSheet",f:gM},28:{n:"PtgErr",f:BI},29:{n:"PtgBool",f:WI},30:{n:"PtgInt",f:$I},31:{n:"PtgNum",f:UI},32:{n:"PtgArray",f:SI},33:{n:"PtgFunc",f:OI},34:{n:"PtgFuncVar",f:II},35:{n:"PtgName",f:KI},36:{n:"PtgRef",f:DI},37:{n:"PtgArea",f:vI},38:{n:"PtgMemArea",f:qI},39:{n:"PtgMemErr",f:eM},40:{n:"PtgMemNoMem",f:tM},41:{n:"PtgMemFunc",f:JI},42:{n:"PtgRefErr",f:QI},43:{n:"PtgAreaErr",f:wI},44:{n:"PtgRefN",f:jI},45:{n:"PtgAreaN",f:bI},46:{n:"PtgMemAreaN",f:xM},47:{n:"PtgMemNoMemN",f:vM},57:{n:"PtgNameX",f:YI},58:{n:"PtgRef3d",f:RI},59:{n:"PtgArea3d",f:yI},60:{n:"PtgRefErr3d",f:ZI},61:{n:"PtgAreaErr3d",f:_I},255:{}},wM={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},_M={1:{n:"PtgElfLel",f:pw},2:{n:"PtgElfRw",f:uM},3:{n:"PtgElfCol",f:nM},6:{n:"PtgElfRwV",f:dM},7:{n:"PtgElfColV",f:iM},10:{n:"PtgElfRadical",f:oM},11:{n:"PtgElfRadicalS",f:cM},13:{n:"PtgElfColS",f:sM},15:{n:"PtgElfColSV",f:aM},16:{n:"PtgElfRadicalLel",f:lM},25:{n:"PtgList",f:hM},29:{n:"PtgSxName",f:mM},255:{}},bM={0:{n:"PtgAttrNoop",f:yM},1:{n:"PtgAttrSemi",f:PI},2:{n:"PtgAttrIf",f:CI},4:{n:"PtgAttrChoose",f:EI},8:{n:"PtgAttrGoto",f:TI},16:{n:"PtgAttrSum",f:FI},32:{n:"PtgAttrBaxcel",f:Zp},33:{n:"PtgAttrBaxcel",f:Zp},64:{n:"PtgAttrSpace",f:AI},65:{n:"PtgAttrSpaceSemi",f:NI},128:{n:"PtgAttrIfError",f:kI},255:{}};function SM(e,t,r,n){if(n.biff<8)return Un(e,t);for(var s=e.l+t,a=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=GI(e,0,n),a.push(r[i][1]);break;case"PtgMemArea":r[i][2]=zI(e,r[i][1],n),a.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),a.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=s-e.l,t!==0&&a.push(Un(e,t)),a}function EM(e,t,r){for(var n=e.l+t,s,a,i=[];n!=e.l;)t=n-e.l,a=e[e.l],s=eg[a]||eg[wM[a]],(a===24||a===25)&&(s=(a===24?_M:bM)[e[e.l+1]]),!s||!s.f?Un(e,t):i.push([s.n,s.f(e,t,r)]);return i}function TM(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],a=0;a<n.length;++a){var i=n[a];if(i)switch(i[0]){case 2:s.push('"'+i[1].replace(/"/g,'""')+'"');break;default:s.push(i[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var CM={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function kM(e,t){var r=e.lastIndexOf("!"),n=t.lastIndexOf("!");return r==-1&&n==-1?e+":"+t:r>0&&n>0&&e.slice(0,r).toLowerCase()==t.slice(0,n).toLowerCase()?e+":"+t.slice(n+1):(console.error("Cannot hydrate range",e,t),e+":"+t)}function gw(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function tg(e,t,r){var n=gw(e,t,r);return n=="#REF"?n:al(n,r)}function Bi(e,t,r,n,s){var a=s&&s.biff||8,i={s:{c:0,r:0},e:{c:0,r:0}},o=[],c,u,d,f=0,h=0,p,v="";if(!e[0]||!e[0][0])return"";for(var g=-1,x="",y=0,w=e[0].length;y<w;++y){var _=e[0][y];switch(_[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),u=o.pop(),g>=0){switch(e[0][g][1][0]){case 0:x=kt(" ",e[0][g][1][1]);break;case 1:x=kt("\r",e[0][g][1][1]);break;default:if(x="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}u=u+x,g=-1}o.push(u+CM[_[0]]+c);break;case"PtgIsect":c=o.pop(),u=o.pop(),o.push(u+" "+c);break;case"PtgUnion":c=o.pop(),u=o.pop(),o.push(u+","+c);break;case"PtgRange":c=o.pop(),u=o.pop(),o.push(kM(u,c));break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Mo(_[1][1],i,s),o.push(Fo(d,a));break;case"PtgRefN":d=r?Mo(_[1][1],r,s):_[1][1],o.push(Fo(d,a));break;case"PtgRef3d":f=_[1][1],d=Mo(_[1][2],i,s),v=tg(n,f,s),o.push(v+"!"+Fo(d,a));break;case"PtgFunc":case"PtgFuncVar":var b=_[1][0],T=_[1][1];b||(b=0),b&=127;var k=b==0?[]:o.slice(-b);o.length-=b,T==="User"&&(T=k.shift()),o.push(T+"("+k.join(",")+")");break;case"PtgBool":o.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(_[1]);break;case"PtgNum":o.push(String(_[1]));break;case"PtgStr":o.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(_[1]);break;case"PtgAreaN":p=Fp(_[1][1],r?{s:r}:i,s),o.push(tf(p,s));break;case"PtgArea":p=Fp(_[1][1],i,s),o.push(tf(p,s));break;case"PtgArea3d":f=_[1][1],p=_[1][2],v=tg(n,f,s),o.push(v+"!"+tf(p,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=_[1][2];var S=(n.names||[])[h-1]||(n[0]||[])[h],E=S?S.Name:"SH33TJSNAME"+String(h);E&&E.slice(0,6)=="_xlfn."&&!s.xlfn&&(E=E.slice(6)),o.push(E);break;case"PtgNameX":var C=_[1][1];h=_[1][2];var L;if(s.biff<=5)C<0&&(C=-C),n[C]&&(L=n[C][h]);else{var M="";if(((n[C]||[])[0]||[])[0]==14849||(((n[C]||[])[0]||[])[0]==1025?n[C][h]&&n[C][h].itab>0&&(M=n.SheetNames[n[C][h].itab-1]+"!"):M=n.SheetNames[h-1]+"!"),n[C]&&n[C][h])M+=n[C][h].Name;else if(n[0]&&n[0][h])M+=n[0][h].Name;else{var j=(gw(n,C,s)||"").split(";;");j[h-1]?M=j[h-1]:M+="SH33TJSERRX"}o.push(M);break}L||(L={Name:"SH33TJSERRY"}),o.push(L.Name);break;case"PtgParen":var V="(",A=")";if(g>=0){switch(x="",e[0][g][1][0]){case 2:V=kt(" ",e[0][g][1][1])+V;break;case 3:V=kt("\r",e[0][g][1][1])+V;break;case 4:A=kt(" ",e[0][g][1][1])+A;break;case 5:A=kt("\r",e[0][g][1][1])+A;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}o.push(V+o.pop()+A);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:_[1][1],r:_[1][0]};var H={c:r.c,r:r.r};if(n.sharedf[Tt(d)]){var G=n.sharedf[Tt(d)];o.push(Bi(G,i,H,n,s))}else{var q=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){o.push(Bi(u[1],i,H,n,s)),q=!0;break}q||o.push(_[1])}break;case"PtgArray":o.push("{"+TM(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=y;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var Y=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&g>=0&&Y.indexOf(e[0][y][0])==-1){_=e[0][g];var Q=!0;switch(_[1][0]){case 4:Q=!1;case 0:x=kt(" ",_[1][1]);break;case 5:Q=!1;case 1:x=kt("\r",_[1][1]);break;default:if(x="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}o.push((Q?x:"")+o.pop()+(Q?"":x)),g=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]=="TRUE"?!0:o[0]=="FALSE"?!1:o[0]}function PM(e){if(e==null){var t=ae(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Da(e);return Da(0)}function AM(e,t,r,n,s){var a=ja(t,r,s),i=PM(e.v),o=ae(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var u=ae(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var f=$t([a,i,o,u]);return f}function cd(e,t,r){var n=e.read_shift(4),s=EM(e,n,r),a=e.read_shift(4),i=a>0?SM(e,a,s,r):null;return[s,i]}var NM=cd,ud=cd,DM=cd,jM=cd;function rg(e){if((e|0)==e&&e<Math.pow(2,16)&&e>=0){var t=ae(11);return t.write_shift(4,3),t.write_shift(1,30),t.write_shift(2,e),t.write_shift(4,0),t}var r=ae(17);return r.write_shift(4,11),r.write_shift(1,31),r.write_shift(8,e),r.write_shift(4,0),r}function RM(e){var t=ae(10);return t.write_shift(4,2),t.write_shift(1,28),t.write_shift(1,e),t.write_shift(4,0),t}function OM(e){var t=ae(10);return t.write_shift(4,2),t.write_shift(1,29),t.write_shift(1,e?1:0),t.write_shift(4,0),t}function IM(e){var t=ae(7);t.write_shift(4,3+2*e.length),t.write_shift(1,23),t.write_shift(2,e.length);var r=ae(2*e.length);r.write_shift(2*e.length,e,"utf16le");var n=ae(4);return n.write_shift(4,0),$t([t,r,n])}function MM(e){var t=_t(e),r=ae(15);return r.write_shift(4,7),r.write_shift(1,36),r.write_shift(4,t.r),r.write_shift(2,t.c|(e.charAt(0)=="$"?0:1)<<14|(e.match(/\$\d/)?0:1)<<15),r.write_shift(4,0),r}function FM(e,t){var r=e.lastIndexOf("!"),n=e.slice(0,r);e=e.slice(r+1);var s=_t(e);n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var a=ae(17);return a.write_shift(4,9),a.write_shift(1,58),a.write_shift(2,2+t.SheetNames.map(function(i){return i.toLowerCase()}).indexOf(n.toLowerCase())),a.write_shift(4,s.r),a.write_shift(2,s.c|(e.charAt(0)=="$"?0:1)<<14|(e.match(/\$\d/)?0:1)<<15),a.write_shift(4,0),a}function LM(e,t){var r=e.lastIndexOf("!"),n=e.slice(0,r);e=e.slice(r+1),n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var s=ae(17);return s.write_shift(4,9),s.write_shift(1,60),s.write_shift(2,2+t.SheetNames.map(function(a){return a.toLowerCase()}).indexOf(n.toLowerCase())),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(4,0),s}function BM(e){var t=e.split(":"),r=t[0],n=ae(23);n.write_shift(4,15),r=t[0];var s=_t(r);return n.write_shift(1,36),n.write_shift(4,s.r),n.write_shift(2,s.c|(r.charAt(0)=="$"?0:1)<<14|(r.match(/\$\d/)?0:1)<<15),n.write_shift(4,0),r=t[1],s=_t(r),n.write_shift(1,36),n.write_shift(4,s.r),n.write_shift(2,s.c|(r.charAt(0)=="$"?0:1)<<14|(r.match(/\$\d/)?0:1)<<15),n.write_shift(4,0),n.write_shift(1,17),n.write_shift(4,0),n}function $M(e,t){var r=e.lastIndexOf("!"),n=e.slice(0,r);e=e.slice(r+1),n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var s=e.split(":");i=s[0];var a=ae(27);a.write_shift(4,19);var i=s[0],o=_t(i);return a.write_shift(1,58),a.write_shift(2,2+t.SheetNames.map(function(c){return c.toLowerCase()}).indexOf(n.toLowerCase())),a.write_shift(4,o.r),a.write_shift(2,o.c|(i.charAt(0)=="$"?0:1)<<14|(i.match(/\$\d/)?0:1)<<15),i=s[1],o=_t(i),a.write_shift(1,58),a.write_shift(2,2+t.SheetNames.map(function(c){return c.toLowerCase()}).indexOf(n.toLowerCase())),a.write_shift(4,o.r),a.write_shift(2,o.c|(i.charAt(0)=="$"?0:1)<<14|(i.match(/\$\d/)?0:1)<<15),a.write_shift(1,17),a.write_shift(4,0),a}function WM(e,t){var r=e.lastIndexOf("!"),n=e.slice(0,r);e=e.slice(r+1),n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var s=Zt(e),a=ae(23);return a.write_shift(4,15),a.write_shift(1,59),a.write_shift(2,2+t.SheetNames.map(function(i){return i.toLowerCase()}).indexOf(n.toLowerCase())),a.write_shift(4,s.s.r),a.write_shift(4,s.e.r),a.write_shift(2,s.s.c),a.write_shift(2,s.e.c),a.write_shift(4,0),a}function UM(e,t){if(typeof e=="number")return rg(e);if(typeof e=="boolean")return OM(e);if(/^#(DIV\/0!|GETTING_DATA|N\/A|NAME\?|NULL!|NUM!|REF!|VALUE!)$/.test(e))return RM(+v4[e]);if(e.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return MM(e);if(e.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return BM(e);if(e.match(/^#REF!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return WM(e,t);if(e.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return FM(e,t);if(e.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return $M(e,t);if(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!#REF!$/.test(e))return LM(e,t);if(/^".*"$/.test(e))return IM(e);if(/^[+-]\d+$/.test(e))return rg(parseInt(e,10));throw"Formula |"+e+"| not supported for XLSB"}var VM=UM,HM={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},xw={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},zM={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function GM(e){var t="of:="+e.replace(k0,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function vw(e){return e.replace(/!/,".")}var Lo=typeof Map<"u";function A0(e,t,r){var n=0,s=e.length;if(r){if(Lo?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var a=Lo?r.get(t):r[t];n<a.length;++n)if(e[a[n]].t===t)return e.Count++,a[n]}}else for(;n<s;++n)if(e[n].t===t)return e.Count++,n;return e[s]={t},e.Count++,e.Unique++,r&&(Lo?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function dd(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(os=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=iu(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=eh(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function yw(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function ta(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],s=60,a=e.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){ER(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=n=s;break}}for(s=0;s!=a;++s)if(e[s].numFmtId===n)return s;return e[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function KM(e,t,r){if(e&&e["!ref"]){var n=yt(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function YM(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Ot(e[r])+'"/>';return t+"</mergeCells>"}function XM(e,t,r,n,s){var a=!1,i={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}a=!0,i.codeName=rl(Ue(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),o=(o||"")+ve("outlinePr",null,u)}!a&&!o||(s[s.length]=ve("sheetPr",o,i))}var qM=["objects","scenarios","selectLockedCells","selectUnlockedCells"],JM=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function QM(e){var t={sheet:1};return qM.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),JM.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=aw(e.password).toString(16).toUpperCase()),ve("sheetProtection",null,t)}function ZM(e){return yw(e),ve("pageMargins",null,e)}function eF(e,t){for(var r=["<cols>"],n,s=0;s!=t.length;++s)(n=t[s])&&(r[r.length]=ve("col",null,dd(s,n)));return r[r.length]="</cols>",r.join("")}function tF(e,t,r,n){var s=typeof e.ref=="string"?e.ref:Ot(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,i=Zt(s);i.s.r==i.e.r&&(i.e.r=Zt(t["!ref"]).e.r,s=Ot(i));for(var o=0;o<a.length;++o){var c=a[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref=al(r.SheetNames[n])+"!"+sl(s);break}}return o==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),ve("autoFilter",null,{ref:s})}function rF(e,t,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),ve("sheetViews",ve("sheetView",null,s),{})}function nF(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),(e.v===void 0||e.t==="z"&&!(n||{}).sheetStubs)&&typeof e.f!="string"&&typeof e.z>"u")return"";var s="",a=e.t,i=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=Ml[e.v];break;case"d":n&&n.cellDates?s=Pr(e.v,-1).toISOString():(e=yr(e),e.t="n",s=""+(e.v=vr(Pr(e.v)))),typeof e.z>"u"&&(e.z=Pt[14]);break;default:s=e.v;break}var o=e.t=="z"||e.v==null?"":Qt("v",Ue(s)),c={r:t},u=ta(n.cellXfs,e,n);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Qt("v",""+A0(n.Strings,e.v,n.revStrings)),c.t="s";break}else c.t="str";break}if(e.t!=a&&(e.t=a,e.v=i),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=ve("f",Ue(e.f),d)+(e.v!=null?o:"")}return e.l&&(e.l.display=Ue(s),r["!links"].push([t,e.l])),e.D&&(c.cm=1),ve("c",o,c)}function sF(e,t,r,n){var s=[],a=[],i=yt(e["!ref"]),o="",c,u="",d=[],f=0,h=0,p=e["!rows"],v=e["!data"]!=null,g={r:u},x,y=-1;for(h=i.s.c;h<=i.e.c;++h)d[h]=xt(h);for(f=i.s.r;f<=i.e.r;++f){for(a=[],u=gt(f),h=i.s.c;h<=i.e.c;++h){c=d[h]+u;var w=v?(e["!data"][f]||[])[h]:e[c];w!==void 0&&(o=nF(w,c,e,t))!=null&&a.push(o)}(a.length>0||p&&p[f])&&(g={r:u},p&&p[f]&&(x=p[f],x.hidden&&(g.hidden=1),y=-1,x.hpx?y=ou(x.hpx):x.hpt&&(y=x.hpt),y>-1&&(g.ht=y,g.customHeight=1),x.level&&(g.outlineLevel=x.level)),s[s.length]=ve("row",a.join(""),g))}if(p)for(;f<p.length;++f)p&&p[f]&&(g={r:f+1},x=p[f],x.hidden&&(g.hidden=1),y=-1,x.hpx?y=ou(x.hpx):x.hpt&&(y=x.hpt),y>-1&&(g.ht=y,g.customHeight=1),x.level&&(g.outlineLevel=x.level),s[s.length]=ve("row","",g));return s.join("")}function aF(e,t,r,n){var s=[It,ve("worksheet",null,{xmlns:eo[0],"xmlns:r":Gt.r})],a=r.SheetNames[e],i=0,o="",c=r.Sheets[a];c==null&&(c={});var u=c["!ref"]||"A1",d=yt(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=Ot(d)}n||(n={}),c["!comments"]=[];var f=[];XM(c,r,e,t,s),s[s.length]=ve("dimension",null,{ref:u}),s[s.length]=rF(c,t,e,r),t.sheetFormat&&(s[s.length]=ve("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(s[s.length]=eF(c,c["!cols"])),s[i=s.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=sF(c,t),o.length>0&&(s[s.length]=o)),s.length>i+1&&(s[s.length]="</sheetData>",s[i]=s[i].replace("/>",">")),c["!protect"]&&(s[s.length]=QM(c["!protect"])),c["!autofilter"]!=null&&(s[s.length]=tF(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(s[s.length]=YM(c["!merges"]));var h=-1,p,v=-1;return c["!links"].length>0&&(s[s.length]="<hyperlinks>",c["!links"].forEach(function(g){g[1].Target&&(p={ref:g[0]},g[1].Target.charAt(0)!="#"&&(v=ft(n,-1,Ue(g[1].Target).replace(/#.*$/,""),tt.HLINK),p["r:id"]="rId"+v),(h=g[1].Target.indexOf("#"))>-1&&(p.location=Ue(g[1].Target.slice(h+1))),g[1].Tooltip&&(p.tooltip=Ue(g[1].Tooltip)),p.display=g[1].display,s[s.length]=ve("hyperlink",null,p))}),s[s.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(s[s.length]=ZM(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=Qt("ignoredErrors",ve("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(v=ft(n,-1,"../drawings/drawing"+(e+1)+".xml",tt.DRAW),s[s.length]=ve("drawing",null,{"r:id":"rId"+v}),c["!drawing"]=f),c["!comments"].length>0&&(v=ft(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",tt.VML),s[s.length]=ve("legacyDrawing",null,{"r:id":"rId"+v}),c["!legacy"]=v),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function iF(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}function oF(e,t,r){var n=ae(145),s=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var a=320;s.hpx?a=ou(s.hpx)*20:s.hpt&&(a=s.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var i=0;s.level&&(i|=s.level),s.hidden&&(i|=16),(s.hpx||s.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var u={r:e,c:0},d=r["!data"]!=null,f=0;f<16;++f)if(!(t.s.c>f+1<<10||t.e.c<f<<10)){for(var h=-1,p=-1,v=f<<10;v<f+1<<10;++v){u.c=v;var g=d?(r["!data"][u.r]||[])[u.c]:r[Tt(u)];g&&(h<0&&(h=v),p=v)}h<0||(++o,n.write_shift(4,h),n.write_shift(4,p))}var x=n.l;return n.l=c,n.write_shift(4,o),n.l=x,n.length>n.l?n.slice(0,n.l):n}function lF(e,t,r,n){var s=oF(n,r,t);(s.length>17||(t["!rows"]||[])[n])&&ce(e,0,s)}var cF=za,uF=no;function dF(){}function fF(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=a4(e),r}function hF(e,t,r){r==null&&(r=ae(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return nu({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),$y(e,r),r.slice(0,r.l)}function mF(e){var t=an(e);return[t]}function pF(e,t,r){return r==null&&(r=ae(8)),Ua(t,r)}function gF(e){var t=Va(e);return[t]}function xF(e,t,r){return r==null&&(r=ae(4)),Ha(t,r)}function vF(e){var t=an(e),r=e.read_shift(1);return[t,r,"b"]}function yF(e,t,r){return r==null&&(r=ae(9)),Ua(t,r),r.write_shift(1,e.v?1:0),r}function wF(e){var t=Va(e),r=e.read_shift(1);return[t,r,"b"]}function _F(e,t,r){return r==null&&(r=ae(5)),Ha(t,r),r.write_shift(1,e.v?1:0),r}function bF(e){var t=an(e),r=e.read_shift(1);return[t,r,"e"]}function SF(e,t,r){return r==null&&(r=ae(9)),Ua(t,r),r.write_shift(1,e.v),r}function EF(e){var t=Va(e),r=e.read_shift(1);return[t,r,"e"]}function TF(e,t,r){return r==null&&(r=ae(8)),Ha(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function CF(e){var t=an(e),r=e.read_shift(4);return[t,r,"s"]}function kF(e,t,r){return r==null&&(r=ae(12)),Ua(t,r),r.write_shift(4,t.v),r}function PF(e){var t=Va(e),r=e.read_shift(4);return[t,r,"s"]}function AF(e,t,r){return r==null&&(r=ae(8)),Ha(t,r),r.write_shift(4,t.v),r}function NF(e){var t=an(e),r=so(e);return[t,r,"n"]}function DF(e,t,r){return r==null&&(r=ae(16)),Ua(t,r),Da(e.v,r),r}function jF(e){var t=Va(e),r=so(e);return[t,r,"n"]}function RF(e,t,r){return r==null&&(r=ae(12)),Ha(t,r),Da(e.v,r),r}function OF(e){var t=an(e),r=Wy(e);return[t,r,"n"]}function IF(e,t,r){return r==null&&(r=ae(12)),Ua(t,r),Uy(e.v,r),r}function MF(e){var t=Va(e),r=Wy(e);return[t,r,"n"]}function FF(e,t,r){return r==null&&(r=ae(8)),Ha(t,r),Uy(e.v,r),r}function LF(e){var t=an(e),r=b0(e);return[t,r,"is"]}function BF(e){var t=an(e),r=ir(e);return[t,r,"str"]}function $F(e,t,r){var n=e.v==null?"":String(e.v);return r==null&&(r=ae(12+4*e.v.length)),Ua(t,r),Wt(n,r),r.length>r.l?r.slice(0,r.l):r}function WF(e){var t=Va(e),r=ir(e);return[t,r,"str"]}function UF(e,t,r){var n=e.v==null?"":String(e.v);return r==null&&(r=ae(8+4*n.length)),Ha(t,r),Wt(n,r),r.length>r.l?r.slice(0,r.l):r}function VF(e,t,r){var n=e.l+t,s=an(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"b"];if(r.cellFormula){e.l+=2;var o=ud(e,n-e.l,r);i[3]=Bi(o,null,s,r.supbooks,r)}else e.l=n;return i}function HF(e,t,r){var n=e.l+t,s=an(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"e"];if(r.cellFormula){e.l+=2;var o=ud(e,n-e.l,r);i[3]=Bi(o,null,s,r.supbooks,r)}else e.l=n;return i}function zF(e,t,r){var n=e.l+t,s=an(e);s.r=r["!row"];var a=so(e),i=[s,a,"n"];if(r.cellFormula){e.l+=2;var o=ud(e,n-e.l,r);i[3]=Bi(o,null,s,r.supbooks,r)}else e.l=n;return i}function GF(e,t,r){var n=e.l+t,s=an(e);s.r=r["!row"];var a=ir(e),i=[s,a,"str"];if(r.cellFormula){e.l+=2;var o=ud(e,n-e.l,r);i[3]=Bi(o,null,s,r.supbooks,r)}else e.l=n;return i}var KF=za,YF=no;function XF(e,t){return t==null&&(t=ae(4)),t.write_shift(4,e),t}function qF(e,t){var r=e.l+t,n=za(e),s=S0(e),a=ir(e),i=ir(e),o=ir(e);e.l=r;var c={rfx:n,relId:s,loc:a,display:o};return i&&(c.Tooltip=i),c}function JF(e,t){var r=ae(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));no({s:_t(e[0]),e:_t(e[0])},r),E0("rId"+t,r);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return Wt(s||"",r),Wt(e[1].Tooltip||"",r),Wt("",r),r.slice(0,r.l)}function QF(){}function ZF(e,t,r){var n=e.l+t,s=Vy(e),a=e.read_shift(1),i=[s];if(i[2]=a,r.cellFormula){var o=NM(e,n-e.l,r);i[1]=o}else e.l=n;return i}function eL(e,t,r){var n=e.l+t,s=za(e),a=[s];if(r.cellFormula){var i=jM(e,n-e.l,r);a[1]=i,e.l=n}else e.l=n;return a}function tL(e,t,r){r==null&&(r=ae(18));var n=dd(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var ww=["left","right","top","bottom","header","footer"];function rL(e){var t={};return ww.forEach(function(r){t[r]=so(e)}),t}function nL(e,t){return t==null&&(t=ae(6*8)),yw(e),ww.forEach(function(r){Da(e[r],t)}),t}function sL(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function aL(e,t,r){r==null&&(r=ae(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function iL(e){var t=ae(24);return t.write_shift(4,4),t.write_shift(4,1),no(e,t),t}function oL(e,t){return t==null&&(t=ae(16*4+2)),t.write_shift(2,e.password?aw(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function lL(){}function cL(){}function uL(e,t,r,n,s,a,i){var o={r,c:n};if(t.c&&a["!comments"].push([Tt(o),t.c]),t.v===void 0)return!1;var c="";switch(t.t){case"b":c=t.v?"1":"0";break;case"d":t=yr(t),t.z=t.z||Pt[14],t.v=vr(Pr(t.v)),t.t="n";break;case"n":case"e":c=""+t.v;break;default:c=t.v;break}switch(o.s=ta(s.cellXfs,t,s),t.l&&a["!links"].push([Tt(o),t.l]),t.t){case"s":case"str":return s.bookSST?(c=A0(s.Strings,t.v==null?"":String(t.v),s.revStrings),o.t="s",o.v=c,i?ce(e,18,AF(t,o)):ce(e,7,kF(t,o))):(o.t="str",i?ce(e,17,UF(t,o)):ce(e,6,$F(t,o))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?i?ce(e,13,FF(t,o)):ce(e,2,IF(t,o)):i?ce(e,16,RF(t,o)):ce(e,5,DF(t,o)),!0;case"b":return o.t="b",i?ce(e,15,_F(t,o)):ce(e,4,yF(t,o)),!0;case"e":return o.t="e",i?ce(e,14,TF(t,o)):ce(e,3,SF(t,o)),!0}return i?ce(e,12,xF(t,o)):ce(e,1,pF(t,o)),!0}function dL(e,t,r,n){var s=yt(t["!ref"]||"A1"),a,i="",o=[];ce(e,145);var c=t["!data"]!=null,u=s.e.r;t["!rows"]&&(u=Math.max(s.e.r,t["!rows"].length-1));for(var d=s.s.r;d<=u;++d){i=gt(d),lF(e,t,s,d);var f=!1;if(d<=s.e.r)for(var h=s.s.c;h<=s.e.c;++h){d===s.s.r&&(o[h]=xt(h)),a=o[h]+i;var p=c?(t["!data"][d]||[])[h]:t[a];if(!p){f=!1;continue}f=uL(e,p,d,h,n,t,f)}}ce(e,146)}function fL(e,t){!t||!t["!merges"]||(ce(e,177,XF(t["!merges"].length)),t["!merges"].forEach(function(r){ce(e,176,YF(r))}),ce(e,178))}function hL(e,t){!t||!t["!cols"]||(ce(e,390),t["!cols"].forEach(function(r,n){r&&ce(e,60,tL(n,r))}),ce(e,391))}function mL(e,t){!t||!t["!ref"]||(ce(e,648),ce(e,649,iL(yt(t["!ref"]))),ce(e,650))}function pL(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var s=ft(r,-1,n[1].Target.replace(/#.*$/,""),tt.HLINK);ce(e,494,JF(n,s))}}),delete t["!links"]}function gL(e,t,r,n){if(t["!comments"].length>0){var s=ft(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",tt.VML);ce(e,551,E0("rId"+s)),t["!legacy"]=s}}function xL(e,t,r,n){if(t["!autofilter"]){var s=t["!autofilter"],a=typeof s.ref=="string"?s.ref:Ot(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=Zt(a);o.s.r==o.e.r&&(o.e.r=Zt(t["!ref"]).e.r,a=Ot(o));for(var c=0;c<i.length;++c){var u=i[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref=al(r.SheetNames[n])+"!"+sl(a);break}}c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:al(r.SheetNames[n])+"!"+sl(a)}),ce(e,161,no(yt(a))),ce(e,162)}}function vL(e,t,r){ce(e,133),ce(e,137,aL(t,r)),ce(e,138),ce(e,134)}function yL(e,t){t["!protect"]&&ce(e,535,oL(t["!protect"]))}function wL(e,t,r,n){var s=kr(),a=r.SheetNames[e],i=r.Sheets[a]||{},o=a;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var c=yt(i["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],ce(s,129),(r.vbaraw||i["!outline"])&&ce(s,147,hF(o,i["!outline"])),ce(s,148,uF(c)),vL(s,i,r.Workbook),hL(s,i),dL(s,i,e,t),yL(s,i),xL(s,i,r,e),fL(s,i),pL(s,i,n),i["!margins"]&&ce(s,476,nL(i["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&mL(s,i),gL(s,i,e,n),ce(s,130),s.end()}function _L(e,t){e.l+=10;var r=ir(e);return{name:r}}var bL=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function SL(e){return!e.Workbook||!e.Workbook.WBProps?"false":FR(e.Workbook.WBProps.date1904)?"true":"false"}var EL=":][*?/\\".split("");function _w(e,t){try{if(e=="")throw new Error("Sheet name cannot be blank");if(e.length>31)throw new Error("Sheet name cannot exceed 31 chars");if(e.charCodeAt(0)==39||e.charCodeAt(e.length-1)==39)throw new Error("Sheet name cannot start or end with apostrophe (')");if(e.toLowerCase()=="history")throw new Error("Sheet name cannot be 'History'");EL.forEach(function(r){if(e.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")})}catch(r){throw r}return!0}function TL(e,t,r){e.forEach(function(n,s){_w(n);for(var a=0;a<s;++a)if(n==e[a])throw new Error("Duplicate Sheet Name: "+n);if(r){var i=t&&t[s]&&t[s].CodeName||n;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function CL(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];TL(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)KM(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r);e.SheetNames.forEach(function(n,s){var a=e.Sheets[n];if(!(!a||!a["!autofilter"])){var i;e.Workbook||(e.Workbook={}),e.Workbook.Names||(e.Workbook.Names=[]),e.Workbook.Names.forEach(function(c){c.Name=="_xlnm._FilterDatabase"&&c.Sheet==s&&(i=c)});var o=al(n)+"!"+sl(a["!autofilter"].ref);i?i.Ref=o:e.Workbook.Names.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:o})}})}function kL(e){var t=[It];t[t.length]=ve("workbook",null,{xmlns:eo[0],"xmlns:r":Gt.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(bL.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=ve("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],a=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=e.SheetNames.length&&!(!s[a]||!s[a].Hidden);++a);a==e.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var i={name:Ue(e.SheetNames[a].slice(0,31))};if(i.sheetId=""+(a+1),i["r:id"]="rId"+(a+1),s[a])switch(s[a].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}t[t.length]=ve("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(t[t.length]=ve("definedName",Ue(o.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function PL(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Qf(e),r.name=ir(e),r}function AL(e,t){return t||(t=ae(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),E0(e.strRelID,t),Wt(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function NL(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?ir(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function DL(e,t){t||(t=ae(72));var r=0;return e&&(e.date1904&&(r|=1),e.filterPrivacy&&(r|=8)),t.write_shift(4,r),t.write_shift(4,0),$y(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function jL(e,t,r){var n=e.l+t,s=e.read_shift(4);e.l+=1;var a=e.read_shift(4),i=i4(e),o=DM(e,0,r),c=S0(e);s&32&&(i="_xlnm."+i),e.l=n;var u={Name:i,Ptg:o,Flags:s};return a<268435455&&(u.Sheet=a),c&&(u.Comment=c),u}function RL(e,t){var r=ae(9),n=0,s=e.Name;y4.indexOf(s)>-1&&(n|=32,s=s.slice(6)),r.write_shift(4,n),r.write_shift(1,0),r.write_shift(4,e.Sheet==null?4294967295:e.Sheet);var a=[r,Wt(s),VM(e.Ref,t)];if(e.Comment)a.push(il(e.Comment));else{var i=ae(4);i.write_shift(4,4294967295),a.push(i)}return $t(a)}function OL(e,t){ce(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};ce(e,156,AL(s))}ce(e,144)}function IL(e,t){t||(t=ae(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Wt("SheetJS",t),Wt(Xc.version,t),Wt(Xc.version,t),Wt("7262",t),t.length>t.l?t.slice(0,t.l):t}function ML(e,t){t||(t=ae(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function FL(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,s=-1,a=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&a==-1&&(a=n);a>s||(ce(e,135),ce(e,158,ML(s)),ce(e,136))}}function LL(e,t){!t.Workbook||!t.Workbook.Names||t.Workbook.Names.forEach(function(r){try{if(r.Flags&14)return;ce(e,39,RL(r,t))}catch{console.error("Could not serialize defined name "+JSON.stringify(r))}})}function BL(e){var t=e.SheetNames.length,r=ae(12*t+28);r.write_shift(4,t+2),r.write_shift(4,0),r.write_shift(4,-2),r.write_shift(4,-2),r.write_shift(4,0),r.write_shift(4,-1),r.write_shift(4,-1);for(var n=0;n<t;++n)r.write_shift(4,0),r.write_shift(4,n),r.write_shift(4,n);return r}function $L(e,t){ce(e,353),ce(e,357),ce(e,362,BL(t)),ce(e,354)}function WL(e,t){var r=kr();return ce(r,131),ce(r,128,IL()),ce(r,153,DL(e.Workbook&&e.Workbook.WBProps||null)),FL(r,e),OL(r,e),$L(r,e),(e.Workbook||{}).Names&&LL(r,e),ce(r,132),r.end()}function UL(e,t){var r=[];return e.Props&&r.push(E4(e.Props,t)),e.Custprops&&r.push(T4(e.Props,e.Custprops)),r.join("")}function VL(e){return(((e||{}).Workbook||{}).WBProps||{}).date1904?'<ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel"><Date1904/></ExcelWorkbook>':""}function HL(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,s){var a=[];a.push(ve("NumberFormat",null,{"ss:Format":Ue(Pt[n.numFmtId])}));var i={"ss:ID":"s"+(21+s)};r.push(ve("Style",a.join(""),i))}),ve("Styles",r.join(""))}function bw(e){return ve("NamedRange",null,{"ss:Name":e.Name.slice(0,6)=="_xlnm."?e.Name.slice(6):e.Name,"ss:RefersTo":"="+ld(e.Ref,{r:0,c:0})})}function zL(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var s=t[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(bw(s)))}return ve("Names",r.join(""))}function GL(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,a=[],i=0;i<s.length;++i){var o=s[i];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||a.push(bw(o)))}return a.join("")}function KL(e,t,r,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(ve("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(ve("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(ve("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(ve("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(Qt("ProtectContents","True")),e["!protect"].objects&&s.push(Qt("ProtectObjects","True")),e["!protect"].scenarios&&s.push(Qt("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(Qt("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(Qt("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){e["!protect"][i[0]]&&s.push("<"+i[1]+"/>")})),s.length==0?"":ve("WorksheetOptions",s.join(""),{xmlns:$r.x})}function YL(e){return e.map(function(t){var r=MR(t.t||""),n=ve("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return ve("Comment",n,{"ss:Author":t.a})}).join("")}function XL(e,t,r,n,s,a,i){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+Ue(ld(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var c=_t(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==i.r?"":"["+(c.r-i.r)+"]")+"C"+(c.c==i.c?"":"["+(c.c-i.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=Ue(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=Ue(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=i.c||u[d].s.r!=i.r||(u[d].e.c>u[d].s.c&&(o["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(o["ss:MergeDown"]=u[d].e.r-u[d].s.r));var f="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",h=String(e.v);break;case"b":f="Boolean",h=e.v?"1":"0";break;case"e":f="Error",h=Ml[e.v];break;case"d":f="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Pt[14]);break;case"s":f="String",h=IR(e.v||"");break}var p=ta(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+p),o["ss:Index"]=i.c+1;var v=e.v!=null?h:"",g=e.t=="z"?"":'<Data ss:Type="'+f+'">'+v+"</Data>";return(e.c||[]).length>0&&(g+=YL(e.c)),ve("Cell",g,o)}function qL(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=ow(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function JL(e,t,r,n){if(!e["!ref"])return"";var s=yt(e["!ref"]),a=e["!merges"]||[],i=0,o=[];e["!cols"]&&e["!cols"].forEach(function(x,y){C0(x);var w=!!x.width,_=dd(y,x),b={"ss:Index":y+1};w&&(b["ss:Width"]=au(_.width)),x.hidden&&(b["ss:Hidden"]="1"),o.push(ve("Column",null,b))});for(var c=e["!data"]!=null,u=s.s.r;u<=s.e.r;++u){for(var d=[qL(u,(e["!rows"]||[])[u])],f=s.s.c;f<=s.e.c;++f){var h=!1;for(i=0;i!=a.length;++i)if(!(a[i].s.c>f)&&!(a[i].s.r>u)&&!(a[i].e.c<f)&&!(a[i].e.r<u)){(a[i].s.c!=f||a[i].s.r!=u)&&(h=!0);break}if(!h){var p={r:u,c:f},v=xt(f)+gt(u),g=c?(e["!data"][u]||[])[f]:e[v];d.push(XL(g,v,e,t,r,n,p))}}d.push("</Row>"),d.length>2&&o.push(d.join(""))}return o.join("")}function QL(e,t,r){var n=[],s=r.SheetNames[e],a=r.Sheets[s],i=a?GL(a,t,e,r):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=a?JL(a,t,e,r):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push(KL(a,t,e,r)),a["!autofilter"]&&n.push('<AutoFilter x:Range="'+ld(sl(a["!autofilter"].ref),{r:0,c:0})+'" xmlns="urn:schemas-microsoft-com:office:excel"></AutoFilter>'),n.join("")}function ZL(e,t){t||(t={}),e.SSF||(e.SSF=yr(Pt)),e.SSF&&(id(),ad(e.SSF),t.revssf=od(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],ta(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(UL(e,t)),r.push(VL(e)),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(ve("Worksheet",QL(n,t,e),{"ss:Name":Ue(e.SheetNames[n])}));return r[2]=HL(e,t),r[3]=zL(e),It+ve("Workbook",r.join(""),{xmlns:$r.ss,"xmlns:o":$r.o,"xmlns:x":$r.x,"xmlns:ss":$r.ss,"xmlns:dt":$r.dt,"xmlns:html":$r.html})}var sf={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function e3(e,t){var r=[],n=[],s=[],a=0,i,o=Tp(Bp,"n"),c=Tp($p,"n");if(e.Props)for(i=Ut(e.Props),a=0;a<i.length;++a)(Object.prototype.hasOwnProperty.call(o,i[a])?r:Object.prototype.hasOwnProperty.call(c,i[a])?n:s).push([i[a],e.Props[i[a]]]);if(e.Custprops)for(i=Ut(e.Custprops),a=0;a<i.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},i[a])||(Object.prototype.hasOwnProperty.call(o,i[a])?r:Object.prototype.hasOwnProperty.call(c,i[a])?n:s).push([i[a],e.Custprops[i[a]]]);var u=[];for(a=0;a<s.length;++a)Zy.indexOf(s[a][0])>-1||qy.indexOf(s[a][0])>-1||s[a][1]!=null&&u.push(s[a]);n.length&&pt.utils.cfb_add(t,"/SummaryInformation",zp(n,sf.SI,c,$p)),(r.length||u.length)&&pt.utils.cfb_add(t,"/DocumentSummaryInformation",zp(r,sf.DSI,o,Bp,u.length?u:null,sf.UDI))}function t3(e,t){var r=t||{},n=pt.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return pt.utils.cfb_add(n,s,Sw(e,r)),r.biff==8&&(e.Props||e.Custprops)&&e3(e,n),r.biff==8&&e.vbaraw&&cI(n,pt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var r3={0:{f:iF},1:{f:mF},2:{f:OF},3:{f:bF},4:{f:vF},5:{f:NF},6:{f:BF},7:{f:CF},8:{f:GF},9:{f:zF},10:{f:VF},11:{f:HF},12:{f:gF},13:{f:MF},14:{f:EF},15:{f:wF},16:{f:jF},17:{f:WF},18:{f:PF},19:{f:b0},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:jL},40:{},42:{},43:{f:TO},44:{f:SO},45:{f:PO},46:{f:NO},47:{f:AO},48:{},49:{f:ZR},50:{},51:{f:GO},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:tO},62:{f:LF},63:{f:ZO},64:{f:lL},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Un,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:sL},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:fF},148:{f:cF,p:16},151:{f:QF},152:{},153:{f:NL},154:{},155:{},156:{f:PL},157:{},158:{},159:{T:1,f:fO},160:{T:-1},161:{T:1,f:za},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:KF},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:HO},336:{T:-1},337:{f:XO,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Qf},357:{},358:{},359:{},360:{T:1},361:{},362:{f:q4},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:ZF},427:{f:eL},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:rL},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:dF},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:qF},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Qf},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:iI},633:{T:1},634:{T:-1},635:{T:1,f:sI},636:{T:-1},637:{f:n4},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:_L},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:cL},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function we(e,t,r,n){var s=t;if(!isNaN(s)){var a=n||(r||[]).length||0,i=e.next(4);i.write_shift(2,s),i.write_shift(2,a),a>0&&y0(r)&&e.push(r)}}function n3(e,t,r,n){var s=(r||[]).length||0;if(s<=8224)return we(e,t,r,s);var a=t;if(!isNaN(a)){for(var i=r.parts||[],o=0,c=0,u=0;u+(i[o]||8224)<=8224;)u+=i[o]||8224,o++;var d=e.next(4);for(d.write_shift(2,a),d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<s;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(i[o]||8224)<=8224;)u+=i[o]||8224,o++;d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function Ll(e,t,r){return e||(e=ae(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function s3(e,t,r,n){var s=ae(9);return Ll(s,e,t),ew(r,n||"b",s),s}function a3(e,t,r){var n=ae(8+2*r.length);return Ll(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function i3(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?vr(Pr(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?we(e,2,aO(r,n,s)):we(e,3,sO(r,n,s));return;case"b":case"e":we(e,5,s3(r,n,t.v,t.t));return;case"s":case"str":we(e,4,a3(r,n,t.v==null?"":String(t.v).slice(0,255)));return}we(e,1,Ll(null,r,n))}function o3(e,t,r,n){var s=t["!data"]!=null,a=yt(t["!ref"]||"A1"),i="",o=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383)}for(var c=[],u=a.s.c;u<=a.e.c;++u)o[u]=xt(u);for(var d=a.s.r;d<=a.e.r;++d)for(s&&(c=t["!data"][d]||[]),i=gt(d),u=a.s.c;u<=a.e.c;++u){var f=s?c[u]:t[o[u]+i];f&&i3(e,f,d,u)}}function l3(e,t){for(var r=t||{},n=kr(),s=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==r.sheet&&(s=a);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return we(n,r.biff==4?1033:r.biff==3?521:9,T0(e,16,r)),o3(n,e.Sheets[e.SheetNames[s]],s,r),we(n,10),n.end()}function c3(e,t,r){we(e,49,U4({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function u3(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&we(e,1054,z4(s,t[s],r))})}function d3(e,t){var r=ae(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),we(e,2151,r),r=ae(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),nw(yt(t["!ref"]||"A1"),r),r.write_shift(4,4),we(e,2152,r)}function f3(e,t){for(var r=0;r<16;++r)we(e,224,Kp({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){we(e,224,Kp(n,0,t))})}function h3(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];we(e,440,Q4(n)),n[1].Tooltip&&we(e,2048,Z4(n))}delete t["!links"]}function m3(e,t){if(t){var r=0;t.forEach(function(n,s){++r<=256&&n&&we(e,125,rO(dd(s,n),s))})}}function p3(e,t,r,n,s){var a=16+ta(s.cellXfs,t,s);if(t.v==null&&!t.bf){we(e,513,ja(r,n,a));return}if(t.bf)we(e,6,AM(t,r,n,s,a));else switch(t.t){case"d":case"n":var i=t.t=="d"?vr(Pr(t.v)):t.v;we(e,515,X4(r,n,i,a));break;case"b":case"e":we(e,517,Y4(r,n,t.v,a,s,t.t));break;case"s":case"str":if(s.bookSST){var o=A0(s.Strings,t.v==null?"":String(t.v),s.revStrings);we(e,253,V4(r,n,o,a))}else we(e,516,H4(r,n,(t.v==null?"":String(t.v)).slice(0,255),a,s));break;default:we(e,513,ja(r,n,a))}}function g3(e,t,r){var n=kr(),s=r.SheetNames[e],a=r.Sheets[s]||{},i=(r||{}).Workbook||{},o=(i.Sheets||[])[e]||{},c=a["!data"]!=null,u=t.biff==8,d,f="",h=[],p=yt(a["!ref"]||"A1"),v=u?65536:16384;if(p.e.c>255||p.e.r>=v){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,v-1)}we(n,2057,T0(r,16,t)),we(n,13,Jr(1)),we(n,12,Jr(100)),we(n,15,dr(!0)),we(n,17,dr(!1)),we(n,16,Da(.001)),we(n,95,dr(!0)),we(n,42,dr(!1)),we(n,43,dr(!1)),we(n,130,Jr(1)),we(n,128,K4()),we(n,131,dr(!1)),we(n,132,dr(!1)),u&&m3(n,a["!cols"]),we(n,512,G4(p,t)),u&&(a["!links"]=[]);for(var g=[],x=[],y=p.s.c;y<=p.e.c;++y)h[y]=xt(y);for(var w=p.s.r;w<=p.e.r;++w)for(c&&(x=a["!data"][w]||[]),f=gt(w),y=p.s.c;y<=p.e.c;++y){d=h[y]+f;var _=c?x[y]:a[d];_&&(p3(n,_,w,y,t),u&&_.l&&a["!links"].push([d,_.l]),u&&_.c&&g.push([d,_.c]))}var b=o.CodeName||o.name||s;return u&&we(n,574,W4((i.Views||[])[0])),u&&(a["!merges"]||[]).length&&we(n,229,J4(a["!merges"])),u&&h3(n,a),we(n,442,rw(b)),u&&d3(n,a),we(n,10),n.end()}function x3(e,t,r){var n=kr(),s=(e||{}).Workbook||{},a=s.Sheets||[],i=s.WBProps||{},o=r.biff==8,c=r.biff==5;if(we(n,2057,T0(e,5,r)),r.bookType=="xla"&&we(n,135),we(n,225,o?Jr(1200):null),we(n,193,P4(2)),c&&we(n,191),c&&we(n,192),we(n,226),we(n,92,F4("SheetJS",r)),we(n,66,Jr(o?1200:1252)),o&&we(n,353,Jr(0)),o&&we(n,448),we(n,317,nO(e.SheetNames.length)),o&&e.vbaraw&&we(n,211),o&&e.vbaraw){var u=i.CodeName||"ThisWorkbook";we(n,442,rw(u))}we(n,156,Jr(17)),we(n,25,dr(!1)),we(n,18,dr(!1)),we(n,19,Jr(0)),o&&we(n,431,dr(!1)),o&&we(n,444,Jr(0)),we(n,61,$4()),we(n,64,dr(!1)),we(n,141,Jr(0)),we(n,34,dr(SL(e)=="true")),we(n,14,dr(!0)),o&&we(n,439,dr(!1)),we(n,218,Jr(0)),c3(n,e,r),u3(n,e.SSF,r),f3(n,r),o&&we(n,352,dr(!1));var d=n.end(),f=kr();o&&we(f,140,eO()),o&&r.Strings&&n3(f,252,B4(r.Strings)),we(f,10);var h=f.end(),p=kr(),v=0,g=0;for(g=0;g<e.SheetNames.length;++g)v+=(o?12:11)+(o?2:1)*e.SheetNames[g].length;var x=d.length+v+h.length;for(g=0;g<e.SheetNames.length;++g){var y=a[g]||{};we(p,133,L4({pos:x,hs:y.Hidden||0,dt:0,name:e.SheetNames[g]},r)),x+=t[g].length}var w=p.end();if(v!=w.length)throw new Error("BS8 "+v+" != "+w.length);var _=[];return d.length&&_.push(d),w.length&&_.push(w),h.length&&_.push(h),$t(_)}function v3(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=yr(Pt)),e&&e.SSF&&(id(),ad(e.SSF),r.revssf=od(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,N0(r),r.cellXfs=[],ta(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=g3(s,r,e);return n.unshift(x3(e,n,r)),$t(n)}function Sw(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var s=Zt(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=t||{};switch(a.biff||2){case 8:case 5:return v3(e,t);case 4:case 3:case 2:return l3(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function y3(e,t,r,n){for(var s=e["!merges"]||[],a=[],i={},o=e["!data"]!=null,c=t.s.c;c<=t.e.c;++c){for(var u=0,d=0,f=0;f<s.length;++f)if(!(s[f].s.r>r||s[f].s.c>c)&&!(s[f].e.r<r||s[f].e.c<c)){if(s[f].s.r<r||s[f].s.c<c){u=-1;break}u=s[f].e.r-s[f].s.r+1,d=s[f].e.c-s[f].s.c+1;break}if(!(u<0)){var h=xt(c)+gt(r),p=o?(e["!data"][r]||[])[c]:e[h],v=p&&p.v!=null&&(p.h||Ap(p.w||(hs(p),p.w)||""))||"";i={},u>1&&(i.rowspan=u),d>1&&(i.colspan=d),n.editable?v='<span contenteditable="true">'+v+"</span>":p&&(i["data-t"]=p&&p.t||"z",p.v!=null&&(i["data-v"]=p.v),p.z!=null&&(i["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(v='<a href="'+Ap(p.l.Target)+'">'+v+"</a>")),i.id=(n.id||"sjs")+"-"+h,a.push(ve("td",v,i))}}var g="<tr>";return g+a.join("")+"</tr>"}var w3='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',_3="</body></html>";function b3(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Ew(e,t){var r=t||{},n=r.header!=null?r.header:w3,s=r.footer!=null?r.footer:_3,a=[n],i=Zt(e["!ref"]);a.push(b3(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)a.push(y3(e,i,o,r));return a.push("</table>"+s),a.join("")}function Tw(e,t,r){var n=t.rows;if(!n)throw"Unsupported origin when "+t.tagName+" is not a TABLE";var s=r||{},a=e["!data"]!=null,i=0,o=0;if(s.origin!=null)if(typeof s.origin=="number")i=s.origin;else{var c=typeof s.origin=="string"?_t(s.origin):s.origin;i=c.r,o=c.c}var u=Math.min(s.sheetRows||1e7,n.length),d={s:{r:0,c:0},e:{r:i,c:o}};if(e["!ref"]){var f=Zt(e["!ref"]);d.s.r=Math.min(d.s.r,f.s.r),d.s.c=Math.min(d.s.c,f.s.c),d.e.r=Math.max(d.e.r,f.e.r),d.e.c=Math.max(d.e.c,f.e.c),i==-1&&(d.e.r=i=f.e.r+1)}var h=[],p=0,v=e["!rows"]||(e["!rows"]=[]),g=0,x=0,y=0,w=0,_=0,b=0;for(e["!cols"]||(e["!cols"]=[]);g<n.length&&x<u;++g){var T=n[g];if(ng(T)){if(s.display)continue;v[x]={hidden:!0}}var k=T.cells;for(y=w=0;y<k.length;++y){var S=k[y];if(!(s.display&&ng(S))){var E=S.hasAttribute("data-v")?S.getAttribute("data-v"):S.hasAttribute("v")?S.getAttribute("v"):LR(S.innerHTML),C=S.getAttribute("data-z")||S.getAttribute("z");for(p=0;p<h.length;++p){var L=h[p];L.s.c==w+o&&L.s.r<x+i&&x+i<=L.e.r&&(w=L.e.c+1-o,p=-1)}b=+S.getAttribute("colspan")||1,((_=+S.getAttribute("rowspan")||1)>1||b>1)&&h.push({s:{r:x+i,c:w+o},e:{r:x+i+(_||1)-1,c:w+o+(b||1)-1}});var M={t:"s",v:E},j=S.getAttribute("data-t")||S.getAttribute("t")||"";E!=null&&(E.length==0?M.t=j||"z":s.raw||E.trim().length==0||j=="s"||(E==="TRUE"?M={t:"b",v:!0}:E==="FALSE"?M={t:"b",v:!1}:isNaN(is(E))?isNaN(tl(E).getDate())||(M={t:"d",v:Pr(E)},s.cellDates||(M={t:"n",v:vr(M.v)}),M.z=s.dateNF||Pt[14]):M={t:"n",v:is(E)})),M.z===void 0&&C!=null&&(M.z=C);var V="",A=S.getElementsByTagName("A");if(A&&A.length)for(var H=0;H<A.length&&!(A[H].hasAttribute("href")&&(V=A[H].getAttribute("href"),V.charAt(0)!="#"));++H);V&&V.charAt(0)!="#"&&V.slice(0,11).toLowerCase()!="javascript:"&&(M.l={Target:V}),a?(e["!data"][x+i]||(e["!data"][x+i]=[]),e["!data"][x+i][w+o]=M):e[Tt({c:w+o,r:x+i})]=M,d.e.c<w+o&&(d.e.c=w+o),w+=b}}++x}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),d.e.r=Math.max(d.e.r,x-1+i),e["!ref"]=Ot(d),x>=u&&(e["!fullref"]=Ot((d.e.r=n.length-g+x-1+i,d))),e}function Cw(e,t){var r=t||{},n={};return r.dense&&(n["!data"]=[]),Tw(n,e,t)}function S3(e,t){var r=to(Cw(e,t),t);return r}function ng(e){var t="",r=E3(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function E3(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var T3=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+nl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return It+t}}();function C3(e,t){var r="number",n="",s={"style:name":t},a="",i=0;e=e.replace(/"[$]"/g,"$");e:{if(e.indexOf(";")>-1&&(console.error("Unsupported ODS Style Map exported.  Using first branch of "+e),e=e.slice(0,e.indexOf(";"))),e=="@"){r="text",n="<number:text-content/>";break e}if(e.indexOf(/\$/)>-1&&(r="currency"),e[i]=='"'){for(a="";e[++i]!='"'||e[++i]=='"';)a+=e[i];--i,e[i+1]=="*"?(i++,n+="<number:fill-character>"+Ue(a.replace(/""/g,'"'))+"</number:fill-character>"):n+="<number:text>"+Ue(a.replace(/""/g,'"'))+"</number:text>",e=e.slice(i+1),i=0}var o=e.match(/# (\?+)\/(\?+)/);if(o){n+=ve("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":o[1].length,"number:max-denominator-value":Math.max(+o[1].replace(/./g,"9"),+o[2].replace(/./g,"9"))});break e}if(o=e.match(/# (\?+)\/(\d+)/)){n+=ve("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":o[1].length,"number:denominator-value":+o[2]});break e}if(o=e.match(/(\d+)(|\.\d+)%/)){r="percentage",n+=ve("number:number",null,{"number:decimal-places":o[2]&&o.length-1||0,"number:min-decimal-places":o[2]&&o.length-1||0,"number:min-integer-digits":o[1].length})+"<number:text>%</number:text>";break e}var c=!1;if(["y","m","d"].indexOf(e[0])>-1){r="date";t:for(;i<e.length;++i)switch(a=e[i].toLowerCase()){case"h":case"s":c=!0,--i;break t;case"m":r:for(var u=i+1;u<e.length;++u)switch(e[u]){case"y":case"d":break r;case"h":case"s":c=!0,--i;break t}case"y":case"d":for(;(e[++i]||"").toLowerCase()==a[0];)a+=a[0];switch(--i,a){case"y":case"yy":n+="<number:year/>";break;case"yyy":case"yyyy":n+='<number:year number:style="long"/>';break;case"mmmmm":console.error("ODS has no equivalent of format |mmmmm|");case"m":case"mm":case"mmm":case"mmmm":n+='<number:month number:style="'+(a.length%2?"short":"long")+'" number:textual="'+(a.length>=3?"true":"false")+'"/>';break;case"d":case"dd":n+='<number:day number:style="'+(a.length%2?"short":"long")+'"/>';break;case"ddd":case"dddd":n+='<number:day-of-week number:style="'+(a.length%2?"short":"long")+'"/>';break}break;case'"':for(;e[++i]!='"'||e[++i]=='"';)a+=e[i];--i,n+="<number:text>"+Ue(a.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"/":n+="<number:text>"+Ue(a)+"</number:text>";break;default:console.error("unrecognized character "+a+" in ODF format "+e)}if(!c)break e;e=e.slice(i+1),i=0}if(e.match(/^\[?[hms]/)){for(r=="number"&&(r="time"),e.match(/\[/)&&(e=e.replace(/[\[\]]/g,""),s["number:truncate-on-overflow"]="false");i<e.length;++i)switch(a=e[i].toLowerCase()){case"h":case"m":case"s":for(;(e[++i]||"").toLowerCase()==a[0];)a+=a[0];switch(--i,a){case"h":case"hh":n+='<number:hours number:style="'+(a.length%2?"short":"long")+'"/>';break;case"m":case"mm":n+='<number:minutes number:style="'+(a.length%2?"short":"long")+'"/>';break;case"s":case"ss":if(e[i+1]==".")do a+=e[i+1],++i;while(e[i+1]=="0");n+='<number:seconds number:style="'+(a.match("ss")?"long":"short")+'"'+(a.match(/\./)?' number:decimal-places="'+(a.match(/0+/)||[""])[0].length+'"':"")+"/>";break}break;case'"':for(;e[++i]!='"'||e[++i]=='"';)a+=e[i];--i,n+="<number:text>"+Ue(a.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"/":n+="<number:text>"+Ue(a)+"</number:text>";break;case"a":if(e.slice(i,i+3).toLowerCase()=="a/p"){n+="<number:am-pm/>",i+=2;break}if(e.slice(i,i+5).toLowerCase()=="am/pm"){n+="<number:am-pm/>",i+=4;break}default:console.error("unrecognized character "+a+" in ODF format "+e)}break e}if(e.indexOf(/\$/)>-1&&(r="currency"),e[0]=="$"&&(n+='<number:currency-symbol number:language="en" number:country="US">$</number:currency-symbol>',e=e.slice(1),i=0),i=0,e[i]=='"'){for(;e[++i]!='"'||e[++i]=='"';)a+=e[i];--i,e[i+1]=="*"?(i++,n+="<number:fill-character>"+Ue(a.replace(/""/g,'"'))+"</number:fill-character>"):n+="<number:text>"+Ue(a.replace(/""/g,'"'))+"</number:text>",e=e.slice(i+1),i=0}var d=e.match(/([#0][0#,]*)(\.[0#]*|)(E[+]?0*|)/i);if(!d||!d[0])console.error("Could not find numeric part of "+e);else{var f=d[1].replace(/,/g,"");n+="<number:"+(d[3]?"scientific-":"")+'number number:min-integer-digits="'+(f.indexOf("0")==-1?"0":f.length-f.indexOf("0"))+'"'+(d[0].indexOf(",")>-1?' number:grouping="true"':"")+(d[2]&&' number:decimal-places="'+(d[2].length-1)+'"'||' number:decimal-places="0"')+(d[3]&&d[3].indexOf("+")>-1?' number:forced-exponent-sign="true"':"")+(d[3]?' number:min-exponent-digits="'+d[3].match(/0+/)[0].length+'"':"")+"></number:"+(d[3]?"scientific-":"")+"number>",i=d.index+d[0].length}if(e[i]=='"'){for(a="";e[++i]!='"'||e[++i]=='"';)a+=e[i];--i,n+="<number:text>"+Ue(a.replace(/""/g,'"'))+"</number:text>"}}return n?ve("number:"+r+"-style",n,s):(console.error("Could not generate ODS number format for |"+e+"|"),"")}function sg(e,t,r){var n=e.filter(function(s){return s.Sheet==(r==-1?null:r)});return n.length?`      <table:named-expressions>
`+n.map(function(s){var a=vw(s.Ref);return"        "+ve("table:named-range",null,{"table:name":s.Name,"table:cell-range-address":a,"table:base-cell-address":a.replace(/[\.]?[^\.]*$/,".$A$1")})}).join(`
`)+`
      </table:named-expressions>
`:""}var ag=function(){var e=function(a){return Ue(a).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(a,i,o,c,u){var d=[];d.push('      <table:table table:name="'+Ue(i.SheetNames[o])+`" table:style-name="ta1">
`);var f=0,h=0,p=Zt(a["!ref"]||"A1"),v=a["!merges"]||[],g=0,x=a["!data"]!=null;if(a["!cols"])for(h=0;h<=p.e.c;++h)d.push("        <table:table-column"+(a["!cols"][h]?' table:style-name="co'+a["!cols"][h].ods+'"':"")+`></table:table-column>
`);var y="",w=a["!rows"]||[];for(f=0;f<p.s.r;++f)y=w[f]?' table:style-name="ro'+w[f].ods+'"':"",d.push("        <table:table-row"+y+`></table:table-row>
`);for(;f<=p.e.r;++f){for(y=w[f]?' table:style-name="ro'+w[f].ods+'"':"",d.push("        <table:table-row"+y+`>
`),h=0;h<p.s.c;++h)d.push(t);for(;h<=p.e.c;++h){var _=!1,b={},T="";for(g=0;g!=v.length;++g)if(!(v[g].s.c>h)&&!(v[g].s.r>f)&&!(v[g].e.c<h)&&!(v[g].e.r<f)){(v[g].s.c!=h||v[g].s.r!=f)&&(_=!0),b["table:number-columns-spanned"]=v[g].e.c-v[g].s.c+1,b["table:number-rows-spanned"]=v[g].e.r-v[g].s.r+1;break}if(_){d.push(r);continue}var k=Tt({r:f,c:h}),S=x?(a["!data"][f]||[])[h]:a[k];if(S&&S.f&&(b["table:formula"]=Ue(GM(S.f)),S.F&&S.F.slice(0,k.length)==k)){var E=Zt(S.F);b["table:number-matrix-columns-spanned"]=E.e.c-E.s.c+1,b["table:number-matrix-rows-spanned"]=E.e.r-E.s.r+1}if(!S){d.push(t);continue}switch(S.t){case"b":T=S.v?"TRUE":"FALSE",b["office:value-type"]="boolean",b["office:boolean-value"]=S.v?"true":"false";break;case"n":T=S.w||String(S.v||0),b["office:value-type"]="float",b["office:value"]=S.v||0;break;case"s":case"str":T=S.v==null?"":S.v,b["office:value-type"]="string";break;case"d":T=S.w||Pr(S.v).toISOString(),b["office:value-type"]="date",b["office:date-value"]=Pr(S.v).toISOString(),b["table:style-name"]="ce1";break;default:d.push(t);continue}var C=e(T);if(S.l&&S.l.Target){var L=S.l.Target;L=L.charAt(0)=="#"?"#"+vw(L.slice(1)):L,L.charAt(0)!="#"&&!L.match(/^\w+:/)&&(L="../"+L),C=ve("text:a",C,{"xlink:href":L.replace(/&/g,"&amp;")})}u[S.z]&&(b["table:style-name"]="ce"+u[S.z].slice(1)),d.push("          "+ve("table:table-cell",ve("text:p",C,{}),b)+`
`)}d.push(`        </table:table-row>
`)}return(i.Workbook||{}).Names&&d.push(sg(i.Workbook.Names,i.SheetNames,o)),d.push(`      </table:table>
`),d.join("")},s=function(a,i){a.push(` <office:automatic-styles>
`);var o=0;i.SheetNames.map(function(f){return i.Sheets[f]}).forEach(function(f){if(f&&f["!cols"]){for(var h=0;h<f["!cols"].length;++h)if(f["!cols"][h]){var p=f["!cols"][h];if(p.width==null&&p.wpx==null&&p.wch==null)continue;C0(p),p.ods=o;var v=f["!cols"][h].wpx+"px";a.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+v+`"/>
`),a.push(`  </style:style>
`),++o}}});var c=0;i.SheetNames.map(function(f){return i.Sheets[f]}).forEach(function(f){if(f&&f["!rows"]){for(var h=0;h<f["!rows"].length;++h)if(f["!rows"][h]){f["!rows"][h].ods=c;var p=f["!rows"][h].hpx+"px";a.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+p+`"/>
`),a.push(`  </style:style>
`),++c}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var u={},d=69;return i.SheetNames.map(function(f){return i.Sheets[f]}).forEach(function(f){if(f)for(var h=f["!data"]!=null,p=Zt(f["!ref"]),v=0;v<=p.e.r;++v)for(var g=0;g<=p.e.c;++g){var x=h?(f["!data"][v]||[])[g]:f[Tt({r:v,c:g})];if(!(!x||!x.z||x.z.toLowerCase()=="general")&&!u[x.z]){var y=C3(x.z,"N"+d);y&&(u[x.z]="N"+d,++d,a.push(y+`
`))}}}),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),Ut(u).forEach(function(f){a.push('<style:style style:name="ce'+u[f].slice(1)+'" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="'+u[f]+`"/>
`)}),a.push(` </office:automatic-styles>
`),u};return function(i,o){var c=[It],u=nl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=nl({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(Yy().replace(/<office:document-meta.*?>/,"").replace(/<\/office:document-meta>/,"")+`
`)):c.push("<office:document-content"+u+`>
`);var f=s(c,i);c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`),((i.Workbook||{}).WBProps||{}).date1904&&c.push(`      <table:calculation-settings table:case-sensitive="false" table:search-criteria-must-apply-to-whole-cell="true" table:use-wildcards="true" table:use-regular-expressions="false" table:automatic-find-labels="false">
        <table:null-date table:date-value="1904-01-01"/>
      </table:calculation-settings>
`);for(var h=0;h!=i.SheetNames.length;++h)c.push(n(i.Sheets[i.SheetNames[h]],i,h,o,f));return(i.Workbook||{}).Names&&c.push(sg(i.Workbook.Names,i.SheetNames,-1)),c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function kw(e,t){if(t.bookType=="fods")return ag(e,t);var r=p0(),n="",s=[],a=[];return n="mimetype",He(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",He(r,n,ag(e,t)),s.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",He(r,n,T3(e,t)),s.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",He(r,n,It+Yy()),s.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",He(r,n,S4(a)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",He(r,n,_4(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */var gr=function(){try{return typeof Uint8Array>"u"||typeof Uint8Array.prototype.subarray>"u"?"slice":typeof Buffer<"u"?typeof Buffer.prototype.subarray>"u"?"slice":(typeof Buffer.from=="function"?Buffer.from([72,62]):new Buffer([72,62]))instanceof Uint8Array?"subarray":"slice":"subarray"}catch{return"slice"}}();function lu(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function cr(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):vi(Na(e))}function mn(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Br(rl(e))}function zs(e){for(var t=0,r=0;r<e.length;++r)t+=e[r].length;var n=new Uint8Array(t),s=0;for(r=0;r<e.length;++r){var a=e[r],i=a.length;if(i<250)for(var o=0;o<i;++o)n[s++]=a[o];else n.set(a,s),s+=i}return n}function k3(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-16,s=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var a=0;s>=1;++a,s/=256)e[t+a]=s&255;e[t+15]|=r>=0?0:128}function ol(e,t){var r=t.l,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t.l=r,n}function Ae(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t[gr](0,r)}function Pw(e){for(var t={l:0},r=[];t.l<e.length;)r.push(ol(e,t));return r}function Aw(e){return zs(e.map(function(t){return Ae(t)}))}function Cr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function De(e){for(var t=[],r={l:0};r.l<e.length;){var n=r.l,s=ol(e,r),a=s&7;s=s/8|0;var i,o=r.l;switch(a){case 0:{for(;e[o++]>=128;);i=e[gr](r.l,o),r.l=o}break;case 1:i=e[gr](o,o+8),r.l=o+8;break;case 2:{var c=ol(e,r);i=e[gr](r.l,r.l+c),r.l+=c}break;case 5:i=e[gr](o,o+4),r.l=o+4;break;default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var u={data:i,type:a};t[s]==null&&(t[s]=[]),t[s].push(u)}return t}function Re(e){var t=[];return e.forEach(function(r,n){n!=0&&r.forEach(function(s){s.data&&(t.push(Ae(n*8+s.type)),s.type==2&&t.push(Ae(s.data.length)),t.push(s.data))})}),zs(t)}function cu(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function uu(e){for(var t,r=[],n={l:0};n.l<e.length;){var s=ol(e,n),a=De(e[gr](n.l,n.l+s));n.l+=s;var i={id:Cr(a[1][0].data),messages:[]};a[2].forEach(function(o){var c=De(o.data),u=Cr(c[3][0].data);i.messages.push({meta:c,data:e[gr](n.l,n.l+u)}),n.l+=u}),(t=a[3])!=null&&t[0]&&(i.merge=Cr(a[3][0].data)>>>0>0),r.push(i)}return r}function Bo(e){var t=[];return e.forEach(function(r){var n=[[],[{data:Ae(r.id),type:0}],[]];r.merge!=null&&(n[3]=[{data:Ae(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(i){s.push(i.data),i.meta[3]=[{type:0,data:Ae(i.data.length)}],n[2].push({data:Re(i.meta),type:2})});var a=Re(n);t.push(Ae(a.length)),t.push(a),s.forEach(function(i){return t.push(i)})}),zs(t)}function P3(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r={l:0},n=ol(t,r),s=[],a=r.l;a<t.length;){var i=t[a]&3;if(i==0){var o=t[a++]>>2;if(o<60)++o;else{var c=o-59;o=t[a],c>1&&(o|=t[a+1]<<8),c>2&&(o|=t[a+2]<<16),c>3&&(o|=t[a+3]<<24),o>>>=0,o++,a+=c}s.push(t[gr](a,a+o)),a+=o;continue}else{var u=0,d=0;if(i==1?(d=(t[a]>>2&7)+4,u=(t[a++]&224)<<3,u|=t[a++]):(d=(t[a++]>>2)+1,i==2?(u=t[a]|t[a+1]<<8,a+=2):(u=(t[a]|t[a+1]<<8|t[a+2]<<16|t[a+3]<<24)>>>0,a+=4)),u==0)throw new Error("Invalid offset 0");for(var f=s.length-1,h=u;f>=0&&h>=s[f].length;)h-=s[f].length,--f;if(f<0)if(h==0)h=s[f=0].length;else throw new Error("Invalid offset beyond length");if(d<h)s.push(s[f][gr](s[f].length-h,s[f].length-h+d));else{for(h>0&&(s.push(s[f][gr](s[f].length-h)),d-=h),++f;d>=s[f].length;)s.push(s[f]),d-=s[f].length,++f;d&&s.push(s[f][gr](0,d))}s.length>25&&(s=[zs(s)])}}for(var p=0,v=0;v<s.length;++v)p+=s[v].length;if(p!=n)throw new Error("Unexpected length: ".concat(p," != ").concat(n));return s}function du(e){Array.isArray(e)&&(e=new Uint8Array(e));for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push.apply(t,P3(n,e[gr](r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return t.length==1?t[0]:zs(t)}function $o(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var a=Ae(n),i=a.length;t.push(a),n<=60?(i++,t.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e[gr](r,r+n)),i+=n,s[0]=0,s[1]=i&255,s[2]=i>>8&255,s[3]=i>>16&255,r+=n}return zs(t)}function pc(e,t){var r=new Uint8Array(32),n=lu(r),s=12,a=0;switch(r[0]=5,e.t){case"n":r[1]=2,k3(r,s,e.v),a|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,e.v?1:0,!0),a|=2,s+=8;break;case"s":var i=e.v==null?"":String(e.v),o=t.indexOf(i);o==-1&&(t[o=t.length]=i),r[1]=3,n.setUint32(s,o,!0),a|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,a,!0),r[gr](0,s)}function gc(e,t){var r=new Uint8Array(32),n=lu(r),s=12,a=0;switch(r[0]=4,e.t){case"n":r[2]=2,n.setFloat64(s,e.v,!0),a|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,e.v?1:0,!0),a|=32,s+=8;break;case"s":var i=e.v==null?"":String(e.v),o=t.indexOf(i);o==-1&&(t[o=t.length]=i),r[2]=3,n.setUint32(s,o,!0),a|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,a,!0),r[gr](0,s)}function Ht(e){var t=De(e);return Cr(t[1][0].data)}function es(e){return Re([[],[{type:0,data:Ae(e)}]])}function Cs(e,t){var r,n=(r=e.messages[0].meta[5])!=null&&r[0]?Pw(e.messages[0].meta[5][0].data):[],s=n.indexOf(t);s==-1&&(n.push(t),e.messages[0].meta[5]=[{type:2,data:Aw(n)}])}function Jn(e,t){var r,n=(r=e.messages[0].meta[5])!=null&&r[0]?Pw(e.messages[0].meta[5][0].data):[];e.messages[0].meta[5]=[{type:2,data:Aw(n.filter(function(s){return s!=t}))}]}function A3(e,t,r){var n,s,a=[[],[{type:0,data:Ae(0)}],[{type:0,data:Ae(0)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:Ae(5)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:Ae(1)}]];if(!((n=a[6])!=null&&n[0])||!((s=a[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var i=0;if(a[7][0].data.length<2*e.length){var o=new Uint8Array(2*e.length);o.set(a[7][0].data),a[7][0].data=o}if(a[4][0].data.length<2*e.length){var c=new Uint8Array(2*e.length);c.set(a[4][0].data),a[4][0].data=c}for(var u=lu(a[7][0].data),d=0,f=[],h=lu(a[4][0].data),p=0,v=[],g=4,x=0;x<e.length;++x){if(e[x]==null){u.setUint16(x*2,65535,!0),h.setUint16(x*2,65535);continue}u.setUint16(x*2,d/g,!0),h.setUint16(x*2,p/g,!0);var y,w;switch(typeof e[x]){case"string":y=pc({t:"s",v:e[x]},t),w=gc({t:"s",v:e[x]},t);break;case"number":y=pc({t:"n",v:e[x]},t),w=gc({t:"n",v:e[x]},t);break;case"boolean":y=pc({t:"b",v:e[x]},t),w=gc({t:"b",v:e[x]},t);break;default:if(e[x]instanceof Date){y=pc({t:"s",v:e[x].toISOString()},t),w=gc({t:"s",v:e[x].toISOString()},t);break}throw new Error("Unsupported value "+e[x])}f.push(y),d+=y.length,v.push(w),p+=w.length,++i}for(a[2][0].data=Ae(i),a[5][0].data=Ae(5);x<a[7][0].data.length/2;++x)u.setUint16(x*2,65535,!0),h.setUint16(x*2,65535,!0);return a[6][0].data=zs(f),a[3][0].data=zs(v),a[8]=[{type:0,data:Ae(1)}],a}function ig(e,t){return{meta:[[],[{type:0,data:Ae(e)}]],data:t}}function ks(e,t){t.last||(t.last=927262);for(var r=t.last;r<2e6;++r)if(!t[r])return t[t.last=r]=e,r;throw new Error("Too many messages")}function N3(e){var t={},r=[];return e.FileIndex.map(function(n,s){return[n,e.FullPaths[s]]}).forEach(function(n){var s=n[0],a=n[1];s.type==2&&s.name.match(/\.iwa/)&&s.content[0]==0&&uu(du(s.content)).forEach(function(i){r.push(i.id),t[i.id]={deps:[],location:a,type:Cr(i.messages[0].meta[1][0].data)}})}),e.FileIndex.forEach(function(n){n.name.match(/\.iwa/)&&n.content[0]==0&&uu(du(n.content)).forEach(function(s){s.messages.forEach(function(a){[5,6].forEach(function(i){a.meta[i]&&a.meta[i].forEach(function(o){t[s.id].deps.push(Cr(o.data))})})})})}),t}function D3(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=pt.read(t.numbers,{type:"base64"}),n=N3(r),s=Rn(r,n,1);if(s==null)throw"Could not find message ".concat(1," in Numbers template");var a=cu(De(s.messages[0].data)[1],Ht);if(a.length>1)throw new Error("Template NUMBERS file must have exactly one sheet");return e.SheetNames.forEach(function(i,o){o>=1&&(j3(r,n,o+1),s=Rn(r,n,1),a=cu(De(s.messages[0].data)[1],Ht)),R3(r,n,e.Sheets[i],i,o,a[o])}),r}function Lt(e,t,r,n){var s=pt.find(e,t[r].location);if(!s)throw"Could not find ".concat(t[r].location," in Numbers template");var a=uu(du(s.content)),i=a.find(function(o){return o.id==r});n(i,a),s.content=$o(Bo(a)),s.size=s.content.length}function Rn(e,t,r){var n=pt.find(e,t[r].location);if(!n)throw"Could not find ".concat(t[r].location," in Numbers template");var s=uu(du(n.content)),a=s.find(function(i){return i.id==r});return a}function j3(e,t,r){var n=-1,s=-1,a={};Lt(e,t,1,function(u,d){var f=De(u.messages[0].data);n=Ht(De(u.messages[0].data)[1][0].data),s=ks({deps:[1],location:t[n].location,type:2},t),a[n]=s,Cs(u,s),f[1].push({type:2,data:es(s)});var h=Rn(e,t,n);h.id=s,t[1].location==t[s].location?d.push(h):Lt(e,t,s,function(p,v){return v.push(h)}),u.messages[0].data=Re(f)});var i=-1;Lt(e,t,s,function(u,d){for(var f=De(u.messages[0].data),h=3;h<=69;++h)delete f[h];var p=cu(f[2],Ht);p.forEach(function(x){return Jn(u,x)}),i=ks({deps:[s],location:t[p[0]].location,type:t[p[0]].type},t),Cs(u,i),a[p[0]]=i,f[2]=[{type:2,data:es(i)}];var v=Rn(e,t,p[0]);if(v.id=i,t[p[0]].location==t[s].location)d.push(v);else{var g=t[s].location;g=g.replace(/^Root Entry\//,""),g=g.replace(/^Index\//,"").replace(/\.iwa$/,""),Lt(e,t,2,function(x){var y=De(x.messages[0].data),w=y[3].findIndex(function(b){var T,k,S=De(b.data);return(T=S[3])!=null&&T[0]?cr(S[3][0].data)==g:!!((k=S[2])!=null&&k[0]&&cr(S[2][0].data)==g)}),_=De(y[3][w].data);_[6]||(_[6]=[]),_[6].push({type:2,data:Re([[],[{type:0,data:Ae(i)}]])}),y[3][w].data=Re(_),x.messages[0].data=Re(y)}),Lt(e,t,i,function(x,y){return y.push(v)})}u.messages[0].data=Re(f)});var o=-1;Lt(e,t,i,function(u,d){for(var f=De(u.messages[0].data),h=De(f[1][0].data),p=3;p<=69;++p)delete h[p];var v=Ht(h[2][0].data);h[2][0].data=es(a[v]),f[1][0].data=Re(h);var g=Ht(f[2][0].data);Jn(u,g),o=ks({deps:[i],location:t[g].location,type:t[g].type},t),Cs(u,o),a[g]=o,f[2][0].data=es(o);var x=Rn(e,t,g);x.id=o,t[i].location==t[o].location?d.push(x):Lt(e,t,o,function(y,w){return w.push(x)}),u.messages[0].data=Re(f)});var c=t[o].location;c=c.replace(/^Root Entry\//,""),c=c.replace(/^Index\//,"").replace(/\.iwa$/,""),Lt(e,t,o,function(u,d){var f,h,p=De(u.messages[0].data),v=cr(p[1][0].data),g=v.replace(/-[A-Z0-9]*/,"-".concat(r.toString(16).padStart(4,"0")));if(p[1][0].data=mn(g),[12,13,29,31,32,33,39,44,47,81,82,84].forEach(function(k){return delete p[k]}),p[45]){var x=De(p[45][0].data),y=Ht(x[1][0].data);Jn(u,y),delete p[45]}if(p[70]){var w=De(p[70][0].data);(f=w[2])==null||f.forEach(function(k){var S=De(k.data);[2,3].map(function(E){return S[E][0]}).forEach(function(E){var C=De(E.data);if(C[8]){var L=Ht(C[8][0].data);Jn(u,L)}})}),delete p[70]}[46,30,34,35,36,38,48,49,60,61,62,63,64,71,72,73,74,75,85,86,87,88,89].forEach(function(k){if(p[k]){var S=Ht(p[k][0].data);delete p[k],Jn(u,S)}});var _=De(p[4][0].data);{[2,4,5,6,11,12,13,15,16,17,18,19,20,21,22].forEach(function(k){var S;if((S=_[k])!=null&&S[0]){var E=Ht(_[k][0].data),C=ks({deps:[o],location:t[E].location,type:t[E].type},t);Jn(u,E),Cs(u,C),a[E]=C;var L=Rn(e,t,E);if(L.id=C,t[E].location==t[o].location)d.push(L);else{t[C].location=t[E].location.replace(E.toString(),C.toString()),t[C].location==t[E].location&&(t[C].location=t[C].location.replace(/\.iwa/,"-".concat(C,".iwa"))),pt.utils.cfb_add(e,t[C].location,$o(Bo([L])));var M=t[C].location;M=M.replace(/^Root Entry\//,""),M=M.replace(/^Index\//,"").replace(/\.iwa$/,""),Lt(e,t,2,function(j){var V=De(j.messages[0].data);V[3].push({type:2,data:Re([[],[{type:0,data:Ae(C)}],[{type:2,data:mn(M.replace(/-.*$/,""))}],[{type:2,data:mn(M)}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:Ae(0)}],[],[{type:0,data:Ae(0)}]])}),V[1]=[{type:0,data:Ae(Math.max(C+1,Cr(V[1][0].data)))}];var A=V[3].findIndex(function(G){var q,Y,Q=De(G.data);return(q=Q[3])!=null&&q[0]?cr(Q[3][0].data)==c:!!((Y=Q[2])!=null&&Y[0]&&cr(Q[2][0].data)==c)}),H=De(V[3][A].data);H[6]||(H[6]=[]),H[6].push({type:2,data:Re([[],[{type:0,data:Ae(C)}]])}),V[3][A].data=Re(H),j.messages[0].data=Re(V)})}_[k][0].data=es(C)}});var b=De(_[1][0].data);(h=b[2])==null||h.forEach(function(k){var S=Ht(k.data),E=ks({deps:[o],location:t[S].location,type:t[S].type},t);Jn(u,S),Cs(u,E),a[S]=E;var C=Rn(e,t,S);if(C.id=E,t[S].location==t[o].location)d.push(C);else{t[E].location=t[S].location.replace(S.toString(),E.toString()),t[E].location==t[S].location&&(t[E].location=t[E].location.replace(/\.iwa/,"-".concat(E,".iwa"))),pt.utils.cfb_add(e,t[E].location,$o(Bo([C])));var L=t[E].location;L=L.replace(/^Root Entry\//,""),L=L.replace(/^Index\//,"").replace(/\.iwa$/,""),Lt(e,t,2,function(M){var j=De(M.messages[0].data);j[3].push({type:2,data:Re([[],[{type:0,data:Ae(E)}],[{type:2,data:mn(L.replace(/-.*$/,""))}],[{type:2,data:mn(L)}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:Ae(0)}],[],[{type:0,data:Ae(0)}]])}),j[1]=[{type:0,data:Ae(Math.max(E+1,Cr(j[1][0].data)))}];var V=j[3].findIndex(function(H){var G,q,Y=De(H.data);return(G=Y[3])!=null&&G[0]?cr(Y[3][0].data)==c:!!((q=Y[2])!=null&&q[0]&&cr(Y[2][0].data)==c)}),A=De(j[3][V].data);A[6]||(A[6]=[]),A[6].push({type:2,data:Re([[],[{type:0,data:Ae(E)}]])}),j[3][V].data=Re(A),M.messages[0].data=Re(j)})}k.data=es(E)}),_[1][0].data=Re(b);var T=De(_[3][0].data);T[1].forEach(function(k){var S=De(k.data),E=Ht(S[2][0].data),C=a[E];if(!a[E]){C=ks({deps:[o],location:"",type:t[E].type},t),t[C].location="Root Entry/Index/Tables/Tile-".concat(C,".iwa"),a[E]=C;var L=Rn(e,t,E);L.id=C,Jn(u,E),Cs(u,C),pt.utils.cfb_add(e,"/Index/Tables/Tile-".concat(C,".iwa"),$o(Bo([L]))),Lt(e,t,2,function(M){var j=De(M.messages[0].data);j[3].push({type:2,data:Re([[],[{type:0,data:Ae(C)}],[{type:2,data:mn("Tables/Tile")}],[{type:2,data:mn("Tables/Tile-".concat(C))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:Ae(0)}],[],[{type:0,data:Ae(0)}]])}),j[1]=[{type:0,data:Ae(Math.max(C+1,Cr(j[1][0].data)))}];var V=j[3].findIndex(function(H){var G,q,Y=De(H.data);return(G=Y[3])!=null&&G[0]?cr(Y[3][0].data)==c:!!((q=Y[2])!=null&&q[0]&&cr(Y[2][0].data)==c)}),A=De(j[3][V].data);A[6]||(A[6]=[]),A[6].push({type:2,data:Re([[],[{type:0,data:Ae(C)}]])}),j[3][V].data=Re(A),M.messages[0].data=Re(j)})}S[2][0].data=es(C),k.data=Re(S)}),_[3][0].data=Re(T)}p[4][0].data=Re(_),u.messages[0].data=Re(p)})}function R3(e,t,r,n,s,a){var i=[];Lt(e,t,a,function(u){var d=De(u.messages[0].data);d[1]=[{type:2,data:mn(n)}],i=cu(d[2],Ht),u.messages[0].data=Re(d)});var o=Rn(e,t,i[0]),c=Ht(De(o.messages[0].data)[2][0].data);Lt(e,t,c,function(u,d){return O3(e,t,r,u,d,c)})}function O3(e,t,r,n,s,a){var i=Zt(r["!ref"]);i.s.r=i.s.c=0;var o=!1;i.e.c>999&&(o=!0,i.e.c=999),i.e.r>999999&&(o=!0,i.e.r=999999),o&&console.error("Truncating to ".concat(Ot(i)));var c=fu(r,{range:i,header:1}),u=["~Sh33tJ5~"],d=t[a].location;d=d.replace(/^Root Entry\//,""),d=d.replace(/^Index\//,"").replace(/\.iwa$/,"");var f=De(n.messages[0].data);{f[6][0].data=Ae(i.e.r+1),f[7][0].data=Ae(i.e.c+1),delete f[46];var h=De(f[4][0].data);{var p=Ht(De(h[1][0].data)[2][0].data);Lt(e,t,p,function(A,H){var G,q=De(A.messages[0].data);if((G=q==null?void 0:q[2])!=null&&G[0])for(var Y=0;Y<c.length;++Y){var Q=De(q[2][0].data);Q[1][0].data=Ae(Y),Q[4][0].data=Ae(c[Y].length),q[2][Y]={type:q[2][0].type,data:Re(Q)}}A.messages[0].data=Re(q)});var v=Ht(h[2][0].data);Lt(e,t,v,function(A,H){for(var G=De(A.messages[0].data),q=0;q<=i.e.c;++q){var Y=De(G[2][0].data);Y[1][0].data=Ae(q),Y[4][0].data=Ae(i.e.r+1),G[2][q]={type:G[2][0].type,data:Re(Y)}}A.messages[0].data=Re(G)});var g=De(h[9][0].data);g[1]=[];var x=De(h[3][0].data);{var y=256;x[2]=[{type:0,data:Ae(y)}];var w=Ht(De(x[1][0].data)[2][0].data),_=function(){var A=Rn(e,t,2),H=De(A.messages[0].data),G=H[3].filter(function(q){return Cr(De(q.data)[1][0].data)==w});return G!=null&&G.length?Cr(De(G[0].data)[12][0].data):0}();pt.utils.cfb_del(e,t[w].location),Lt(e,t,2,function(A){var H=De(A.messages[0].data);H[3]=H[3].filter(function(Y){return Cr(De(Y.data)[1][0].data)!=w});var G=H[3].findIndex(function(Y){var Q,fe,oe=De(Y.data);return(Q=oe[3])!=null&&Q[0]?cr(oe[3][0].data)==d:!!((fe=oe[2])!=null&&fe[0]&&cr(oe[2][0].data)==d)}),q=De(H[3][G].data);q[6]||(q[6]=[]),q[6]=q[6].filter(function(Y){return Cr(De(Y.data)[1][0].data)!=w}),H[3][G].data=Re(q),A.messages[0].data=Re(H)}),Jn(n,w),x[1]=[];for(var b=Math.ceil((i.e.r+1)/y),T=0;T<b;++T){var k=ks({deps:[],location:"",type:6002},t);t[k].location="Root Entry/Index/Tables/Tile-".concat(k,".iwa");for(var S=[[],[{type:0,data:Ae(0)}],[{type:0,data:Ae(Math.min(i.e.r+1,(T+1)*y))}],[{type:0,data:Ae(0)}],[{type:0,data:Ae(Math.min((T+1)*y,i.e.r+1)-T*y)}],[],[{type:0,data:Ae(5)}],[{type:0,data:Ae(1)}],[{type:0,data:Ae(1)}]],E=T*y;E<=Math.min(i.e.r,(T+1)*y-1);++E){var C=A3(c[E],u);C[1][0].data=Ae(E-T*y),S[5].push({data:Re(C),type:2})}x[1].push({type:2,data:Re([[],[{type:0,data:Ae(T)}],[{type:2,data:es(k)}]])});var L={id:k,messages:[ig(6002,Re(S))]},M=$o(Bo([L]));pt.utils.cfb_add(e,"/Index/Tables/Tile-".concat(k,".iwa"),M),Lt(e,t,2,function(A){var H=De(A.messages[0].data);H[3].push({type:2,data:Re([[],[{type:0,data:Ae(k)}],[{type:2,data:mn("Tables/Tile")}],[{type:2,data:mn("Tables/Tile-".concat(k))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:Ae(0)}],[],[{type:0,data:Ae(_)}]])}),H[1]=[{type:0,data:Ae(Math.max(k+1,Cr(H[1][0].data)))}];var G=H[3].findIndex(function(Y){var Q,fe,oe=De(Y.data);return(Q=oe[3])!=null&&Q[0]?cr(oe[3][0].data)==d:!!((fe=oe[2])!=null&&fe[0]&&cr(oe[2][0].data)==d)}),q=De(H[3][G].data);q[6]||(q[6]=[]),q[6].push({type:2,data:Re([[],[{type:0,data:Ae(k)}]])}),H[3][G].data=Re(q),A.messages[0].data=Re(H)}),Cs(n,k),g[1].push({type:2,data:Re([[],[{type:0,data:Ae(T*y)}],[{type:0,data:Ae(T)}]])})}}if(h[3][0].data=Re(x),h[9][0].data=Re(g),h[10]=[{type:2,data:new Uint8Array([])}],r["!merges"]){var j=ks({type:6144,deps:[a],location:t[a].location},t);s.push({id:j,messages:[ig(6144,Re([[],r["!merges"].map(function(A){return{type:2,data:Re([[],[{type:2,data:Re([[],[{type:5,data:new Uint8Array(new Uint16Array([A.s.r,A.s.c]).buffer)}]])}],[{type:2,data:Re([[],[{type:5,data:new Uint8Array(new Uint16Array([A.e.r-A.s.r+1,A.e.c-A.s.c+1]).buffer)}]])}]])}})]))]}),h[13]=[{type:2,data:es(j)}],Lt(e,t,2,function(A){var H=De(A.messages[0].data),G=H[3].findIndex(function(Y){var Q,fe,oe=De(Y.data);return(Q=oe[3])!=null&&Q[0]?cr(oe[3][0].data)==d:!!((fe=oe[2])!=null&&fe[0]&&cr(oe[2][0].data)==d)}),q=De(H[3][G].data);q[6]||(q[6]=[]),q[6].push({type:2,data:Re([[],[{type:0,data:Ae(j)}]])}),H[3][G].data=Re(q),A.messages[0].data=Re(H)}),Cs(n,j)}else delete h[13];var V=Ht(h[4][0].data);Lt(e,t,V,function(A){var H=De(A.messages[0].data);H[3]=[],u.forEach(function(G,q){q!=0&&H[3].push({type:2,data:Re([[],[{type:0,data:Ae(q)}],[{type:0,data:Ae(1)}],[{type:2,data:mn(G)}]])})}),A.messages[0].data=Re(H)})}f[4][0].data=Re(h)}n.messages[0].data=Re(f)}function I3(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function N0(e){I3([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function M3(e,t){e&&!e.SSF&&(e.SSF=yr(Pt)),e&&e.SSF&&(id(),ad(e.SSF),t.revssf=od(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Lo?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="bin",n=!0,s=zy();N0(t=t||{});var a=p0(),i="",o=0;if(t.cellXfs=[],ta(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",He(a,i,Xy(e.Props,t)),s.coreprops.push(i),ft(t.rels,2,i,tt.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,He(a,i,Jy(e.Props)),s.extprops.push(i),ft(t.rels,3,i,tt.EXT_PROPS),e.Custprops!==e.Props&&Ut(e.Custprops||{}).length>0&&(i="docProps/custom.xml",He(a,i,Qy(e.Custprops)),s.custprops.push(i),ft(t.rels,4,i,tt.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},f=e.Sheets[e.SheetNames[o-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,He(a,i,wL(o-1,t,e,d)),s.sheets.push(i),ft(t.wbrels,-1,"worksheets/sheet"+o+"."+r,tt.WS[0])}if(f){var p=f["!comments"],v=!1,g="";p&&p.length>0&&(g="xl/comments"+o+"."+r,He(a,g,lI(p)),s.comments.push(g),ft(d,-1,"../comments"+o+"."+r,tt.CMNT),v=!0),f["!legacy"]&&v&&He(a,"xl/drawings/vmlDrawing"+o+".vml",uw(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&He(a,Ky(i),yi(d))}t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,He(a,i,pO(t.Strings)),s.strs.push(i),ft(t.wbrels,-1,"sharedStrings."+r,tt.SST)),i="xl/workbook."+r,He(a,i,WL(e)),s.workbooks.push(i),ft(t.rels,1,i,tt.WB),i="xl/theme/theme1.xml";var x=cw(e.Themes,t);return He(a,i,x),s.themes.push(i),ft(t.wbrels,-1,"theme/theme1.xml",tt.THEME),i="xl/styles."+r,He(a,i,VO(e,t)),s.styles.push(i),ft(t.wbrels,-1,"styles."+r,tt.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",He(a,i,e.vbaraw),s.vba.push(i),ft(t.wbrels,-1,"vbaProject.bin",tt.VBA)),i="xl/metadata."+r,He(a,i,JO()),s.metadata.push(i),ft(t.wbrels,-1,"metadata."+r,tt.XLMETA),He(a,"[Content_Types].xml",Gy(s,t)),He(a,"_rels/.rels",yi(t.rels)),He(a,"xl/_rels/workbook."+r+".rels",yi(t.wbrels)),delete t.revssf,delete t.ssf,a}function F3(e,t){e&&!e.SSF&&(e.SSF=yr(Pt)),e&&e.SSF&&(id(),ad(e.SSF),t.revssf=od(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Lo?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=uI.indexOf(t.bookType)>-1,s=zy();N0(t=t||{});var a=p0(),i="",o=0;if(t.cellXfs=[],ta(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",He(a,i,Xy(e.Props,t)),s.coreprops.push(i),ft(t.rels,2,i,tt.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,He(a,i,Jy(e.Props)),s.extprops.push(i),ft(t.rels,3,i,tt.EXT_PROPS),e.Custprops!==e.Props&&Ut(e.Custprops||{}).length>0&&(i="docProps/custom.xml",He(a,i,Qy(e.Custprops)),s.custprops.push(i),ft(t.rels,4,i,tt.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],p=(h||{})["!type"]||"sheet";switch(p){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,He(a,i,aF(o-1,t,e,f)),s.sheets.push(i),ft(t.wbrels,-1,"worksheets/sheet"+o+"."+r,tt.WS[0])}if(h){var v=h["!comments"],g=!1,x="";if(v&&v.length>0){var y=!1;v.forEach(function(w){w[1].forEach(function(_){_.T==!0&&(y=!0)})}),y&&(x="xl/threadedComments/threadedComment"+o+".xml",He(a,x,rI(v,d,t)),s.threadedcomments.push(x),ft(f,-1,"../threadedComments/threadedComment"+o+".xml",tt.TCMNT)),x="xl/comments"+o+"."+r,He(a,x,tI(v)),s.comments.push(x),ft(f,-1,"../comments"+o+"."+r,tt.CMNT),g=!0}h["!legacy"]&&g&&He(a,"xl/drawings/vmlDrawing"+o+".vml",uw(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&He(a,Ky(i),yi(f))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,He(a,i,dO(t.Strings,t)),s.strs.push(i),ft(t.wbrels,-1,"sharedStrings."+r,tt.SST)),i="xl/workbook."+r,He(a,i,kL(e)),s.workbooks.push(i),ft(t.rels,1,i,tt.WB),i="xl/theme/theme1.xml",He(a,i,cw(e.Themes,t)),s.themes.push(i),ft(t.wbrels,-1,"theme/theme1.xml",tt.THEME),i="xl/styles."+r,He(a,i,bO(e,t)),s.styles.push(i),ft(t.wbrels,-1,"styles."+r,tt.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",He(a,i,e.vbaraw),s.vba.push(i),ft(t.wbrels,-1,"vbaProject.bin",tt.VBA)),i="xl/metadata."+r,He(a,i,QO()),s.metadata.push(i),ft(t.wbrels,-1,"metadata."+r,tt.XLMETA),d.length>1&&(i="xl/persons/person.xml",He(a,i,nI(d)),s.people.push(i),ft(t.wbrels,-1,"persons/person.xml",tt.PEOPLE)),He(a,"[Content_Types].xml",Gy(s,t)),He(a,"_rels/.rels",yi(t.rels)),He(a,"xl/_rels/workbook."+r+".rels",yi(t.wbrels)),delete t.revssf,delete t.ssf,a}function L3(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Vs(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Nw(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Ol(t.file,pt.write(e,{type:lt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return pt.write(e,t)}function B3(e,t){switch(t.bookType){case"ods":return kw(e,t);case"numbers":return D3(e,t);case"xlsb":return M3(e,t);default:return F3(e,t)}}function $3(e,t){var r=yr(t||{}),n=B3(e,r);return W3(n,r)}function W3(e,t){var r={},n=lt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?pt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(sd(s))}return t.password&&typeof encrypt_agile<"u"?Nw(encrypt_agile(s,t.password),t):t.type==="file"?Ol(t.file,s):t.type=="string"?vi(s):s}function U3(e,t){var r=t||{},n=t3(e,r);return Nw(n,r)}function An(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return qc(rl(n));case"binary":return rl(n);case"string":return e;case"file":return Ol(t.file,n,"utf8");case"buffer":return lt?zn(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):An(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function V3(e,t){switch(t.type){case"base64":return Xj(e);case"binary":return e;case"string":return e;case"file":return Ol(t.file,e,"binary");case"buffer":return lt?zn(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function xc(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?qc(r):t.type=="string"?vi(r):r;case"file":return Ol(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function Dw(e,t){Yj(),CL(e);var r=yr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=Dw(e,r);return r.type="array",sd(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return An(ZL(e,r),r);case"slk":case"sylk":return An(oO.from_sheet(e.Sheets[e.SheetNames[s]],r,e),r);case"htm":case"html":return An(Ew(e.Sheets[e.SheetNames[s]],r),r);case"txt":return V3(jw(e.Sheets[e.SheetNames[s]],r),r);case"csv":return An(D0(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return An(lO.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return xc(iO.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return An(cO.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return An(xO(e.Sheets[e.SheetNames[s]]),r);case"eth":return An(sw.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return An(kw(e,r),r);case"wk1":return xc(Xp.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return xc(Xp.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),xc(Sw(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),U3(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return $3(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function H3(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function z3(e,t,r){var n=r||{};return n.type="file",n.file=t,H3(n),Dw(e,n)}function G3(e,t,r,n,s,a,i){var o=gt(r),c=i.defval,u=i.raw||!Object.prototype.hasOwnProperty.call(i,"raw"),d=!0,f=e["!data"]!=null,h=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!f||e["!data"][r])for(var p=t.s.c;p<=t.e.c;++p){var v=f?(e["!data"][r]||[])[p]:e[n[p]+o];if(v===void 0||v.t===void 0){if(c===void 0)continue;a[p]!=null&&(h[a[p]]=c);continue}var g=v.v;switch(v.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(a[p]!=null){if(g==null)if(v.t=="e"&&g===null)h[a[p]]=null;else if(c!==void 0)h[a[p]]=c;else if(u&&g===null)h[a[p]]=null;else continue;else h[a[p]]=u&&(v.t!=="n"||v.t==="n"&&i.rawNumbers!==!1)?g:hs(v,g,i);g!=null&&(d=!1)}}return{row:h,isempty:d}}function fu(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],i=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":c=yt(d);break;case"number":c=yt(e["!ref"]),c.s.r=d;break;default:c=d}n>0&&(s=0);var f=gt(c.s.r),h=[],p=[],v=0,g=0,x=e["!data"]!=null,y=c.s.r,w=0,_={};x&&!e["!data"][y]&&(e["!data"][y]=[]);var b=u.skipHidden&&e["!cols"]||[],T=u.skipHidden&&e["!rows"]||[];for(w=c.s.c;w<=c.e.c;++w)if(!(b[w]||{}).hidden)switch(h[w]=xt(w),r=x?e["!data"][y][w]:e[h[w]+f],n){case 1:a[w]=w-c.s.c;break;case 2:a[w]=h[w];break;case 3:a[w]=u.header[w-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=hs(r,null,u),g=_[i]||0,!g)_[i]=1;else{do o=i+"_"+g++;while(_[o]);_[i]=g,_[o]=1}a[w]=o}for(y=c.s.r+s;y<=c.e.r;++y)if(!(T[y]||{}).hidden){var k=G3(e,c,y,h,n,a,u);(k.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(p[v++]=k.row)}return p.length=v,p}var og=/"/g;function K3(e,t,r,n,s,a,i,o){for(var c=!0,u=[],d="",f=gt(r),h=e["!data"]!=null,p=h&&e["!data"][r]||[],v=t.s.c;v<=t.e.c;++v)if(n[v]){var g=h?p[v]:e[n[v]+f];if(g==null)d="";else if(g.v!=null){c=!1,d=""+(o.rawNumbers&&g.t=="n"?g.v:hs(g,null,o));for(var x=0,y=0;x!==d.length;++x)if((y=d.charCodeAt(x))===s||y===a||y===34||o.forceQuotes){d='"'+d.replace(og,'""')+'"';break}d=="ID"&&(d='"ID"')}else g.f!=null&&!g.F?(c=!1,d="="+g.f,d.indexOf(",")>=0&&(d='"'+d.replace(og,'""')+'"')):d="";u.push(d)}return o.blankrows===!1&&c?null:u.join(i)}function D0(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";for(var s=yt(e["!ref"]),a=n.FS!==void 0?n.FS:",",i=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),u=new RegExp((a=="|"?"\\|":a)+"+$"),d="",f=[],h=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],v=s.s.c;v<=s.e.c;++v)(h[v]||{}).hidden||(f[v]=xt(v));for(var g=0,x=s.s.r;x<=s.e.r;++x)(p[x]||{}).hidden||(d=K3(e,s,x,f,i,c,a,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((g++?o:"")+d)));return r.join("")}function jw(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=D0(e,t);return r}function Y3(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=yt(e["!ref"]),a="",i=[],o,c=[],u=e["!data"]!=null;for(o=s.s.c;o<=s.e.c;++o)i[o]=xt(o);for(var d=s.s.r;d<=s.e.r;++d)for(a=gt(d),o=s.s.c;o<=s.e.c;++o)if(t=i[o]+a,r=u?(e["!data"][d]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function Rw(e,t,r){var n=r||{},s=e?e["!data"]!=null:n.dense,a=+!n.skipHeader,i=e||{};!e&&s&&(i["!data"]=[]);var o=0,c=0;if(i&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var u=typeof n.origin=="string"?_t(n.origin):n.origin;o=u.r,c=u.c}var d={s:{c:0,r:0},e:{c,r:o+t.length-1+a}};if(i["!ref"]){var f=yt(i["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),o==-1&&(o=f.e.r+1,d.e.r=o+t.length-1+a)}else o==-1&&(o=0,d.e.r=t.length-1+a);var h=n.header||[],p=0,v=[];t.forEach(function(x,y){s&&!i["!data"][o+y+a]&&(i["!data"][o+y+a]=[]),s&&(v=i["!data"][o+y+a]),Ut(x).forEach(function(w){(p=h.indexOf(w))==-1&&(h[p=h.length]=w);var _=x[w],b="z",T="",k=s?"":xt(c+p)+gt(o+y+a),S=s?v[c+p]:i[k];_&&typeof _=="object"&&!(_ instanceof Date)?s?v[c+p]=_:i[k]=_:(typeof _=="number"?b="n":typeof _=="boolean"?b="b":typeof _=="string"?b="s":_ instanceof Date?(b="d",n.cellDates||(b="n",_=vr(_)),T=S!=null&&S.z&&f0(S.z)?S.z:n.dateNF||Pt[14]):_===null&&n.nullError&&(b="e",_=0),S?(S.t=b,S.v=_,delete S.w,delete S.R,T&&(S.z=T)):s?v[c+p]=S={t:b,v:_}:i[k]=S={t:b,v:_},T&&(S.z=T))})}),d.e.c=Math.max(d.e.c,c+h.length-1);var g=gt(o);if(s&&!i["!data"][o]&&(i["!data"][o]=[]),a)for(p=0;p<h.length;++p)s?i["!data"][o][p+c]={t:"s",v:h[p]}:i[xt(p+c)+g]={t:"s",v:h[p]};return i["!ref"]=Ot(d),i}function X3(e,t){return Rw(null,e,t)}function hu(e,t,r){if(typeof t=="string"){if(e["!data"]!=null){var n=_t(t);return e["!data"][n.r]||(e["!data"][n.r]=[]),e["!data"][n.r][n.c]||(e["!data"][n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?hu(e,Tt(t)):hu(e,xt(r||0)+gt(t))}function q3(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function J3(){return{SheetNames:[],Sheets:{}}}function Ow(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var i=a&&a[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=i+s)!=-1;++s);}if(_w(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function Q3(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=q3(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function Z3(e,t){return e.z=t,e}function Iw(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function e5(e,t,r){return Iw(e,"#"+t,r)}function t5(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function r5(e,t,r,n){for(var s=typeof t!="string"?t:yt(t),a=typeof t=="string"?t:Ot(t),i=s.s.r;i<=s.e.r;++i)for(var o=s.s.c;o<=s.e.c;++o){var c=hu(e,i,o);c.t="n",c.F=a,delete c.v,i==s.s.r&&o==s.s.c&&(c.f=r,n&&(c.D=!0))}var u=Zt(e["!ref"]);return u.s.r>s.s.r&&(u.s.r=s.s.r),u.s.c>s.s.c&&(u.s.c=s.s.c),u.e.r<s.e.r&&(u.e.r=s.e.r),u.e.c<s.e.c&&(u.e.c=s.e.c),e["!ref"]=Ot(u),e}var af={encode_col:xt,encode_row:gt,encode_cell:Tt,encode_range:Ot,decode_col:_0,decode_row:w0,split_cell:QR,decode_cell:_t,decode_range:Zt,format_cell:hs,sheet_add_aoa:By,sheet_add_json:Rw,sheet_add_dom:Tw,aoa_to_sheet:ro,json_to_sheet:X3,table_to_sheet:Cw,table_to_book:S3,sheet_to_csv:D0,sheet_to_txt:jw,sheet_to_json:fu,sheet_to_html:Ew,sheet_to_formulae:Y3,sheet_to_row_object_array:fu,sheet_get_cell:hu,book_new:J3,book_append_sheet:Ow,book_set_sheet_visibility:Q3,cell_set_number_format:Z3,cell_set_hyperlink:Iw,cell_set_internal_link:e5,cell_add_comment:t5,sheet_set_array_formula:r5,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Mw=({filename:e,visibleColumns:t,data:r})=>{const n=d=>{const f={IV_ClosestToStrike:"IV Closest To Strike",IV_UntilExpiryClosestToStrike:"IV Until Expiry Closest To Strike",LowerBoundClosestToStrike:"Lower Bound Closest To Strike",LowerBoundDistanceFromCurrentPrice:"Lower Bound Distance From Current Price",LowerBoundDistanceFromStrike:"Lower Bound Distance From Strike",ImpliedDownPct:"Implied Down %",ToStrikePct:"To Strike %",SafetyMultiple:"Safety Multiple",SigmasToStrike:"Sigmas To Strike",ProbAssignment:"Prob Assignment",SafetyCategory:"Safety Category",CushionMinusIVPct:"Cushion Minus IV %",PotentialLossAtLowerBound:"Potential Loss At IV Lower Bound",recalculatedNumberOfContracts:"Number Of Contracts"};return f[d]?f[d]:d.replace(/([A-Z])/g," $1").replace(/_/g," ").replace(/^\w/,h=>h.toUpperCase()).replace(/\b\w/g,h=>h.toUpperCase())},s=[t.map(d=>n(d)),...r.map(d=>t.map(f=>{const h=d[f];return h==null?"-":typeof h=="number"?ji(h,f):h}))],a=af.book_new(),i=af.aoa_to_sheet(s),o=t.map(d=>{const f=n(d),h=Math.max(f.length,...r.map(p=>{const v=p[d];return String(v||"").length}));return{wch:Math.min(Math.max(h+2,10),50)}});i["!cols"]=o,af.book_append_sheet(a,i,"Options Data");const c=new Date().toISOString().split("T")[0],u=`${e}_${c}.xlsx`;z3(a,u)},n5={OptionName:{name:"Option Name",category:"Identification",whatItIs:"Unique code identifying this specific put option contract",whyItMatters:"Use this to place orders or track specific options",example:"ERICB6U45 (Ericsson B-share, expiry code 6U, strike 45 SEK)"},StockName:{name:"Stock Name",category:"Identification",whatItIs:"Company name (Swedish convention)",whyItMatters:"Identifies which stock you're protecting",example:"ERIC B for Ericsson B-shares"},ExpiryDate:{name:"Expiry Date",category:"Identification",whatItIs:"Last day the option is valid",whyItMatters:"After this date, option expires. Earlier dates = less time = lower premiums but faster profit",unit:"YYYY-MM-DD"},FinancialReport:{name:"Financial Report",category:"Identification",whatItIs:"'Y' if company releases quarterly/annual report before expiry",whyItMatters:"Reports can cause big price swings. 'Y' means higher risk but potentially higher reward"},"X-Day":{name:"X-Day",category:"Identification",whatItIs:"'Y' if ex-dividend date falls before expiry",whyItMatters:"Stock price drops by dividend amount on ex-dividend date. Our calculations already adjust for this"},Premium:{name:"Premium",category:"Pricing",whatItIs:"Total money you receive for selling this put option position",whyItMatters:"This is your profit if stock stays above strike price",unit:"SEK (for ~100,000 SEK position)",example:"5,000 SEK means you get 5,000 SEK immediately"},Bid_Ask_Mid_Price:{name:"Bid-Ask Mid Price",category:"Pricing",whatItIs:"Average between what buyers offer (bid) and what sellers ask",whyItMatters:"Fair market price for one option. Used to calculate Premium field",unit:"SEK per option contract (1 contract = 100 shares)"},Option_Price_Min:{name:"Option Price Min",category:"Pricing",whatItIs:"Minimum price per option to break even (accounting for transaction costs)",whyItMatters:"Only sell if market price is above this break-even point",unit:"SEK per option"},NumberOfContractsBasedOnLimit:{name:"Number of Contracts",category:"Pricing",whatItIs:"How many option contracts you'd sell for a 100,000 SEK position",whyItMatters:"All loss/premium calculations assume this position size"},Bid:{name:"Bid",category:"Pricing",whatItIs:"Highest price buyers are offering right now",whyItMatters:"You can sell immediately at this price (real market price)",unit:"SEK per option"},Ask:{name:"Ask",category:"Pricing",whatItIs:"Lowest price sellers are offering right now",whyItMatters:"Shows other side of market. Gap between Bid and Ask shows liquidity",unit:"SEK per option"},AskBidSpread:{name:"Ask-Bid Spread",category:"Pricing",whatItIs:"Difference between Ask and Bid prices",whyItMatters:"Narrow spread (<1 SEK) = liquid, easy to trade. Wide spread (>5 SEK) = harder to get fair price",unit:"SEK"},"1_2_3_ProbOfWorthless_Weighted":{name:"Weighted Probability",category:"Probability",whatItIs:"Main probability estimate - combines 3 methods (Black-Scholes, Calibrated, Historical)",whyItMatters:"Use this as your primary probability estimate. Higher is safer but lower premium",unit:"0.0 to 1.0 (0% to 100%)",example:"0.85 = 85% chance you keep the premium"},"1_ProbOfWorthless_Original":{name:"Black-Scholes Probability",category:"Probability",whatItIs:"Black-Scholes mathematical model probability",whyItMatters:"Pure mathematical calculation. Part of weighted probability but may over/underestimate",unit:"0.0 to 1.0"},"2_ProbOfWorthless_Calibrated":{name:"Calibrated Probability",category:"Probability",whatItIs:"Black-Scholes adjusted with historical accuracy for this stock",whyItMatters:"Corrects for consistent over/underestimation. More accurate than raw Black-Scholes",unit:"0.0 to 1.0"},"3_ProbOfWorthless_Historical_IV":{name:"Historical IV Probability",category:"Probability",whatItIs:"Probability based on how accurate implied volatility has been historically",whyItMatters:"Uses real market data to estimate probability",unit:"0.0 to 1.0"},ProbWorthless_Bayesian_IsoCal:{name:"Bayesian Probability",category:"Probability",whatItIs:"Sophisticated statistical adjustment based on similar past options",whyItMatters:"Groups similar options (by probability bucket and time to expiry) and learns from outcomes",unit:"0.0 to 1.0"},PoW_Simulation_Mean_Earnings:{name:"Simulation Mean Earnings",category:"Probability",whatItIs:"Average profit/loss from 1,000 Monte Carlo simulations",whyItMatters:"Simulated long-term average outcome. Positive = profitable strategy over many trades",unit:"SEK"},PoW_Stats_MedianLossPct:{name:"Median Loss %",category:"Probability",whatItIs:"Typical loss percentage when things go wrong (historical high-probability options)",whyItMatters:"Shows what actually happened to similar options in the past",unit:"Percentage"},PoW_Stats_WorstLossPct:{name:"Worst Loss %",category:"Probability",whatItIs:"Worst historical loss percentage (from similar high-probability options)",whyItMatters:"Reality check on worst-case scenarios",unit:"Percentage"},PoW_Stats_MedianLoss:{name:"Median Loss",category:"Probability",whatItIs:"Typical loss amount when things go wrong",whyItMatters:"Historical reality check in SEK",unit:"SEK"},PoW_Stats_WorstLoss:{name:"Worst Loss",category:"Probability",whatItIs:"Worst historical loss amount",whyItMatters:"Shows maximum pain in SEK from similar past options",unit:"SEK"},PoW_Stats_MedianProbOfWorthless:{name:"Median Probability",category:"Probability",whatItIs:"Typical probability value in this historical group",whyItMatters:"Reference point for similar options",unit:"0.0 to 1.0"},PoW_Stats_MinProbOfWorthless:{name:"Min Probability",category:"Probability",whatItIs:"Lowest probability in historical group",whyItMatters:"Shows range of similar options",unit:"0.0 to 1.0"},PoW_Stats_MaxProbOfWorthless:{name:"Max Probability",category:"Probability",whatItIs:"Highest probability in historical group",whyItMatters:"Shows range of similar options",unit:"0.0 to 1.0"},Lower_Bound_at_Accuracy:{name:"Lower Bound (80% Accuracy)",category:"Risk Protection",whatItIs:"Stock price level with 80% historical accuracy",whyItMatters:"Strike price below this = extra safety margin. Key risk metric",unit:"SEK",example:"If stock is 100 SEK and lower bound is 85 SEK, stock can drop 15% before reaching this level"},Lower_Bound_HistMedianIV_at_Accuracy:{name:"Lower Bound (Historical Median IV)",category:"Risk Protection",whatItIs:"Lower bound using historical median implied volatility (at 80% accuracy)",whyItMatters:"Alternative calculation using longer-term volatility average. More conservative estimate",unit:"SEK"},Lower_Bound:{name:"Lower Bound",category:"Risk Protection",whatItIs:"Basic lower bound calculation using current implied volatility",whyItMatters:"Simplest estimate. Compare with other lower bounds for full picture",unit:"SEK"},Lower_Bound_HistMedianIV:{name:"Lower Bound (Hist Median)",category:"Risk Protection",whatItIs:"Lower bound using historical median IV (without accuracy adjustment)",whyItMatters:"Shows typical volatility range without accuracy weighting",unit:"SEK"},ExpiryDate_Lower_Bound_Minus_Pct_Based_on_Accuracy:{name:"Lower Bound Adjustment %",category:"Risk Protection",whatItIs:"Percentage adjustment used in lower bound calculations",whyItMatters:"Technical field showing how much volatility buffer is applied",unit:"Decimal (0.35 = 35%)"},StrikeBelowLowerAtAcc:{name:"Strike Below Lower Bound",category:"Risk Protection",whatItIs:"'Y' if strike price is below Lower_Bound_at_Accuracy AND spread is reasonable (≤10 SEK)",whyItMatters:"Quick safety filter. 'Y' = extra protection against losses. Good for conservative strategies"},LossAtBadDecline:{name:"Loss at Bad Decline",category:"Loss Scenarios",whatItIs:"Your loss if stock experiences a 'bad' historical decline (around 10th-20th worst)",whyItMatters:"Realistic worst-case for typical market stress. Not catastrophic, but uncomfortable",unit:"SEK (negative = loss)",example:"-15,000 = you lose 15,000 SEK"},LossAtWorstDecline:{name:"Loss at Worst Decline",category:"Loss Scenarios",whatItIs:"Your loss if stock experiences its single worst historical decline",whyItMatters:"Absolute worst case seen in this stock's history. Very rare but possible",unit:"SEK (negative = loss)"},LossAt100DayWorstDecline:{name:"Loss at 100-Day Worst",category:"Loss Scenarios",whatItIs:"Loss if stock drops like its worst 100-day period ever",whyItMatters:"Time-matched risk (if option has ~100 days, shows relevant historical comparison)",unit:"SEK (negative = loss)"},LossAt_2008_100DayWorstDecline:{name:"Loss at 2008 (100-Day)",category:"Loss Scenarios",whatItIs:"Loss if stock drops like it did during 2008 financial crisis (100-day window)",whyItMatters:"Stress test against global financial crisis. Extreme but has happened",unit:"SEK (negative = loss)"},LossAt50DayWorstDecline:{name:"Loss at 50-Day Worst",category:"Loss Scenarios",whatItIs:"Loss if stock drops like its worst 50-day period ever",whyItMatters:"For shorter-term options (~50 days to expiry)",unit:"SEK (negative = loss)"},LossAt_2008_50DayWorstDecline:{name:"Loss at 2008 (50-Day)",category:"Loss Scenarios",whatItIs:"Loss if stock drops like it did during 2008 crisis (50-day window)",whyItMatters:"Shorter-term 2008 crisis stress test",unit:"SEK (negative = loss)"},Loss_Least_Bad:{name:"Least Bad Loss",category:"Loss Scenarios",whatItIs:"The smallest loss among Bad, Worst, and 100Day scenarios",whyItMatters:"Most optimistic of the realistic bad scenarios",unit:"SEK (negative = loss)"},WorstHistoricalDecline:{name:"Worst Historical Decline",category:"Loss Scenarios",whatItIs:"Percentage the stock dropped during its worst historical period",whyItMatters:"Shows the stock's maximum pain point",unit:"Decimal (0.45 = 45% decline)"},BadHistoricalDecline:{name:"Bad Historical Decline",category:"Loss Scenarios",whatItIs:"Percentage the stock dropped during 'bad' historical period",whyItMatters:"Typical significant decline for this stock",unit:"Decimal (0.25 = 25% decline)"},"100DayMaxPrice":{name:"100-Day Max Price",category:"Loss Scenarios",whatItIs:"Highest stock price in last 100 days",whyItMatters:"Shows recent peak. Current price vs this = how much stock has already fallen",unit:"SEK"},"100DayMaxPriceDate":{name:"100-Day Max Price Date",category:"Loss Scenarios",whatItIs:"Date when stock hit its 100-day maximum",whyItMatters:"Recent peak timing. If yesterday = near highs, if 95 days ago = already declined",unit:"YYYY-MM-DD"},"50DayMaxPrice":{name:"50-Day Max Price",category:"Loss Scenarios",whatItIs:"Highest stock price in last 50 days",whyItMatters:"Shorter-term peak reference",unit:"SEK"},"50DayMaxPriceDate":{name:"50-Day Max Price Date",category:"Loss Scenarios",whatItIs:"Date when stock hit its 50-day maximum",whyItMatters:"Recent trend indicator",unit:"YYYY-MM-DD"},Historical100DaysWorstDecline:{name:"Historical 100-Day Worst",category:"Loss Scenarios",whatItIs:"Worst decline percentage over any 100-day period in stock's history",whyItMatters:"Historical volatility reference for 100-day timeframe",unit:"Decimal (negative, e.g., -0.45 = -45%)"},Historical50DaysWorstDecline:{name:"Historical 50-Day Worst",category:"Loss Scenarios",whatItIs:"Worst decline percentage over any 50-day period in stock's history",whyItMatters:"Historical volatility reference for 50-day timeframe",unit:"Decimal (negative)"},"2008_100DaysWorstDecline":{name:"2008 100-Day Worst",category:"Loss Scenarios",whatItIs:"Worst 100-day decline during 2008 financial crisis",whyItMatters:"Crisis benchmark for 100-day timeframe",unit:"Decimal (negative)"},"2008_50DaysWorstDecline":{name:"2008 50-Day Worst",category:"Loss Scenarios",whatItIs:"Worst 50-day decline during 2008 financial crisis",whyItMatters:"Crisis benchmark for 50-day timeframe",unit:"Decimal (negative)"},ProfitLossPctLeastBad:{name:"Profit/Loss % (Least Bad)",category:"Profit Ratios",whatItIs:"Premium ÷ Loss_Least_Bad (smallest of the bad scenarios)",whyItMatters:"Risk/reward ratio for most optimistic bad scenario. Higher = better payoff",unit:"Ratio",example:"0.25 = premium is 25% of potential loss"},ProfitLossPctBad:{name:"Profit/Loss % (Bad)",category:"Profit Ratios",whatItIs:"Premium ÷ LossAtBadDecline",whyItMatters:"Typical bad scenario risk/reward",unit:"Ratio",example:"0.20 = you get 20% of potential loss as premium"},ProfitLossPctWorst:{name:"Profit/Loss % (Worst)",category:"Profit Ratios",whatItIs:"Premium ÷ LossAtWorstDecline",whyItMatters:"Absolute worst-case risk/reward. Very low = scary losses possible",unit:"Ratio",example:"0.10 = premium is 10% of worst-case loss"},ProfitLossPct100DayWorst:{name:"Profit/Loss % (100-Day)",category:"Profit Ratios",whatItIs:"Premium ÷ LossAt100DayWorstDecline",whyItMatters:"Time-matched risk/reward for 100-day scenarios",unit:"Ratio"},ImpliedVolatility:{name:"Implied Volatility",category:"Volatility",whatItIs:"Market's expectation of future stock volatility (annualized)",whyItMatters:"Key pricing input. Higher IV = higher premiums but more risk",unit:"Decimal (0.30 = 30%)",example:"0.30 means market expects stock to move ±30% over a year"},ImpliedVolatilityUntilExpiry:{name:"IV Until Expiry",category:"Volatility",whatItIs:"ImpliedVolatility scaled to actual time until expiry",whyItMatters:"More accurate volatility for shorter time periods",unit:"Decimal"},TodayStockMedianIV_Maximum100DaysToExp:{name:"Today's Median IV",category:"Volatility",whatItIs:"Today's median implied volatility across all options for this stock (≤100 days to expiry)",whyItMatters:"Shows today's overall volatility level for this stock",unit:"Decimal"},AllMedianIV_Maximum100DaysToExp:{name:"Historical Median IV",category:"Volatility",whatItIs:"Historical median implied volatility for this stock (all-time, ≤100 days to expiry)",whyItMatters:"Baseline volatility. Current IV above this = elevated premiums",unit:"Decimal"},IV_AllMedianIV_Maximum100DaysToExp_Ratio:{name:"IV Ratio",category:"Volatility",whatItIs:"Current IV ÷ Historical median IV",whyItMatters:"Volatility indicator. >1.2 = high volatility (good premiums), <0.8 = low volatility (poor premiums)",unit:"Ratio",example:"1.5 = current volatility is 50% higher than usual"},StockPrice:{name:"Stock Price",category:"Position Sizing",whatItIs:"Current stock price (adjusted for dividends if X-Day = 'Y')",whyItMatters:"Reference price for strike comparison and lower bounds",unit:"SEK"},StrikePrice:{name:"Strike Price",category:"Position Sizing",whatItIs:"Price at which you must buy the stock if option is exercised",whyItMatters:"Key decision point. Stock must fall below strike before you lose money",unit:"SEK",example:"Strike = 100 SEK means you buy stock at 100 if it falls below that"},Underlying_Value:{name:"Underlying Value",category:"Position Sizing",whatItIs:"Total value of stocks you'd have to buy if exercised",whyItMatters:"Shows capital requirement if you get assigned",unit:"SEK",example:"StrikePrice × NumberOfContracts × 100"},StockPrice_After_2008_100DayWorstDecline:{name:"Stock Price After 2008 (100-Day)",category:"Position Sizing",whatItIs:"Where stock would be after a 2008-style 100-day crash",whyItMatters:"Concrete price level for worst-case scenario",unit:"SEK"},StockPrice_After_100DayWorstDecline:{name:"Stock Price After 100-Day Worst",category:"Position Sizing",whatItIs:"Where stock would be after its worst historical 100-day decline",whyItMatters:"Historical worst-case price level",unit:"SEK"},StockPrice_After_50DayWorstDecline:{name:"Stock Price After 50-Day Worst",category:"Position Sizing",whatItIs:"Where stock would be after its worst historical 50-day decline",whyItMatters:"Shorter-term worst-case price level",unit:"SEK"},StockPrice_After_2008_50DayWorstDecline:{name:"Stock Price After 2008 (50-Day)",category:"Position Sizing",whatItIs:"Where stock would be after a 2008-style 50-day crash",whyItMatters:"Shorter-term 2008 crisis price level",unit:"SEK"},DaysToExpiry:{name:"Days to Expiry",category:"Timing",whatItIs:"Calendar days until option expires",whyItMatters:"More days = more premium but more time for things to go wrong. Sweet spot often 30-90 days",unit:"Days"},Mean_Accuracy:{name:"Mean Accuracy",category:"Timing",whatItIs:"Historical accuracy of implied volatility predictions for this stock/timeframe",whyItMatters:"Confidence indicator. Higher = more reliable probability estimates",unit:"0.0 to 1.0 (0% to 100%)",example:"0.80 = implied volatility was accurate 80% of the time historically"},"100k_Invested_Loss_Mean":{name:"100k Invested Loss Mean",category:"Timing",whatItIs:"Average loss for 100k SEK positions with similar probability/expiry, based on historical outcomes",whyItMatters:"Real-world results from similar past trades. Reality check on your estimates",unit:"SEK"}},s5=e=>n5[e];function a5({fieldName:e,className:t}){const r=s5(e);return r?l.jsx(zi,{children:l.jsxs(zo,{delayDuration:200,children:[l.jsx(Go,{asChild:!0,children:l.jsx(Mn,{className:`h-4 w-4 text-muted-foreground hover:text-foreground cursor-help transition-colors ${t||""}`})}),l.jsxs(Ii,{side:"right",className:"max-w-sm p-4 space-y-2",children:[l.jsxs("div",{children:[l.jsx("div",{className:"font-semibold text-sm mb-1",children:r.name}),l.jsx("div",{className:"text-xs text-muted-foreground mb-2",children:r.category})]}),l.jsxs("div",{className:"space-y-1.5",children:[l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-xs",children:"What it is:"}),l.jsx("p",{className:"text-xs text-muted-foreground mt-0.5",children:r.whatItIs})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-xs",children:"Why it matters:"}),l.jsx("p",{className:"text-xs text-muted-foreground mt-0.5",children:r.whyItMatters})]}),r.unit&&l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-xs",children:"Unit:"}),l.jsx("p",{className:"text-xs text-muted-foreground mt-0.5",children:r.unit})]}),r.example&&l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-xs",children:"Example:"}),l.jsx("p",{className:"text-xs text-muted-foreground mt-0.5",children:r.example})]})]})]})]})}):null}const i5=({data:e,onRowClick:t,onStockClick:r,columnFilters:n=[],onColumnFiltersChange:s=()=>{},sortField:a,sortDirection:i,onSortChange:o,enableFiltering:c=!0})=>{const{columnPreferences:u,isLoading:d}=Uu(),[f,h]=m.useState([]),[p,v]=m.useState(null),[g,x]=m.useState({minValue:"",maxValue:""}),y=m.useRef(null),w=["StockName","OptionName","ExpiryDate","DaysToExpiry","StrikePrice","Premium","NumberOfContractsBasedOnLimit","1_2_3_ProbOfWorthless_Weighted"];m.useEffect(()=>{if(!d)if(u.length>0){const A=u.filter(H=>H.visible).sort((H,G)=>H.order-G.order).map(H=>H.key);h(A)}else h(w)},[u,d]),m.useEffect(()=>{const A=H=>{y.current&&!y.current.contains(H.target)&&v(null)};if(p&&c)return document.addEventListener("mousedown",A),()=>document.removeEventListener("mousedown",A)},[p,c]);const _=A=>{if(A==="recalculatedNumberOfContracts")return"Number Of Contracts";const H={IV_ClosestToStrike:"IV Closest To Strike",IV_UntilExpiryClosestToStrike:"IV Until Expiry Closest To Strike",LowerBoundClosestToStrike:"Lower Bound Closest To Strike",LowerBoundDistanceFromCurrentPrice:"Lower Bound Distance From Current Price",LowerBoundDistanceFromStrike:"Lower Bound Distance From Strike",ImpliedDownPct:"Implied Down %",ToStrikePct:"To Strike %",SafetyMultiple:"Safety Multiple",SigmasToStrike:"Sigmas To Strike",ProbAssignment:"Prob Assignment",SafetyCategory:"Safety Category",CushionMinusIVPct:"Cushion Minus IV %",PotentialLossAtLowerBound:"Potential Loss At IV Lower Bound"};return H[A]?H[A]:A.replace(/([A-Z])/g," $1").replace(/_/g," ").replace(/^\w/,G=>G.toUpperCase()).replace(/\b\w/g,G=>G.toUpperCase())},b=A=>{a===A?o(A,i==="asc"?"desc":"asc"):o(A,"asc")},T=[...e].sort((A,H)=>{if(!a)return 0;const G=A[a],q=H[a];if(typeof G=="number"&&typeof q=="number")return i==="asc"?G-q:q-G;const Y=String(G).toLowerCase(),Q=String(q).toLowerCase();return i==="asc"?Y.localeCompare(Q):Q.localeCompare(Y)}),k=A=>e.length===0?"text":typeof e[0][A]=="number"?"number":"text",S=c?T.filter(A=>n.every(H=>{const G=A[H.field];return H.type==="text"?H.textValue?String(G).toLowerCase().includes(H.textValue.toLowerCase()):!0:typeof G!="number"?!1:H.minValue===void 0&&H.maxValue===void 0?!0:!(H.minValue!==void 0&&G<H.minValue||H.maxValue!==void 0&&G>H.maxValue)})):T,E=(A,H)=>{if(!c)return;const G=n,q=G.findIndex(fe=>fe.field===A),Y=k(A);let Q;if(q>=0){const fe=[...G];fe[q]={...fe[q],...H},Y==="text"&&!fe[q].textValue?Q=fe.filter((oe,X)=>X!==q):Y==="number"&&fe[q].minValue===void 0&&fe[q].maxValue===void 0?Q=fe.filter((oe,X)=>X!==q):Q=fe}else Y==="text"&&!H.textValue||Y==="number"&&H.minValue===void 0&&H.maxValue===void 0?Q=G:Q=[...G,{field:A,type:Y,...H}];s(Q)},C=A=>n.find(H=>H.field===A),L=(A,H)=>ji(A,H),M=(A,H)=>{H?f.includes(A)||h(G=>[...G,A]):h(G=>G.filter(q=>q!==A))},j=A=>{h(A)},V=()=>{Mw({filename:"options_data",visibleColumns:f,data:S})};return l.jsx(zi,{children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between gap-4",children:[c&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(jc,{className:"h-4 w-4"}),l.jsx("span",{className:"text-sm text-muted-foreground",children:"Click on column headers to filter"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs(Ee,{variant:"outline",size:"sm",onClick:V,className:"flex items-center gap-2",children:[l.jsx(gx,{className:"h-4 w-4"}),"Export to Excel"]}),l.jsx(Kj,{visibleColumns:f,onVisibilityChange:M,onColumnOrderChange:j})]})]}),l.jsxs(zu,{className:"w-full whitespace-nowrap rounded-md border",children:[l.jsxs(Sl,{children:[l.jsx(El,{children:l.jsx(ds,{children:f.map(A=>{const H=k(A),G=C(A),q=!!G;return l.jsx(qr,{className:A==="StockName"?"w-28 max-w-28":"min-w-[120px]",children:l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsxs(Ee,{variant:"ghost",onClick:()=>b(A),className:"h-8 p-0 font-medium",title:_(A),children:[_(A)," ",l.jsx(Di,{className:"ml-1 h-3 w-3"})]}),l.jsx(a5,{fieldName:A})]}),c&&l.jsxs("div",{className:"relative",children:[l.jsxs(Ee,{variant:q?"default":"outline",size:"sm",onClick:()=>{const Y=p!==A;if(v(Y?A:null),Y){const Q=C(A);x({minValue:(Q==null?void 0:Q.minValue)!==void 0?String(Q.minValue).replace(".",","):"",maxValue:(Q==null?void 0:Q.maxValue)!==void 0?String(Q.maxValue).replace(".",","):""})}},className:"h-6 w-full text-xs",children:[l.jsx(jc,{className:"h-3 w-3 mr-1"}),q?"Filtered":"Filter"]}),p===A&&l.jsxs("div",{ref:y,className:"absolute top-8 left-0 z-50 bg-background border rounded-md shadow-md p-2 min-w-48",children:[H==="text"?l.jsx(Rt,{placeholder:"Search...",value:(G==null?void 0:G.textValue)||"",onChange:Y=>E(A,{textValue:Y.target.value.slice(0,100)}),className:"h-8",maxLength:100,autoFocus:!0}):l.jsxs("div",{className:"space-y-2",children:[l.jsx(Rt,{type:"text",inputMode:"decimal",placeholder:"Min value",value:g.minValue,onChange:Y=>{const Q=Y.target.value;x(oe=>({...oe,minValue:Q}));const fe=Q.replace(",",".");if(fe==="")E(A,{minValue:void 0});else{const oe=parseFloat(fe);!isNaN(oe)&&isFinite(oe)&&E(A,{minValue:oe})}},className:"h-8",autoFocus:!0}),l.jsx(Rt,{type:"text",inputMode:"decimal",placeholder:"Max value",value:g.maxValue,onChange:Y=>{const Q=Y.target.value;x(oe=>({...oe,maxValue:Q}));const fe=Q.replace(",",".");if(fe==="")E(A,{maxValue:void 0});else{const oe=parseFloat(fe);!isNaN(oe)&&isFinite(oe)&&E(A,{maxValue:oe})}},className:"h-8"})]}),l.jsx(Ee,{variant:"ghost",size:"sm",onClick:()=>{E(A,{minValue:void 0,maxValue:void 0}),x({minValue:"",maxValue:""}),v(null)},className:"mt-2 h-6 w-full text-xs",children:"Clear"})]})]})]})},A)})})}),l.jsx(Tl,{children:S.map((A,H)=>l.jsx(ds,{className:"hover:bg-muted/50",children:f.map(G=>{const q=()=>G!=="OptionName"?"":A.FinancialReport==="Y"?"text-orange-600 dark:text-orange-400":A["X-Day"]&&String(A["X-Day"]).toUpperCase()==="Y"?"text-red-600 dark:text-red-400":"text-primary";return l.jsx(Dt,{className:`${G==="StockName"?"w-28 max-w-28 truncate":"min-w-[120px]"} ${G==="OptionName"||G==="StockName"?"cursor-pointer hover:bg-accent/50 transition-colors":""}`,onClick:G==="OptionName"?()=>t==null?void 0:t(A):G==="StockName"?()=>r==null?void 0:r(A.StockName):void 0,children:G==="OptionName"?l.jsx("span",{className:`font-medium ${q()} hover:opacity-80 transition-all`,children:L(A[G],G)}):G==="StockName"?l.jsx("span",{className:"font-medium text-secondary-foreground hover:text-primary transition-colors",children:L(A[G],G)}):L(A[G],G)},G)})},`${A.StockName}-${A.OptionName}-${H}`))})]}),l.jsx(Gu,{orientation:"horizontal"})]})]})})},Ke=m.forwardRef(({className:e,...t},r)=>l.jsx("div",{ref:r,className:Pe("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));Ke.displayName="Card";const qe=m.forwardRef(({className:e,...t},r)=>l.jsx("div",{ref:r,className:Pe("flex flex-col space-y-1.5 p-6",e),...t}));qe.displayName="CardHeader";const Je=m.forwardRef(({className:e,...t},r)=>l.jsx("h3",{ref:r,className:Pe("text-2xl font-semibold leading-none tracking-tight",e),...t}));Je.displayName="CardTitle";const o5=m.forwardRef(({className:e,...t},r)=>l.jsx("p",{ref:r,className:Pe("text-sm text-muted-foreground",e),...t}));o5.displayName="CardDescription";const Ye=m.forwardRef(({className:e,...t},r)=>l.jsx("div",{ref:r,className:Pe("p-6 pt-0",e),...t}));Ye.displayName="CardContent";const l5=m.forwardRef(({className:e,...t},r)=>l.jsx("div",{ref:r,className:Pe("flex items-center p-6 pt-0",e),...t}));l5.displayName="CardFooter";function c5(e,t=[]){let r=[];function n(a,i){const o=m.createContext(i),c=r.length;r=[...r,i];function u(f){const{scope:h,children:p,...v}=f,g=(h==null?void 0:h[e][c])||o,x=m.useMemo(()=>v,Object.values(v));return l.jsx(g.Provider,{value:x,children:p})}function d(f,h){const p=(h==null?void 0:h[e][c])||o,v=m.useContext(p);if(v)return v;if(i!==void 0)return i;throw new Error(`\`${f}\` must be used within \`${a}\``)}return u.displayName=a+"Provider",[u,d]}const s=()=>{const a=r.map(i=>m.createContext(i));return function(o){const c=(o==null?void 0:o[e])||a;return m.useMemo(()=>({[`__scope${e}`]:{...o,[e]:c}}),[o,c])}};return s.scopeName=e,[n,u5(s,...t)]}function u5(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(a){const i=n.reduce((o,{useScope:c,scopeName:u})=>{const f=c(a)[`__scope${u}`];return{...o,...f}},{});return m.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return r.scopeName=t.scopeName,r}var of="rovingFocusGroup.onEntryFocus",d5={bubbles:!1,cancelable:!0},fd="RovingFocusGroup",[th,Fw,f5]=pl(fd),[h5,hd]=c5(fd,[f5]),[m5,p5]=h5(fd),Lw=m.forwardRef((e,t)=>l.jsx(th.Provider,{scope:e.__scopeRovingFocusGroup,children:l.jsx(th.Slot,{scope:e.__scopeRovingFocusGroup,children:l.jsx(g5,{...e,ref:t})})}));Lw.displayName=fd;var g5=m.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:n,loop:s=!1,dir:a,currentTabStopId:i,defaultCurrentTabStopId:o,onCurrentTabStopIdChange:c,onEntryFocus:u,preventScrollOnEntryFocus:d=!1,...f}=e,h=m.useRef(null),p=Me(t,h),v=Xi(a),[g=null,x]=vn({prop:i,defaultProp:o,onChange:c}),[y,w]=m.useState(!1),_=Et(u),b=Fw(r),T=m.useRef(!1),[k,S]=m.useState(0);return m.useEffect(()=>{const E=h.current;if(E)return E.addEventListener(of,_),()=>E.removeEventListener(of,_)},[_]),l.jsx(m5,{scope:r,orientation:n,dir:v,loop:s,currentTabStopId:g,onItemFocus:m.useCallback(E=>x(E),[x]),onItemShiftTab:m.useCallback(()=>w(!0),[]),onFocusableItemAdd:m.useCallback(()=>S(E=>E+1),[]),onFocusableItemRemove:m.useCallback(()=>S(E=>E-1),[]),children:l.jsx(Ne.div,{tabIndex:y||k===0?-1:0,"data-orientation":n,...f,ref:p,style:{outline:"none",...e.style},onMouseDown:he(e.onMouseDown,()=>{T.current=!0}),onFocus:he(e.onFocus,E=>{const C=!T.current;if(E.target===E.currentTarget&&C&&!y){const L=new CustomEvent(of,d5);if(E.currentTarget.dispatchEvent(L),!L.defaultPrevented){const M=b().filter(G=>G.focusable),j=M.find(G=>G.active),V=M.find(G=>G.id===g),H=[j,V,...M].filter(Boolean).map(G=>G.ref.current);Ww(H,d)}}T.current=!1}),onBlur:he(e.onBlur,()=>w(!1))})})}),Bw="RovingFocusGroupItem",$w=m.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:n=!0,active:s=!1,tabStopId:a,...i}=e,o=tn(),c=a||o,u=p5(Bw,r),d=u.currentTabStopId===c,f=Fw(r),{onFocusableItemAdd:h,onFocusableItemRemove:p}=u;return m.useEffect(()=>{if(n)return h(),()=>p()},[n,h,p]),l.jsx(th.ItemSlot,{scope:r,id:c,focusable:n,active:s,children:l.jsx(Ne.span,{tabIndex:d?0:-1,"data-orientation":u.orientation,...i,ref:t,onMouseDown:he(e.onMouseDown,v=>{n?u.onItemFocus(c):v.preventDefault()}),onFocus:he(e.onFocus,()=>u.onItemFocus(c)),onKeyDown:he(e.onKeyDown,v=>{if(v.key==="Tab"&&v.shiftKey){u.onItemShiftTab();return}if(v.target!==v.currentTarget)return;const g=y5(v,u.orientation,u.dir);if(g!==void 0){if(v.metaKey||v.ctrlKey||v.altKey||v.shiftKey)return;v.preventDefault();let y=f().filter(w=>w.focusable).map(w=>w.ref.current);if(g==="last")y.reverse();else if(g==="prev"||g==="next"){g==="prev"&&y.reverse();const w=y.indexOf(v.currentTarget);y=u.loop?w5(y,w+1):y.slice(w+1)}setTimeout(()=>Ww(y))}})})})});$w.displayName=Bw;var x5={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function v5(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function y5(e,t,r){const n=v5(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return x5[n]}function Ww(e,t=!1){const r=document.activeElement;for(const n of e)if(n===r||(n.focus({preventScroll:t}),document.activeElement!==r))return}function w5(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var Uw=Lw,Vw=$w,j0="Tabs",[_5,NW]=bn(j0,[hd]),Hw=hd(),[b5,R0]=_5(j0),zw=m.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,onValueChange:s,defaultValue:a,orientation:i="horizontal",dir:o,activationMode:c="automatic",...u}=e,d=Xi(o),[f,h]=vn({prop:n,onChange:s,defaultProp:a});return l.jsx(b5,{scope:r,baseId:tn(),value:f,onValueChange:h,orientation:i,dir:d,activationMode:c,children:l.jsx(Ne.div,{dir:d,"data-orientation":i,...u,ref:t})})});zw.displayName=j0;var Gw="TabsList",Kw=m.forwardRef((e,t)=>{const{__scopeTabs:r,loop:n=!0,...s}=e,a=R0(Gw,r),i=Hw(r);return l.jsx(Uw,{asChild:!0,...i,orientation:a.orientation,dir:a.dir,loop:n,children:l.jsx(Ne.div,{role:"tablist","aria-orientation":a.orientation,...s,ref:t})})});Kw.displayName=Gw;var Yw="TabsTrigger",Xw=m.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,disabled:s=!1,...a}=e,i=R0(Yw,r),o=Hw(r),c=Qw(i.baseId,n),u=Zw(i.baseId,n),d=n===i.value;return l.jsx(Vw,{asChild:!0,...o,focusable:!s,active:d,children:l.jsx(Ne.button,{type:"button",role:"tab","aria-selected":d,"aria-controls":u,"data-state":d?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:c,...a,ref:t,onMouseDown:he(e.onMouseDown,f=>{!s&&f.button===0&&f.ctrlKey===!1?i.onValueChange(n):f.preventDefault()}),onKeyDown:he(e.onKeyDown,f=>{[" ","Enter"].includes(f.key)&&i.onValueChange(n)}),onFocus:he(e.onFocus,()=>{const f=i.activationMode!=="manual";!d&&!s&&f&&i.onValueChange(n)})})})});Xw.displayName=Yw;var qw="TabsContent",Jw=m.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,forceMount:s,children:a,...i}=e,o=R0(qw,r),c=Qw(o.baseId,n),u=Zw(o.baseId,n),d=n===o.value,f=m.useRef(d);return m.useEffect(()=>{const h=requestAnimationFrame(()=>f.current=!1);return()=>cancelAnimationFrame(h)},[]),l.jsx(Kt,{present:s||d,children:({present:h})=>l.jsx(Ne.div,{"data-state":d?"active":"inactive","data-orientation":o.orientation,role:"tabpanel","aria-labelledby":c,hidden:!h,id:u,tabIndex:0,...i,ref:t,style:{...e.style,animationDuration:f.current?"0s":void 0},children:h&&a})})});Jw.displayName=qw;function Qw(e,t){return`${e}-trigger-${t}`}function Zw(e,t){return`${e}-content-${t}`}var S5=zw,e_=Kw,t_=Xw,r_=Jw;const md=S5,Bl=m.forwardRef(({className:e,...t},r)=>l.jsx(e_,{ref:r,className:Pe("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));Bl.displayName=e_.displayName;const Ln=m.forwardRef(({className:e,...t},r)=>l.jsx(t_,{ref:r,className:Pe("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));Ln.displayName=t_.displayName;const Bn=m.forwardRef(({className:e,...t},r)=>l.jsx(r_,{ref:r,className:Pe("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));Bn.displayName=r_.displayName;var E5="Label",n_=m.forwardRef((e,t)=>l.jsx(Ne.label,{...e,ref:t,onMouseDown:r=>{var s;r.target.closest("button, input, select, textarea")||((s=e.onMouseDown)==null||s.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));n_.displayName=E5;var s_=n_;const T5=bu("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),ze=m.forwardRef(({className:e,...t},r)=>l.jsx(s_,{ref:r,className:Pe(T5(),e),...t}));ze.displayName=s_.displayName;const C5=({data:e})=>{const[t,r]=m.useState(["ProbWorthless_Bayesian_IsoCal"]),n=[{value:"1_2_3_ProbOfWorthless_Weighted",label:"1_2_3_ProbOfWorthless_Weighted"},{value:"ProbWorthless_Bayesian_IsoCal",label:"ProbWorthless_Bayesian_IsoCal"},{value:"1_ProbOfWorthless_Original",label:"1_ProbOfWorthless_Original"},{value:"2_ProbOfWorthless_Calibrated",label:"2_ProbOfWorthless_Calibrated"},{value:"3_ProbOfWorthless_Historical_IV",label:"3_ProbOfWorthless_Historical_IV"}],s=["#2563eb","#dc2626","#16a34a","#ca8a04","#9333ea"],a=e.map(u=>{const d={name:u.OptionName,x:u.Premium,z:u.DaysToExpiry,stockName:u.StockName};return t.forEach(f=>{d[f]=u[f]}),d}),i=e.reduce((u,d)=>{const f=d.ProbWorthless_Bayesian_IsoCal??d["1_2_3_ProbOfWorthless_Weighted"],h=f<=.6?"High Risk":f<.8?"Medium Risk":"Low Risk";return u[h]=(u[h]||0)+1,u},{}),o=Object.entries(i).map(([u,d])=>({risk:u,count:d})),c=u=>{r(d=>d.includes(u)?d.filter(f=>f!==u):[...d,u])};return l.jsxs(md,{defaultValue:"scatter",className:"w-full",children:[l.jsxs(Bl,{className:"grid w-full grid-cols-2",children:[l.jsx(Ln,{value:"scatter",children:"Risk vs Premium"}),l.jsx(Ln,{value:"distribution",children:"Risk Distribution"})]}),l.jsx(Bn,{value:"scatter",children:l.jsxs(Ke,{children:[l.jsxs(qe,{className:"space-y-4",children:[l.jsx(Je,{children:"Premium vs Probability of Worthless"}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(ze,{children:"Select Probability Fields:"}),l.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:n.map(u=>l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Lr,{id:u.value,checked:t.includes(u.value),onCheckedChange:()=>c(u.value)}),l.jsx("label",{htmlFor:u.value,className:"text-sm cursor-pointer",children:u.label})]},u.value))})]})]}),l.jsx(Ye,{children:l.jsx(Is,{width:"100%",height:400,children:l.jsxs(LS,{margin:{top:20,right:20,bottom:20,left:20},children:[l.jsx(rs,{strokeDasharray:"3 3"}),l.jsx(ns,{type:"number",dataKey:"x",name:"Premium",domain:["dataMin","dataMax"]}),l.jsx(Fn,{type:"number",name:"Prob of Worthless",tickFormatter:u=>`${(u*100).toFixed(0)}%`}),l.jsx(ss,{cursor:{strokeDasharray:"3 3"},content:({active:u,payload:d})=>{if(u&&d&&d.length>0){const f=d[0].payload;return l.jsxs("div",{className:"bg-background border border-border rounded-lg p-3 shadow-lg",children:[l.jsxs("div",{className:"font-semibold text-foreground mb-2",children:[f.stockName," - ",f.name]}),l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"text-sm",children:[l.jsx("span",{className:"font-medium",children:"Premium:"})," ",Number(f.x).toLocaleString("sv-SE")]}),t.map(h=>l.jsxs("div",{className:"text-sm",children:[l.jsxs("span",{className:"font-medium",children:[h,":"]})," ",(Number(f[h])*100).toFixed(2),"%"]},h)),l.jsxs("div",{className:"text-sm",children:[l.jsx("span",{className:"font-medium",children:"Days to Expiry:"})," ",f.z]})]})]})}return null}}),l.jsx(Ac,{}),t.map((u,d)=>l.jsx(BS,{name:u,data:a,dataKey:u,fill:s[d%s.length]},u))]})})})]})}),l.jsx(Bn,{value:"distribution",children:l.jsxs(Ke,{children:[l.jsx(qe,{children:l.jsx(Je,{children:"Options Risk Distribution"})}),l.jsx(Ye,{children:l.jsx(Is,{width:"100%",height:400,children:l.jsxs(Sc,{data:o,children:[l.jsx(rs,{strokeDasharray:"3 3"}),l.jsx(ns,{dataKey:"risk"}),l.jsx(Fn,{}),l.jsx(ss,{}),l.jsx(Es,{dataKey:"count",fill:"hsl(var(--primary))"})]})})})]})})]})},k5=()=>{const[e,t]=m.useState([]),[r,n]=m.useState(!1),[s,a]=m.useState(null),i=m.useCallback(async u=>{console.log("📥 Loading CSV:",u),n(!0),a(null);const d=[`https://raw.githubusercontent.com/datamilo/put-options-se/main/data/${u}?${Date.now()}`,`https://raw.githubusercontent.com/datamilo/put-options-se/main/public/data/${u}?${Date.now()}`,`${window.location.origin}/put-options-sedata/${u}?${Date.now()}`];let f=null;for(const h of d)try{console.log("🔗 Trying URL:",h);const p=await fetch(h);if(!p.ok)throw new Error(`Failed to fetch CSV: ${p.status} ${p.statusText}`);const v=await p.text();if(!v||v.trim().length===0)throw new Error("Empty CSV file received");console.log("✅ Successfully loaded CSV from:",h);const g=await new Promise((x,y)=>{Sa.parse(v,{header:!0,skipEmptyLines:!0,transformHeader:w=>w.trim(),transform:(w,_)=>{if(typeof _=="string"&&["X-Day","Premium","PoW_Simulation_Mean_Earnings","100k_Invested_Loss_Mean","1_2_3_ProbOfWorthless_Weighted","ProbWorthless_Bayesian_IsoCal","1_ProbOfWorthless_Original","2_ProbOfWorthless_Calibrated","3_ProbOfWorthless_Historical_IV","Lower_Bound_at_Accuracy","LossAtBadDecline","LossAtWorstDecline","PoW_Stats_MedianLossPct","PoW_Stats_WorstLossPct","PoW_Stats_MedianLoss","PoW_Stats_WorstLoss","PoW_Stats_MedianProbOfWorthless","PoW_Stats_MinProbOfWorthless","PoW_Stats_MaxProbOfWorthless","LossAt100DayWorstDecline","LossAt_2008_100DayWorstDecline","Mean_Accuracy","Lower_Bound_HistMedianIV_at_Accuracy","Lower_Bound","Lower_Bound_HistMedianIV","Bid_Ask_Mid_Price","Option_Price_Min","NumberOfContractsBasedOnLimit","Bid","ProfitLossPctLeastBad","Loss_Least_Bad","IV_AllMedianIV_Maximum100DaysToExp_Ratio","StockPrice","DaysToExpiry","AskBidSpread","Underlying_Value","StrikePrice","StockPrice_After_2008_100DayWorstDecline","LossAt50DayWorstDecline","LossAt_2008_50DayWorstDecline","ProfitLossPctBad","ProfitLossPctWorst","ProfitLossPct100DayWorst","ImpliedVolatility","TodayStockMedianIV_Maximum100DaysToExp","AllMedianIV_Maximum100DaysToExp","ExpiryDate_Lower_Bound_Minus_Pct_Based_on_Accuracy","Ask","WorstHistoricalDecline","BadHistoricalDecline","ImpliedVolatilityUntilExpiry","StockPrice_After_100DayWorstDecline","StockPrice_After_50DayWorstDecline","StockPrice_After_2008_50DayWorstDecline","100DayMaxPrice","50DayMaxPrice","Historical100DaysWorstDecline","Historical50DaysWorstDecline","2008_100DaysWorstDecline","2008_50DaysWorstDecline"].includes(_)){const T=parseFloat(w);return isNaN(T)?null:T}return w},complete:w=>{if(w.errors.length>0){console.warn("CSV parsing warnings:",w.errors);const _=w.errors.filter(b=>b.type==="Delimiter"||b.type==="Quotes");if(_.length>0){y(new Error(`CSV parsing errors: ${_.map(b=>b.message).join(", ")}`));return}}w.data&&w.data.length>0?(console.log(`✅ Parsed ${w.data.length} rows from CSV`),x(w.data)):(console.warn("No data found in CSV, trying next URL..."),y(new Error("No data found in CSV")))},error:w=>{y(new Error(`Failed to parse CSV: ${w.message}`))}})});t(g),n(!1);return}catch(p){console.warn(`❌ Failed to load from ${h}:`,p),f=p;continue}console.warn("❌ All CSV loading attempts failed, using mock data"),a(`Failed to load data from any source. Last error: ${f==null?void 0:f.message}`),c(),n(!1)},[]),o=m.useCallback(u=>{n(!0),a(null),Sa.parse(u,{header:!0,skipEmptyLines:!0,transformHeader:d=>d.trim(),transform:(d,f)=>{if(typeof f=="string"&&["X-Day","Premium","PoW_Simulation_Mean_Earnings","100k_Invested_Loss_Mean","1_2_3_ProbOfWorthless_Weighted","ProbWorthless_Bayesian_IsoCal","1_ProbOfWorthless_Original","2_ProbOfWorthless_Calibrated","3_ProbOfWorthless_Historical_IV","Lower_Bound_at_Accuracy","LossAtBadDecline","LossAtWorstDecline","PoW_Stats_MedianLossPct","PoW_Stats_WorstLossPct","PoW_Stats_MedianLoss","PoW_Stats_WorstLoss","PoW_Stats_MedianProbOfWorthless","PoW_Stats_MinProbOfWorthless","PoW_Stats_MaxProbOfWorthless","LossAt100DayWorstDecline","LossAt_2008_100DayWorstDecline","Mean_Accuracy","Lower_Bound_HistMedianIV_at_Accuracy","Lower_Bound","Lower_Bound_HistMedianIV","Bid_Ask_Mid_Price","Option_Price_Min","NumberOfContractsBasedOnLimit","Bid","ProfitLossPctLeastBad","Loss_Least_Bad","IV_AllMedianIV_Maximum100DaysToExp_Ratio","StockPrice","DaysToExpiry","AskBidSpread","Underlying_Value","StrikePrice","StockPrice_After_2008_100DayWorstDecline","LossAt50DayWorstDecline","LossAt_2008_50DayWorstDecline","ProfitLossPctBad","ProfitLossPctWorst","ProfitLossPct100DayWorst","ImpliedVolatility","TodayStockMedianIV_Maximum100DaysToExp","AllMedianIV_Maximum100DaysToExp","ExpiryDate_Lower_Bound_Minus_Pct_Based_on_Accuracy","Ask","WorstHistoricalDecline","BadHistoricalDecline","ImpliedVolatilityUntilExpiry","StockPrice_After_100DayWorstDecline","StockPrice_After_50DayWorstDecline","StockPrice_After_2008_50DayWorstDecline","100DayMaxPrice","50DayMaxPrice","Historical100DaysWorstDecline","Historical50DaysWorstDecline","2008_100DaysWorstDecline","2008_50DaysWorstDecline"].includes(f)){const p=parseFloat(d);return isNaN(p)?null:p}return d},complete:d=>{d.errors.length>0?a(`CSV parsing errors: ${d.errors.map(f=>f.message).join(", ")}`):t(d.data),n(!1)},error:d=>{a(`Failed to parse CSV: ${d.message}`),n(!1)}})},[]),c=m.useCallback(()=>{console.log("📦 Loading mock data..."),t([{StockName:"AAK AB",OptionName:"AAK5T240",Premium:250,ExpiryDate:"2024-12-15","1_2_3_ProbOfWorthless_Weighted":.898455,ProbWorthless_Bayesian_IsoCal:.810947,"1_ProbOfWorthless_Original":.884279,"2_ProbOfWorthless_Calibrated":.85,"3_ProbOfWorthless_Historical_IV":.12,Lower_Bound_at_Accuracy:.75,LossAtBadDecline:-21150,LossAtWorstDecline:-25e3,PoW_Stats_MedianLossPct:.15,PoW_Stats_WorstLossPct:.25,PoW_Stats_MedianLoss:-18e3,PoW_Stats_WorstLoss:-3e4,PoW_Stats_MedianProbOfWorthless:.82,PoW_Stats_MinProbOfWorthless:.75,PoW_Stats_MaxProbOfWorthless:.95,LossAt100DayWorstDecline:-22e3,LossAt_2008_100DayWorstDecline:-45e3,Mean_Accuracy:.78,Lower_Bound_HistMedianIV_at_Accuracy:.22,Lower_Bound:195,Lower_Bound_HistMedianIV:.21,Bid_Ask_Mid_Price:248,Option_Price_Min:240,NumberOfContractsBasedOnLimit:400,Bid:245,ProfitLossPctLeastBad:.02,Loss_Least_Bad:-5e3,IV_AllMedianIV_Maximum100DaysToExp_Ratio:1.15,StockPrice:280,DaysToExpiry:45,AskBidSpread:10,Underlying_Value:280,StrikePrice:290,StockPrice_After_2008_100DayWorstDecline:220,LossAt50DayWorstDecline:-21150,LossAt_2008_50DayWorstDecline:-48910,ProfitLossPctBad:.02,ProfitLossPctWorst:.01,ProfitLossPct100DayWorst:.021,ImpliedVolatility:.298041,TodayStockMedianIV_Maximum100DaysToExp:.22951,AllMedianIV_Maximum100DaysToExp:.216361,ExpiryDate_Lower_Bound_Minus_Pct_Based_on_Accuracy:.2,StrikeBelowLowerAtAcc:"Y",Ask:255,"X-Day":0,PoW_Simulation_Mean_Earnings:12e3,"100k_Invested_Loss_Mean":-15e3,WorstHistoricalDecline:-.45,BadHistoricalDecline:-.35,ImpliedVolatilityUntilExpiry:.298,StockPrice_After_100DayWorstDecline:210,StockPrice_After_50DayWorstDecline:215,StockPrice_After_2008_50DayWorstDecline:180,"100DayMaxPrice":320,"50DayMaxPrice":310,Historical100DaysWorstDecline:-.42,Historical50DaysWorstDecline:-.38,"2008_100DaysWorstDecline":-.55,"2008_50DaysWorstDecline":-.52}])},[]);return m.useEffect(()=>{let u=!0;return(async()=>{if(u)try{await i("data.csv")}catch(f){console.warn("❌ All CSV loading attempts failed:",f),u&&c()}})(),()=>{u=!1}},[i,c]),{data:e,isLoading:r,error:s,loadCSVFile:o,loadCSVFromGitHub:i,loadMockData:c,setData:t}},P5=e=>{const{underlyingValue:t,transactionCost:r}=Yi();return m.useMemo(()=>(console.log("useRecalculatedOptions: Recalculating with underlyingValue:",t,"transactionCost:",r,"options count:",e.length),e.map(n=>{const s=Math.round(t/n.StrikePrice/100),a=(n.Bid+(n.Ask||n.Bid))/2,i=Math.round(a*s*100-r);return{...n,originalPremium:n.Premium,recalculatedPremium:i,recalculatedNumberOfContracts:s,recalculatedBid_Ask_Mid_Price:a,Premium:i,NumberOfContractsBasedOnLimit:s,Bid_Ask_Mid_Price:a}})),[e,t,r])};let et={data:[],isLoading:!1,error:null,loaded:!1};const A5=()=>{const[e,t]=m.useState(et.data),[r,n]=m.useState(et.isLoading),[s,a]=m.useState(et.error);console.log("🔍 useIVData hook called, singleton loaded:",et.loaded,"data length:",et.data.length);const i=m.useCallback(async()=>{if(et.loaded&&et.data.length>0){console.log("🚀 IV data already loaded in singleton, using cached data:",et.data.length),t(et.data),n(!1),a(et.error);return}console.log("📥 Loading IV data..."),n(!0),et.isLoading=!0,a(null),et.error=null;const o=[`https://raw.githubusercontent.com/datamilo/put-options-se/main/data/IV_PotentialDecline.csv?${Date.now()}`,`${window.location.origin}/put-options-sedata/IV_PotentialDecline.csv?${Date.now()}`];let c=null;for(const u of o)try{console.log("🔗 Trying IV URL:",u);const d=await fetch(u);if(!d.ok)throw new Error(`Failed to fetch CSV: ${d.status} ${d.statusText}`);const f=await d.text();if(!f||f.trim().length===0)throw new Error("Empty CSV file received");console.log("✅ Successfully loaded IV CSV from:",u),Sa.parse(f,{header:!0,skipEmptyLines:!0,delimiter:"|",transformHeader:h=>h.trim(),transform:(h,p)=>{const v=String(p||"");if(["IV_ClosestToStrike","IV_UntilExpiryClosestToStrike","LowerBoundClosestToStrike","LowerBoundDistanceFromCurrentPrice","LowerBoundDistanceFromStrike","ImpliedDownPct","ToStrikePct","SafetyMultiple","SigmasToStrike","ProbAssignment","CushionMinusIVPct"].includes(v)&&h!==""){const x=parseFloat(String(h));return isNaN(x)?0:x}return String(h||"").trim()},complete:h=>{if(h.errors.length>0){console.warn("IV CSV parsing warnings:",h.errors);const p=h.errors.filter(v=>v.type==="Delimiter"||v.type==="Quotes");if(p.length>0){a(`IV CSV parsing errors: ${p.map(v=>v.message).join(", ")}`),n(!1),et.isLoading=!1;return}}if(h.data&&h.data.length>0){console.log(`✅ Parsed ${h.data.length} IV rows from CSV - STORING IN SINGLETON`);const p=h.data;et.data=p,et.loaded=!0,et.isLoading=!1,et.error=null,t(p),n(!1),a(null);return}else throw new Error("No IV data found in CSV")},error:h=>{throw new Error(`Failed to parse IV CSV: ${h.message}`)}});break}catch(d){console.warn(`❌ Failed to load IV data from ${u}:`,d),c=d;continue}if(!et.loaded||et.data.length===0){console.warn("❌ All IV CSV loading attempts failed, current singleton data length:",et.data.length);const u=`Failed to load IV data from any source. Last error: ${c==null?void 0:c.message}`;a(u),et.error=u}n(!1),et.isLoading=!1},[]);return m.useEffect(()=>{if(console.log("🚀 useIVData useEffect triggered, singleton loaded:",et.loaded,"data length:",et.data.length),et.loaded&&et.data.length>0){console.log("📋 Using cached IV data from singleton:",et.data.length),t(et.data),n(et.isLoading),a(et.error);return}let o=!0;return(async()=>{if(!o){console.log("⚠️ Component unmounted, aborting load");return}console.log("📥 Starting IV data load...");try{await i()}catch(u){console.warn("❌ useEffect: All IV CSV loading attempts failed:",u)}})(),()=>{o=!1}},[]),{data:e,isLoading:r,error:s,loadIVDataFromGitHub:i,setData:o=>{t(o),et.data=o,et.loaded=o.length>0}}},O0=()=>{const{data:e,isLoading:t,error:r,...n}=k5(),s=P5(e),{data:a,isLoading:i,error:o}=A5(),{underlyingValue:c,transactionCost:u}=Yi();return{data:m.useMemo(()=>s.length?(console.log("🔄 Enriching options data with IV data...",{optionsDataLength:s.length,ivDataLength:a.length}),s.map(f=>{const h=a.find(v=>v.OptionName===f.OptionName);h||console.log("⚠️ No IV data found for option:",f.OptionName);let p=null;if(h!=null&&h.LowerBoundClosestToStrike){const v=f.NumberOfContractsBasedOnLimit||0,g=f.StrikePrice*v*100,x=v*h.LowerBoundClosestToStrike*100,y=x-g;p=f.Premium+y,p>=0&&(p=0),p<0&&(p=p-(p*75e-6+u)),f.OptionName==="HOLMB5U356"&&console.log("🎯 HOLMB5U356 Debug - Full Calculation:",{optionName:f.OptionName,strikePrice:f.StrikePrice,numberOfContracts:v,lowerBoundClosestToStrike:h.LowerBoundClosestToStrike,premium:f.Premium,transactionCost:u,"1_underlyingValueInvestment":g,"2_underlyingValueLowerBoundClosestToStrike":x,"3_lossLowerBoundClosestToStrike":y,"4_beforeTransactionCost":f.Premium+y,"5_potentialLossAtLowerBound_FINAL":p,expectedResult:-2402.8272,expectedCalc_step1:356*3*100,expectedCalc_step2:3*345.9*100,expectedCalc_step3:3*345.9*100-356*3*100,expectedCalc_step4:726+(3*345.9*100-356*3*100),expectedCalc_step5:726+(3*345.9*100-356*3*100)-((726+(3*345.9*100-356*3*100))*75e-6+99)})}return{...f,IV_ClosestToStrike:(h==null?void 0:h.IV_ClosestToStrike)??void 0,IV_UntilExpiryClosestToStrike:(h==null?void 0:h.IV_UntilExpiryClosestToStrike)??void 0,LowerBoundClosestToStrike:(h==null?void 0:h.LowerBoundClosestToStrike)??void 0,LowerBoundDistanceFromCurrentPrice:(h==null?void 0:h.LowerBoundDistanceFromCurrentPrice)??void 0,LowerBoundDistanceFromStrike:(h==null?void 0:h.LowerBoundDistanceFromStrike)??void 0,ImpliedDownPct:(h==null?void 0:h.ImpliedDownPct)??void 0,ToStrikePct:(h==null?void 0:h.ToStrikePct)??void 0,SafetyMultiple:(h==null?void 0:h.SafetyMultiple)??void 0,SigmasToStrike:(h==null?void 0:h.SigmasToStrike)??void 0,ProbAssignment:(h==null?void 0:h.ProbAssignment)??void 0,SafetyCategory:(h==null?void 0:h.SafetyCategory)??void 0,CushionMinusIVPct:(h==null?void 0:h.CushionMinusIVPct)??void 0,PotentialLossAtLowerBound:p}})):s,[s,a,c,u]),isLoading:t||i,error:r||o,...n}},pd=()=>{const[e,t]=m.useState([]),[r,n]=m.useState(!0),[s,a]=m.useState(null);m.useEffect(()=>{i()},[]);const i=async()=>{try{n(!0),a(null);const f=[`https://raw.githubusercontent.com/datamilo/put-options-se/main/data/stock_data.csv?${Date.now()}`,`${window.location.origin}/put-options-sedata/stock_data.csv?${Date.now()}`];let h=null,p=null;for(const g of f)try{if(console.log("🔗 Trying stock data URL:",g),p=await fetch(g),p.ok){console.log("✅ Successfully loaded CSV from:",g);break}}catch(x){console.warn("❌ Failed to load from:",g,x),h=x}if(!p||!p.ok)throw h||new Error("Failed to load stock data from any URL");const v=await p.text();Sa.parse(v,{header:!0,delimiter:"|",skipEmptyLines:!0,transform:(g,x)=>x==="close"||x==="volume"||x==="pct_change_close"?g===""||g===null||g===void 0?x==="volume"?0:null:parseFloat(g):g,complete:g=>{console.log("Raw CSV data loaded:",g.data.slice(0,5)),console.log("Total rows loaded:",g.data.length);const x=g.data.filter(y=>y.name==="AAK AB");console.log("AAK AB data found:",x.length,"rows"),console.log("Latest AAK AB entries:",x.slice(-5)),t(g.data),n(!1)},error:g=>{console.error("Error parsing CSV:",g),a("Failed to parse stock data"),n(!1)}})}catch(f){console.error("Error loading stock data:",f),a("Failed to load stock data"),n(!1)}},o=f=>e.filter(h=>h.name===f).sort((h,p)=>new Date(h.date).getTime()-new Date(p.date).getTime());return{allStockData:e,isLoading:r,error:s,getStockData:o,getStockSummary:f=>{const h=o(f);if(h.length===0)return null;console.log(`Stock data for ${f}:`,h.slice(-5)),console.log(`Latest data for ${f}:`,h[h.length-1]);const p=h[h.length-1],v=h[h.length-2],g=v?p.close-v.close:0,x=v?g/v.close*100:0,y=new Date;y.setFullYear(y.getFullYear()-1);const w=h.filter(j=>new Date(j.date)>=y),_=w.map(j=>j.close),b=Math.max(..._),T=Math.min(..._),k=w.slice(1).map((j,V)=>(j.close-w[V].close)/w[V].close),S=k.reduce((j,V)=>j+V,0)/k.length,E=k.reduce((j,V)=>j+Math.pow(V-S,2),0)/k.length,C=Math.sqrt(E)*Math.sqrt(252)*100,L=w.map(j=>j.volume).sort((j,V)=>j-V),M=L.length%2===0?(L[L.length/2-1]+L[L.length/2])/2:L[Math.floor(L.length/2)];return{name:f,currentPrice:p.close,priceChange:g,priceChangePercent:x,volume:p.volume,medianVolume:M,highPrice52Week:b,lowPrice52Week:T,volatility:C}},getLowPriceForPeriod:(f,h)=>{const p=o(f);if(p.length===0)return null;const v=new Date;v.setDate(v.getDate()-h);const g=p.filter(y=>new Date(y.date)>=v);if(g.length===0)return null;const x=g.map(y=>y.close);return Math.min(...x)},getPriceRangeForPeriod:(f,h)=>{const p=o(f);if(p.length===0)return null;const v=new Date;v.setDate(v.getDate()-h);const g=p.filter(y=>new Date(y.date)>=v);if(g.length===0)return null;const x=g.map(y=>y.close);return{high:Math.max(...x),low:Math.min(...x)}},loadStockData:i}};function En(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function Ra(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}const a_=6048e5,N5=864e5;let D5={};function gd(){return D5}function ll(e,t){var o,c,u,d;const r=gd(),n=(t==null?void 0:t.weekStartsOn)??((c=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:c.weekStartsOn)??r.weekStartsOn??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.weekStartsOn)??0,s=En(e),a=s.getDay(),i=(a<n?7:0)+a-n;return s.setDate(s.getDate()-i),s.setHours(0,0,0,0),s}function mu(e){return ll(e,{weekStartsOn:1})}function i_(e){const t=En(e),r=t.getFullYear(),n=Ra(e,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const s=mu(n),a=Ra(e,0);a.setFullYear(r,0,4),a.setHours(0,0,0,0);const i=mu(a);return t.getTime()>=s.getTime()?r+1:t.getTime()>=i.getTime()?r:r-1}function lg(e){const t=En(e);return t.setHours(0,0,0,0),t}function cg(e){const t=En(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function j5(e,t){const r=lg(e),n=lg(t),s=+r-cg(r),a=+n-cg(n);return Math.round((s-a)/N5)}function R5(e){const t=i_(e),r=Ra(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),mu(r)}function O5(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function I5(e){if(!O5(e)&&typeof e!="number")return!1;const t=En(e);return!isNaN(Number(t))}function M5(e){const t=En(e),r=Ra(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}const F5={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},L5=(e,t,r)=>{let n;const s=F5[e];return typeof s=="string"?n=s:t===1?n=s.one:n=s.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function lf(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const B5={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},$5={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},W5={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},U5={date:lf({formats:B5,defaultWidth:"full"}),time:lf({formats:$5,defaultWidth:"full"}),dateTime:lf({formats:W5,defaultWidth:"full"})},V5={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},H5=(e,t,r,n)=>V5[e];function xo(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let s;if(n==="formatting"&&e.formattingValues){const i=e.defaultFormattingWidth||e.defaultWidth,o=r!=null&&r.width?String(r.width):i;s=e.formattingValues[o]||e.formattingValues[i]}else{const i=e.defaultWidth,o=r!=null&&r.width?String(r.width):e.defaultWidth;s=e.values[o]||e.values[i]}const a=e.argumentCallback?e.argumentCallback(t):t;return s[a]}}const z5={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},G5={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},K5={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Y5={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},X5={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},q5={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},J5=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},Q5={ordinalNumber:J5,era:xo({values:z5,defaultWidth:"wide"}),quarter:xo({values:G5,defaultWidth:"wide",argumentCallback:e=>e-1}),month:xo({values:K5,defaultWidth:"wide"}),day:xo({values:Y5,defaultWidth:"wide"}),dayPeriod:xo({values:X5,defaultWidth:"wide",formattingValues:q5,defaultFormattingWidth:"wide"})};function vo(e){return(t,r={})=>{const n=r.width,s=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],a=t.match(s);if(!a)return null;const i=a[0],o=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(o)?e8(o,f=>f.test(i)):Z5(o,f=>f.test(i));let u;u=e.valueCallback?e.valueCallback(c):c,u=r.valueCallback?r.valueCallback(u):u;const d=t.slice(i.length);return{value:u,rest:d}}}function Z5(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function e8(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function t8(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const s=n[0],a=t.match(e.parsePattern);if(!a)return null;let i=e.valueCallback?e.valueCallback(a[0]):a[0];i=r.valueCallback?r.valueCallback(i):i;const o=t.slice(s.length);return{value:i,rest:o}}}const r8=/^(\d+)(th|st|nd|rd)?/i,n8=/\d+/i,s8={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},a8={any:[/^b/i,/^(a|c)/i]},i8={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},o8={any:[/1/i,/2/i,/3/i,/4/i]},l8={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},c8={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},u8={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},d8={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},f8={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},h8={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},m8={ordinalNumber:t8({matchPattern:r8,parsePattern:n8,valueCallback:e=>parseInt(e,10)}),era:vo({matchPatterns:s8,defaultMatchWidth:"wide",parsePatterns:a8,defaultParseWidth:"any"}),quarter:vo({matchPatterns:i8,defaultMatchWidth:"wide",parsePatterns:o8,defaultParseWidth:"any",valueCallback:e=>e+1}),month:vo({matchPatterns:l8,defaultMatchWidth:"wide",parsePatterns:c8,defaultParseWidth:"any"}),day:vo({matchPatterns:u8,defaultMatchWidth:"wide",parsePatterns:d8,defaultParseWidth:"any"}),dayPeriod:vo({matchPatterns:f8,defaultMatchWidth:"any",parsePatterns:h8,defaultParseWidth:"any"})},p8={code:"en-US",formatDistance:L5,formatLong:U5,formatRelative:H5,localize:Q5,match:m8,options:{weekStartsOn:0,firstWeekContainsDate:1}};function g8(e){const t=En(e);return j5(t,M5(t))+1}function x8(e){const t=En(e),r=+mu(t)-+R5(t);return Math.round(r/a_)+1}function o_(e,t){var d,f,h,p;const r=En(e),n=r.getFullYear(),s=gd(),a=(t==null?void 0:t.firstWeekContainsDate)??((f=(d=t==null?void 0:t.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??s.firstWeekContainsDate??((p=(h=s.locale)==null?void 0:h.options)==null?void 0:p.firstWeekContainsDate)??1,i=Ra(e,0);i.setFullYear(n+1,0,a),i.setHours(0,0,0,0);const o=ll(i,t),c=Ra(e,0);c.setFullYear(n,0,a),c.setHours(0,0,0,0);const u=ll(c,t);return r.getTime()>=o.getTime()?n+1:r.getTime()>=u.getTime()?n:n-1}function v8(e,t){var o,c,u,d;const r=gd(),n=(t==null?void 0:t.firstWeekContainsDate)??((c=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:c.firstWeekContainsDate)??r.firstWeekContainsDate??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??1,s=o_(e,t),a=Ra(e,0);return a.setFullYear(s,0,n),a.setHours(0,0,0,0),ll(a,t)}function y8(e,t){const r=En(e),n=+ll(r,t)-+v8(r,t);return Math.round(n/a_)+1}function dt(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const ys={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return dt(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):dt(r+1,2)},d(e,t){return dt(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return dt(e.getHours()%12||12,t.length)},H(e,t){return dt(e.getHours(),t.length)},m(e,t){return dt(e.getMinutes(),t.length)},s(e,t){return dt(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),s=Math.trunc(n*Math.pow(10,r-3));return dt(s,t.length)}},ai={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},ug={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),s=n>0?n:1-n;return r.ordinalNumber(s,{unit:"year"})}return ys.y(e,t)},Y:function(e,t,r,n){const s=o_(e,n),a=s>0?s:1-s;if(t==="YY"){const i=a%100;return dt(i,2)}return t==="Yo"?r.ordinalNumber(a,{unit:"year"}):dt(a,t.length)},R:function(e,t){const r=i_(e);return dt(r,t.length)},u:function(e,t){const r=e.getFullYear();return dt(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return dt(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return dt(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return ys.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return dt(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const s=y8(e,n);return t==="wo"?r.ordinalNumber(s,{unit:"week"}):dt(s,t.length)},I:function(e,t,r){const n=x8(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):dt(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):ys.d(e,t)},D:function(e,t,r){const n=g8(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):dt(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const s=e.getDay(),a=(s-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(a);case"ee":return dt(a,2);case"eo":return r.ordinalNumber(a,{unit:"day"});case"eee":return r.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(s,{width:"short",context:"formatting"});case"eeee":default:return r.day(s,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const s=e.getDay(),a=(s-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(a);case"cc":return dt(a,t.length);case"co":return r.ordinalNumber(a,{unit:"day"});case"ccc":return r.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(s,{width:"narrow",context:"standalone"});case"cccccc":return r.day(s,{width:"short",context:"standalone"});case"cccc":default:return r.day(s,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),s=n===0?7:n;switch(t){case"i":return String(s);case"ii":return dt(s,t.length);case"io":return r.ordinalNumber(s,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const s=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let s;switch(n===12?s=ai.noon:n===0?s=ai.midnight:s=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let s;switch(n>=17?s=ai.evening:n>=12?s=ai.afternoon:n>=4?s=ai.morning:s=ai.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return ys.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):ys.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):dt(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):dt(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):ys.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):ys.s(e,t)},S:function(e,t){return ys.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return fg(n);case"XXXX":case"XX":return fa(n);case"XXXXX":case"XXX":default:return fa(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return fg(n);case"xxxx":case"xx":return fa(n);case"xxxxx":case"xxx":default:return fa(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+dg(n,":");case"OOOO":default:return"GMT"+fa(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+dg(n,":");case"zzzz":default:return"GMT"+fa(n,":")}},t:function(e,t,r){const n=Math.trunc(e.getTime()/1e3);return dt(n,t.length)},T:function(e,t,r){const n=e.getTime();return dt(n,t.length)}};function dg(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),s=Math.trunc(n/60),a=n%60;return a===0?r+String(s):r+String(s)+t+dt(a,2)}function fg(e,t){return e%60===0?(e>0?"-":"+")+dt(Math.abs(e)/60,2):fa(e,t)}function fa(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),s=dt(Math.trunc(n/60),2),a=dt(n%60,2);return r+s+t+a}const hg=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},l_=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},w8=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],s=r[2];if(!s)return hg(e,t);let a;switch(n){case"P":a=t.dateTime({width:"short"});break;case"PP":a=t.dateTime({width:"medium"});break;case"PPP":a=t.dateTime({width:"long"});break;case"PPPP":default:a=t.dateTime({width:"full"});break}return a.replace("{{date}}",hg(n,t)).replace("{{time}}",l_(s,t))},_8={p:l_,P:w8},b8=/^D+$/,S8=/^Y+$/,E8=["D","DD","YY","YYYY"];function T8(e){return b8.test(e)}function C8(e){return S8.test(e)}function k8(e,t,r){const n=P8(e,t,r);if(console.warn(n),E8.includes(e))throw new RangeError(n)}function P8(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const A8=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,N8=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,D8=/^'([^]*?)'?$/,j8=/''/g,R8=/[a-zA-Z]/;function mg(e,t,r){var d,f,h,p;const n=gd(),s=n.locale??p8,a=n.firstWeekContainsDate??((f=(d=n.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??1,i=n.weekStartsOn??((p=(h=n.locale)==null?void 0:h.options)==null?void 0:p.weekStartsOn)??0,o=En(e);if(!I5(o))throw new RangeError("Invalid time value");let c=t.match(N8).map(v=>{const g=v[0];if(g==="p"||g==="P"){const x=_8[g];return x(v,s.formatLong)}return v}).join("").match(A8).map(v=>{if(v==="''")return{isToken:!1,value:"'"};const g=v[0];if(g==="'")return{isToken:!1,value:O8(v)};if(ug[g])return{isToken:!0,value:v};if(g.match(R8))throw new RangeError("Format string contains an unescaped latin alphabet character `"+g+"`");return{isToken:!1,value:v}});s.localize.preprocessor&&(c=s.localize.preprocessor(o,c));const u={firstWeekContainsDate:a,weekStartsOn:i,locale:s};return c.map(v=>{if(!v.isToken)return v.value;const g=v.value;(C8(g)||T8(g))&&k8(g,t,String(e));const x=ug[g[0]];return x(o,g,s.localize,u)}).join("")}function O8(e){const t=e.match(D8);return t?t[1].replace(j8,"'"):e}const I8=()=>{const[e,t]=m.useState(null),[r,n]=m.useState(!0);return m.useEffect(()=>{console.log("🚀 TimestampDisplay component mounted"),(async()=>{console.log("📡 About to fetch timestamps...");try{const a=[`https://raw.githubusercontent.com/datamilo/put-options-se/main/data/last_updated.json?${Date.now()}`,`${window.location.origin}/put-options-sedata/last_updated.json?${Date.now()}`];let i=null,o=null;for(const c of a)try{if(console.log("🔗 Trying timestamp URL:",c),o=await fetch(c),o.ok){console.log("✅ Successfully loaded timestamps from:",c);break}}catch(u){console.warn("❌ Failed to load from:",c,u),i=u}if(!o||!o.ok)throw i||new Error("Failed to load timestamps from any URL");if(console.log("📨 Got response:",o.status),o.ok){const c=await o.json();console.log("✅ Got data:",c),t(c)}else console.error("❌ Bad response:",o.status)}catch(a){console.error("❌ Fetch error:",a)}finally{n(!1)}})()},[]),console.log("🔍 Render - timestamps:",e,"loading:",r),r?l.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading timestamp information..."}):e?l.jsxs("div",{className:"bg-muted/50 border border-border rounded-lg p-3 max-w-xs",children:[l.jsx("h3",{className:"text-xs font-medium text-muted-foreground mb-2",children:"Last Updated"}),l.jsxs("div",{className:"space-y-1 text-xs text-muted-foreground",children:[l.jsxs("p",{children:["Options: ",mg(new Date(e.optionsData.lastUpdated),"yyyy-MM-dd HH:mm")]}),l.jsxs("p",{children:["Stocks: ",mg(new Date(e.stockData.lastUpdated),"yyyy-MM-dd HH:mm")]})]})]}):l.jsx("div",{className:"text-sm text-destructive",children:"Failed to load timestamps"})},M8={selectedStocks:[],selectedExpiryDates:[],selectedRiskLevels:[],strikePriceFilter:"all"},cf="mainPageFilterSettings",F8=()=>{const{user:e}=ea(),[t,r]=m.useState(M8),[n,s]=m.useState(!0);return m.useEffect(()=>{(()=>{try{const o=localStorage.getItem(cf);if(o){const c=JSON.parse(o);r(c)}}catch(o){console.error("Error loading main page settings from localStorage:",o)}})()},[]),m.useEffect(()=>{if(!e){s(!1);return}(async()=>{try{s(!0);const{data:o,error:c}=await mr.from("user_preferences").select("preference_data").eq("user_id",e.id).eq("preference_type","main_page_filters").maybeSingle();if(c){console.error("Error loading main page settings from Supabase:",c);return}if(o!=null&&o.preference_data){const u=o.preference_data;console.log("🔄 useMainPagePreferences - Loaded from Supabase:",u),r(u),localStorage.setItem(cf,JSON.stringify(u))}else console.log("🔄 useMainPagePreferences - No saved preferences found in Supabase")}catch(o){console.error("Error loading main page settings:",o)}finally{s(!1)}})()},[e]),{settings:t,isLoading:n,saveSettings:async i=>{console.log("💾 useMainPagePreferences - Saving settings:",i),r(i);try{localStorage.setItem(cf,JSON.stringify(i))}catch(o){console.error("Error saving to localStorage:",o)}if(e)try{const{error:o}=await mr.from("user_preferences").upsert({user_id:e.id,preference_type:"main_page_filters",preference_data:i},{onConflict:"user_id,preference_type"});o?console.error("Error saving main page settings to Supabase:",o):console.log("✅ useMainPagePreferences - Successfully saved to Supabase")}catch(o){console.error("Error saving main page settings:",o)}}}};var rh=["Enter"," "],L8=["ArrowDown","PageUp","Home"],c_=["ArrowUp","PageDown","End"],B8=[...L8,...c_],$8={ltr:[...rh,"ArrowRight"],rtl:[...rh,"ArrowLeft"]},W8={ltr:["ArrowLeft"],rtl:["ArrowRight"]},$l="Menu",[cl,U8,V8]=pl($l),[Ga,u_]=bn($l,[V8,Qs,hd]),xd=Qs(),d_=hd(),[H8,Ka]=Ga($l),[z8,Wl]=Ga($l),f_=e=>{const{__scopeMenu:t,open:r=!1,children:n,dir:s,onOpenChange:a,modal:i=!0}=e,o=xd(t),[c,u]=m.useState(null),d=m.useRef(!1),f=Et(a),h=Xi(s);return m.useEffect(()=>{const p=()=>{d.current=!0,document.addEventListener("pointerdown",v,{capture:!0,once:!0}),document.addEventListener("pointermove",v,{capture:!0,once:!0})},v=()=>d.current=!1;return document.addEventListener("keydown",p,{capture:!0}),()=>{document.removeEventListener("keydown",p,{capture:!0}),document.removeEventListener("pointerdown",v,{capture:!0}),document.removeEventListener("pointermove",v,{capture:!0})}},[]),l.jsx(Cu,{...o,children:l.jsx(H8,{scope:t,open:r,onOpenChange:f,content:c,onContentChange:u,children:l.jsx(z8,{scope:t,onClose:m.useCallback(()=>f(!1),[f]),isUsingKeyboardRef:d,dir:h,modal:i,children:n})})})};f_.displayName=$l;var G8="MenuAnchor",I0=m.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,s=xd(r);return l.jsx(yl,{...s,...n,ref:t})});I0.displayName=G8;var M0="MenuPortal",[K8,h_]=Ga(M0,{forceMount:void 0}),m_=e=>{const{__scopeMenu:t,forceMount:r,children:n,container:s}=e,a=Ka(M0,t);return l.jsx(K8,{scope:t,forceMount:r,children:l.jsx(Kt,{present:r||a.open,children:l.jsx(Wi,{asChild:!0,container:s,children:n})})})};m_.displayName=M0;var rn="MenuContent",[Y8,F0]=Ga(rn),p_=m.forwardRef((e,t)=>{const r=h_(rn,e.__scopeMenu),{forceMount:n=r.forceMount,...s}=e,a=Ka(rn,e.__scopeMenu),i=Wl(rn,e.__scopeMenu);return l.jsx(cl.Provider,{scope:e.__scopeMenu,children:l.jsx(Kt,{present:n||a.open,children:l.jsx(cl.Slot,{scope:e.__scopeMenu,children:i.modal?l.jsx(X8,{...s,ref:t}):l.jsx(q8,{...s,ref:t})})})})}),X8=m.forwardRef((e,t)=>{const r=Ka(rn,e.__scopeMenu),n=m.useRef(null),s=Me(t,n);return m.useEffect(()=>{const a=n.current;if(a)return Pl(a)},[]),l.jsx(L0,{...e,ref:s,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:he(e.onFocusOutside,a=>a.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),q8=m.forwardRef((e,t)=>{const r=Ka(rn,e.__scopeMenu);return l.jsx(L0,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),L0=m.forwardRef((e,t)=>{const{__scopeMenu:r,loop:n=!1,trapFocus:s,onOpenAutoFocus:a,onCloseAutoFocus:i,disableOutsidePointerEvents:o,onEntryFocus:c,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:f,onInteractOutside:h,onDismiss:p,disableOutsideScroll:v,...g}=e,x=Ka(rn,r),y=Wl(rn,r),w=xd(r),_=d_(r),b=U8(r),[T,k]=m.useState(null),S=m.useRef(null),E=Me(t,S,x.onContentChange),C=m.useRef(0),L=m.useRef(""),M=m.useRef(0),j=m.useRef(null),V=m.useRef("right"),A=m.useRef(0),H=v?kl:m.Fragment,G=v?{as:ls,allowPinchZoom:!0}:void 0,q=Q=>{var I,ee;const fe=L.current+Q,oe=b().filter(z=>!z.disabled),X=document.activeElement,le=(I=oe.find(z=>z.ref.current===X))==null?void 0:I.textValue,D=oe.map(z=>z.textValue),K=l6(D,fe,le),U=(ee=oe.find(z=>z.textValue===K))==null?void 0:ee.ref.current;(function z(R){L.current=R,window.clearTimeout(C.current),R!==""&&(C.current=window.setTimeout(()=>z(""),1e3))})(fe),U&&setTimeout(()=>U.focus())};m.useEffect(()=>()=>window.clearTimeout(C.current),[]),Ku();const Y=m.useCallback(Q=>{var oe,X;return V.current===((oe=j.current)==null?void 0:oe.side)&&u6(Q,(X=j.current)==null?void 0:X.area)},[]);return l.jsx(Y8,{scope:r,searchRef:L,onItemEnter:m.useCallback(Q=>{Y(Q)&&Q.preventDefault()},[Y]),onItemLeave:m.useCallback(Q=>{var fe;Y(Q)||((fe=S.current)==null||fe.focus(),k(null))},[Y]),onTriggerLeave:m.useCallback(Q=>{Y(Q)&&Q.preventDefault()},[Y]),pointerGraceTimerRef:M,onPointerGraceIntentChange:m.useCallback(Q=>{j.current=Q},[]),children:l.jsx(H,{...G,children:l.jsx(Cl,{asChild:!0,trapped:s,onMountAutoFocus:he(a,Q=>{var fe;Q.preventDefault(),(fe=S.current)==null||fe.focus({preventScroll:!0})}),onUnmountAutoFocus:i,children:l.jsx($a,{asChild:!0,disableOutsidePointerEvents:o,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:f,onInteractOutside:h,onDismiss:p,children:l.jsx(Uw,{asChild:!0,..._,dir:y.dir,orientation:"vertical",loop:n,currentTabStopId:T,onCurrentTabStopIdChange:k,onEntryFocus:he(c,Q=>{y.isUsingKeyboardRef.current||Q.preventDefault()}),preventScrollOnEntryFocus:!0,children:l.jsx(ku,{role:"menu","aria-orientation":"vertical","data-state":D_(x.open),"data-radix-menu-content":"",dir:y.dir,...w,...g,ref:E,style:{outline:"none",...g.style},onKeyDown:he(g.onKeyDown,Q=>{const oe=Q.target.closest("[data-radix-menu-content]")===Q.currentTarget,X=Q.ctrlKey||Q.altKey||Q.metaKey,le=Q.key.length===1;oe&&(Q.key==="Tab"&&Q.preventDefault(),!X&&le&&q(Q.key));const D=S.current;if(Q.target!==D||!B8.includes(Q.key))return;Q.preventDefault();const U=b().filter(I=>!I.disabled).map(I=>I.ref.current);c_.includes(Q.key)&&U.reverse(),i6(U)}),onBlur:he(e.onBlur,Q=>{Q.currentTarget.contains(Q.target)||(window.clearTimeout(C.current),L.current="")}),onPointerMove:he(e.onPointerMove,ul(Q=>{const fe=Q.target,oe=A.current!==Q.clientX;if(Q.currentTarget.contains(fe)&&oe){const X=Q.clientX>A.current?"right":"left";V.current=X,A.current=Q.clientX}}))})})})})})})});p_.displayName=rn;var J8="MenuGroup",B0=m.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return l.jsx(Ne.div,{role:"group",...n,ref:t})});B0.displayName=J8;var Q8="MenuLabel",g_=m.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return l.jsx(Ne.div,{...n,ref:t})});g_.displayName=Q8;var pu="MenuItem",pg="menu.itemSelect",vd=m.forwardRef((e,t)=>{const{disabled:r=!1,onSelect:n,...s}=e,a=m.useRef(null),i=Wl(pu,e.__scopeMenu),o=F0(pu,e.__scopeMenu),c=Me(t,a),u=m.useRef(!1),d=()=>{const f=a.current;if(!r&&f){const h=new CustomEvent(pg,{bubbles:!0,cancelable:!0});f.addEventListener(pg,p=>n==null?void 0:n(p),{once:!0}),bh(f,h),h.defaultPrevented?u.current=!1:i.onClose()}};return l.jsx(x_,{...s,ref:c,disabled:r,onClick:he(e.onClick,d),onPointerDown:f=>{var h;(h=e.onPointerDown)==null||h.call(e,f),u.current=!0},onPointerUp:he(e.onPointerUp,f=>{var h;u.current||(h=f.currentTarget)==null||h.click()}),onKeyDown:he(e.onKeyDown,f=>{const h=o.searchRef.current!=="";r||h&&f.key===" "||rh.includes(f.key)&&(f.currentTarget.click(),f.preventDefault())})})});vd.displayName=pu;var x_=m.forwardRef((e,t)=>{const{__scopeMenu:r,disabled:n=!1,textValue:s,...a}=e,i=F0(pu,r),o=d_(r),c=m.useRef(null),u=Me(t,c),[d,f]=m.useState(!1),[h,p]=m.useState("");return m.useEffect(()=>{const v=c.current;v&&p((v.textContent??"").trim())},[a.children]),l.jsx(cl.ItemSlot,{scope:r,disabled:n,textValue:s??h,children:l.jsx(Vw,{asChild:!0,...o,focusable:!n,children:l.jsx(Ne.div,{role:"menuitem","data-highlighted":d?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0,...a,ref:u,onPointerMove:he(e.onPointerMove,ul(v=>{n?i.onItemLeave(v):(i.onItemEnter(v),v.defaultPrevented||v.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:he(e.onPointerLeave,ul(v=>i.onItemLeave(v))),onFocus:he(e.onFocus,()=>f(!0)),onBlur:he(e.onBlur,()=>f(!1))})})})}),Z8="MenuCheckboxItem",v_=m.forwardRef((e,t)=>{const{checked:r=!1,onCheckedChange:n,...s}=e;return l.jsx(S_,{scope:e.__scopeMenu,checked:r,children:l.jsx(vd,{role:"menuitemcheckbox","aria-checked":gu(r)?"mixed":r,...s,ref:t,"data-state":W0(r),onSelect:he(s.onSelect,()=>n==null?void 0:n(gu(r)?!0:!r),{checkForDefaultPrevented:!1})})})});v_.displayName=Z8;var y_="MenuRadioGroup",[e6,t6]=Ga(y_,{value:void 0,onValueChange:()=>{}}),w_=m.forwardRef((e,t)=>{const{value:r,onValueChange:n,...s}=e,a=Et(n);return l.jsx(e6,{scope:e.__scopeMenu,value:r,onValueChange:a,children:l.jsx(B0,{...s,ref:t})})});w_.displayName=y_;var __="MenuRadioItem",b_=m.forwardRef((e,t)=>{const{value:r,...n}=e,s=t6(__,e.__scopeMenu),a=r===s.value;return l.jsx(S_,{scope:e.__scopeMenu,checked:a,children:l.jsx(vd,{role:"menuitemradio","aria-checked":a,...n,ref:t,"data-state":W0(a),onSelect:he(n.onSelect,()=>{var i;return(i=s.onValueChange)==null?void 0:i.call(s,r)},{checkForDefaultPrevented:!1})})})});b_.displayName=__;var $0="MenuItemIndicator",[S_,r6]=Ga($0,{checked:!1}),E_=m.forwardRef((e,t)=>{const{__scopeMenu:r,forceMount:n,...s}=e,a=r6($0,r);return l.jsx(Kt,{present:n||gu(a.checked)||a.checked===!0,children:l.jsx(Ne.span,{...s,ref:t,"data-state":W0(a.checked)})})});E_.displayName=$0;var n6="MenuSeparator",T_=m.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return l.jsx(Ne.div,{role:"separator","aria-orientation":"horizontal",...n,ref:t})});T_.displayName=n6;var s6="MenuArrow",C_=m.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,s=xd(r);return l.jsx(Pu,{...s,...n,ref:t})});C_.displayName=s6;var a6="MenuSub",[DW,k_]=Ga(a6),So="MenuSubTrigger",P_=m.forwardRef((e,t)=>{const r=Ka(So,e.__scopeMenu),n=Wl(So,e.__scopeMenu),s=k_(So,e.__scopeMenu),a=F0(So,e.__scopeMenu),i=m.useRef(null),{pointerGraceTimerRef:o,onPointerGraceIntentChange:c}=a,u={__scopeMenu:e.__scopeMenu},d=m.useCallback(()=>{i.current&&window.clearTimeout(i.current),i.current=null},[]);return m.useEffect(()=>d,[d]),m.useEffect(()=>{const f=o.current;return()=>{window.clearTimeout(f),c(null)}},[o,c]),l.jsx(I0,{asChild:!0,...u,children:l.jsx(x_,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":s.contentId,"data-state":D_(r.open),...e,ref:yu(t,s.onTriggerChange),onClick:f=>{var h;(h=e.onClick)==null||h.call(e,f),!(e.disabled||f.defaultPrevented)&&(f.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:he(e.onPointerMove,ul(f=>{a.onItemEnter(f),!f.defaultPrevented&&!e.disabled&&!r.open&&!i.current&&(a.onPointerGraceIntentChange(null),i.current=window.setTimeout(()=>{r.onOpenChange(!0),d()},100))})),onPointerLeave:he(e.onPointerLeave,ul(f=>{var p,v;d();const h=(p=r.content)==null?void 0:p.getBoundingClientRect();if(h){const g=(v=r.content)==null?void 0:v.dataset.side,x=g==="right",y=x?-5:5,w=h[x?"left":"right"],_=h[x?"right":"left"];a.onPointerGraceIntentChange({area:[{x:f.clientX+y,y:f.clientY},{x:w,y:h.top},{x:_,y:h.top},{x:_,y:h.bottom},{x:w,y:h.bottom}],side:g}),window.clearTimeout(o.current),o.current=window.setTimeout(()=>a.onPointerGraceIntentChange(null),300)}else{if(a.onTriggerLeave(f),f.defaultPrevented)return;a.onPointerGraceIntentChange(null)}})),onKeyDown:he(e.onKeyDown,f=>{var p;const h=a.searchRef.current!=="";e.disabled||h&&f.key===" "||$8[n.dir].includes(f.key)&&(r.onOpenChange(!0),(p=r.content)==null||p.focus(),f.preventDefault())})})})});P_.displayName=So;var A_="MenuSubContent",N_=m.forwardRef((e,t)=>{const r=h_(rn,e.__scopeMenu),{forceMount:n=r.forceMount,...s}=e,a=Ka(rn,e.__scopeMenu),i=Wl(rn,e.__scopeMenu),o=k_(A_,e.__scopeMenu),c=m.useRef(null),u=Me(t,c);return l.jsx(cl.Provider,{scope:e.__scopeMenu,children:l.jsx(Kt,{present:n||a.open,children:l.jsx(cl.Slot,{scope:e.__scopeMenu,children:l.jsx(L0,{id:o.contentId,"aria-labelledby":o.triggerId,...s,ref:u,align:"start",side:i.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:d=>{var f;i.isUsingKeyboardRef.current&&((f=c.current)==null||f.focus()),d.preventDefault()},onCloseAutoFocus:d=>d.preventDefault(),onFocusOutside:he(e.onFocusOutside,d=>{d.target!==o.trigger&&a.onOpenChange(!1)}),onEscapeKeyDown:he(e.onEscapeKeyDown,d=>{i.onClose(),d.preventDefault()}),onKeyDown:he(e.onKeyDown,d=>{var p;const f=d.currentTarget.contains(d.target),h=W8[i.dir].includes(d.key);f&&h&&(a.onOpenChange(!1),(p=o.trigger)==null||p.focus(),d.preventDefault())})})})})})});N_.displayName=A_;function D_(e){return e?"open":"closed"}function gu(e){return e==="indeterminate"}function W0(e){return gu(e)?"indeterminate":e?"checked":"unchecked"}function i6(e){const t=document.activeElement;for(const r of e)if(r===t||(r.focus(),document.activeElement!==t))return}function o6(e,t){return e.map((r,n)=>e[(t+n)%e.length])}function l6(e,t,r){const s=t.length>1&&Array.from(t).every(u=>u===t[0])?t[0]:t,a=r?e.indexOf(r):-1;let i=o6(e,Math.max(a,0));s.length===1&&(i=i.filter(u=>u!==r));const c=i.find(u=>u.toLowerCase().startsWith(s.toLowerCase()));return c!==r?c:void 0}function c6(e,t){const{x:r,y:n}=e;let s=!1;for(let a=0,i=t.length-1;a<t.length;i=a++){const o=t[a].x,c=t[a].y,u=t[i].x,d=t[i].y;c>n!=d>n&&r<(u-o)*(n-c)/(d-c)+o&&(s=!s)}return s}function u6(e,t){if(!t)return!1;const r={x:e.clientX,y:e.clientY};return c6(r,t)}function ul(e){return t=>t.pointerType==="mouse"?e(t):void 0}var d6=f_,f6=I0,h6=m_,m6=p_,p6=B0,g6=g_,x6=vd,v6=v_,y6=w_,w6=b_,_6=E_,b6=T_,S6=C_,E6=P_,T6=N_,U0="DropdownMenu",[C6,jW]=bn(U0,[u_]),wr=u_(),[k6,j_]=C6(U0),R_=e=>{const{__scopeDropdownMenu:t,children:r,dir:n,open:s,defaultOpen:a,onOpenChange:i,modal:o=!0}=e,c=wr(t),u=m.useRef(null),[d=!1,f]=vn({prop:s,defaultProp:a,onChange:i});return l.jsx(k6,{scope:t,triggerId:tn(),triggerRef:u,contentId:tn(),open:d,onOpenChange:f,onOpenToggle:m.useCallback(()=>f(h=>!h),[f]),modal:o,children:l.jsx(d6,{...c,open:d,onOpenChange:f,dir:n,modal:o,children:r})})};R_.displayName=U0;var O_="DropdownMenuTrigger",I_=m.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,disabled:n=!1,...s}=e,a=j_(O_,r),i=wr(r);return l.jsx(f6,{asChild:!0,...i,children:l.jsx(Ne.button,{type:"button",id:a.triggerId,"aria-haspopup":"menu","aria-expanded":a.open,"aria-controls":a.open?a.contentId:void 0,"data-state":a.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...s,ref:yu(t,a.triggerRef),onPointerDown:he(e.onPointerDown,o=>{!n&&o.button===0&&o.ctrlKey===!1&&(a.onOpenToggle(),a.open||o.preventDefault())}),onKeyDown:he(e.onKeyDown,o=>{n||(["Enter"," "].includes(o.key)&&a.onOpenToggle(),o.key==="ArrowDown"&&a.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(o.key)&&o.preventDefault())})})})});I_.displayName=O_;var P6="DropdownMenuPortal",M_=e=>{const{__scopeDropdownMenu:t,...r}=e,n=wr(t);return l.jsx(h6,{...n,...r})};M_.displayName=P6;var F_="DropdownMenuContent",L_=m.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=j_(F_,r),a=wr(r),i=m.useRef(!1);return l.jsx(m6,{id:s.contentId,"aria-labelledby":s.triggerId,...a,...n,ref:t,onCloseAutoFocus:he(e.onCloseAutoFocus,o=>{var c;i.current||(c=s.triggerRef.current)==null||c.focus(),i.current=!1,o.preventDefault()}),onInteractOutside:he(e.onInteractOutside,o=>{const c=o.detail.originalEvent,u=c.button===0&&c.ctrlKey===!0,d=c.button===2||u;(!s.modal||d)&&(i.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});L_.displayName=F_;var A6="DropdownMenuGroup",N6=m.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=wr(r);return l.jsx(p6,{...s,...n,ref:t})});N6.displayName=A6;var D6="DropdownMenuLabel",B_=m.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=wr(r);return l.jsx(g6,{...s,...n,ref:t})});B_.displayName=D6;var j6="DropdownMenuItem",$_=m.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=wr(r);return l.jsx(x6,{...s,...n,ref:t})});$_.displayName=j6;var R6="DropdownMenuCheckboxItem",W_=m.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=wr(r);return l.jsx(v6,{...s,...n,ref:t})});W_.displayName=R6;var O6="DropdownMenuRadioGroup",I6=m.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=wr(r);return l.jsx(y6,{...s,...n,ref:t})});I6.displayName=O6;var M6="DropdownMenuRadioItem",U_=m.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=wr(r);return l.jsx(w6,{...s,...n,ref:t})});U_.displayName=M6;var F6="DropdownMenuItemIndicator",V_=m.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=wr(r);return l.jsx(_6,{...s,...n,ref:t})});V_.displayName=F6;var L6="DropdownMenuSeparator",H_=m.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=wr(r);return l.jsx(b6,{...s,...n,ref:t})});H_.displayName=L6;var B6="DropdownMenuArrow",$6=m.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=wr(r);return l.jsx(S6,{...s,...n,ref:t})});$6.displayName=B6;var W6="DropdownMenuSubTrigger",z_=m.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=wr(r);return l.jsx(E6,{...s,...n,ref:t})});z_.displayName=W6;var U6="DropdownMenuSubContent",G_=m.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=wr(r);return l.jsx(T6,{...s,...n,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});G_.displayName=U6;var V6=R_,H6=I_,z6=M_,K_=L_,Y_=B_,X_=$_,q_=W_,J_=U_,Q_=V_,Z_=H_,eb=z_,tb=G_;const On=V6,In=H6,G6=m.forwardRef(({className:e,inset:t,children:r,...n},s)=>l.jsxs(eb,{ref:s,className:Pe("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",t&&"pl-8",e),...n,children:[r,l.jsx(Q2,{className:"ml-auto h-4 w-4"})]}));G6.displayName=eb.displayName;const K6=m.forwardRef(({className:e,...t},r)=>l.jsx(tb,{ref:r,className:Pe("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));K6.displayName=tb.displayName;const pn=m.forwardRef(({className:e,sideOffset:t=4,...r},n)=>l.jsx(z6,{children:l.jsx(K_,{ref:n,sideOffset:t,className:Pe("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})}));pn.displayName=K_.displayName;const Jt=m.forwardRef(({className:e,inset:t,...r},n)=>l.jsx(X_,{ref:n,className:Pe("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",e),...r}));Jt.displayName=X_.displayName;const Y6=m.forwardRef(({className:e,children:t,checked:r,...n},s)=>l.jsxs(q_,{ref:s,className:Pe("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:r,...n,children:[l.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:l.jsx(Q_,{children:l.jsx(pr,{className:"h-4 w-4"})})}),t]}));Y6.displayName=q_.displayName;const X6=m.forwardRef(({className:e,children:t,...r},n)=>l.jsxs(J_,{ref:n,className:Pe("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[l.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:l.jsx(Q_,{children:l.jsx(eE,{className:"h-2 w-2 fill-current"})})}),t]}));X6.displayName=J_.displayName;const q6=m.forwardRef(({className:e,inset:t,...r},n)=>l.jsx(Y_,{ref:n,className:Pe("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...r}));q6.displayName=Y_.displayName;const rb=m.forwardRef(({className:e,...t},r)=>l.jsx(Z_,{ref:r,className:Pe("-mx-1 my-1 h-px bg-muted",e),...t}));rb.displayName=Z_.displayName;const J6=()=>{var ee;console.log("🏠 Index component rendering");const e=ms(),[t,r]=wh(),{data:n,isLoading:s,error:a,loadMockData:i}=O0(),{getStockSummary:o,getLowPriceForPeriod:c}=pd(),{settings:u,isLoading:d,saveSettings:f}=F8(),[h,p]=m.useState([]),[v,g]=m.useState([]),x=m.useRef(!1),[y,w]=m.useState(()=>{const z=t.get("strikeBelowPeriod");return z?parseInt(z,10):null}),[_,b]=m.useState(()=>{const z=t.get("riskLevels");if(!z)return[];try{const R=decodeURIComponent(z),J=JSON.parse(R);return Array.isArray(J)?J:[]}catch{return z.split(",").filter(Boolean)}}),[T,k]=m.useState(()=>t.get("sortField")||null),[S,E]=m.useState(()=>t.get("sortDirection")==="desc"?"desc":"asc"),C=[{label:"1 Week Low",days:7},{label:"1 Month Low",days:30},{label:"3 Months Low",days:90},{label:"6 Months Low",days:180},{label:"9 Months Low",days:270},{label:"1 Year Low",days:365}],L=[{value:"High Risk",label:"High Risk"},{value:"Medium Risk",label:"Medium Risk"},{value:"Low Risk",label:"Low Risk"}],M=z=>{const R=z.ProbWorthless_Bayesian_IsoCal??z["1_2_3_ProbOfWorthless_Weighted"];return R<=.6?"High Risk":R<.8?"Medium Risk":"Low Risk"},j=()=>l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"hidden md:block",children:l.jsx(zi,{children:l.jsxs(zo,{children:[l.jsx(Go,{asChild:!0,children:l.jsx(Mn,{className:"h-3 w-3 text-muted-foreground cursor-help"})}),l.jsx(Ii,{className:"max-w-sm bg-background border z-50",children:l.jsxs("div",{className:"space-y-2 text-sm",children:[l.jsx("p",{className:"font-medium",children:"Risk Level Classification:"}),l.jsxs("div",{className:"space-y-1",children:[l.jsxs("p",{children:[l.jsx("strong",{children:"High Risk:"})," ≤60% probability of being worthless"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Medium Risk:"})," ",">","60% and ","<","80% probability of being worthless"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Low Risk:"})," ≥80% probability of being worthless"]})]}),l.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Based on ProbWorthless_Bayesian_IsoCal field, or 1_2_3_ProbOfWorthless_Weighted as fallback. No overlapping values between categories."})]})})]})})}),l.jsx("div",{className:"md:hidden",children:l.jsxs(Al,{children:[l.jsx(Nl,{asChild:!0,children:l.jsx(Mn,{className:"h-3 w-3 text-muted-foreground cursor-pointer"})}),l.jsx(qi,{className:"max-w-sm",children:l.jsxs("div",{className:"space-y-3",children:[l.jsx("h3",{className:"font-medium",children:"Risk Level Classification"}),l.jsxs("div",{className:"space-y-2 text-sm",children:[l.jsxs("p",{children:[l.jsx("strong",{children:"High Risk:"})," ≤60% probability of being worthless"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Medium Risk:"})," ",">","60% and ","<","80% probability of being worthless"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Low Risk:"})," ≥80% probability of being worthless"]})]}),l.jsx("p",{className:"text-xs text-muted-foreground",children:"Based on ProbWorthless_Bayesian_IsoCal field, or 1_2_3_ProbOfWorthless_Weighted as fallback. No overlapping values between categories."})]})})]})})]});m.useEffect(()=>{if(x.current||!n.length)return;if(t.has("stocks")||t.has("expiryDates")||t.has("riskLevels")){const R=t.get("stocks"),J=t.get("expiryDates"),Z=t.get("riskLevels");if(R)try{const ge=JSON.parse(decodeURIComponent(R));Array.isArray(ge)&&p(ge)}catch{p(R.split(",").filter(Boolean))}if(J)try{const ge=JSON.parse(decodeURIComponent(J));Array.isArray(ge)&&g(ge)}catch{g(J.split(",").filter(Boolean))}if(Z)try{const ge=JSON.parse(decodeURIComponent(Z));Array.isArray(ge)&&b(ge)}catch{b(Z.split(",").filter(Boolean))}x.current=!0}},[n.length,t]),m.useEffect(()=>{if(x.current||n.length===0||d)return;console.log("📥 Loading preferences from Supabase:",u);const z=[...new Set(n.map(ye=>ye.StockName))],R=[...new Set(n.map(ye=>ye.ExpiryDate))],J=u.selectedStocks.filter(ye=>z.includes(ye)),Z=u.selectedExpiryDates.filter(ye=>R.includes(ye));console.log("✅ Valid saved stocks:",J),console.log("✅ Valid saved dates:",Z);let ge=Z;if(ge.length===0){const ye=V(R);ye&&(ge=[ye]),console.log("🎯 Using default expiry date:",ge)}p(J),g(ge),b(u.selectedRiskLevels),console.log("📝 Applied filters - stocks:",J,"dates:",ge,"risk:",u.selectedRiskLevels)},[n,d,u]);const V=z=>{const R=new Date,J=new Date(R.getFullYear(),R.getMonth()+1,1),Z=new Date(J),ye=(5-Z.getDay()+7)%7;Z.setDate(Z.getDate()+ye);const Ce=new Date(Z);Ce.setDate(Ce.getDate()+14);let Ie=z[0],st=1/0;return z.forEach(Se=>{const Le=new Date(Se),de=Math.abs(Le.getTime()-Ce.getTime());de<st&&(st=de,Ie=Se)}),Ie},A=()=>{const z=[...new Set(n.map(J=>J.ExpiryDate))],R=V(z);p([]),g(R?[R]:[]),b([]),w(null),Ir.success("Filters reset to default")};m.useEffect(()=>{if(!d&&n.length>0&&!x.current){const z=setTimeout(()=>{console.log("💾 Saving preferences to Supabase:",{selectedStocks:h,selectedExpiryDates:v,selectedRiskLevels:_}),f({selectedStocks:h,selectedExpiryDates:v,selectedRiskLevels:_,strikePriceFilter:"all"})},500);return()=>clearTimeout(z)}},[h,v,_,d,n.length,f]);const[H,G]=m.useState(""),[q,Y]=m.useState(""),[Q,fe]=m.useState([]),oe=m.useMemo(()=>{if(y===null)return new Map;const z=new Map;return[...new Set(n.map(J=>J.StockName))].forEach(J=>{z.set(J,c(J,y))}),z},[n,y,c]),X=m.useMemo(()=>n.filter(z=>{const R=h.length===0||h.includes(z.StockName),J=v.length===0||v.includes(z.ExpiryDate);if(y!==null){const ge=oe.get(z.StockName);if(ge==null||z.StrikePrice>ge)return!1}const Z=_.length===0||_.includes(M(z));return R&&J&&Z}),[n,h,v,y,_,oe,M]),le=m.useMemo(()=>{let z=n;return v.length>0&&(z=z.filter(J=>v.includes(J.ExpiryDate))),y!==null&&(z=z.filter(J=>{const Z=oe.get(J.StockName);return Z!=null&&J.StrikePrice<=Z})),[...new Set(z.map(J=>J.StockName))].filter(J=>J.toLowerCase().includes(H.toLowerCase())).sort()},[n,v,y,oe,H]),D=m.useMemo(()=>{let z=n;return h.length>0&&(z=z.filter(J=>h.includes(J.StockName))),y!==null&&(z=z.filter(J=>{const Z=oe.get(J.StockName);return Z!=null&&J.StrikePrice<=Z})),[...new Set(z.map(J=>J.ExpiryDate))].filter(J=>J.toLowerCase().includes(q.toLowerCase())).sort()},[n,h,y,oe,q]),K=()=>{i(),Ir.success("Mock data loaded")},U=z=>{const R=encodeURIComponent(z.OptionName);e(`/option/${R}?${t.toString()}`)},I=z=>{e(`/stock/${encodeURIComponent(z)}?${t.toString()}`)};return l.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[l.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-r from-background via-muted/50 to-background border border-border rounded-lg",children:[l.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/5 via-transparent to-secondary/5"}),l.jsxs("div",{className:"relative px-8 py-12 text-center",children:[l.jsx("h1",{className:"text-5xl font-bold bg-gradient-to-r from-foreground to-foreground/70 bg-clip-text text-transparent mb-3",children:"Swedish Put Options"}),l.jsx("p",{className:"text-xl text-muted-foreground mb-6 max-w-2xl mx-auto",children:"Analysis and insights for Swedish equity put options"})]}),l.jsx("div",{className:"absolute top-4 right-4 opacity-20",children:l.jsx(Ea,{className:"h-24 w-24 text-primary"})})]}),l.jsx("div",{className:"flex justify-end",children:l.jsx(I8,{})}),n.length===0?l.jsxs(Ke,{className:"max-w-2xl mx-auto",children:[l.jsx(qe,{children:l.jsxs(Je,{className:"flex items-center gap-2",children:[l.jsx(tE,{className:"h-5 w-5"}),"Loading Options Data"]})}),l.jsxs(Ye,{className:"space-y-4",children:[a&&l.jsxs("div",{className:"text-sm text-destructive bg-destructive/10 p-3 rounded",children:[a,l.jsx("div",{className:"mt-2 space-y-2",children:l.jsx("div",{className:"text-center",children:l.jsx(Ee,{onClick:K,variant:"outline",disabled:s,children:"Load Sample Data Instead"})})})]}),s&&l.jsx("div",{className:"text-center text-sm text-muted-foreground",children:"Loading..."}),!s&&!a&&l.jsx("div",{className:"text-center text-sm text-muted-foreground",children:"Loading..."})]})]}):l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[l.jsxs("div",{className:"space-y-1",children:[l.jsxs("h2",{className:"text-lg font-semibold",children:[X.length," Options Available"]}),l.jsxs("p",{className:"text-sm text-muted-foreground",children:["From ",le.length," different stocks"]})]}),l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start gap-4 flex-wrap",children:[l.jsxs(Ee,{onClick:A,variant:"ghost",size:"sm",className:"self-start text-xs text-muted-foreground hover:text-foreground",title:"Reset all filters to default (third Friday of next month)",children:[l.jsx(iE,{className:"h-3 w-3 mr-1"}),"Reset to Default"]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("div",{className:"flex items-center gap-1 min-h-5",children:l.jsx(ze,{children:"Strike Price Below"})}),l.jsxs(On,{children:[l.jsx(In,{asChild:!0,children:l.jsxs(Ee,{variant:"outline",className:"min-w-[200px] justify-between",children:[y===null?"Select Period":`✓ ${(ee=C.find(z=>z.days===y))==null?void 0:ee.label}`,l.jsx(Ur,{className:"h-4 w-4"})]})}),l.jsxs(pn,{className:"w-[200px] bg-background z-50",children:[l.jsx(Jt,{onClick:()=>w(null),children:"Clear Filter"}),C.map(z=>l.jsx(Jt,{onClick:()=>w(z.days),children:z.label},z.days))]})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center gap-1 min-h-5",children:[l.jsx(ze,{children:"Risk Level"}),l.jsx(j,{})]}),l.jsxs(On,{children:[l.jsx(In,{asChild:!0,children:l.jsxs(Ee,{variant:"outline",className:"min-w-[200px] justify-between",children:[_.length===0?"All Risk Levels":_.length===1?_[0]:`${_.length} levels selected`,l.jsx(Ur,{className:"h-4 w-4"})]})}),l.jsx(pn,{className:"w-[200px] p-3 bg-background z-50",children:l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center space-x-2 border-b pb-2",children:[l.jsx(Lr,{id:"select-all-risk",checked:_.length===L.length,onCheckedChange:z=>{b(z?L.map(R=>R.value):[])}}),l.jsx("label",{htmlFor:"select-all-risk",className:"text-sm cursor-pointer font-medium",children:"Select All"})]}),L.map(z=>l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Lr,{id:`risk-${z.value}`,checked:_.includes(z.value),onCheckedChange:R=>{b(R?J=>[...J,z.value]:J=>J.filter(Z=>Z!==z.value))}}),l.jsx("label",{htmlFor:`risk-${z.value}`,className:"text-sm cursor-pointer",children:z.label})]},z.value))]})})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("div",{className:"flex items-center gap-1 min-h-5",children:l.jsx(ze,{children:"Filter by Stock"})}),l.jsxs(On,{children:[l.jsx(In,{asChild:!0,children:l.jsxs(Ee,{variant:"outline",className:"min-w-[200px] justify-between",children:[h.length===0?"All Stocks":h.length===1?h[0]:`${h.length} stocks selected`,l.jsx(Ur,{className:"h-4 w-4"})]})}),l.jsx(pn,{className:"w-[200px] p-3 max-h-60 overflow-y-auto bg-background z-50",children:l.jsxs("div",{className:"space-y-2",children:[l.jsx(Rt,{placeholder:"Search stocks...",value:H,onChange:z=>G(z.target.value.slice(0,50)),className:"h-8",maxLength:50}),l.jsxs("div",{className:"flex items-center space-x-2 border-b pb-2",children:[l.jsx(Lr,{id:"select-all-stocks",checked:h.length===le.length&&le.length>0,onCheckedChange:z=>{p(z?le:[])}}),l.jsx("label",{htmlFor:"select-all-stocks",className:"text-sm cursor-pointer font-medium",children:"Select All"})]}),le.map(z=>l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Lr,{id:`stock-${z}`,checked:h.includes(z),onCheckedChange:R=>{p(R?J=>[...J,z]:J=>J.filter(Z=>Z!==z))}}),l.jsx("label",{htmlFor:`stock-${z}`,className:"text-sm cursor-pointer",children:z})]},z))]})})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("div",{className:"flex items-center gap-1 min-h-5",children:l.jsx(ze,{children:"Filter by Expiry Date"})}),l.jsxs(On,{children:[l.jsx(In,{asChild:!0,children:l.jsxs(Ee,{variant:"outline",className:"min-w-[200px] justify-between",children:[v.length===0?"All Expiry Dates":v.length===1?v[0]:`${v.length} dates selected`,l.jsx(Ur,{className:"h-4 w-4"})]})}),l.jsx(pn,{className:"w-[200px] p-3 max-h-60 overflow-y-auto bg-background z-50",children:l.jsxs("div",{className:"space-y-2",children:[l.jsx(Rt,{placeholder:"Search dates...",value:q,onChange:z=>Y(z.target.value.slice(0,50)),className:"h-8",maxLength:50}),l.jsxs("div",{className:"flex items-center space-x-2 border-b pb-2",children:[l.jsx(Lr,{id:"select-all-expiry",checked:v.length===D.length&&D.length>0,onCheckedChange:z=>{g(z?D:[])}}),l.jsx("label",{htmlFor:"select-all-expiry",className:"text-sm cursor-pointer font-medium",children:"Select All"})]}),D.map(z=>l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Lr,{id:`expiry-${z}`,checked:v.includes(z),onCheckedChange:R=>{g(R?J=>[...J,z]:J=>J.filter(Z=>Z!==z))}}),l.jsx("label",{htmlFor:`expiry-${z}`,className:"text-sm cursor-pointer",children:z})]},z))]})})]})]})]})]}),l.jsxs(md,{defaultValue:"table",className:"w-full",children:[l.jsxs(Bl,{className:"grid w-full grid-cols-2",children:[l.jsxs(Ln,{value:"table",className:"flex items-center gap-2",children:[l.jsx(cE,{className:"h-4 w-4"}),"Table View"]}),l.jsxs(Ln,{value:"charts",className:"flex items-center gap-2",children:[l.jsx(Ea,{className:"h-4 w-4"}),"Charts"]})]}),l.jsx(Bn,{value:"table",children:l.jsx(i5,{data:X,onRowClick:U,onStockClick:I,columnFilters:Q,onColumnFiltersChange:fe,sortField:T,sortDirection:S,onSortChange:(z,R)=>{k(z),E(R)},enableFiltering:!0})}),l.jsx(Bn,{value:"charts",children:l.jsx(C5,{data:X})})]})]})]})},nb=()=>{const{portfolioColumnPreferences:e,savePortfolioColumnPreferences:t,isLoading:r}=Uu();return{columnPreferences:e,isLoading:r,saveColumnPreferences:t}},Q6=({column:e,onVisibilityChange:t})=>{const{attributes:r,listeners:n,setNodeRef:s,transform:a,transition:i,isDragging:o}=iy({id:e.key}),c={transform:Li.Transform.toString(a),transition:i,opacity:o?.5:1},u=d=>d.replace(/([A-Z])/g," $1").replace(/^./,f=>f.toUpperCase()).replace(/_/g," ");return l.jsxs("div",{ref:s,style:c,className:"flex items-center space-x-3 p-3 bg-card rounded-lg border hover:bg-accent transition-colors",children:[l.jsx("div",{...r,...n,className:"cursor-grab active:cursor-grabbing p-1 hover:bg-muted rounded",children:l.jsx(xx,{className:"h-4 w-4 text-muted-foreground"})}),l.jsx(Lr,{checked:e.visible,onCheckedChange:d=>t(!!d),className:"data-[state=checked]:bg-primary data-[state=checked]:border-primary"}),l.jsx("span",{className:"flex-1 text-sm font-medium",children:u(e.key)}),l.jsx(Pa,{variant:e.visible?"default":"secondary",className:"text-xs",children:e.visible?"Visible":"Hidden"})]})},Z6=({visibleColumns:e,onVisibilityChange:t,onColumnOrderChange:r})=>{const[n,s]=m.useState(!1),{columnPreferences:a,saveColumnPreferences:i,isLoading:o}=nb(),[c,u]=m.useState([]),d=M1(Gc(ed),Gc(Zu,{coordinateGetter:oy})),f=["StockName","OptionName","ExpiryDate","DaysToExpiry","StrikePrice","Premium","NumberOfContractsBasedOnLimit","1_2_3_ProbOfWorthless_Weighted","PotentialLossAtLowerBound"],h=()=>["StockName","OptionName","ExpiryDate","FinancialReport","X-Day","Premium","PoW_Simulation_Mean_Earnings","100k_Invested_Loss_Mean","1_2_3_ProbOfWorthless_Weighted","ProbWorthless_Bayesian_IsoCal","1_ProbOfWorthless_Original","2_ProbOfWorthless_Calibrated","3_ProbOfWorthless_Historical_IV","Lower_Bound_at_Accuracy","LossAtBadDecline","LossAtWorstDecline","PoW_Stats_MedianLossPct","PoW_Stats_WorstLossPct","PoW_Stats_MedianLoss","PoW_Stats_WorstLoss","PoW_Stats_MedianProbOfWorthless","PoW_Stats_MinProbOfWorthless","PoW_Stats_MaxProbOfWorthless","LossAt100DayWorstDecline","LossAt_2008_100DayWorstDecline","Mean_Accuracy","Lower_Bound_HistMedianIV_at_Accuracy","Lower_Bound","Lower_Bound_HistMedianIV","Bid_Ask_Mid_Price","Option_Price_Min","NumberOfContractsBasedOnLimit","Bid","ProfitLossPctLeastBad","Loss_Least_Bad","IV_AllMedianIV_Maximum100DaysToExp_Ratio","StockPrice","DaysToExpiry","AskBidSpread","Underlying_Value","StrikePrice","StockPrice_After_2008_100DayWorstDecline","LossAt50DayWorstDecline","LossAt_2008_50DayWorstDecline","ProfitLossPctBad","ProfitLossPctWorst","ProfitLossPct100DayWorst","ImpliedVolatility","TodayStockMedianIV_Maximum100DaysToExp","AllMedianIV_Maximum100DaysToExp","ExpiryDate_Lower_Bound_Minus_Pct_Based_on_Accuracy","StrikeBelowLowerAtAcc","Ask","WorstHistoricalDecline","BadHistoricalDecline","ImpliedVolatilityUntilExpiry","StockPrice_After_100DayWorstDecline","StockPrice_After_50DayWorstDecline","StockPrice_After_2008_50DayWorstDecline","100DayMaxPrice","100DayMaxPriceDate","50DayMaxPrice","50DayMaxPriceDate","Historical100DaysWorstDecline","Historical50DaysWorstDecline","2008_100DaysWorstDecline","2008_50DaysWorstDecline","IV_ClosestToStrike","IV_UntilExpiryClosestToStrike","LowerBoundClosestToStrike","LowerBoundDistanceFromCurrentPrice","LowerBoundDistanceFromStrike","ImpliedDownPct","ToStrikePct","SafetyMultiple","SigmasToStrike","ProbAssignment","SafetyCategory","CushionMinusIVPct","PotentialLossAtLowerBound"];m.useEffect(()=>{const y=h(),w=new Map(a.map(b=>[b.key,b])),_=y.map((b,T)=>w.get(b)||{key:b,visible:f.includes(b),order:w.size+T});_.sort((b,T)=>{const k=w.has(b.key),S=w.has(T.key);return k&&S?b.order-T.order:k?-1:S?1:b.order-T.order}),u(_)},[a]);const p=y=>{const{active:w,over:_}=y;w.id!==(_==null?void 0:_.id)&&u(b=>{const T=b.findIndex(E=>E.key===w.id),k=b.findIndex(E=>E.key===(_==null?void 0:_.id));return nd(b,T,k).map((E,C)=>({...E,order:C}))})},v=(y,w)=>{u(_=>_.map(b=>b.key===y?{...b,visible:w}:b))},g=async()=>{await i(c);const y=c.filter(w=>w.visible).sort((w,_)=>w.order-_.order).map(w=>w.key);r(y),s(!1)},x=c.filter(y=>y.visible).length;return l.jsxs(Al,{open:n,onOpenChange:s,children:[l.jsx(Nl,{asChild:!0,children:l.jsxs(Ee,{variant:"outline",size:"sm",className:"ml-2",children:[l.jsx(xl,{className:"h-4 w-4 mr-1"}),"Portfolio Columns (",x,")"]})}),l.jsxs(qi,{className:"max-w-2xl max-h-[80vh] overflow-hidden flex flex-col",children:[l.jsxs(Xu,{children:[l.jsx(qu,{children:"Manage Portfolio Table Columns"}),l.jsx("p",{className:"text-sm text-muted-foreground",children:"Drag to reorder columns and check/uncheck to show/hide them. These settings are independent from the main options table. Click Save to persist your preferences."})]}),l.jsx("div",{className:"flex-1 overflow-y-auto space-y-2 pr-2",children:!o&&c.length>0&&l.jsx(Z1,{sensors:d,collisionDetection:$1,onDragEnd:p,children:l.jsx(sy,{items:c.map(y=>y.key),strategy:ty,children:c.sort((y,w)=>y.order-w.order).map(y=>l.jsx(Q6,{column:y,onVisibilityChange:w=>v(y.key,w)},y.key))})})}),l.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[l.jsxs("p",{className:"text-sm text-muted-foreground",children:[x," of ",c.length," columns visible"]}),l.jsxs("div",{className:"flex space-x-2",children:[l.jsx(Ee,{variant:"outline",onClick:()=>s(!1),children:"Cancel"}),l.jsxs(Ee,{onClick:g,disabled:o,children:[l.jsx(vx,{className:"h-4 w-4 mr-1"}),"Save Preferences"]})]})]})]})]})},eB=({data:e,onRowClick:t,onStockClick:r,columnFilters:n=[],onColumnFiltersChange:s=()=>{},sortField:a,sortDirection:i,onSortChange:o,enableFiltering:c=!0})=>{const{columnPreferences:u,isLoading:d}=nb(),[f,h]=m.useState([]),[p,v]=m.useState(null),g=m.useRef(null),x=["StockName","OptionName","ExpiryDate","DaysToExpiry","StrikePrice","Premium","NumberOfContractsBasedOnLimit","1_2_3_ProbOfWorthless_Weighted","PotentialLossAtLowerBound"];m.useEffect(()=>{if(!d)if(u.length>0){const j=u.filter(V=>V.visible).sort((V,A)=>V.order-A.order).map(V=>V.key);h(j)}else h(x)},[u,d]),m.useEffect(()=>{const j=V=>{g.current&&!g.current.contains(V.target)&&v(null)};if(p&&c)return document.addEventListener("mousedown",j),()=>document.removeEventListener("mousedown",j)},[p,c]);const y=j=>{if(j==="recalculatedNumberOfContracts")return"Number Of Contracts";const V={IV_ClosestToStrike:"IV Closest To Strike",IV_UntilExpiryClosestToStrike:"IV Until Expiry Closest To Strike",LowerBoundClosestToStrike:"Lower Bound Closest To Strike",LowerBoundDistanceFromCurrentPrice:"Lower Bound Distance From Current Price",LowerBoundDistanceFromStrike:"Lower Bound Distance From Strike",ImpliedDownPct:"Implied Down %",ToStrikePct:"To Strike %",SafetyMultiple:"Safety Multiple",SigmasToStrike:"Sigmas To Strike",ProbAssignment:"Prob Assignment",SafetyCategory:"Safety Category",CushionMinusIVPct:"Cushion Minus IV %",PotentialLossAtLowerBound:"Potential Loss At IV Lower Bound"};return V[j]?V[j]:j.replace(/([A-Z])/g," $1").replace(/_/g," ").replace(/^\w/,A=>A.toUpperCase()).replace(/\b\w/g,A=>A.toUpperCase())},w=j=>{a===j?o(j,i==="asc"?"desc":"asc"):o(j,"asc")},_=[...e].sort((j,V)=>{if(!a)return 0;const A=j[a],H=V[a];if(typeof A=="number"&&typeof H=="number")return i==="asc"?A-H:H-A;const G=String(A).toLowerCase(),q=String(H).toLowerCase();return i==="asc"?G.localeCompare(q):q.localeCompare(G)}),b=j=>e.length===0?"text":typeof e[0][j]=="number"?"number":"text",T=c?_.filter(j=>n.every(V=>{const A=j[V.field];return V.type==="text"?V.textValue?String(A).toLowerCase().includes(V.textValue.toLowerCase()):!0:typeof A!="number"?!0:!(V.minValue!==void 0&&A<V.minValue||V.maxValue!==void 0&&A>V.maxValue)})):_,k=(j,V)=>{if(!c)return;const A=n,H=A.findIndex(Y=>Y.field===j),G=b(j);let q;if(H>=0){const Y=[...A];Y[H]={...Y[H],...V},G==="text"&&!Y[H].textValue?q=Y.filter((Q,fe)=>fe!==H):G==="number"&&Y[H].minValue===void 0&&Y[H].maxValue===void 0?q=Y.filter((Q,fe)=>fe!==H):q=Y}else G==="text"&&!V.textValue||G==="number"&&V.minValue===void 0&&V.maxValue===void 0?q=A:q=[...A,{field:j,type:G,...V}];s(q)},S=j=>n.find(V=>V.field===j),E=(j,V)=>ji(j,V),C=(j,V)=>{V?f.includes(j)||h(A=>[...A,j]):h(A=>A.filter(H=>H!==j))},L=j=>{h(j)},M=()=>{Mw({filename:"portfolio_options_data",visibleColumns:f,data:T})};return l.jsx(zi,{children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between gap-4",children:[c&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(jc,{className:"h-4 w-4"}),l.jsx("span",{className:"text-sm text-muted-foreground",children:"Click on column headers to filter"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs(Ee,{variant:"outline",size:"sm",onClick:M,className:"flex items-center gap-2",children:[l.jsx(gx,{className:"h-4 w-4"}),"Export to Excel"]}),l.jsx(Z6,{visibleColumns:f,onVisibilityChange:C,onColumnOrderChange:L})]})]}),l.jsxs(zu,{className:"w-full whitespace-nowrap rounded-md border",children:[l.jsxs(Sl,{children:[l.jsx(El,{children:l.jsx(ds,{children:f.map(j=>{const V=b(j),A=S(j),H=!!A;return l.jsx(qr,{className:j==="StockName"?"w-28 max-w-28":"min-w-[120px]",children:l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsxs(Ee,{variant:"ghost",onClick:()=>w(j),className:"h-8 p-0 font-medium",title:y(j),children:[y(j)," ",l.jsx(Di,{className:"ml-1 h-3 w-3"})]}),j==="OptionName"&&l.jsxs(zo,{children:[l.jsx(Go,{asChild:!0,children:l.jsx(Mn,{className:"h-3 w-3 text-muted-foreground cursor-help"})}),l.jsx(Ii,{side:"top",className:"max-w-xs",children:l.jsxs("div",{className:"space-y-1 text-xs",children:[l.jsx("div",{className:"font-medium"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-3 h-3 bg-orange-500 rounded"}),l.jsx("span",{children:"Financial Report"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-3 h-3 bg-red-500 rounded"}),l.jsx("span",{children:"Ex-Dividend Day"})]})]})})]}),j==="PotentialLossAtLowerBound"&&l.jsxs(zo,{children:[l.jsx(Go,{asChild:!0,children:l.jsx(Mn,{className:"h-3 w-3 text-muted-foreground cursor-help"})}),l.jsx(Ii,{side:"top",align:"center",sideOffset:5,className:"z-[9999] border bg-popover text-popover-foreground shadow-md !max-w-none !w-auto",style:{width:"auto",minWidth:"max-content",maxWidth:"none",whiteSpace:"normal"},children:l.jsxs("div",{className:"text-xs leading-relaxed p-3",style:{width:"auto",minWidth:"max-content"},children:[l.jsx("div",{className:"font-medium mb-2",children:"How this field is calculated:"}),l.jsx("div",{className:"mb-2",children:"This field represents the maximum potential loss if the stock price falls to its IV-based lower bound at expiration."}),l.jsx("div",{className:"mb-2 font-mono text-xs bg-muted/50 p-2 rounded",children:"Premium + (LowerBoundValue × Contracts × 100) - (StrikePrice × Contracts × 100)"}),l.jsx("div",{children:"The lower bound is derived from implied volatility analysis to estimate worst-case scenarios for the option position."})]})})]})]}),c&&l.jsxs("div",{className:"relative",children:[l.jsxs(Ee,{variant:H?"default":"outline",size:"sm",onClick:()=>v(p===j?null:j),className:"h-6 w-full text-xs",children:[l.jsx(jc,{className:"h-3 w-3 mr-1"}),H?"Filtered":"Filter"]}),p===j&&l.jsxs("div",{ref:g,className:"absolute top-8 left-0 z-50 bg-background border rounded-md shadow-md p-2 min-w-48",children:[V==="text"?l.jsx(Rt,{placeholder:"Search...",value:(A==null?void 0:A.textValue)||"",onChange:G=>k(j,{textValue:G.target.value.slice(0,100)}),className:"h-8",maxLength:100,autoFocus:!0}):l.jsxs("div",{className:"space-y-2",children:[l.jsx(Rt,{type:"number",placeholder:"Min value",value:(A==null?void 0:A.minValue)||"",onChange:G=>{const q=G.target.value,Y=q?parseFloat(q):void 0;(Y===void 0||!isNaN(Y)&&isFinite(Y))&&k(j,{minValue:Y})},className:"h-8"}),l.jsx(Rt,{type:"number",placeholder:"Max value",value:(A==null?void 0:A.maxValue)||"",onChange:G=>{const q=G.target.value,Y=q?parseFloat(q):void 0;(Y===void 0||!isNaN(Y)&&isFinite(Y))&&k(j,{maxValue:Y})},className:"h-8"})]}),l.jsx(Ee,{variant:"ghost",size:"sm",onClick:()=>{k(j,V==="text"?{textValue:""}:{minValue:void 0,maxValue:void 0}),v(null)},className:"mt-2 h-6 w-full text-xs",children:"Clear"})]})]})]})},j)})})}),l.jsx(Tl,{children:T.map((j,V)=>l.jsx(ds,{className:"hover:bg-muted/50",children:f.map(A=>{const H=()=>A!=="OptionName"?"":j.FinancialReport==="Y"?"text-orange-600 dark:text-orange-400":j["X-Day"]&&String(j["X-Day"]).toUpperCase()==="Y"?"text-red-600 dark:text-red-400":"text-primary";return l.jsx(Dt,{className:`${A==="StockName"?"w-28 max-w-28 truncate":"min-w-[120px]"} ${A==="OptionName"||A==="StockName"?"cursor-pointer hover:bg-accent/50 transition-colors":""}`,onClick:A==="OptionName"?()=>t==null?void 0:t(j):A==="StockName"?()=>r==null?void 0:r(j.StockName):void 0,children:A==="OptionName"?l.jsx("span",{className:`font-medium ${H()} hover:opacity-80 transition-all`,children:E(j[A],A)}):A==="StockName"?l.jsx("span",{className:"font-medium text-secondary-foreground hover:text-primary transition-colors",children:E(j[A],A)}):E(j[A],A)},A)})},`${j.StockName}-${j.OptionName}-${V}`))})]}),l.jsx(Gu,{orientation:"horizontal"})]})]})})},gg={totalPremiumTarget:500,strikeBelowPeriod:null,minProbabilityWorthless:null,selectedExpiryDate:"",portfolioUnderlyingValue:1e5,selectedProbabilityField:"ProbWorthless_Bayesian_IsoCal",optimizationStrategy:"returns",maxTotalCapital:null,excludedStocks:[],generatedPortfolio:[],portfolioGenerated:!1,totalUnderlyingValue:0,portfolioMessage:"",totalPotentialLoss:0},tB=()=>{const{user:e}=ea(),[t,r]=m.useState(gg),[n,s]=m.useState(!0),[a,i]=m.useState(!1),[o,c]=m.useState(!1);m.useEffect(()=>{(()=>{const x={totalPremiumTarget:parseInt(localStorage.getItem("portfolioGenerator_totalPremiumTarget")||"500"),strikeBelowPeriod:localStorage.getItem("portfolioGenerator_strikeBelowPeriod")?parseInt(localStorage.getItem("portfolioGenerator_strikeBelowPeriod")):null,minProbabilityWorthless:localStorage.getItem("portfolioGenerator_minProbabilityWorthless")?parseInt(localStorage.getItem("portfolioGenerator_minProbabilityWorthless")):null,selectedExpiryDate:localStorage.getItem("portfolioGenerator_selectedExpiryDate")||"",portfolioUnderlyingValue:parseInt(localStorage.getItem("portfolioGenerator_underlyingStockValue")||"100000"),selectedProbabilityField:localStorage.getItem("portfolioGenerator_selectedProbabilityField")||"ProbWorthless_Bayesian_IsoCal",optimizationStrategy:localStorage.getItem("portfolioGenerator_optimizationStrategy")||"returns",maxTotalCapital:localStorage.getItem("portfolioGenerator_maxTotalCapital")?parseInt(localStorage.getItem("portfolioGenerator_maxTotalCapital")):null,excludedStocks:localStorage.getItem("portfolioGenerator_excludedStocks")?JSON.parse(localStorage.getItem("portfolioGenerator_excludedStocks")):[],generatedPortfolio:localStorage.getItem("portfolioGenerator_generatedPortfolio")?JSON.parse(localStorage.getItem("portfolioGenerator_generatedPortfolio")):[],portfolioGenerated:localStorage.getItem("portfolioGenerator_portfolioGenerated")==="true",totalUnderlyingValue:parseInt(localStorage.getItem("portfolioGenerator_totalUnderlyingValue")||"0"),portfolioMessage:localStorage.getItem("portfolioGenerator_portfolioMessage")||"",totalPotentialLoss:parseFloat(localStorage.getItem("portfolioGenerator_totalPotentialLoss")||"0")};r(x)})(),s(!1)},[]),m.useEffect(()=>{e&&!a&&!o&&u()},[e,a,o]);const u=async()=>{if(!(!e||a||o))try{const{data:g,error:x}=await mr.from("user_preferences").select("preference_data").eq("user_id",e.id).eq("preference_type","portfolio_generator").maybeSingle();if(x){console.error("Error loading portfolio generator preferences:",x),c(!0);return}if(g!=null&&g.preference_data){const y=g.preference_data;y.portfolioUnderlyingValue&&y.portfolioUnderlyingValue>=1e4&&y.portfolioUnderlyingValue<=1e6&&(r(y),d(y))}c(!0)}catch(g){console.error("Error loading portfolio generator preferences:",g),c(!0)}},d=g=>{var x,y,w;console.log("💾 Saving to localStorage:",{portfolioUnderlyingValue:g.portfolioUnderlyingValue}),localStorage.setItem("portfolioGenerator_totalPremiumTarget",g.totalPremiumTarget.toString()),localStorage.setItem("portfolioGenerator_strikeBelowPeriod",((x=g.strikeBelowPeriod)==null?void 0:x.toString())||""),localStorage.setItem("portfolioGenerator_minProbabilityWorthless",((y=g.minProbabilityWorthless)==null?void 0:y.toString())||""),localStorage.setItem("portfolioGenerator_selectedExpiryDate",g.selectedExpiryDate),localStorage.setItem("portfolioGenerator_underlyingStockValue",g.portfolioUnderlyingValue.toString()),localStorage.setItem("portfolioGenerator_selectedProbabilityField",g.selectedProbabilityField),localStorage.setItem("portfolioGenerator_optimizationStrategy",g.optimizationStrategy),localStorage.setItem("portfolioGenerator_maxTotalCapital",((w=g.maxTotalCapital)==null?void 0:w.toString())||""),localStorage.setItem("portfolioGenerator_excludedStocks",JSON.stringify(g.excludedStocks)),localStorage.setItem("portfolioGenerator_generatedPortfolio",JSON.stringify(g.generatedPortfolio)),localStorage.setItem("portfolioGenerator_portfolioGenerated",g.portfolioGenerated.toString()),localStorage.setItem("portfolioGenerator_totalUnderlyingValue",g.totalUnderlyingValue.toString()),localStorage.setItem("portfolioGenerator_portfolioMessage",g.portfolioMessage),localStorage.setItem("portfolioGenerator_totalPotentialLoss",g.totalPotentialLoss.toString())},f=async g=>{if(console.log("💾 Saving settings:",{portfolioUnderlyingValue:g.portfolioUnderlyingValue}),r(g),d(g),e)try{const{error:x}=await mr.from("user_preferences").upsert({user_id:e.id,preference_type:"portfolio_generator",preference_data:g},{onConflict:"user_id,preference_type"});x?console.error("Error saving portfolio generator preferences:",x):console.log("✅ Successfully saved to Supabase")}catch(x){console.error("Error saving portfolio generator preferences:",x)}};return{settings:t,isLoading:n,updateSetting:(g,x)=>{const y={...t,[g]:x};f(y)},updateMultipleSettings:g=>{const x={...t,...g};f(x)},saveSettings:f,resetToDefaults:()=>{i(!0),c(!1);const g={...gg,portfolioUnderlyingValue:1e5,totalPremiumTarget:500};r(g),d(g),e?mr.from("user_preferences").delete().eq("user_id",e.id).eq("preference_type","portfolio_generator").then(()=>{i(!1)}):i(!1)}}},rB=()=>{var U,I,ee,z;const e=ms(),{data:t,isLoading:r,error:n}=O0(),{getLowPriceForPeriod:s}=pd(),{transactionCost:a}=Yi(),{settings:i,updateSetting:o,updateMultipleSettings:c,resetToDefaults:u,isLoading:d}=tB(),[f,h]=m.useState(!1),[p,v]=m.useState(i.totalPremiumTarget.toString()),[g,x]=m.useState(i.portfolioUnderlyingValue.toString()),[y,w]=m.useState(((U=i.maxTotalCapital)==null?void 0:U.toString())||"");m.useEffect(()=>{var Z;v(i.totalPremiumTarget.toString());const R=parseInt(g)||0,J=i.portfolioUnderlyingValue;R!==J&&x(J.toString()),w(((Z=i.maxTotalCapital)==null?void 0:Z.toString())||"")},[i]);const _=(R,J)=>R.map(Z=>{const ge=Math.round(J/Z.StrikePrice/100),ye=(Z.Bid+(Z.Ask||Z.Bid))/2,Ce=Math.round(ye*ge*100-a),Ie=ge*Z.StrikePrice*100;return{...Z,originalPremium:Z.Premium,recalculatedPremium:Ce,recalculatedNumberOfContracts:ge,recalculatedBid_Ask_Mid_Price:ye,Premium:Ce,NumberOfContractsBasedOnLimit:ge,Bid_Ask_Mid_Price:ye,Underlying_Value:Ie}}),b=m.useMemo(()=>_(t||[],i.portfolioUnderlyingValue),[t,i.portfolioUnderlyingValue,a]),[T,k]=m.useState(null),[S,E]=m.useState("asc"),[C,L]=m.useState(!1),M=R=>{T===R?E(S==="asc"?"desc":"asc"):(k(R),E("asc"))},j=[{label:"1 Week Low",days:7},{label:"1 Month Low",days:30},{label:"3 Months Low",days:90},{label:"6 Months Low",days:180},{label:"9 Months Low",days:270},{label:"1 Year Low",days:365}],V=[{value:"ProbWorthless_Bayesian_IsoCal",label:"Bayesian Calibrated"},{value:"1_2_3_ProbOfWorthless_Weighted",label:"Weighted Average"},{value:"1_ProbOfWorthless_Original",label:"Original"},{value:"2_ProbOfWorthless_Calibrated",label:"Calibrated"},{value:"3_ProbOfWorthless_Historical_IV",label:"Historical IV"}],A=[{value:"returns",label:"Maximize Returns",description:"Prioritize highest risk-adjusted returns"},{value:"capital",label:"Minimize Capital",description:"Prioritize lowest capital requirements"},{value:"balanced",label:"Balanced",description:"Balance returns and capital efficiency"}],H=m.useMemo(()=>[...new Set(b.map(R=>R.ExpiryDate))].sort(),[b]),G=m.useMemo(()=>[...new Set(b.map(R=>R.StockName))].sort(),[b]),q=R=>{const J=parseInt(R)||500,Z=Math.max(500,Math.min(1e6,J));o("totalPremiumTarget",Z),v(Z.toString())},Y=R=>{x(R)},Q=()=>{if(f)return;const R=parseInt(g)||1e4,J=Math.max(1e4,Math.min(1e6,R));o("portfolioUnderlyingValue",J),x(J.toString()),console.log("📝 Portfolio Generator - Saved underlying value:",J),i.portfolioGenerated&&c({generatedPortfolio:[],portfolioGenerated:!1,portfolioMessage:"",totalPotentialLoss:0,totalUnderlyingValue:0,portfolioUnderlyingValue:J})},fe=R=>{const J=R[i.selectedProbabilityField],Z=R["1_2_3_ProbOfWorthless_Weighted"];return(J==null||isNaN(J))&&(Z==null||isNaN(Z))?null:J||Z||0},oe=R=>{if(fe(R)===null)return!1;const Z=R.PotentialLossAtLowerBound;return!(Z==null||isNaN(Z)||!R.NumberOfContractsBasedOnLimit||R.NumberOfContractsBasedOnLimit<=0)},X=R=>{const J=R||i.portfolioUnderlyingValue;if(!b||b.length===0){o("portfolioMessage","No options data available for portfolio generation");return}h(!0),Cc({title:"Generating Portfolio",description:"Analyzing options and building your portfolio..."}),setTimeout(()=>{var Z;try{const ge=[],ye=new Set;let Ce=0,st=_(t||[],J).filter(ke=>{if(!oe(ke)||ke.Premium<=0||i.excludedStocks.includes(ke.StockName))return!1;if(i.strikeBelowPeriod){const je=s(ke.StockName,i.strikeBelowPeriod);if(!je||ke.StrikePrice>je)return!1}if(i.selectedExpiryDate&&ke.ExpiryDate!==i.selectedExpiryDate)return!1;if(i.minProbabilityWorthless){const je=fe(ke),ht=i.minProbabilityWorthless/100;if(je===null||je<ht)return!1}return!0});st.forEach(ke=>{const je=fe(ke),ht=Math.abs(ke.PotentialLossAtLowerBound),At=ke.Premium,Ze=At-(1-je)*ht,ct=ke.NumberOfContractsBasedOnLimit*ke.StrikePrice*100,tr=ct>0?Ze/ct:0,Gr=ct>0?Ze/ct:0,Yt=ht>0?At/ht*je:je;let Dr=0;i.optimizationStrategy==="returns"?Dr=Yt:i.optimizationStrategy==="capital"?Dr=Gr*(je*2):Dr=Yt*.6+Gr*.4,ke.expectedValue=Ze,ke.expectedValuePerCapital=tr,ke.capitalEfficiencyScore=Gr,ke.riskAdjustedScore=Yt,ke.finalScore=Dr,ke.capitalRequired=ct}),st.sort((ke,je)=>{const ht=ke.finalScore||0,At=je.finalScore||0;if(At!==ht)return At-ht;if(i.optimizationStrategy==="capital"){const Ze=ke.capitalRequired||0,ct=je.capitalRequired||0;if(Ze!==ct)return Ze-ct}else{const Ze=ke.expectedValuePerCapital||0,ct=je.expectedValuePerCapital||0;if(ct!==Ze)return ct-Ze}return je.Premium-ke.Premium});let Se=0;for(const ke of st){if(ye.has(ke.StockName))continue;const je=ke.capitalRequired||0,ht=Se+je,At=Ce+ke.Premium<=i.totalPremiumTarget,Ze=!i.maxTotalCapital||ht<=i.maxTotalCapital;At&&Ze&&(ge.push(ke),ye.add(ke.StockName),Ce+=ke.Premium,Se=ht)}if(Ce<i.totalPremiumTarget){const ke=st.filter(je=>{const ht=je.capitalRequired||0,At=!ye.has(je.StockName)&&je.Premium<=i.totalPremiumTarget-Ce,Ze=!i.maxTotalCapital||Se+ht<=i.maxTotalCapital;return At&&Ze});for(const je of ke){const ht=je.capitalRequired||0,At=Ce+je.Premium<=i.totalPremiumTarget,Ze=!i.maxTotalCapital||Se+ht<=i.maxTotalCapital;At&&Ze&&(ge.push(je),ye.add(je.StockName),Ce+=je.Premium,Se+=ht)}}const Le=ge.reduce((ke,je)=>ke+je.NumberOfContractsBasedOnLimit*je.StrikePrice*100,0),de=ge.reduce((ke,je)=>{const ht=je.PotentialLossAtLowerBound||0;return ke+ht},0);let Fe="";if(Ce<i.totalPremiumTarget){const ke=i.totalPremiumTarget-Ce;Fe=`Portfolio generated with ${Ce.toLocaleString("sv-SE")} SEK premium (${ke.toLocaleString("sv-SE")} SEK below target). `}else Fe=`Portfolio successfully generated with ${Ce.toLocaleString("sv-SE")} SEK premium.`;const at=ge.length>0?ge.reduce((ke,je)=>ke+(je.capitalEfficiencyScore||0),0)/ge.length:0;Fe+=` Strategy: ${(Z=A.find(ke=>ke.value===i.optimizationStrategy))==null?void 0:Z.label}. Avg Capital Efficiency: ${(at*100).toFixed(2)}%.`,c({generatedPortfolio:ge,portfolioGenerated:!0,portfolioMessage:Fe,totalUnderlyingValue:Le,totalPotentialLoss:de,portfolioUnderlyingValue:J}),Cc({title:"Portfolio Generated",description:`Successfully created portfolio with ${ge.length} options.`})}catch(ge){o("portfolioMessage",`Error generating portfolio: ${ge}`),Cc({title:"Error",description:"Failed to generate portfolio. Please try again.",variant:"destructive"})}finally{h(!1)}},100)},le=R=>{const J=encodeURIComponent(R.OptionName);e(`/option/${J}`)},D=R=>{e(`/stock/${encodeURIComponent(R)}`)},K=()=>{e("/")};return l.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[l.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[l.jsxs(Ee,{variant:"ghost",onClick:K,className:"flex items-center gap-2",children:[l.jsx(Zr,{className:"h-4 w-4"}),"Back to Options"]}),l.jsx("h1",{className:"text-3xl font-bold",children:"Automatic Portfolio Generator"}),l.jsxs(Ee,{variant:"ghost",size:"sm",onClick:()=>L(!C),className:"ml-auto flex items-center gap-2 text-muted-foreground hover:text-foreground",children:[l.jsx(Mn,{className:"h-4 w-4"}),"How it works"]})]}),C&&l.jsx(Ke,{className:"border-muted bg-muted/20",children:l.jsx(Ye,{className:"pt-4",children:l.jsxs("p",{className:"text-sm text-muted-foreground leading-relaxed",children:["The Portfolio Generator uses an algorithm to evaluate each option's probability of expiring worthless, potential loss, and premium. It calculates risk-adjusted scores and expected values, ranks all options based on your selected optimization strategy, and automatically selects a diversified set. ",l.jsx("strong",{children:"Maximize Returns"})," prioritizes highest risk-adjusted returns. ",l.jsx("strong",{children:"Minimize Capital"})," prioritizes lowest capital requirements while maintaining quality. ",l.jsx("strong",{children:"Balanced"})," optimizes for both return and capital efficiency. It will always pick just one option per stock."]})})}),l.jsxs(Ke,{children:[l.jsx(qe,{children:l.jsxs(Je,{className:"flex items-center gap-2",children:[l.jsx(xl,{className:"h-5 w-5"}),"Portfolio Configuration"]})}),l.jsxs(Ye,{className:"space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(ze,{htmlFor:"totalPremium",children:"Total Portfolio Premium"}),l.jsx(Rt,{id:"totalPremium",type:"number",value:p,onChange:R=>v(R.target.value),onBlur:R=>q(R.target.value),placeholder:"500 - 1 000 000"}),l.jsx("p",{className:"text-xs text-muted-foreground",children:"Range: 500 - 1 000 000 SEK"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(ze,{htmlFor:"underlyingValue",children:"Underlying Stock Value Per Option"}),l.jsx(Rt,{id:"underlyingValue",type:"text",inputMode:"numeric",pattern:"[0-9]*",value:g,onChange:R=>Y(R.target.value),onBlur:Q,placeholder:"10 000 - 1 000 000",className:"text-left"}),l.jsx("p",{className:"text-xs text-muted-foreground",children:"Range: 10 000 - 1 000 000 SEK"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(ze,{children:"Strike Price Below"}),l.jsxs(On,{children:[l.jsx(In,{asChild:!0,children:l.jsxs(Ee,{variant:"outline",className:"w-full justify-between",children:[i.strikeBelowPeriod===null?"Select Period (Optional)":(I=j.find(R=>R.days===i.strikeBelowPeriod))==null?void 0:I.label,l.jsx(Ur,{className:"h-4 w-4"})]})}),l.jsxs(pn,{className:"w-full bg-background z-50",children:[l.jsx(Jt,{onClick:()=>{o("strikeBelowPeriod",null)},children:"No Filter"}),j.map(R=>l.jsx(Jt,{onClick:()=>{o("strikeBelowPeriod",R.days)},children:R.label},R.days))]})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(ze,{htmlFor:"minProbability",children:"Minimum Probability of Worthless (%)"}),l.jsx(Rt,{id:"minProbability",type:"number",min:"40",max:"100",value:i.minProbabilityWorthless||"",onChange:R=>{const J=R.target.value?parseInt(R.target.value):null;o("minProbabilityWorthless",J)},placeholder:"40-100% (Optional)"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(ze,{children:"Probability Field to Use"}),l.jsxs(On,{children:[l.jsx(In,{asChild:!0,children:l.jsxs(Ee,{variant:"outline",className:"w-full justify-between",children:[((ee=V.find(R=>R.value===i.selectedProbabilityField))==null?void 0:ee.label)||"Select Field",l.jsx(Ur,{className:"h-4 w-4"})]})}),l.jsx(pn,{className:"w-full bg-background z-50",children:V.map(R=>l.jsx(Jt,{onClick:()=>{o("selectedProbabilityField",R.value)},children:R.label},R.value))})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(ze,{children:"Expiry Date"}),l.jsxs(On,{children:[l.jsx(In,{asChild:!0,children:l.jsxs(Ee,{variant:"outline",className:"w-full justify-between",children:[i.selectedExpiryDate||"Select Expiry Date (Optional)",l.jsx(Ur,{className:"h-4 w-4"})]})}),l.jsxs(pn,{className:"w-full bg-background z-50 max-h-[200px] overflow-y-auto",children:[l.jsx(Jt,{onClick:()=>{o("selectedExpiryDate","")},children:"All Expiry Dates"}),H.map(R=>l.jsx(Jt,{onClick:()=>{o("selectedExpiryDate",R)},children:R},R))]})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(ze,{children:"Optimization Strategy"}),l.jsxs(On,{children:[l.jsx(In,{asChild:!0,children:l.jsxs(Ee,{variant:"outline",className:"w-full justify-between",children:[((z=A.find(R=>R.value===i.optimizationStrategy))==null?void 0:z.label)||"Select Strategy",l.jsx(Ur,{className:"h-4 w-4"})]})}),l.jsx(pn,{className:"w-full bg-background z-50",children:A.map(R=>l.jsx(Jt,{onClick:()=>{o("optimizationStrategy",R.value)},children:l.jsxs("div",{children:[l.jsx("div",{className:"font-medium",children:R.label}),l.jsx("div",{className:"text-xs text-muted-foreground",children:R.description})]})},R.value))})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(ze,{htmlFor:"maxCapital",children:"Maximum Total Capital (Optional)"}),l.jsx(Rt,{id:"maxCapital",type:"number",value:y,onChange:R=>w(R.target.value),onBlur:R=>{const J=R.target.value?parseInt(R.target.value):null;o("maxTotalCapital",J)},placeholder:"e.g., 5 000 000 SEK"}),l.jsx("p",{className:"text-xs text-muted-foreground",children:"Limits total underlying value across all options"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(ze,{children:"Exclude Stocks"}),l.jsxs(On,{children:[l.jsx(In,{asChild:!0,children:l.jsxs(Ee,{variant:"outline",className:"w-full justify-between",children:[i.excludedStocks.length>0?`${i.excludedStocks.length} stock(s) excluded`:"No stocks excluded",l.jsx(Ur,{className:"h-4 w-4"})]})}),l.jsxs(pn,{className:"w-full bg-background z-50 max-h-[200px] overflow-y-auto",children:[l.jsx(Jt,{onClick:()=>{o("excludedStocks",[])},children:"Clear All Exclusions"}),G.map(R=>l.jsxs(Jt,{onClick:()=>{const J=i.excludedStocks.includes(R)?i.excludedStocks.filter(Z=>Z!==R):[...i.excludedStocks,R];o("excludedStocks",J)},children:[i.excludedStocks.includes(R)?"✓ ":"",R]},R))]})]}),i.excludedStocks.length>0&&l.jsxs("p",{className:"text-xs text-muted-foreground",children:["Excluded: ",i.excludedStocks.join(", ")]})]})]}),l.jsx(Ee,{onClick:()=>{const R=parseInt(g)||1e5,J=Math.max(1e4,Math.min(1e6,R));!b||b.length===0||X(J)},disabled:f||!b||b.length===0,type:"button",className:"w-full md:w-auto",size:"lg",children:f?"Generating...":"Generate Portfolio Automatically"})]})]}),i.portfolioGenerated&&l.jsxs(Ke,{children:[l.jsx(qe,{children:l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("div",{children:[l.jsxs(Je,{children:["Generated Portfolio (",i.generatedPortfolio.length," options)"]}),l.jsxs("div",{className:"text-sm text-muted-foreground space-y-1 mt-2",children:[l.jsx("p",{children:i.portfolioMessage}),l.jsxs("p",{children:["Total Underlying Stock Value: ",i.totalUnderlyingValue.toLocaleString("sv-SE")," SEK"]}),l.jsxs("p",{children:["Total Premium: ",i.generatedPortfolio.reduce((R,J)=>R+J.Premium,0).toLocaleString("sv-SE")," SEK (Based on ",i.portfolioUnderlyingValue.toLocaleString("sv-SE")," SEK underlying value, ",a," SEK transaction cost per option included)"]}),l.jsxs("p",{children:["Total Calculated Risk of Loss: ",Math.round(i.totalPotentialLoss).toLocaleString("sv-SE")," SEK"]})]})]})})}),l.jsx(Ye,{children:l.jsx(eB,{data:i.generatedPortfolio,onRowClick:le,onStockClick:D,sortField:T,sortDirection:S,onSortChange:M,enableFiltering:!1})})]})]})};var nB=[" ","Enter","ArrowUp","ArrowDown"],sB=[" ","Enter"],Ul="Select",[yd,wd,aB]=pl(Ul),[ao,RW]=bn(Ul,[aB,Qs]),_d=Qs(),[iB,ra]=ao(Ul),[oB,lB]=ao(Ul),sb=e=>{const{__scopeSelect:t,children:r,open:n,defaultOpen:s,onOpenChange:a,value:i,defaultValue:o,onValueChange:c,dir:u,name:d,autoComplete:f,disabled:h,required:p,form:v}=e,g=_d(t),[x,y]=m.useState(null),[w,_]=m.useState(null),[b,T]=m.useState(!1),k=Xi(u),[S=!1,E]=vn({prop:n,defaultProp:s,onChange:a}),[C,L]=vn({prop:i,defaultProp:o,onChange:c}),M=m.useRef(null),j=x?v||!!x.closest("form"):!0,[V,A]=m.useState(new Set),H=Array.from(V).map(G=>G.props.value).join(";");return l.jsx(Cu,{...g,children:l.jsxs(iB,{required:p,scope:t,trigger:x,onTriggerChange:y,valueNode:w,onValueNodeChange:_,valueNodeHasChildren:b,onValueNodeHasChildrenChange:T,contentId:tn(),value:C,onValueChange:L,open:S,onOpenChange:E,dir:k,triggerPointerDownPosRef:M,disabled:h,children:[l.jsx(yd.Provider,{scope:t,children:l.jsx(oB,{scope:e.__scopeSelect,onNativeOptionAdd:m.useCallback(G=>{A(q=>new Set(q).add(G))},[]),onNativeOptionRemove:m.useCallback(G=>{A(q=>{const Y=new Set(q);return Y.delete(G),Y})},[]),children:r})}),j?l.jsxs(Ab,{"aria-hidden":!0,required:p,tabIndex:-1,name:d,autoComplete:f,value:C,onChange:G=>L(G.target.value),disabled:h,form:v,children:[C===void 0?l.jsx("option",{value:""}):null,Array.from(V)]},H):null]})})};sb.displayName=Ul;var ab="SelectTrigger",ib=m.forwardRef((e,t)=>{const{__scopeSelect:r,disabled:n=!1,...s}=e,a=_d(r),i=ra(ab,r),o=i.disabled||n,c=Me(t,i.onTriggerChange),u=wd(r),d=m.useRef("touch"),[f,h,p]=Nb(g=>{const x=u().filter(_=>!_.disabled),y=x.find(_=>_.value===i.value),w=Db(x,g,y);w!==void 0&&i.onValueChange(w.value)}),v=g=>{o||(i.onOpenChange(!0),p()),g&&(i.triggerPointerDownPosRef.current={x:Math.round(g.pageX),y:Math.round(g.pageY)})};return l.jsx(yl,{asChild:!0,...a,children:l.jsx(Ne.button,{type:"button",role:"combobox","aria-controls":i.contentId,"aria-expanded":i.open,"aria-required":i.required,"aria-autocomplete":"none",dir:i.dir,"data-state":i.open?"open":"closed",disabled:o,"data-disabled":o?"":void 0,"data-placeholder":Pb(i.value)?"":void 0,...s,ref:c,onClick:he(s.onClick,g=>{g.currentTarget.focus(),d.current!=="mouse"&&v(g)}),onPointerDown:he(s.onPointerDown,g=>{d.current=g.pointerType;const x=g.target;x.hasPointerCapture(g.pointerId)&&x.releasePointerCapture(g.pointerId),g.button===0&&g.ctrlKey===!1&&g.pointerType==="mouse"&&(v(g),g.preventDefault())}),onKeyDown:he(s.onKeyDown,g=>{const x=f.current!=="";!(g.ctrlKey||g.altKey||g.metaKey)&&g.key.length===1&&h(g.key),!(x&&g.key===" ")&&nB.includes(g.key)&&(v(),g.preventDefault())})})})});ib.displayName=ab;var ob="SelectValue",lb=m.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:s,children:a,placeholder:i="",...o}=e,c=ra(ob,r),{onValueNodeHasChildrenChange:u}=c,d=a!==void 0,f=Me(t,c.onValueNodeChange);return er(()=>{u(d)},[u,d]),l.jsx(Ne.span,{...o,ref:f,style:{pointerEvents:"none"},children:Pb(c.value)?l.jsx(l.Fragment,{children:i}):a})});lb.displayName=ob;var cB="SelectIcon",cb=m.forwardRef((e,t)=>{const{__scopeSelect:r,children:n,...s}=e;return l.jsx(Ne.span,{"aria-hidden":!0,...s,ref:t,children:n||"▼"})});cb.displayName=cB;var uB="SelectPortal",ub=e=>l.jsx(Wi,{asChild:!0,...e});ub.displayName=uB;var Oa="SelectContent",db=m.forwardRef((e,t)=>{const r=ra(Oa,e.__scopeSelect),[n,s]=m.useState();if(er(()=>{s(new DocumentFragment)},[]),!r.open){const a=n;return a?Vr.createPortal(l.jsx(fb,{scope:e.__scopeSelect,children:l.jsx(yd.Slot,{scope:e.__scopeSelect,children:l.jsx("div",{children:e.children})})}),a):null}return l.jsx(hb,{...e,ref:t})});db.displayName=Oa;var un=10,[fb,na]=ao(Oa),dB="SelectContentImpl",hb=m.forwardRef((e,t)=>{const{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:s,onEscapeKeyDown:a,onPointerDownOutside:i,side:o,sideOffset:c,align:u,alignOffset:d,arrowPadding:f,collisionBoundary:h,collisionPadding:p,sticky:v,hideWhenDetached:g,avoidCollisions:x,...y}=e,w=ra(Oa,r),[_,b]=m.useState(null),[T,k]=m.useState(null),S=Me(t,I=>b(I)),[E,C]=m.useState(null),[L,M]=m.useState(null),j=wd(r),[V,A]=m.useState(!1),H=m.useRef(!1);m.useEffect(()=>{if(_)return Pl(_)},[_]),Ku();const G=m.useCallback(I=>{const[ee,...z]=j().map(Z=>Z.ref.current),[R]=z.slice(-1),J=document.activeElement;for(const Z of I)if(Z===J||(Z==null||Z.scrollIntoView({block:"nearest"}),Z===ee&&T&&(T.scrollTop=0),Z===R&&T&&(T.scrollTop=T.scrollHeight),Z==null||Z.focus(),document.activeElement!==J))return},[j,T]),q=m.useCallback(()=>G([E,_]),[G,E,_]);m.useEffect(()=>{V&&q()},[V,q]);const{onOpenChange:Y,triggerPointerDownPosRef:Q}=w;m.useEffect(()=>{if(_){let I={x:0,y:0};const ee=R=>{var J,Z;I={x:Math.abs(Math.round(R.pageX)-(((J=Q.current)==null?void 0:J.x)??0)),y:Math.abs(Math.round(R.pageY)-(((Z=Q.current)==null?void 0:Z.y)??0))}},z=R=>{I.x<=10&&I.y<=10?R.preventDefault():_.contains(R.target)||Y(!1),document.removeEventListener("pointermove",ee),Q.current=null};return Q.current!==null&&(document.addEventListener("pointermove",ee),document.addEventListener("pointerup",z,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",ee),document.removeEventListener("pointerup",z,{capture:!0})}}},[_,Y,Q]),m.useEffect(()=>{const I=()=>Y(!1);return window.addEventListener("blur",I),window.addEventListener("resize",I),()=>{window.removeEventListener("blur",I),window.removeEventListener("resize",I)}},[Y]);const[fe,oe]=Nb(I=>{const ee=j().filter(J=>!J.disabled),z=ee.find(J=>J.ref.current===document.activeElement),R=Db(ee,I,z);R&&setTimeout(()=>R.ref.current.focus())}),X=m.useCallback((I,ee,z)=>{const R=!H.current&&!z;(w.value!==void 0&&w.value===ee||R)&&(C(I),R&&(H.current=!0))},[w.value]),le=m.useCallback(()=>_==null?void 0:_.focus(),[_]),D=m.useCallback((I,ee,z)=>{const R=!H.current&&!z;(w.value!==void 0&&w.value===ee||R)&&M(I)},[w.value]),K=n==="popper"?nh:mb,U=K===nh?{side:o,sideOffset:c,align:u,alignOffset:d,arrowPadding:f,collisionBoundary:h,collisionPadding:p,sticky:v,hideWhenDetached:g,avoidCollisions:x}:{};return l.jsx(fb,{scope:r,content:_,viewport:T,onViewportChange:k,itemRefCallback:X,selectedItem:E,onItemLeave:le,itemTextRefCallback:D,focusSelectedItem:q,selectedItemText:L,position:n,isPositioned:V,searchRef:fe,children:l.jsx(kl,{as:ls,allowPinchZoom:!0,children:l.jsx(Cl,{asChild:!0,trapped:w.open,onMountAutoFocus:I=>{I.preventDefault()},onUnmountAutoFocus:he(s,I=>{var ee;(ee=w.trigger)==null||ee.focus({preventScroll:!0}),I.preventDefault()}),children:l.jsx($a,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:a,onPointerDownOutside:i,onFocusOutside:I=>I.preventDefault(),onDismiss:()=>w.onOpenChange(!1),children:l.jsx(K,{role:"listbox",id:w.contentId,"data-state":w.open?"open":"closed",dir:w.dir,onContextMenu:I=>I.preventDefault(),...y,...U,onPlaced:()=>A(!0),ref:S,style:{display:"flex",flexDirection:"column",outline:"none",...y.style},onKeyDown:he(y.onKeyDown,I=>{const ee=I.ctrlKey||I.altKey||I.metaKey;if(I.key==="Tab"&&I.preventDefault(),!ee&&I.key.length===1&&oe(I.key),["ArrowUp","ArrowDown","Home","End"].includes(I.key)){let R=j().filter(J=>!J.disabled).map(J=>J.ref.current);if(["ArrowUp","End"].includes(I.key)&&(R=R.slice().reverse()),["ArrowUp","ArrowDown"].includes(I.key)){const J=I.target,Z=R.indexOf(J);R=R.slice(Z+1)}setTimeout(()=>G(R)),I.preventDefault()}})})})})})})});hb.displayName=dB;var fB="SelectItemAlignedPosition",mb=m.forwardRef((e,t)=>{const{__scopeSelect:r,onPlaced:n,...s}=e,a=ra(Oa,r),i=na(Oa,r),[o,c]=m.useState(null),[u,d]=m.useState(null),f=Me(t,S=>d(S)),h=wd(r),p=m.useRef(!1),v=m.useRef(!0),{viewport:g,selectedItem:x,selectedItemText:y,focusSelectedItem:w}=i,_=m.useCallback(()=>{if(a.trigger&&a.valueNode&&o&&u&&g&&x&&y){const S=a.trigger.getBoundingClientRect(),E=u.getBoundingClientRect(),C=a.valueNode.getBoundingClientRect(),L=y.getBoundingClientRect();if(a.dir!=="rtl"){const J=L.left-E.left,Z=C.left-J,ge=S.left-Z,ye=S.width+ge,Ce=Math.max(ye,E.width),Ie=window.innerWidth-un,st=qo(Z,[un,Math.max(un,Ie-Ce)]);o.style.minWidth=ye+"px",o.style.left=st+"px"}else{const J=E.right-L.right,Z=window.innerWidth-C.right-J,ge=window.innerWidth-S.right-Z,ye=S.width+ge,Ce=Math.max(ye,E.width),Ie=window.innerWidth-un,st=qo(Z,[un,Math.max(un,Ie-Ce)]);o.style.minWidth=ye+"px",o.style.right=st+"px"}const M=h(),j=window.innerHeight-un*2,V=g.scrollHeight,A=window.getComputedStyle(u),H=parseInt(A.borderTopWidth,10),G=parseInt(A.paddingTop,10),q=parseInt(A.borderBottomWidth,10),Y=parseInt(A.paddingBottom,10),Q=H+G+V+Y+q,fe=Math.min(x.offsetHeight*5,Q),oe=window.getComputedStyle(g),X=parseInt(oe.paddingTop,10),le=parseInt(oe.paddingBottom,10),D=S.top+S.height/2-un,K=j-D,U=x.offsetHeight/2,I=x.offsetTop+U,ee=H+G+I,z=Q-ee;if(ee<=D){const J=M.length>0&&x===M[M.length-1].ref.current;o.style.bottom="0px";const Z=u.clientHeight-g.offsetTop-g.offsetHeight,ge=Math.max(K,U+(J?le:0)+Z+q),ye=ee+ge;o.style.height=ye+"px"}else{const J=M.length>0&&x===M[0].ref.current;o.style.top="0px";const ge=Math.max(D,H+g.offsetTop+(J?X:0)+U)+z;o.style.height=ge+"px",g.scrollTop=ee-D+g.offsetTop}o.style.margin=`${un}px 0`,o.style.minHeight=fe+"px",o.style.maxHeight=j+"px",n==null||n(),requestAnimationFrame(()=>p.current=!0)}},[h,a.trigger,a.valueNode,o,u,g,x,y,a.dir,n]);er(()=>_(),[_]);const[b,T]=m.useState();er(()=>{u&&T(window.getComputedStyle(u).zIndex)},[u]);const k=m.useCallback(S=>{S&&v.current===!0&&(_(),w==null||w(),v.current=!1)},[_,w]);return l.jsx(mB,{scope:r,contentWrapper:o,shouldExpandOnScrollRef:p,onScrollButtonChange:k,children:l.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:b},children:l.jsx(Ne.div,{...s,ref:f,style:{boxSizing:"border-box",maxHeight:"100%",...s.style}})})})});mb.displayName=fB;var hB="SelectPopperPosition",nh=m.forwardRef((e,t)=>{const{__scopeSelect:r,align:n="start",collisionPadding:s=un,...a}=e,i=_d(r);return l.jsx(ku,{...i,...a,ref:t,align:n,collisionPadding:s,style:{boxSizing:"border-box",...a.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});nh.displayName=hB;var[mB,V0]=ao(Oa,{}),sh="SelectViewport",pb=m.forwardRef((e,t)=>{const{__scopeSelect:r,nonce:n,...s}=e,a=na(sh,r),i=V0(sh,r),o=Me(t,a.onViewportChange),c=m.useRef(0);return l.jsxs(l.Fragment,{children:[l.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),l.jsx(yd.Slot,{scope:r,children:l.jsx(Ne.div,{"data-radix-select-viewport":"",role:"presentation",...s,ref:o,style:{position:"relative",flex:1,overflow:"hidden auto",...s.style},onScroll:he(s.onScroll,u=>{const d=u.currentTarget,{contentWrapper:f,shouldExpandOnScrollRef:h}=i;if(h!=null&&h.current&&f){const p=Math.abs(c.current-d.scrollTop);if(p>0){const v=window.innerHeight-un*2,g=parseFloat(f.style.minHeight),x=parseFloat(f.style.height),y=Math.max(g,x);if(y<v){const w=y+p,_=Math.min(v,w),b=w-_;f.style.height=_+"px",f.style.bottom==="0px"&&(d.scrollTop=b>0?b:0,f.style.justifyContent="flex-end")}}}c.current=d.scrollTop})})})]})});pb.displayName=sh;var gb="SelectGroup",[pB,gB]=ao(gb),xB=m.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,s=tn();return l.jsx(pB,{scope:r,id:s,children:l.jsx(Ne.div,{role:"group","aria-labelledby":s,...n,ref:t})})});xB.displayName=gb;var xb="SelectLabel",vb=m.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,s=gB(xb,r);return l.jsx(Ne.div,{id:s.id,...n,ref:t})});vb.displayName=xb;var xu="SelectItem",[vB,yb]=ao(xu),wb=m.forwardRef((e,t)=>{const{__scopeSelect:r,value:n,disabled:s=!1,textValue:a,...i}=e,o=ra(xu,r),c=na(xu,r),u=o.value===n,[d,f]=m.useState(a??""),[h,p]=m.useState(!1),v=Me(t,w=>{var _;return(_=c.itemRefCallback)==null?void 0:_.call(c,w,n,s)}),g=tn(),x=m.useRef("touch"),y=()=>{s||(o.onValueChange(n),o.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return l.jsx(vB,{scope:r,value:n,disabled:s,textId:g,isSelected:u,onItemTextChange:m.useCallback(w=>{f(_=>_||((w==null?void 0:w.textContent)??"").trim())},[]),children:l.jsx(yd.ItemSlot,{scope:r,value:n,disabled:s,textValue:d,children:l.jsx(Ne.div,{role:"option","aria-labelledby":g,"data-highlighted":h?"":void 0,"aria-selected":u&&h,"data-state":u?"checked":"unchecked","aria-disabled":s||void 0,"data-disabled":s?"":void 0,tabIndex:s?void 0:-1,...i,ref:v,onFocus:he(i.onFocus,()=>p(!0)),onBlur:he(i.onBlur,()=>p(!1)),onClick:he(i.onClick,()=>{x.current!=="mouse"&&y()}),onPointerUp:he(i.onPointerUp,()=>{x.current==="mouse"&&y()}),onPointerDown:he(i.onPointerDown,w=>{x.current=w.pointerType}),onPointerMove:he(i.onPointerMove,w=>{var _;x.current=w.pointerType,s?(_=c.onItemLeave)==null||_.call(c):x.current==="mouse"&&w.currentTarget.focus({preventScroll:!0})}),onPointerLeave:he(i.onPointerLeave,w=>{var _;w.currentTarget===document.activeElement&&((_=c.onItemLeave)==null||_.call(c))}),onKeyDown:he(i.onKeyDown,w=>{var b;((b=c.searchRef)==null?void 0:b.current)!==""&&w.key===" "||(sB.includes(w.key)&&y(),w.key===" "&&w.preventDefault())})})})})});wb.displayName=xu;var Eo="SelectItemText",_b=m.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:s,...a}=e,i=ra(Eo,r),o=na(Eo,r),c=yb(Eo,r),u=lB(Eo,r),[d,f]=m.useState(null),h=Me(t,y=>f(y),c.onItemTextChange,y=>{var w;return(w=o.itemTextRefCallback)==null?void 0:w.call(o,y,c.value,c.disabled)}),p=d==null?void 0:d.textContent,v=m.useMemo(()=>l.jsx("option",{value:c.value,disabled:c.disabled,children:p},c.value),[c.disabled,c.value,p]),{onNativeOptionAdd:g,onNativeOptionRemove:x}=u;return er(()=>(g(v),()=>x(v)),[g,x,v]),l.jsxs(l.Fragment,{children:[l.jsx(Ne.span,{id:c.textId,...a,ref:h}),c.isSelected&&i.valueNode&&!i.valueNodeHasChildren?Vr.createPortal(a.children,i.valueNode):null]})});_b.displayName=Eo;var bb="SelectItemIndicator",Sb=m.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return yb(bb,r).isSelected?l.jsx(Ne.span,{"aria-hidden":!0,...n,ref:t}):null});Sb.displayName=bb;var ah="SelectScrollUpButton",Eb=m.forwardRef((e,t)=>{const r=na(ah,e.__scopeSelect),n=V0(ah,e.__scopeSelect),[s,a]=m.useState(!1),i=Me(t,n.onScrollButtonChange);return er(()=>{if(r.viewport&&r.isPositioned){let o=function(){const u=c.scrollTop>0;a(u)};const c=r.viewport;return o(),c.addEventListener("scroll",o),()=>c.removeEventListener("scroll",o)}},[r.viewport,r.isPositioned]),s?l.jsx(Cb,{...e,ref:i,onAutoScroll:()=>{const{viewport:o,selectedItem:c}=r;o&&c&&(o.scrollTop=o.scrollTop-c.offsetHeight)}}):null});Eb.displayName=ah;var ih="SelectScrollDownButton",Tb=m.forwardRef((e,t)=>{const r=na(ih,e.__scopeSelect),n=V0(ih,e.__scopeSelect),[s,a]=m.useState(!1),i=Me(t,n.onScrollButtonChange);return er(()=>{if(r.viewport&&r.isPositioned){let o=function(){const u=c.scrollHeight-c.clientHeight,d=Math.ceil(c.scrollTop)<u;a(d)};const c=r.viewport;return o(),c.addEventListener("scroll",o),()=>c.removeEventListener("scroll",o)}},[r.viewport,r.isPositioned]),s?l.jsx(Cb,{...e,ref:i,onAutoScroll:()=>{const{viewport:o,selectedItem:c}=r;o&&c&&(o.scrollTop=o.scrollTop+c.offsetHeight)}}):null});Tb.displayName=ih;var Cb=m.forwardRef((e,t)=>{const{__scopeSelect:r,onAutoScroll:n,...s}=e,a=na("SelectScrollButton",r),i=m.useRef(null),o=wd(r),c=m.useCallback(()=>{i.current!==null&&(window.clearInterval(i.current),i.current=null)},[]);return m.useEffect(()=>()=>c(),[c]),er(()=>{var d;const u=o().find(f=>f.ref.current===document.activeElement);(d=u==null?void 0:u.ref.current)==null||d.scrollIntoView({block:"nearest"})},[o]),l.jsx(Ne.div,{"aria-hidden":!0,...s,ref:t,style:{flexShrink:0,...s.style},onPointerDown:he(s.onPointerDown,()=>{i.current===null&&(i.current=window.setInterval(n,50))}),onPointerMove:he(s.onPointerMove,()=>{var u;(u=a.onItemLeave)==null||u.call(a),i.current===null&&(i.current=window.setInterval(n,50))}),onPointerLeave:he(s.onPointerLeave,()=>{c()})})}),yB="SelectSeparator",kb=m.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return l.jsx(Ne.div,{"aria-hidden":!0,...n,ref:t})});kb.displayName=yB;var oh="SelectArrow",wB=m.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,s=_d(r),a=ra(oh,r),i=na(oh,r);return a.open&&i.position==="popper"?l.jsx(Pu,{...s,...n,ref:t}):null});wB.displayName=oh;function Pb(e){return e===""||e===void 0}var Ab=m.forwardRef((e,t)=>{const{value:r,...n}=e,s=m.useRef(null),a=Me(t,s),i=r0(r);return m.useEffect(()=>{const o=s.current,c=window.HTMLSelectElement.prototype,d=Object.getOwnPropertyDescriptor(c,"value").set;if(i!==r&&d){const f=new Event("change",{bubbles:!0});d.call(o,r),o.dispatchEvent(f)}},[i,r]),l.jsx(gl,{asChild:!0,children:l.jsx("select",{...n,ref:a,defaultValue:r})})});Ab.displayName="BubbleSelect";function Nb(e){const t=Et(e),r=m.useRef(""),n=m.useRef(0),s=m.useCallback(i=>{const o=r.current+i;t(o),function c(u){r.current=u,window.clearTimeout(n.current),u!==""&&(n.current=window.setTimeout(()=>c(""),1e3))}(o)},[t]),a=m.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return m.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,s,a]}function Db(e,t,r){const s=t.length>1&&Array.from(t).every(u=>u===t[0])?t[0]:t,a=r?e.indexOf(r):-1;let i=_B(e,Math.max(a,0));s.length===1&&(i=i.filter(u=>u!==r));const c=i.find(u=>u.textValue.toLowerCase().startsWith(s.toLowerCase()));return c!==r?c:void 0}function _B(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var bB=sb,jb=ib,SB=lb,EB=cb,TB=ub,Rb=db,CB=pb,Ob=vb,Ib=wb,kB=_b,PB=Sb,Mb=Eb,Fb=Tb,Lb=kb;const _a=bB,ba=SB,Fs=m.forwardRef(({className:e,children:t,...r},n)=>l.jsxs(jb,{ref:n,className:Pe("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...r,children:[t,l.jsx(EB,{asChild:!0,children:l.jsx(Ur,{className:"h-4 w-4 opacity-50"})})]}));Fs.displayName=jb.displayName;const Bb=m.forwardRef(({className:e,...t},r)=>l.jsx(Mb,{ref:r,className:Pe("flex cursor-default items-center justify-center py-1",e),...t,children:l.jsx(Z2,{className:"h-4 w-4"})}));Bb.displayName=Mb.displayName;const $b=m.forwardRef(({className:e,...t},r)=>l.jsx(Fb,{ref:r,className:Pe("flex cursor-default items-center justify-center py-1",e),...t,children:l.jsx(Ur,{className:"h-4 w-4"})}));$b.displayName=Fb.displayName;const Ls=m.forwardRef(({className:e,children:t,position:r="popper",...n},s)=>l.jsx(TB,{children:l.jsxs(Rb,{ref:s,className:Pe("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...n,children:[l.jsx(Bb,{}),l.jsx(CB,{className:Pe("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),l.jsx($b,{})]})}));Ls.displayName=Rb.displayName;const AB=m.forwardRef(({className:e,...t},r)=>l.jsx(Ob,{ref:r,className:Pe("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));AB.displayName=Ob.displayName;const jt=m.forwardRef(({className:e,children:t,...r},n)=>l.jsxs(Ib,{ref:n,className:Pe("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[l.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:l.jsx(PB,{children:l.jsx(pr,{className:"h-4 w-4"})})}),l.jsx(kB,{children:t})]}));jt.displayName=Ib.displayName;const NB=m.forwardRef(({className:e,...t},r)=>l.jsx(Lb,{ref:r,className:Pe("-mx-1 my-1 h-px bg-muted",e),...t}));NB.displayName=Lb.displayName;var xg=1,DB=.9,jB=.8,RB=.17,uf=.1,df=.999,OB=.9999,IB=.99,MB=/[\\\/_+.#"@\[\(\{&]/,FB=/[\\\/_+.#"@\[\(\{&]/g,LB=/[\s-]/,Wb=/[\s-]/g;function lh(e,t,r,n,s,a,i){if(a===t.length)return s===e.length?xg:IB;var o=`${s},${a}`;if(i[o]!==void 0)return i[o];for(var c=n.charAt(a),u=r.indexOf(c,s),d=0,f,h,p,v;u>=0;)f=lh(e,t,r,n,u+1,a+1,i),f>d&&(u===s?f*=xg:MB.test(e.charAt(u-1))?(f*=jB,p=e.slice(s,u-1).match(FB),p&&s>0&&(f*=Math.pow(df,p.length))):LB.test(e.charAt(u-1))?(f*=DB,v=e.slice(s,u-1).match(Wb),v&&s>0&&(f*=Math.pow(df,v.length))):(f*=RB,s>0&&(f*=Math.pow(df,u-s))),e.charAt(u)!==t.charAt(a)&&(f*=OB)),(f<uf&&r.charAt(u-1)===n.charAt(a+1)||n.charAt(a+1)===n.charAt(a)&&r.charAt(u-1)!==n.charAt(a))&&(h=lh(e,t,r,n,u+1,a+2,i),h*uf>f&&(f=h*uf)),f>d&&(d=f),u=r.indexOf(c,u+1);return i[o]=d,d}function vg(e){return e.toLowerCase().replace(Wb," ")}function BB(e,t,r){return e=r&&r.length>0?`${e+" "+r.join(" ")}`:e,lh(e,t,vg(e),vg(t),0,0,{})}function _i(e,t,{checkForDefaultPrevented:r=!0}={}){return function(s){if(e==null||e(s),r===!1||!s.defaultPrevented)return t==null?void 0:t(s)}}function $B(e,t){typeof e=="function"?e(t):e!=null&&(e.current=t)}function Ub(...e){return t=>e.forEach(r=>$B(r,t))}function Vl(...e){return m.useCallback(Ub(...e),e)}function WB(e,t=[]){let r=[];function n(a,i){const o=m.createContext(i),c=r.length;r=[...r,i];function u(f){const{scope:h,children:p,...v}=f,g=(h==null?void 0:h[e][c])||o,x=m.useMemo(()=>v,Object.values(v));return m.createElement(g.Provider,{value:x},p)}function d(f,h){const p=(h==null?void 0:h[e][c])||o,v=m.useContext(p);if(v)return v;if(i!==void 0)return i;throw new Error(`\`${f}\` must be used within \`${a}\``)}return u.displayName=a+"Provider",[u,d]}const s=()=>{const a=r.map(i=>m.createContext(i));return function(o){const c=(o==null?void 0:o[e])||a;return m.useMemo(()=>({[`__scope${e}`]:{...o,[e]:c}}),[o,c])}};return s.scopeName=e,[n,UB(s,...t)]}function UB(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(a){const i=n.reduce((o,{useScope:c,scopeName:u})=>{const f=c(a)[`__scope${u}`];return{...o,...f}},{});return m.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return r.scopeName=t.scopeName,r}const ch=globalThis!=null&&globalThis.document?m.useLayoutEffect:()=>{},VB=$g.useId||(()=>{});let HB=0;function ff(e){const[t,r]=m.useState(VB());return ch(()=>{e||r(n=>n??String(HB++))},[e]),e||(t?`radix-${t}`:"")}function Ia(e){const t=m.useRef(e);return m.useEffect(()=>{t.current=e}),m.useMemo(()=>(...r)=>{var n;return(n=t.current)===null||n===void 0?void 0:n.call(t,...r)},[])}function zB({prop:e,defaultProp:t,onChange:r=()=>{}}){const[n,s]=GB({defaultProp:t,onChange:r}),a=e!==void 0,i=a?e:n,o=Ia(r),c=m.useCallback(u=>{if(a){const f=typeof u=="function"?u(e):u;f!==e&&o(f)}else s(u)},[a,e,s,o]);return[i,c]}function GB({defaultProp:e,onChange:t}){const r=m.useState(e),[n]=r,s=m.useRef(n),a=Ia(t);return m.useEffect(()=>{s.current!==n&&(a(n),s.current=n)},[n,s,a]),r}const H0=m.forwardRef((e,t)=>{const{children:r,...n}=e,s=m.Children.toArray(r),a=s.find(YB);if(a){const i=a.props.children,o=s.map(c=>c===a?m.Children.count(i)>1?m.Children.only(null):m.isValidElement(i)?i.props.children:null:c);return m.createElement(uh,zr({},n,{ref:t}),m.isValidElement(i)?m.cloneElement(i,void 0,o):null)}return m.createElement(uh,zr({},n,{ref:t}),r)});H0.displayName="Slot";const uh=m.forwardRef((e,t)=>{const{children:r,...n}=e;return m.isValidElement(r)?m.cloneElement(r,{...XB(n,r.props),ref:t?Ub(t,r.ref):r.ref}):m.Children.count(r)>1?m.Children.only(null):null});uh.displayName="SlotClone";const KB=({children:e})=>m.createElement(m.Fragment,null,e);function YB(e){return m.isValidElement(e)&&e.type===KB}function XB(e,t){const r={...t};for(const n in t){const s=e[n],a=t[n];/^on[A-Z]/.test(n)?s&&a?r[n]=(...o)=>{a(...o),s(...o)}:s&&(r[n]=s):n==="style"?r[n]={...s,...a}:n==="className"&&(r[n]=[s,a].filter(Boolean).join(" "))}return{...e,...r}}const qB=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],on=qB.reduce((e,t)=>{const r=m.forwardRef((n,s)=>{const{asChild:a,...i}=n,o=a?H0:t;return m.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),m.createElement(o,zr({},i,{ref:s}))});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function JB(e,t){e&&Vr.flushSync(()=>e.dispatchEvent(t))}function QB(e,t=globalThis==null?void 0:globalThis.document){const r=Ia(e);m.useEffect(()=>{const n=s=>{s.key==="Escape"&&r(s)};return t.addEventListener("keydown",n),()=>t.removeEventListener("keydown",n)},[r,t])}const dh="dismissableLayer.update",ZB="dismissableLayer.pointerDownOutside",e$="dismissableLayer.focusOutside";let yg;const t$=m.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),r$=m.forwardRef((e,t)=>{var r;const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:s,onPointerDownOutside:a,onFocusOutside:i,onInteractOutside:o,onDismiss:c,...u}=e,d=m.useContext(t$),[f,h]=m.useState(null),p=(r=f==null?void 0:f.ownerDocument)!==null&&r!==void 0?r:globalThis==null?void 0:globalThis.document,[,v]=m.useState({}),g=Vl(t,E=>h(E)),x=Array.from(d.layers),[y]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),w=x.indexOf(y),_=f?x.indexOf(f):-1,b=d.layersWithOutsidePointerEventsDisabled.size>0,T=_>=w,k=n$(E=>{const C=E.target,L=[...d.branches].some(M=>M.contains(C));!T||L||(a==null||a(E),o==null||o(E),E.defaultPrevented||c==null||c())},p),S=s$(E=>{const C=E.target;[...d.branches].some(M=>M.contains(C))||(i==null||i(E),o==null||o(E),E.defaultPrevented||c==null||c())},p);return QB(E=>{_===d.layers.size-1&&(s==null||s(E),!E.defaultPrevented&&c&&(E.preventDefault(),c()))},p),m.useEffect(()=>{if(f)return n&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(yg=p.body.style.pointerEvents,p.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(f)),d.layers.add(f),wg(),()=>{n&&d.layersWithOutsidePointerEventsDisabled.size===1&&(p.body.style.pointerEvents=yg)}},[f,p,n,d]),m.useEffect(()=>()=>{f&&(d.layers.delete(f),d.layersWithOutsidePointerEventsDisabled.delete(f),wg())},[f,d]),m.useEffect(()=>{const E=()=>v({});return document.addEventListener(dh,E),()=>document.removeEventListener(dh,E)},[]),m.createElement(on.div,zr({},u,{ref:g,style:{pointerEvents:b?T?"auto":"none":void 0,...e.style},onFocusCapture:_i(e.onFocusCapture,S.onFocusCapture),onBlurCapture:_i(e.onBlurCapture,S.onBlurCapture),onPointerDownCapture:_i(e.onPointerDownCapture,k.onPointerDownCapture)}))});function n$(e,t=globalThis==null?void 0:globalThis.document){const r=Ia(e),n=m.useRef(!1),s=m.useRef(()=>{});return m.useEffect(()=>{const a=o=>{if(o.target&&!n.current){let u=function(){Vb(ZB,r,c,{discrete:!0})};const c={originalEvent:o};o.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=u,t.addEventListener("click",s.current,{once:!0})):u()}else t.removeEventListener("click",s.current);n.current=!1},i=window.setTimeout(()=>{t.addEventListener("pointerdown",a)},0);return()=>{window.clearTimeout(i),t.removeEventListener("pointerdown",a),t.removeEventListener("click",s.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function s$(e,t=globalThis==null?void 0:globalThis.document){const r=Ia(e),n=m.useRef(!1);return m.useEffect(()=>{const s=a=>{a.target&&!n.current&&Vb(e$,r,{originalEvent:a},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function wg(){const e=new CustomEvent(dh);document.dispatchEvent(e)}function Vb(e,t,r,{discrete:n}){const s=r.originalEvent.target,a=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&s.addEventListener(e,t,{once:!0}),n?JB(s,a):s.dispatchEvent(a)}const hf="focusScope.autoFocusOnMount",mf="focusScope.autoFocusOnUnmount",_g={bubbles:!1,cancelable:!0},a$=m.forwardRef((e,t)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:s,onUnmountAutoFocus:a,...i}=e,[o,c]=m.useState(null),u=Ia(s),d=Ia(a),f=m.useRef(null),h=Vl(t,g=>c(g)),p=m.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;m.useEffect(()=>{if(n){let g=function(_){if(p.paused||!o)return;const b=_.target;o.contains(b)?f.current=b:Ss(f.current,{select:!0})},x=function(_){if(p.paused||!o)return;const b=_.relatedTarget;b!==null&&(o.contains(b)||Ss(f.current,{select:!0}))},y=function(_){if(document.activeElement===document.body)for(const T of _)T.removedNodes.length>0&&Ss(o)};document.addEventListener("focusin",g),document.addEventListener("focusout",x);const w=new MutationObserver(y);return o&&w.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",g),document.removeEventListener("focusout",x),w.disconnect()}}},[n,o,p.paused]),m.useEffect(()=>{if(o){Sg.add(p);const g=document.activeElement;if(!o.contains(g)){const y=new CustomEvent(hf,_g);o.addEventListener(hf,u),o.dispatchEvent(y),y.defaultPrevented||(i$(d$(Hb(o)),{select:!0}),document.activeElement===g&&Ss(o))}return()=>{o.removeEventListener(hf,u),setTimeout(()=>{const y=new CustomEvent(mf,_g);o.addEventListener(mf,d),o.dispatchEvent(y),y.defaultPrevented||Ss(g??document.body,{select:!0}),o.removeEventListener(mf,d),Sg.remove(p)},0)}}},[o,u,d,p]);const v=m.useCallback(g=>{if(!r&&!n||p.paused)return;const x=g.key==="Tab"&&!g.altKey&&!g.ctrlKey&&!g.metaKey,y=document.activeElement;if(x&&y){const w=g.currentTarget,[_,b]=o$(w);_&&b?!g.shiftKey&&y===b?(g.preventDefault(),r&&Ss(_,{select:!0})):g.shiftKey&&y===_&&(g.preventDefault(),r&&Ss(b,{select:!0})):y===w&&g.preventDefault()}},[r,n,p.paused]);return m.createElement(on.div,zr({tabIndex:-1},i,{ref:h,onKeyDown:v}))});function i$(e,{select:t=!1}={}){const r=document.activeElement;for(const n of e)if(Ss(n,{select:t}),document.activeElement!==r)return}function o$(e){const t=Hb(e),r=bg(t,e),n=bg(t.reverse(),e);return[r,n]}function Hb(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const s=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||s?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function bg(e,t){for(const r of e)if(!l$(r,{upTo:t}))return r}function l$(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function c$(e){return e instanceof HTMLInputElement&&"select"in e}function Ss(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&c$(e)&&t&&e.select()}}const Sg=u$();function u$(){let e=[];return{add(t){const r=e[0];t!==r&&(r==null||r.pause()),e=Eg(e,t),e.unshift(t)},remove(t){var r;e=Eg(e,t),(r=e[0])===null||r===void 0||r.resume()}}}function Eg(e,t){const r=[...e],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function d$(e){return e.filter(t=>t.tagName!=="A")}const f$=m.forwardRef((e,t)=>{var r;const{container:n=globalThis==null||(r=globalThis.document)===null||r===void 0?void 0:r.body,...s}=e;return n?vh.createPortal(m.createElement(on.div,zr({},s,{ref:t})),n):null});function h$(e,t){return m.useReducer((r,n)=>{const s=t[r][n];return s??r},e)}const bd=e=>{const{present:t,children:r}=e,n=m$(t),s=typeof r=="function"?r({present:n.isPresent}):m.Children.only(r),a=Vl(n.ref,s.ref);return typeof r=="function"||n.isPresent?m.cloneElement(s,{ref:a}):null};bd.displayName="Presence";function m$(e){const[t,r]=m.useState(),n=m.useRef({}),s=m.useRef(e),a=m.useRef("none"),i=e?"mounted":"unmounted",[o,c]=h$(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return m.useEffect(()=>{const u=vc(n.current);a.current=o==="mounted"?u:"none"},[o]),ch(()=>{const u=n.current,d=s.current;if(d!==e){const h=a.current,p=vc(u);e?c("MOUNT"):p==="none"||(u==null?void 0:u.display)==="none"?c("UNMOUNT"):c(d&&h!==p?"ANIMATION_OUT":"UNMOUNT"),s.current=e}},[e,c]),ch(()=>{if(t){const u=f=>{const p=vc(n.current).includes(f.animationName);f.target===t&&p&&Vr.flushSync(()=>c("ANIMATION_END"))},d=f=>{f.target===t&&(a.current=vc(n.current))};return t.addEventListener("animationstart",d),t.addEventListener("animationcancel",u),t.addEventListener("animationend",u),()=>{t.removeEventListener("animationstart",d),t.removeEventListener("animationcancel",u),t.removeEventListener("animationend",u)}}else c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(o),ref:m.useCallback(u=>{u&&(n.current=getComputedStyle(u)),r(u)},[])}}function vc(e){return(e==null?void 0:e.animationName)||"none"}let pf=0;function p$(){m.useEffect(()=>{var e,t;const r=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",(e=r[0])!==null&&e!==void 0?e:Tg()),document.body.insertAdjacentElement("beforeend",(t=r[1])!==null&&t!==void 0?t:Tg()),pf++,()=>{pf===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(n=>n.remove()),pf--}},[])}function Tg(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",e}var zb=Qv(),gf=function(){},Sd=m.forwardRef(function(e,t){var r=m.useRef(null),n=m.useState({onScrollCapture:gf,onWheelCapture:gf,onTouchMoveCapture:gf}),s=n[0],a=n[1],i=e.forwardProps,o=e.children,c=e.className,u=e.removeScrollBar,d=e.enabled,f=e.shards,h=e.sideCar,p=e.noIsolation,v=e.inert,g=e.allowPinchZoom,x=e.as,y=x===void 0?"div":x,w=qh(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),_=h,b=Jv([r,t]),T=ar(ar({},w),s);return m.createElement(m.Fragment,null,d&&m.createElement(_,{sideCar:zb,removeScrollBar:u,shards:f,noIsolation:p,inert:v,setCallbacks:a,allowPinchZoom:!!g,lockRef:r}),i?m.cloneElement(m.Children.only(o),ar(ar({},T),{ref:b})):m.createElement(y,ar({},T,{className:c,ref:b}),o))});Sd.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Sd.classNames={fullWidth:No,zeroRight:Ao};var fh=!1;if(typeof window<"u")try{var yc=Object.defineProperty({},"passive",{get:function(){return fh=!0,!0}});window.addEventListener("test",yc,yc),window.removeEventListener("test",yc,yc)}catch{fh=!1}var ii=fh?{passive:!1}:!1,g$=function(e){return e.tagName==="TEXTAREA"},Gb=function(e,t){var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!g$(e)&&r[t]==="visible")},x$=function(e){return Gb(e,"overflowY")},v$=function(e){return Gb(e,"overflowX")},Cg=function(e,t){var r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var n=Kb(e,r);if(n){var s=Yb(e,r),a=s[1],i=s[2];if(a>i)return!0}r=r.parentNode}while(r&&r!==document.body);return!1},y$=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},w$=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},Kb=function(e,t){return e==="v"?x$(t):v$(t)},Yb=function(e,t){return e==="v"?y$(t):w$(t)},_$=function(e,t){return e==="h"&&t==="rtl"?-1:1},b$=function(e,t,r,n,s){var a=_$(e,window.getComputedStyle(t).direction),i=a*n,o=r.target,c=t.contains(o),u=!1,d=i>0,f=0,h=0;do{var p=Yb(e,o),v=p[0],g=p[1],x=p[2],y=g-x-a*v;(v||y)&&Kb(e,o)&&(f+=y,h+=v),o=o.parentNode}while(!c&&o!==document.body||c&&(t.contains(o)||t===o));return(d&&(f===0||!s)||!d&&(h===0||!s))&&(u=!0),u},wc=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},kg=function(e){return[e.deltaX,e.deltaY]},Pg=function(e){return e&&"current"in e?e.current:e},S$=function(e,t){return e[0]===t[0]&&e[1]===t[1]},E$=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},T$=0,oi=[];function C$(e){var t=m.useRef([]),r=m.useRef([0,0]),n=m.useRef(),s=m.useState(T$++)[0],a=m.useState(function(){return Jh()})[0],i=m.useRef(e);m.useEffect(function(){i.current=e},[e]),m.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(s));var g=qv([e.lockRef.current],(e.shards||[]).map(Pg),!0).filter(Boolean);return g.forEach(function(x){return x.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),g.forEach(function(x){return x.classList.remove("allow-interactivity-".concat(s))})}}},[e.inert,e.lockRef.current,e.shards]);var o=m.useCallback(function(g,x){if("touches"in g&&g.touches.length===2)return!i.current.allowPinchZoom;var y=wc(g),w=r.current,_="deltaX"in g?g.deltaX:w[0]-y[0],b="deltaY"in g?g.deltaY:w[1]-y[1],T,k=g.target,S=Math.abs(_)>Math.abs(b)?"h":"v";if("touches"in g&&S==="h"&&k.type==="range")return!1;var E=Cg(S,k);if(!E)return!0;if(E?T=S:(T=S==="v"?"h":"v",E=Cg(S,k)),!E)return!1;if(!n.current&&"changedTouches"in g&&(_||b)&&(n.current=T),!T)return!0;var C=n.current||T;return b$(C,x,g,C==="h"?_:b,!0)},[]),c=m.useCallback(function(g){var x=g;if(!(!oi.length||oi[oi.length-1]!==a)){var y="deltaY"in x?kg(x):wc(x),w=t.current.filter(function(T){return T.name===x.type&&T.target===x.target&&S$(T.delta,y)})[0];if(w&&w.should){x.cancelable&&x.preventDefault();return}if(!w){var _=(i.current.shards||[]).map(Pg).filter(Boolean).filter(function(T){return T.contains(x.target)}),b=_.length>0?o(x,_[0]):!i.current.noIsolation;b&&x.cancelable&&x.preventDefault()}}},[]),u=m.useCallback(function(g,x,y,w){var _={name:g,delta:x,target:y,should:w};t.current.push(_),setTimeout(function(){t.current=t.current.filter(function(b){return b!==_})},1)},[]),d=m.useCallback(function(g){r.current=wc(g),n.current=void 0},[]),f=m.useCallback(function(g){u(g.type,kg(g),g.target,o(g,e.lockRef.current))},[]),h=m.useCallback(function(g){u(g.type,wc(g),g.target,o(g,e.lockRef.current))},[]);m.useEffect(function(){return oi.push(a),e.setCallbacks({onScrollCapture:f,onWheelCapture:f,onTouchMoveCapture:h}),document.addEventListener("wheel",c,ii),document.addEventListener("touchmove",c,ii),document.addEventListener("touchstart",d,ii),function(){oi=oi.filter(function(g){return g!==a}),document.removeEventListener("wheel",c,ii),document.removeEventListener("touchmove",c,ii),document.removeEventListener("touchstart",d,ii)}},[]);var p=e.removeScrollBar,v=e.inert;return m.createElement(m.Fragment,null,v?m.createElement(a,{styles:E$(s)}):null,p?m.createElement(r1,{gapMode:"margin"}):null)}const k$=e1(zb,C$);var Xb=m.forwardRef(function(e,t){return m.createElement(Sd,ar({},e,{ref:t,sideCar:k$}))});Xb.classNames=Sd.classNames;const qb="Dialog",[Jb,OW]=WB(qb),[P$,Ya]=Jb(qb),A$=e=>{const{__scopeDialog:t,children:r,open:n,defaultOpen:s,onOpenChange:a,modal:i=!0}=e,o=m.useRef(null),c=m.useRef(null),[u=!1,d]=zB({prop:n,defaultProp:s,onChange:a});return m.createElement(P$,{scope:t,triggerRef:o,contentRef:c,contentId:ff(),titleId:ff(),descriptionId:ff(),open:u,onOpenChange:d,onOpenToggle:m.useCallback(()=>d(f=>!f),[d]),modal:i},r)},Qb="DialogPortal",[N$,Zb]=Jb(Qb,{forceMount:void 0}),D$=e=>{const{__scopeDialog:t,forceMount:r,children:n,container:s}=e,a=Ya(Qb,t);return m.createElement(N$,{scope:t,forceMount:r},m.Children.map(n,i=>m.createElement(bd,{present:r||a.open},m.createElement(f$,{asChild:!0,container:s},i))))},hh="DialogOverlay",j$=m.forwardRef((e,t)=>{const r=Zb(hh,e.__scopeDialog),{forceMount:n=r.forceMount,...s}=e,a=Ya(hh,e.__scopeDialog);return a.modal?m.createElement(bd,{present:n||a.open},m.createElement(R$,zr({},s,{ref:t}))):null}),R$=m.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=Ya(hh,r);return m.createElement(Xb,{as:H0,allowPinchZoom:!0,shards:[s.contentRef]},m.createElement(on.div,zr({"data-state":tS(s.open)},n,{ref:t,style:{pointerEvents:"auto",...n.style}})))}),dl="DialogContent",O$=m.forwardRef((e,t)=>{const r=Zb(dl,e.__scopeDialog),{forceMount:n=r.forceMount,...s}=e,a=Ya(dl,e.__scopeDialog);return m.createElement(bd,{present:n||a.open},a.modal?m.createElement(I$,zr({},s,{ref:t})):m.createElement(M$,zr({},s,{ref:t})))}),I$=m.forwardRef((e,t)=>{const r=Ya(dl,e.__scopeDialog),n=m.useRef(null),s=Vl(t,r.contentRef,n);return m.useEffect(()=>{const a=n.current;if(a)return Pl(a)},[]),m.createElement(eS,zr({},e,{ref:s,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:_i(e.onCloseAutoFocus,a=>{var i;a.preventDefault(),(i=r.triggerRef.current)===null||i===void 0||i.focus()}),onPointerDownOutside:_i(e.onPointerDownOutside,a=>{const i=a.detail.originalEvent,o=i.button===0&&i.ctrlKey===!0;(i.button===2||o)&&a.preventDefault()}),onFocusOutside:_i(e.onFocusOutside,a=>a.preventDefault())}))}),M$=m.forwardRef((e,t)=>{const r=Ya(dl,e.__scopeDialog),n=m.useRef(!1),s=m.useRef(!1);return m.createElement(eS,zr({},e,{ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:a=>{var i;if((i=e.onCloseAutoFocus)===null||i===void 0||i.call(e,a),!a.defaultPrevented){var o;n.current||(o=r.triggerRef.current)===null||o===void 0||o.focus(),a.preventDefault()}n.current=!1,s.current=!1},onInteractOutside:a=>{var i,o;(i=e.onInteractOutside)===null||i===void 0||i.call(e,a),a.defaultPrevented||(n.current=!0,a.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const c=a.target;((o=r.triggerRef.current)===null||o===void 0?void 0:o.contains(c))&&a.preventDefault(),a.detail.originalEvent.type==="focusin"&&s.current&&a.preventDefault()}}))}),eS=m.forwardRef((e,t)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:s,onCloseAutoFocus:a,...i}=e,o=Ya(dl,r),c=m.useRef(null),u=Vl(t,c);return p$(),m.createElement(m.Fragment,null,m.createElement(a$,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:s,onUnmountAutoFocus:a},m.createElement(r$,zr({role:"dialog",id:o.contentId,"aria-describedby":o.descriptionId,"aria-labelledby":o.titleId,"data-state":tS(o.open)},i,{ref:u,onDismiss:()=>o.onOpenChange(!1)}))),!1)});function tS(e){return e?"open":"closed"}const F$=A$,L$=D$,B$=j$,$$=O$;var yo='[cmdk-group=""]',xf='[cmdk-group-items=""]',W$='[cmdk-group-heading=""]',z0='[cmdk-item=""]',Ag=`${z0}:not([aria-disabled="true"])`,mh="cmdk-item-select",pa="data-value",U$=(e,t,r)=>BB(e,t,r),rS=m.createContext(void 0),Hl=()=>m.useContext(rS),nS=m.createContext(void 0),G0=()=>m.useContext(nS),sS=m.createContext(void 0),aS=m.forwardRef((e,t)=>{let r=fi(()=>{var X,le;return{search:"",value:(le=(X=e.value)!=null?X:e.defaultValue)!=null?le:"",filtered:{count:0,items:new Map,groups:new Set}}}),n=fi(()=>new Set),s=fi(()=>new Map),a=fi(()=>new Map),i=fi(()=>new Set),o=iS(e),{label:c,children:u,value:d,onValueChange:f,filter:h,shouldFilter:p,loop:v,disablePointerSelection:g=!1,vimBindings:x=!0,...y}=e,w=m.useId(),_=m.useId(),b=m.useId(),T=m.useRef(null),k=Z$();Ma(()=>{if(d!==void 0){let X=d.trim();r.current.value=X,S.emit()}},[d]),Ma(()=>{k(6,V)},[]);let S=m.useMemo(()=>({subscribe:X=>(i.current.add(X),()=>i.current.delete(X)),snapshot:()=>r.current,setState:(X,le,D)=>{var K,U,I;if(!Object.is(r.current[X],le)){if(r.current[X]=le,X==="search")j(),L(),k(1,M);else if(X==="value"&&(D||k(5,V),((K=o.current)==null?void 0:K.value)!==void 0)){let ee=le??"";(I=(U=o.current).onValueChange)==null||I.call(U,ee);return}S.emit()}},emit:()=>{i.current.forEach(X=>X())}}),[]),E=m.useMemo(()=>({value:(X,le,D)=>{var K;le!==((K=a.current.get(X))==null?void 0:K.value)&&(a.current.set(X,{value:le,keywords:D}),r.current.filtered.items.set(X,C(le,D)),k(2,()=>{L(),S.emit()}))},item:(X,le)=>(n.current.add(X),le&&(s.current.has(le)?s.current.get(le).add(X):s.current.set(le,new Set([X]))),k(3,()=>{j(),L(),r.current.value||M(),S.emit()}),()=>{a.current.delete(X),n.current.delete(X),r.current.filtered.items.delete(X);let D=A();k(4,()=>{j(),(D==null?void 0:D.getAttribute("id"))===X&&M(),S.emit()})}),group:X=>(s.current.has(X)||s.current.set(X,new Set),()=>{a.current.delete(X),s.current.delete(X)}),filter:()=>o.current.shouldFilter,label:c||e["aria-label"],disablePointerSelection:g,listId:w,inputId:b,labelId:_,listInnerRef:T}),[]);function C(X,le){var D,K;let U=(K=(D=o.current)==null?void 0:D.filter)!=null?K:U$;return X?U(X,r.current.search,le):0}function L(){if(!r.current.search||o.current.shouldFilter===!1)return;let X=r.current.filtered.items,le=[];r.current.filtered.groups.forEach(K=>{let U=s.current.get(K),I=0;U.forEach(ee=>{let z=X.get(ee);I=Math.max(z,I)}),le.push([K,I])});let D=T.current;H().sort((K,U)=>{var I,ee;let z=K.getAttribute("id"),R=U.getAttribute("id");return((I=X.get(R))!=null?I:0)-((ee=X.get(z))!=null?ee:0)}).forEach(K=>{let U=K.closest(xf);U?U.appendChild(K.parentElement===U?K:K.closest(`${xf} > *`)):D.appendChild(K.parentElement===D?K:K.closest(`${xf} > *`))}),le.sort((K,U)=>U[1]-K[1]).forEach(K=>{let U=T.current.querySelector(`${yo}[${pa}="${encodeURIComponent(K[0])}"]`);U==null||U.parentElement.appendChild(U)})}function M(){let X=H().find(D=>D.getAttribute("aria-disabled")!=="true"),le=X==null?void 0:X.getAttribute(pa);S.setState("value",le||void 0)}function j(){var X,le,D,K;if(!r.current.search||o.current.shouldFilter===!1){r.current.filtered.count=n.current.size;return}r.current.filtered.groups=new Set;let U=0;for(let I of n.current){let ee=(le=(X=a.current.get(I))==null?void 0:X.value)!=null?le:"",z=(K=(D=a.current.get(I))==null?void 0:D.keywords)!=null?K:[],R=C(ee,z);r.current.filtered.items.set(I,R),R>0&&U++}for(let[I,ee]of s.current)for(let z of ee)if(r.current.filtered.items.get(z)>0){r.current.filtered.groups.add(I);break}r.current.filtered.count=U}function V(){var X,le,D;let K=A();K&&(((X=K.parentElement)==null?void 0:X.firstChild)===K&&((D=(le=K.closest(yo))==null?void 0:le.querySelector(W$))==null||D.scrollIntoView({block:"nearest"})),K.scrollIntoView({block:"nearest"}))}function A(){var X;return(X=T.current)==null?void 0:X.querySelector(`${z0}[aria-selected="true"]`)}function H(){var X;return Array.from((X=T.current)==null?void 0:X.querySelectorAll(Ag))}function G(X){let le=H()[X];le&&S.setState("value",le.getAttribute(pa))}function q(X){var le;let D=A(),K=H(),U=K.findIndex(ee=>ee===D),I=K[U+X];(le=o.current)!=null&&le.loop&&(I=U+X<0?K[K.length-1]:U+X===K.length?K[0]:K[U+X]),I&&S.setState("value",I.getAttribute(pa))}function Y(X){let le=A(),D=le==null?void 0:le.closest(yo),K;for(;D&&!K;)D=X>0?J$(D,yo):Q$(D,yo),K=D==null?void 0:D.querySelector(Ag);K?S.setState("value",K.getAttribute(pa)):q(X)}let Q=()=>G(H().length-1),fe=X=>{X.preventDefault(),X.metaKey?Q():X.altKey?Y(1):q(1)},oe=X=>{X.preventDefault(),X.metaKey?G(0):X.altKey?Y(-1):q(-1)};return m.createElement(on.div,{ref:t,tabIndex:-1,...y,"cmdk-root":"",onKeyDown:X=>{var le;if((le=y.onKeyDown)==null||le.call(y,X),!X.defaultPrevented)switch(X.key){case"n":case"j":{x&&X.ctrlKey&&fe(X);break}case"ArrowDown":{fe(X);break}case"p":case"k":{x&&X.ctrlKey&&oe(X);break}case"ArrowUp":{oe(X);break}case"Home":{X.preventDefault(),G(0);break}case"End":{X.preventDefault(),Q();break}case"Enter":if(!X.nativeEvent.isComposing&&X.keyCode!==229){X.preventDefault();let D=A();if(D){let K=new Event(mh);D.dispatchEvent(K)}}}}},m.createElement("label",{"cmdk-label":"",htmlFor:E.inputId,id:E.labelId,style:t7},c),Ed(e,X=>m.createElement(nS.Provider,{value:S},m.createElement(rS.Provider,{value:E},X))))}),V$=m.forwardRef((e,t)=>{var r,n;let s=m.useId(),a=m.useRef(null),i=m.useContext(sS),o=Hl(),c=iS(e),u=(n=(r=c.current)==null?void 0:r.forceMount)!=null?n:i==null?void 0:i.forceMount;Ma(()=>{if(!u)return o.item(s,i==null?void 0:i.id)},[u]);let d=oS(s,a,[e.value,e.children,a],e.keywords),f=G0(),h=Fa(k=>k.value&&k.value===d.current),p=Fa(k=>u||o.filter()===!1?!0:k.search?k.filtered.items.get(s)>0:!0);m.useEffect(()=>{let k=a.current;if(!(!k||e.disabled))return k.addEventListener(mh,v),()=>k.removeEventListener(mh,v)},[p,e.onSelect,e.disabled]);function v(){var k,S;g(),(S=(k=c.current).onSelect)==null||S.call(k,d.current)}function g(){f.setState("value",d.current,!0)}if(!p)return null;let{disabled:x,value:y,onSelect:w,forceMount:_,keywords:b,...T}=e;return m.createElement(on.div,{ref:fl([a,t]),...T,id:s,"cmdk-item":"",role:"option","aria-disabled":!!x,"aria-selected":!!h,"data-disabled":!!x,"data-selected":!!h,onPointerMove:x||o.disablePointerSelection?void 0:g,onClick:x?void 0:v},e.children)}),H$=m.forwardRef((e,t)=>{let{heading:r,children:n,forceMount:s,...a}=e,i=m.useId(),o=m.useRef(null),c=m.useRef(null),u=m.useId(),d=Hl(),f=Fa(p=>s||d.filter()===!1?!0:p.search?p.filtered.groups.has(i):!0);Ma(()=>d.group(i),[]),oS(i,o,[e.value,e.heading,c]);let h=m.useMemo(()=>({id:i,forceMount:s}),[s]);return m.createElement(on.div,{ref:fl([o,t]),...a,"cmdk-group":"",role:"presentation",hidden:f?void 0:!0},r&&m.createElement("div",{ref:c,"cmdk-group-heading":"","aria-hidden":!0,id:u},r),Ed(e,p=>m.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?u:void 0},m.createElement(sS.Provider,{value:h},p))))}),z$=m.forwardRef((e,t)=>{let{alwaysRender:r,...n}=e,s=m.useRef(null),a=Fa(i=>!i.search);return!r&&!a?null:m.createElement(on.div,{ref:fl([s,t]),...n,"cmdk-separator":"",role:"separator"})}),G$=m.forwardRef((e,t)=>{let{onValueChange:r,...n}=e,s=e.value!=null,a=G0(),i=Fa(d=>d.search),o=Fa(d=>d.value),c=Hl(),u=m.useMemo(()=>{var d;let f=(d=c.listInnerRef.current)==null?void 0:d.querySelector(`${z0}[${pa}="${encodeURIComponent(o)}"]`);return f==null?void 0:f.getAttribute("id")},[]);return m.useEffect(()=>{e.value!=null&&a.setState("search",e.value)},[e.value]),m.createElement(on.input,{ref:t,...n,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":c.listId,"aria-labelledby":c.labelId,"aria-activedescendant":u,id:c.inputId,type:"text",value:s?e.value:i,onChange:d=>{s||a.setState("search",d.target.value),r==null||r(d.target.value)}})}),K$=m.forwardRef((e,t)=>{let{children:r,label:n="Suggestions",...s}=e,a=m.useRef(null),i=m.useRef(null),o=Hl();return m.useEffect(()=>{if(i.current&&a.current){let c=i.current,u=a.current,d,f=new ResizeObserver(()=>{d=requestAnimationFrame(()=>{let h=c.offsetHeight;u.style.setProperty("--cmdk-list-height",h.toFixed(1)+"px")})});return f.observe(c),()=>{cancelAnimationFrame(d),f.unobserve(c)}}},[]),m.createElement(on.div,{ref:fl([a,t]),...s,"cmdk-list":"",role:"listbox","aria-label":n,id:o.listId},Ed(e,c=>m.createElement("div",{ref:fl([i,o.listInnerRef]),"cmdk-list-sizer":""},c)))}),Y$=m.forwardRef((e,t)=>{let{open:r,onOpenChange:n,overlayClassName:s,contentClassName:a,container:i,...o}=e;return m.createElement(F$,{open:r,onOpenChange:n},m.createElement(L$,{container:i},m.createElement(B$,{"cmdk-overlay":"",className:s}),m.createElement($$,{"aria-label":e.label,"cmdk-dialog":"",className:a},m.createElement(aS,{ref:t,...o}))))}),X$=m.forwardRef((e,t)=>Fa(r=>r.filtered.count===0)?m.createElement(on.div,{ref:t,...e,"cmdk-empty":"",role:"presentation"}):null),q$=m.forwardRef((e,t)=>{let{progress:r,children:n,label:s="Loading...",...a}=e;return m.createElement(on.div,{ref:t,...a,"cmdk-loading":"",role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,"aria-label":s},Ed(e,i=>m.createElement("div",{"aria-hidden":!0},i)))}),Nr=Object.assign(aS,{List:K$,Item:V$,Input:G$,Group:H$,Separator:z$,Dialog:Y$,Empty:X$,Loading:q$});function J$(e,t){let r=e.nextElementSibling;for(;r;){if(r.matches(t))return r;r=r.nextElementSibling}}function Q$(e,t){let r=e.previousElementSibling;for(;r;){if(r.matches(t))return r;r=r.previousElementSibling}}function iS(e){let t=m.useRef(e);return Ma(()=>{t.current=e}),t}var Ma=typeof window>"u"?m.useEffect:m.useLayoutEffect;function fi(e){let t=m.useRef();return t.current===void 0&&(t.current=e()),t}function fl(e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}function Fa(e){let t=G0(),r=()=>e(t.snapshot());return m.useSyncExternalStore(t.subscribe,r,r)}function oS(e,t,r,n=[]){let s=m.useRef(),a=Hl();return Ma(()=>{var i;let o=(()=>{var u;for(let d of r){if(typeof d=="string")return d.trim();if(typeof d=="object"&&"current"in d)return d.current?(u=d.current.textContent)==null?void 0:u.trim():s.current}})(),c=n.map(u=>u.trim());a.value(e,o,c),(i=t.current)==null||i.setAttribute(pa,o),s.current=o}),s}var Z$=()=>{let[e,t]=m.useState(),r=fi(()=>new Map);return Ma(()=>{r.current.forEach(n=>n()),r.current=new Map},[e]),(n,s)=>{r.current.set(n,s),t({})}};function e7(e){let t=e.type;return typeof t=="function"?t(e.props):"render"in t?t.render(e.props):e}function Ed({asChild:e,children:t},r){return e&&m.isValidElement(t)?m.cloneElement(e7(t),{ref:t.ref},r(t.props.children)):r(t)}var t7={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const Gs=m.forwardRef(({className:e,...t},r)=>l.jsx(Nr,{ref:r,className:Pe("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",e),...t}));Gs.displayName=Nr.displayName;const Ks=m.forwardRef(({className:e,...t},r)=>l.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[l.jsx(oE,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),l.jsx(Nr.Input,{ref:r,className:Pe("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",e),...t})]}));Ks.displayName=Nr.Input.displayName;const Ys=m.forwardRef(({className:e,...t},r)=>l.jsx(Nr.List,{ref:r,className:Pe("max-h-[300px] overflow-y-auto overflow-x-hidden",e),...t}));Ys.displayName=Nr.List.displayName;const Xs=m.forwardRef((e,t)=>l.jsx(Nr.Empty,{ref:t,className:"py-6 text-center text-sm",...e}));Xs.displayName=Nr.Empty.displayName;const qs=m.forwardRef(({className:e,...t},r)=>l.jsx(Nr.Group,{ref:r,className:Pe("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",e),...t}));qs.displayName=Nr.Group.displayName;const r7=m.forwardRef(({className:e,...t},r)=>l.jsx(Nr.Separator,{ref:r,className:Pe("-mx-1 h-px bg-border",e),...t}));r7.displayName=Nr.Separator.displayName;const xr=m.forwardRef(({className:e,...t},r)=>l.jsx(Nr.Item,{ref:r,className:Pe("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",e),...t}));xr.displayName=Nr.Item.displayName;var K0="Popover",[lS,IW]=bn(K0,[Qs]),zl=Qs(),[n7,sa]=lS(K0),cS=e=>{const{__scopePopover:t,children:r,open:n,defaultOpen:s,onOpenChange:a,modal:i=!1}=e,o=zl(t),c=m.useRef(null),[u,d]=m.useState(!1),[f=!1,h]=vn({prop:n,defaultProp:s,onChange:a});return l.jsx(Cu,{...o,children:l.jsx(n7,{scope:t,contentId:tn(),triggerRef:c,open:f,onOpenChange:h,onOpenToggle:m.useCallback(()=>h(p=>!p),[h]),hasCustomAnchor:u,onCustomAnchorAdd:m.useCallback(()=>d(!0),[]),onCustomAnchorRemove:m.useCallback(()=>d(!1),[]),modal:i,children:r})})};cS.displayName=K0;var uS="PopoverAnchor",s7=m.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,s=sa(uS,r),a=zl(r),{onCustomAnchorAdd:i,onCustomAnchorRemove:o}=s;return m.useEffect(()=>(i(),()=>o()),[i,o]),l.jsx(yl,{...a,...n,ref:t})});s7.displayName=uS;var dS="PopoverTrigger",fS=m.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,s=sa(dS,r),a=zl(r),i=Me(t,s.triggerRef),o=l.jsx(Ne.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":xS(s.open),...n,ref:i,onClick:he(e.onClick,s.onOpenToggle)});return s.hasCustomAnchor?o:l.jsx(yl,{asChild:!0,...a,children:o})});fS.displayName=dS;var Y0="PopoverPortal",[a7,i7]=lS(Y0,{forceMount:void 0}),hS=e=>{const{__scopePopover:t,forceMount:r,children:n,container:s}=e,a=sa(Y0,t);return l.jsx(a7,{scope:t,forceMount:r,children:l.jsx(Kt,{present:r||a.open,children:l.jsx(Wi,{asChild:!0,container:s,children:n})})})};hS.displayName=Y0;var $i="PopoverContent",mS=m.forwardRef((e,t)=>{const r=i7($i,e.__scopePopover),{forceMount:n=r.forceMount,...s}=e,a=sa($i,e.__scopePopover);return l.jsx(Kt,{present:n||a.open,children:a.modal?l.jsx(o7,{...s,ref:t}):l.jsx(l7,{...s,ref:t})})});mS.displayName=$i;var o7=m.forwardRef((e,t)=>{const r=sa($i,e.__scopePopover),n=m.useRef(null),s=Me(t,n),a=m.useRef(!1);return m.useEffect(()=>{const i=n.current;if(i)return Pl(i)},[]),l.jsx(kl,{as:ls,allowPinchZoom:!0,children:l.jsx(pS,{...e,ref:s,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:he(e.onCloseAutoFocus,i=>{var o;i.preventDefault(),a.current||(o=r.triggerRef.current)==null||o.focus()}),onPointerDownOutside:he(e.onPointerDownOutside,i=>{const o=i.detail.originalEvent,c=o.button===0&&o.ctrlKey===!0,u=o.button===2||c;a.current=u},{checkForDefaultPrevented:!1}),onFocusOutside:he(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1})})})}),l7=m.forwardRef((e,t)=>{const r=sa($i,e.__scopePopover),n=m.useRef(!1),s=m.useRef(!1);return l.jsx(pS,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:a=>{var i,o;(i=e.onCloseAutoFocus)==null||i.call(e,a),a.defaultPrevented||(n.current||(o=r.triggerRef.current)==null||o.focus(),a.preventDefault()),n.current=!1,s.current=!1},onInteractOutside:a=>{var c,u;(c=e.onInteractOutside)==null||c.call(e,a),a.defaultPrevented||(n.current=!0,a.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const i=a.target;((u=r.triggerRef.current)==null?void 0:u.contains(i))&&a.preventDefault(),a.detail.originalEvent.type==="focusin"&&s.current&&a.preventDefault()}})}),pS=m.forwardRef((e,t)=>{const{__scopePopover:r,trapFocus:n,onOpenAutoFocus:s,onCloseAutoFocus:a,disableOutsidePointerEvents:i,onEscapeKeyDown:o,onPointerDownOutside:c,onFocusOutside:u,onInteractOutside:d,...f}=e,h=sa($i,r),p=zl(r);return Ku(),l.jsx(Cl,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:s,onUnmountAutoFocus:a,children:l.jsx($a,{asChild:!0,disableOutsidePointerEvents:i,onInteractOutside:d,onEscapeKeyDown:o,onPointerDownOutside:c,onFocusOutside:u,onDismiss:()=>h.onOpenChange(!1),children:l.jsx(ku,{"data-state":xS(h.open),role:"dialog",id:h.contentId,...p,...f,ref:t,style:{...f.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),gS="PopoverClose",c7=m.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,s=sa(gS,r);return l.jsx(Ne.button,{type:"button",...n,ref:t,onClick:he(e.onClick,()=>s.onOpenChange(!1))})});c7.displayName=gS;var u7="PopoverArrow",d7=m.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,s=zl(r);return l.jsx(Pu,{...s,...n,ref:t})});d7.displayName=u7;function xS(e){return e?"open":"closed"}var f7=cS,h7=fS,m7=hS,vS=mS;const La=f7,Ba=h7,Js=m.forwardRef(({className:e,align:t="center",sideOffset:r=4,...n},s)=>l.jsx(m7,{children:l.jsx(vS,{ref:s,align:t,sideOffset:r,className:Pe("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));Js.displayName=vS.displayName;var yS=["PageUp","PageDown"],wS=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],_S={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},io="Slider",[ph,p7,g7]=pl(io),[bS,MW]=bn(io,[g7]),[x7,Td]=bS(io),SS=m.forwardRef((e,t)=>{const{name:r,min:n=0,max:s=100,step:a=1,orientation:i="horizontal",disabled:o=!1,minStepsBetweenThumbs:c=0,defaultValue:u=[n],value:d,onValueChange:f=()=>{},onValueCommit:h=()=>{},inverted:p=!1,form:v,...g}=e,x=m.useRef(new Set),y=m.useRef(0),_=i==="horizontal"?v7:y7,[b=[],T]=vn({prop:d,defaultProp:u,onChange:M=>{var V;(V=[...x.current][y.current])==null||V.focus(),f(M)}}),k=m.useRef(b);function S(M){const j=E7(b,M);L(M,j)}function E(M){L(M,y.current)}function C(){const M=k.current[y.current];b[y.current]!==M&&h(b)}function L(M,j,{commit:V}={commit:!1}){const A=P7(a),H=A7(Math.round((M-n)/a)*a+n,A),G=qo(H,[n,s]);T((q=[])=>{const Y=b7(q,G,j);if(k7(Y,c*a)){y.current=Y.indexOf(G);const Q=String(Y)!==String(q);return Q&&V&&h(Y),Q?Y:q}else return q})}return l.jsx(x7,{scope:e.__scopeSlider,name:r,disabled:o,min:n,max:s,valueIndexToChangeRef:y,thumbs:x.current,values:b,orientation:i,form:v,children:l.jsx(ph.Provider,{scope:e.__scopeSlider,children:l.jsx(ph.Slot,{scope:e.__scopeSlider,children:l.jsx(_,{"aria-disabled":o,"data-disabled":o?"":void 0,...g,ref:t,onPointerDown:he(g.onPointerDown,()=>{o||(k.current=b)}),min:n,max:s,inverted:p,onSlideStart:o?void 0:S,onSlideMove:o?void 0:E,onSlideEnd:o?void 0:C,onHomeKeyDown:()=>!o&&L(n,0,{commit:!0}),onEndKeyDown:()=>!o&&L(s,b.length-1,{commit:!0}),onStepKeyDown:({event:M,direction:j})=>{if(!o){const H=yS.includes(M.key)||M.shiftKey&&wS.includes(M.key)?10:1,G=y.current,q=b[G],Y=a*H*j;L(q+Y,G,{commit:!0})}}})})})})});SS.displayName=io;var[ES,TS]=bS(io,{startEdge:"left",endEdge:"right",size:"width",direction:1}),v7=m.forwardRef((e,t)=>{const{min:r,max:n,dir:s,inverted:a,onSlideStart:i,onSlideMove:o,onSlideEnd:c,onStepKeyDown:u,...d}=e,[f,h]=m.useState(null),p=Me(t,_=>h(_)),v=m.useRef(),g=Xi(s),x=g==="ltr",y=x&&!a||!x&&a;function w(_){const b=v.current||f.getBoundingClientRect(),T=[0,b.width],S=X0(T,y?[r,n]:[n,r]);return v.current=b,S(_-b.left)}return l.jsx(ES,{scope:e.__scopeSlider,startEdge:y?"left":"right",endEdge:y?"right":"left",direction:y?1:-1,size:"width",children:l.jsx(CS,{dir:g,"data-orientation":"horizontal",...d,ref:p,style:{...d.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:_=>{const b=w(_.clientX);i==null||i(b)},onSlideMove:_=>{const b=w(_.clientX);o==null||o(b)},onSlideEnd:()=>{v.current=void 0,c==null||c()},onStepKeyDown:_=>{const T=_S[y?"from-left":"from-right"].includes(_.key);u==null||u({event:_,direction:T?-1:1})}})})}),y7=m.forwardRef((e,t)=>{const{min:r,max:n,inverted:s,onSlideStart:a,onSlideMove:i,onSlideEnd:o,onStepKeyDown:c,...u}=e,d=m.useRef(null),f=Me(t,d),h=m.useRef(),p=!s;function v(g){const x=h.current||d.current.getBoundingClientRect(),y=[0,x.height],_=X0(y,p?[n,r]:[r,n]);return h.current=x,_(g-x.top)}return l.jsx(ES,{scope:e.__scopeSlider,startEdge:p?"bottom":"top",endEdge:p?"top":"bottom",size:"height",direction:p?1:-1,children:l.jsx(CS,{"data-orientation":"vertical",...u,ref:f,style:{...u.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:g=>{const x=v(g.clientY);a==null||a(x)},onSlideMove:g=>{const x=v(g.clientY);i==null||i(x)},onSlideEnd:()=>{h.current=void 0,o==null||o()},onStepKeyDown:g=>{const y=_S[p?"from-bottom":"from-top"].includes(g.key);c==null||c({event:g,direction:y?-1:1})}})})}),CS=m.forwardRef((e,t)=>{const{__scopeSlider:r,onSlideStart:n,onSlideMove:s,onSlideEnd:a,onHomeKeyDown:i,onEndKeyDown:o,onStepKeyDown:c,...u}=e,d=Td(io,r);return l.jsx(Ne.span,{...u,ref:t,onKeyDown:he(e.onKeyDown,f=>{f.key==="Home"?(i(f),f.preventDefault()):f.key==="End"?(o(f),f.preventDefault()):yS.concat(wS).includes(f.key)&&(c(f),f.preventDefault())}),onPointerDown:he(e.onPointerDown,f=>{const h=f.target;h.setPointerCapture(f.pointerId),f.preventDefault(),d.thumbs.has(h)?h.focus():n(f)}),onPointerMove:he(e.onPointerMove,f=>{f.target.hasPointerCapture(f.pointerId)&&s(f)}),onPointerUp:he(e.onPointerUp,f=>{const h=f.target;h.hasPointerCapture(f.pointerId)&&(h.releasePointerCapture(f.pointerId),a(f))})})}),kS="SliderTrack",PS=m.forwardRef((e,t)=>{const{__scopeSlider:r,...n}=e,s=Td(kS,r);return l.jsx(Ne.span,{"data-disabled":s.disabled?"":void 0,"data-orientation":s.orientation,...n,ref:t})});PS.displayName=kS;var gh="SliderRange",AS=m.forwardRef((e,t)=>{const{__scopeSlider:r,...n}=e,s=Td(gh,r),a=TS(gh,r),i=m.useRef(null),o=Me(t,i),c=s.values.length,u=s.values.map(h=>DS(h,s.min,s.max)),d=c>1?Math.min(...u):0,f=100-Math.max(...u);return l.jsx(Ne.span,{"data-orientation":s.orientation,"data-disabled":s.disabled?"":void 0,...n,ref:o,style:{...e.style,[a.startEdge]:d+"%",[a.endEdge]:f+"%"}})});AS.displayName=gh;var xh="SliderThumb",NS=m.forwardRef((e,t)=>{const r=p7(e.__scopeSlider),[n,s]=m.useState(null),a=Me(t,o=>s(o)),i=m.useMemo(()=>n?r().findIndex(o=>o.ref.current===n):-1,[r,n]);return l.jsx(w7,{...e,ref:a,index:i})}),w7=m.forwardRef((e,t)=>{const{__scopeSlider:r,index:n,name:s,...a}=e,i=Td(xh,r),o=TS(xh,r),[c,u]=m.useState(null),d=Me(t,w=>u(w)),f=c?i.form||!!c.closest("form"):!0,h=Ih(c),p=i.values[n],v=p===void 0?0:DS(p,i.min,i.max),g=S7(n,i.values.length),x=h==null?void 0:h[o.size],y=x?T7(x,v,o.direction):0;return m.useEffect(()=>{if(c)return i.thumbs.add(c),()=>{i.thumbs.delete(c)}},[c,i.thumbs]),l.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[o.startEdge]:`calc(${v}% + ${y}px)`},children:[l.jsx(ph.ItemSlot,{scope:e.__scopeSlider,children:l.jsx(Ne.span,{role:"slider","aria-label":e["aria-label"]||g,"aria-valuemin":i.min,"aria-valuenow":p,"aria-valuemax":i.max,"aria-orientation":i.orientation,"data-orientation":i.orientation,"data-disabled":i.disabled?"":void 0,tabIndex:i.disabled?void 0:0,...a,ref:d,style:p===void 0?{display:"none"}:e.style,onFocus:he(e.onFocus,()=>{i.valueIndexToChangeRef.current=n})})}),f&&l.jsx(_7,{name:s??(i.name?i.name+(i.values.length>1?"[]":""):void 0),form:i.form,value:p},n)]})});NS.displayName=xh;var _7=e=>{const{value:t,...r}=e,n=m.useRef(null),s=r0(t);return m.useEffect(()=>{const a=n.current,i=window.HTMLInputElement.prototype,c=Object.getOwnPropertyDescriptor(i,"value").set;if(s!==t&&c){const u=new Event("input",{bubbles:!0});c.call(a,t),a.dispatchEvent(u)}},[s,t]),l.jsx("input",{style:{display:"none"},...r,ref:n,defaultValue:t})};function b7(e=[],t,r){const n=[...e];return n[r]=t,n.sort((s,a)=>s-a)}function DS(e,t,r){const a=100/(r-t)*(e-t);return qo(a,[0,100])}function S7(e,t){return t>2?`Value ${e+1} of ${t}`:t===2?["Minimum","Maximum"][e]:void 0}function E7(e,t){if(e.length===1)return 0;const r=e.map(s=>Math.abs(s-t)),n=Math.min(...r);return r.indexOf(n)}function T7(e,t,r){const n=e/2,a=X0([0,50],[0,n]);return(n-a(t)*r)*r}function C7(e){return e.slice(0,-1).map((t,r)=>e[r+1]-t)}function k7(e,t){if(t>0){const r=C7(e);return Math.min(...r)>=t}return!0}function X0(e,t){return r=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const n=(t[1]-t[0])/(e[1]-e[0]);return t[0]+n*(r-e[0])}}function P7(e){return(String(e).split(".")[1]||"").length}function A7(e,t){const r=Math.pow(10,t);return Math.round(e*r)/r}var jS=SS,N7=PS,D7=AS,j7=NS;const q0=m.forwardRef(({className:e,...t},r)=>l.jsxs(jS,{ref:r,className:Pe("relative flex w-full touch-none select-none items-center",e),...t,children:[l.jsx(N7,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:l.jsx(D7,{className:"absolute h-full bg-primary"})}),l.jsx(j7,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));q0.displayName=jS.displayName;const R7=()=>{const[e,t]=m.useState([]),[r,n]=m.useState([]),[s,a]=m.useState(!0),[i,o]=m.useState(null),c=async()=>{try{a(!0),o(null),console.log("🔍 Attempting to load monthly stock data...");const d=["https://raw.githubusercontent.com/datamilo/put-options-se/main/data/Stocks_Monthly_Data.csv","/data/Stocks_Monthly_Data.csv"];let f="",h="";for(const x of d)try{console.log(`🌐 Trying to fetch from: ${x}`);const y=x.includes("github")?`${x}?${Date.now()}`:x,w=await fetch(y);if(console.log(`📨 Response status: ${w.status} for ${x}`),w.ok){f=await w.text(),h=x,console.log(`✅ Successfully loaded from: ${x}`),console.log(`📄 CSV length: ${f.length} characters`),console.log(`📄 First 200 chars: ${f.substring(0,200)}`);break}else console.log(`❌ Failed to load from ${x}: ${w.status} ${w.statusText}`)}catch(y){console.warn(`❌ Failed to fetch from ${x}:`,y)}if(!f)throw new Error("Could not load monthly stock data from GitHub or local source. Please check if the file exists and is accessible.");const p=Sa.parse(f,{header:!0,skipEmptyLines:!0,delimiter:"|",transform:(x,y)=>y==="month"?{Jan:1,Feb:2,Mar:3,Apr:4,May:5,Jun:6,Jul:7,Aug:8,Sep:9,Oct:10,Nov:11,Dec:12}[x]||parseInt(x)||0:["year","day_low_day_of_month","day_high_day_of_month"].includes(y)?parseInt(x)||0:["open","high","low","close","close_previous_month","low_previous_month","pct_return_month","pct_open_to_low","pct_low_to_high","pct_low_previous_month_to_low_current_month"].includes(y)?parseFloat(x)||0:x});p.errors.length>0&&console.warn("📝 CSV parsing warnings:",p.errors);const v=p.data.filter(x=>x.name&&x.month&&x.year);console.log(`📊 Parsed ${v.length} monthly records`),console.log("📊 Sample records:",v.slice(0,3)),t(v);const g=u(v);console.log(`📈 Calculated stats for ${g.length} stock-month combinations`),n(g)}catch(d){console.error("❌ Error loading monthly data:",d),o(d instanceof Error?d.message:"Unknown error occurred")}finally{a(!1)}},u=d=>{const f=new Map,h=d.reduce((v,g)=>{const x=`${g.name}-${g.month}`;return v[x]||(v[x]=[]),v[x].push(g),v},{});for(const[v,g]of Object.entries(h)){const[x,y]=v.split("-"),w=parseInt(y),_=g.filter(C=>C.pct_return_month>=0).length,b=g.length,T=g.reduce((C,L)=>C+L.pct_return_month,0)/b,k=g.reduce((C,L)=>C+L.pct_open_to_low,0)/b,S=Math.min(...g.map(C=>C.pct_open_to_low)),E=Math.max(...g.map(C=>C.pct_open_to_low));f.set(v,{name:x,month:w,number_of_months_available:b,number_of_months_positive_return:_,pct_pos_return_months:_/b*100,return_month_mean_pct_return_month:T,open_to_low_mean_pct_return_month:k,open_to_low_min_pct_return_month:S,open_to_low_max_pct_return_month:E,top_5_accumulated_score:0})}return Array.from(f.values())};return m.useEffect(()=>{c()},[]),{monthlyData:e,monthlyStats:r,isLoading:s,error:i,loadMonthlyData:c}},wo=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],O7=({data:e,selectedMonths:t=[]})=>{const[r,n]=m.useState("pct_pos_return_months"),[s,a]=m.useState("pct_pos_return_months"),[i,o]=m.useState(20),[c,u]=m.useState(null),d=m.useMemo(()=>{const x=new Map;return e.forEach(w=>{x.has(w.name)||x.set(w.name,{name:w.name,avgReturn:0,avgPosMonths:0,monthlyData:new Map}),x.get(w.name).monthlyData.set(w.month,w)}),x.forEach(w=>{const _=Array.from(w.monthlyData.values()),b=_.map(k=>k.return_month_mean_pct_return_month),T=_.map(k=>k.pct_pos_return_months);w.avgReturn=b.length>0?b.reduce((k,S)=>k+S,0)/b.length:0,w.avgPosMonths=T.length>0?T.reduce((k,S)=>k+S,0)/T.length:0}),Array.from(x.values()).sort((w,_)=>{var b,T;if(c!==null){const k=((b=w.monthlyData.get(c))==null?void 0:b[r])||0;return(((T=_.monthlyData.get(c))==null?void 0:T[r])||0)-k}switch(s){case"pct_pos_return_months":if(t.length>0){const k=t.map(L=>{var M;return((M=w.monthlyData.get(L))==null?void 0:M.pct_pos_return_months)||0}),S=t.map(L=>{var M;return((M=_.monthlyData.get(L))==null?void 0:M.pct_pos_return_months)||0}),E=k.reduce((L,M)=>L+M,0)/k.length;return S.reduce((L,M)=>L+M,0)/S.length-E}else return _.avgPosMonths-w.avgPosMonths;case"avg_return":if(t.length>0){const k=t.map(L=>{var M;return((M=w.monthlyData.get(L))==null?void 0:M.return_month_mean_pct_return_month)||0}),S=t.map(L=>{var M;return((M=_.monthlyData.get(L))==null?void 0:M.return_month_mean_pct_return_month)||0}),E=k.reduce((L,M)=>L+M,0)/k.length;return S.reduce((L,M)=>L+M,0)/S.length-E}else return _.avgReturn-w.avgReturn;case"alphabetical":return w.name.localeCompare(_.name);default:return _.avgPosMonths-w.avgPosMonths}}).slice(0,i)},[e,s,i,t,c,r]),f=m.useMemo(()=>{const x=d.flatMap(_=>t.length===0?Array.from({length:12},(b,T)=>{const k=T+1,S=_.monthlyData.get(k);return S?S[r]:null}).filter(b=>b!==null):t.map(b=>{const T=_.monthlyData.get(b);return T?T[r]:null}).filter(b=>b!==null));if(x.length===0)return null;const y=x.sort((_,b)=>_-b),w=_=>{const b=Math.ceil(_*y.length/100)-1;return y[Math.max(0,Math.min(b,y.length-1))]};return{p20:w(20),p40:w(40),p60:w(60),p80:w(80)}},[d,r,t]),h=(x,y)=>x===null||!f?"bg-slate-100 dark:bg-slate-800":x<=f.p20?"bg-gradient-to-br from-red-500 to-red-600":x<=f.p40?"bg-gradient-to-br from-orange-400 to-orange-500":x<=f.p60?"bg-gradient-to-br from-amber-400 to-amber-500":x<=f.p80?"bg-gradient-to-br from-emerald-400 to-emerald-500":"bg-gradient-to-br from-emerald-500 to-emerald-600",p=x=>x<5?"opacity-40":x<10?"opacity-70":"opacity-100",v=(x,y)=>{if(x===null)return"—";if(y==="pct_pos_return_months")return Math.round(x).toString();{const w=x*100,_=Math.round(w*100)/100;return _>0?`+${_.toFixed(2)}%`:`${_.toFixed(2)}%`}},g=(x,y,w)=>w?`${x} - ${wo[y-1]}
${w.pct_pos_return_months.toFixed(1)}% positive months
Avg return: ${(w.return_month_mean_pct_return_month*100).toFixed(2)}%
Data points: ${w.number_of_months_available} months`:"No data available";return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"space-y-4",children:[c!==null&&l.jsx("div",{className:"p-4 bg-primary/5 border border-primary/20 rounded-lg",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs(Pa,{variant:"secondary",className:"bg-primary/10 text-primary border-primary/20",children:["Sorted by ",wo[c-1]]}),l.jsx("span",{className:"text-sm text-muted-foreground",children:"Click any month header to change sorting or click again to clear"})]}),l.jsx("button",{onClick:()=>u(null),className:"text-sm text-muted-foreground hover:text-foreground underline",children:"Clear month sorting"})]})}),l.jsxs("div",{className:"flex flex-wrap items-center gap-6 p-6 bg-gradient-to-r from-muted/10 to-muted/20 rounded-xl border border-border/50 shadow-sm",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(ze,{htmlFor:"metric-select",className:"text-sm font-medium",children:"Metric:"}),l.jsxs(_a,{value:r,onValueChange:x=>n(x),children:[l.jsx(Fs,{id:"metric-select",className:"w-44 bg-background",children:l.jsx(ba,{})}),l.jsxs(Ls,{className:"bg-background border shadow-lg z-50",children:[l.jsx(jt,{value:"pct_pos_return_months",children:"% Positive Months"}),l.jsx(jt,{value:"return_month_mean_pct_return_month",children:"Average Return"})]})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(ze,{htmlFor:"sort-select",className:"text-sm font-medium",children:"Sort by:"}),l.jsxs(_a,{value:s,onValueChange:x=>a(x),children:[l.jsx(Fs,{id:"sort-select",className:"w-36 bg-background",children:l.jsx(ba,{})}),l.jsxs(Ls,{className:"bg-background border shadow-lg z-50",children:[l.jsx(jt,{value:"pct_pos_return_months",children:"% Positive Months"}),l.jsx(jt,{value:"avg_return",children:"Avg Return"}),l.jsx(jt,{value:"alphabetical",children:"Alphabetical"})]})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(ze,{htmlFor:"stocks-select",className:"text-sm font-medium",children:"Show:"}),l.jsxs(_a,{value:i.toString(),onValueChange:x=>o(parseInt(x)),children:[l.jsx(Fs,{id:"stocks-select",className:"w-28 bg-background",children:l.jsx(ba,{})}),l.jsxs(Ls,{className:"bg-background border shadow-lg z-50",children:[l.jsx(jt,{value:"10",children:"Top 10"}),l.jsx(jt,{value:"20",children:"Top 20"}),l.jsx(jt,{value:"30",children:"Top 30"}),l.jsx(jt,{value:"50",children:"Top 50"})]})]})]})]})]}),l.jsx("div",{className:"w-full overflow-x-auto bg-background rounded-lg border shadow-sm",children:l.jsxs("div",{className:"min-w-[1200px] p-6",children:[l.jsxs("div",{className:"flex mb-3 pb-2 border-b border-border/50",children:[l.jsx("div",{className:"w-40 flex-shrink-0 text-sm font-semibold text-foreground px-3 py-2",children:"Stock Symbol"}),t.length===0?wo.map((x,y)=>{const w=y+1,_=c===w;return l.jsxs("button",{onClick:()=>{u(c===w?null:w)},className:`
                      w-16 flex-shrink-0 text-sm font-semibold text-center px-2 py-2 rounded-md mx-0.5
                      transition-all duration-200 cursor-pointer hover:bg-muted/20
                      flex items-center justify-center gap-1
                      ${_?"bg-primary/10 text-primary border-2 border-primary/20":"text-foreground hover:text-primary"}
                    `,title:`Click to sort by ${x} values`,children:[x,_&&l.jsx(Ur,{className:"h-3 w-3"})]},x)}):t.map(x=>{const y=c===x;return l.jsxs("button",{onClick:()=>{u(c===x?null:x)},className:`
                      w-16 flex-shrink-0 text-sm font-semibold text-center px-2 py-2 rounded-md mx-0.5
                      transition-all duration-200 cursor-pointer hover:bg-muted/20
                      flex items-center justify-center gap-1
                      ${y?"bg-primary/10 text-primary border-2 border-primary/20":"text-foreground hover:text-primary"}
                    `,title:`Click to sort by ${wo[x-1]} values`,children:[wo[x-1],y&&l.jsx(Ur,{className:"h-3 w-3"})]},x)})]}),l.jsx("div",{className:"space-y-2",children:d.map(x=>l.jsxs("div",{className:"flex items-center hover:bg-muted/5 rounded-lg transition-colors duration-200",children:[l.jsx("div",{className:"w-40 flex-shrink-0 text-sm font-medium px-3 py-2 truncate text-foreground",title:x.name,children:x.name}),t.length===0?Array.from({length:12},(y,w)=>{const _=w+1,b=x.monthlyData.get(_),T=b?b[r]:null,k=(b==null?void 0:b.number_of_months_available)||0;return l.jsxs("div",{className:`
                          w-16 h-10 flex-shrink-0 rounded-md flex items-center justify-center
                          text-xs font-semibold text-white cursor-help transition-all duration-200
                          hover:scale-105 hover:shadow-lg hover:z-10 relative border border-white/20 mx-0.5
                          ${h(T)}
                          ${p(k)}
                        `,title:g(x.name,_,b),onTouchStart:S=>{const E=g(x.name,_,b),C=document.createElement("div");C.className="fixed z-50 bg-black text-white text-xs p-2 rounded shadow-lg pointer-events-none",C.textContent=E,C.style.top=`${S.touches[0].clientY-50}px`,C.style.left=`${S.touches[0].clientX-75}px`,document.body.appendChild(C),setTimeout(()=>{document.body.removeChild(C)},2e3)},children:[v(T,r),k<5&&T!==null&&l.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-transparent via-transparent to-black/20 rounded-sm pointer-events-none"})]},w)}):t.map(y=>{const w=x.monthlyData.get(y),_=w?w[r]:null,b=(w==null?void 0:w.number_of_months_available)||0;return l.jsxs("div",{className:`
                          w-16 h-10 flex-shrink-0 rounded-md flex items-center justify-center
                          text-xs font-semibold text-white cursor-help transition-all duration-200
                          hover:scale-105 hover:shadow-lg hover:z-10 relative border border-white/20 mx-0.5
                          ${h(_)}
                          ${p(b)}
                        `,title:g(x.name,y,w),onTouchStart:T=>{const k=g(x.name,y,w),S=document.createElement("div");S.className="fixed z-50 bg-black text-white text-xs p-2 rounded shadow-lg pointer-events-none",S.textContent=k,S.style.top=`${T.touches[0].clientY-50}px`,S.style.left=`${T.touches[0].clientX-75}px`,document.body.appendChild(S),setTimeout(()=>{document.body.removeChild(S)},2e3)},children:[v(_,r),b<5&&_!==null&&l.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-transparent via-transparent to-black/20 rounded-sm pointer-events-none"})]},y)})]},x.name))})]})}),l.jsxs("div",{className:"space-y-4 p-6 bg-gradient-to-r from-muted/5 to-muted/10 rounded-xl border border-border/50",children:[l.jsxs("div",{className:"flex flex-wrap items-center gap-6",children:[l.jsx("span",{className:"text-base font-semibold text-foreground",children:r==="pct_pos_return_months"?"Performance Scale - % Positive Months":"Performance Scale - Average Return (%)"}),f&&l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-5 h-5 bg-gradient-to-br from-red-500 to-red-600 rounded-md shadow-sm"}),l.jsx("span",{className:"text-sm font-medium",children:"Lowest 20%"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-5 h-5 bg-gradient-to-br from-orange-400 to-orange-500 rounded-md shadow-sm"}),l.jsx("span",{className:"text-sm font-medium",children:"20-40%"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-5 h-5 bg-gradient-to-br from-amber-400 to-amber-500 rounded-md shadow-sm"}),l.jsx("span",{className:"text-sm font-medium",children:"40-60%"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-5 h-5 bg-gradient-to-br from-emerald-400 to-emerald-500 rounded-md shadow-sm"}),l.jsx("span",{className:"text-sm font-medium",children:"60-80%"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-5 h-5 bg-gradient-to-br from-emerald-500 to-emerald-600 rounded-md shadow-sm"}),l.jsx("span",{className:"text-sm font-medium",children:"Top 20%"})]})]})]}),l.jsxs("div",{className:"flex items-center gap-6 text-sm text-muted-foreground pt-2 border-t border-border/30",children:[l.jsx("span",{className:"font-medium",children:"Data Reliability:"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-5 h-5 bg-primary rounded-md opacity-40 shadow-sm"}),l.jsx("span",{children:"<5 months (limited data)"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-5 h-5 bg-primary rounded-md opacity-70 shadow-sm"}),l.jsx("span",{children:"5-10 months (moderate)"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-5 h-5 bg-primary rounded-md shadow-sm"}),l.jsx("span",{children:"10+ months (reliable)"})]})]})]})]})},I7=["All Months","January","February","March","April","May","June","July","August","September","October","November","December"],M7=({data:e})=>{const[t,r]=m.useState("pct_pos_return_months"),[n,s]=m.useState("desc"),[a,i]=m.useState(""),[o,c]=m.useState(1),[u,d]=m.useState(0),[f,h]=m.useState(""),[p,v]=m.useState(!1),g=20,x=m.useMemo(()=>Array.from(new Set(e.map(C=>C.name))).sort(),[e]),y=E=>{t===E?s(n==="asc"?"desc":"asc"):(r(E),s("desc")),c(1)},w=m.useMemo(()=>{let E=e;return u>0&&(E=E.filter(C=>C.month===u)),f&&(E=E.filter(C=>C.name===f)),a&&(E=E.filter(C=>C.name.toLowerCase().includes(a.toLowerCase()))),[...E].sort((C,L)=>{let M=C[t],j=L[t];if(t==="name"){const V=String(M).localeCompare(String(j));return n==="asc"?V:-V}return M=Number(M)||0,j=Number(j)||0,n==="asc"?M-j:j-M})},[e,a,t,n,u,f]),_=m.useMemo(()=>{const E=(o-1)*g;return w.slice(E,E+g)},[w,o]),b=Math.ceil(w.length/g),T=E=>t!==E?l.jsx(Di,{className:"h-4 w-4"}):n==="asc"?l.jsx(X2,{className:"h-4 w-4"}):l.jsx(Y2,{className:"h-4 w-4"}),k=(E,C=2)=>E.toFixed(C),S=E=>["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][E-1]||"All";return l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 p-4 bg-muted/20 rounded-lg",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(ze,{children:"Month Filter"}),l.jsxs(_a,{value:u.toString(),onValueChange:E=>{d(parseInt(E)),c(1)},children:[l.jsx(Fs,{children:l.jsx(ba,{})}),l.jsx(Ls,{className:"bg-background border shadow-lg z-50",children:I7.map((E,C)=>l.jsx(jt,{value:C.toString(),children:E},C))})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(ze,{children:"Stock Filter"}),l.jsxs(La,{open:p,onOpenChange:v,children:[l.jsx(Ba,{asChild:!0,children:l.jsxs(Ee,{variant:"outline",role:"combobox","aria-expanded":p,className:"w-full justify-between",children:[f||"All stocks...",l.jsx(Ta,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),l.jsx(Js,{className:"w-full p-0 bg-background border shadow-lg z-50",align:"start",children:l.jsxs(Gs,{children:[l.jsx(Ks,{placeholder:"Search stocks..."}),l.jsxs(Ys,{children:[l.jsx(Xs,{children:"No stock found."}),l.jsxs(qs,{children:[l.jsxs(xr,{value:"",onSelect:()=>{h(""),v(!1),c(1)},children:[l.jsx(pr,{className:`mr-2 h-4 w-4 ${f===""?"opacity-100":"opacity-0"}`}),"All stocks"]}),x.map(E=>l.jsxs(xr,{value:E,onSelect:C=>{h(C===f?"":C),v(!1),c(1)},children:[l.jsx(pr,{className:`mr-2 h-4 w-4 ${f===E?"opacity-100":"opacity-0"}`}),E]},E))]})]})]})})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(ze,{children:"Search"}),l.jsx(Rt,{placeholder:"Search stocks...",value:a,onChange:E=>{i(E.target.value),c(1)}})]})]}),l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("div",{className:"text-sm text-muted-foreground",children:[w.length," results"]})}),l.jsx("div",{className:"border rounded-lg overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto",children:l.jsxs(Sl,{children:[l.jsx(El,{children:l.jsxs(ds,{children:[l.jsx(qr,{className:"w-20",children:l.jsxs(Ee,{variant:"ghost",onClick:()=>y("name"),className:"h-auto p-0 font-medium",children:["Stock ",T("name")]})}),l.jsx(qr,{className:"w-16",children:l.jsxs(Ee,{variant:"ghost",onClick:()=>y("month"),className:"h-auto p-0 font-medium",children:["Month ",T("month")]})}),l.jsx(qr,{className:"w-20",children:l.jsxs(Ee,{variant:"ghost",onClick:()=>y("number_of_months_available"),className:"h-auto p-0 font-medium text-xs",children:["History ",T("number_of_months_available")]})}),l.jsx(qr,{className:"w-20",children:l.jsxs(Ee,{variant:"ghost",onClick:()=>y("pct_pos_return_months"),className:"h-auto p-0 font-medium text-xs",children:["Pos % ",T("pct_pos_return_months")]})}),l.jsx(qr,{className:"w-20",children:l.jsxs(Ee,{variant:"ghost",onClick:()=>y("return_month_mean_pct_return_month"),className:"h-auto p-0 font-medium text-xs",children:["Avg Ret % ",T("return_month_mean_pct_return_month")]})}),l.jsx(qr,{className:"w-20",children:l.jsxs(Ee,{variant:"ghost",onClick:()=>y("open_to_low_mean_pct_return_month"),className:"h-auto p-0 font-medium text-xs",children:["Avg DD % ",T("open_to_low_mean_pct_return_month")]})}),l.jsx(qr,{className:"w-20",children:l.jsxs(Ee,{variant:"ghost",onClick:()=>y("open_to_low_min_pct_return_month"),className:"h-auto p-0 font-medium text-xs",children:["Worst DD % ",T("open_to_low_min_pct_return_month")]})}),l.jsx(qr,{className:"w-20",children:l.jsxs(Ee,{variant:"ghost",onClick:()=>y("open_to_low_max_pct_return_month"),className:"h-auto p-0 font-medium text-xs",children:["Best DD % ",T("open_to_low_max_pct_return_month")]})})]})}),l.jsx(Tl,{children:_.map((E,C)=>l.jsxs(ds,{children:[l.jsx(Dt,{className:"font-medium",children:E.name}),l.jsx(Dt,{children:S(E.month)}),l.jsx(Dt,{children:E.number_of_months_available}),l.jsx(Dt,{children:l.jsxs("span",{className:E.pct_pos_return_months>=70?"text-green-600":E.pct_pos_return_months>=50?"text-yellow-600":"text-red-600",children:[k(E.pct_pos_return_months,1),"%"]})}),l.jsx(Dt,{children:l.jsxs("span",{className:E.return_month_mean_pct_return_month>=0?"text-green-600":"text-red-600",children:[k(E.return_month_mean_pct_return_month*100),"%"]})}),l.jsx(Dt,{children:l.jsxs("span",{className:E.open_to_low_mean_pct_return_month>=-.05?"text-green-600":"text-red-600",children:[k(E.open_to_low_mean_pct_return_month*100),"%"]})}),l.jsx(Dt,{children:l.jsxs("span",{className:"text-red-600",children:[k(E.open_to_low_min_pct_return_month*100),"%"]})}),l.jsx(Dt,{children:l.jsxs("span",{className:E.open_to_low_max_pct_return_month>=0?"text-green-600":"text-orange-600",children:[k(E.open_to_low_max_pct_return_month*100),"%"]})})]},`${E.name}-${E.month}-${C}`))})]})})}),b>1&&l.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[l.jsx(Ee,{variant:"outline",size:"sm",onClick:()=>c(Math.max(1,o-1)),disabled:o===1,children:"Previous"}),l.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(5,b)},(E,C)=>{let L;return b<=5||o<=3?L=C+1:o>=b-2?L=b-4+C:L=o-2+C,l.jsx(Ee,{variant:o===L?"default":"outline",size:"sm",onClick:()=>c(L),className:"w-8 h-8 p-0",children:L},L)})}),l.jsx(Ee,{variant:"outline",size:"sm",onClick:()=>c(Math.min(b,o+1)),disabled:o===b,children:"Next"})]})]})},Ng=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],_c=["#3B82F6","#EF4444","#10B981","#F59E0B","#8B5CF6","#06B6D4","#84CC16","#F97316","#EC4899","#6366F1","#14B8A6","#F43F5E"],F7=({data:e,selectedStock:t})=>{const[r,n]=m.useState(new Set([1,2,3,4,5,6,7,8,9,10,11,12])),s=m.useMemo(()=>{if(!t||!e.length)return[];const h=e.filter(v=>v.name===t).reduce((v,g)=>(v[g.year]||(v[g.year]={}),v[g.year][g.month]||(v[g.year][g.month]=[]),v[g.year][g.month].push(g.pct_return_month),v),{});return Object.keys(h).map(v=>parseInt(v)).sort((v,g)=>v-g).map(v=>{const g={year:v};for(let x=1;x<=12;x++){const y=h[v][x];y&&y.length>0&&(g[`month_${x}`]=y.reduce((w,_)=>w+_,0)/y.length*100)}return g})},[e,t]),a=m.useMemo(()=>{if(!s.length)return{min:-10,max:10};const f=[];if(s.forEach(g=>{for(let x=1;x<=12;x++){const y=g[`month_${x}`];typeof y=="number"&&f.push(y)}}),f.length===0)return{min:-10,max:10};const h=Math.min(...f),p=Math.max(...f),v=Math.abs(p-h)*.1;return{min:h-v,max:p+v}},[s]),i=f=>{const h=new Set(r);h.has(f)?h.delete(f):h.add(f),n(h)},o=()=>{n(new Set([1,2,3,4,5,6,7,8,9,10,11,12]))},c=()=>{n(new Set)},u=(f,h)=>typeof f=="number"?[`${f.toFixed(2)}%`,h]:[f,h],d=f=>`${f.toFixed(1)}%`;return t?s.length?l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("h4",{className:"text-sm font-medium",children:"Toggle Months"}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx(Ee,{variant:"outline",size:"sm",onClick:o,children:"Show All"}),l.jsx(Ee,{variant:"outline",size:"sm",onClick:c,children:"Hide All"})]})]}),l.jsx("div",{className:"flex flex-wrap gap-2",children:Ng.map((f,h)=>{const p=h+1,v=r.has(p);return l.jsx(Pa,{variant:v?"default":"outline",className:"cursor-pointer transition-colors",style:{backgroundColor:v?_c[h]:void 0,borderColor:_c[h],color:v?"white":_c[h]},onClick:()=>i(p),children:f},p)})})]}),l.jsx("div",{className:"h-96",children:l.jsx(Is,{width:"100%",height:"100%",children:l.jsxs(yh,{data:s,margin:{top:20,right:30,left:20,bottom:20},children:[l.jsx(rs,{strokeDasharray:"3 3",className:"stroke-muted"}),l.jsx(ns,{dataKey:"year",className:"fill-muted-foreground",tick:{fontSize:12}}),l.jsx(Fn,{tickFormatter:d,className:"fill-muted-foreground",tick:{fontSize:12},domain:[a.min,a.max]}),l.jsx(ss,{formatter:u,labelFormatter:f=>`Year: ${f}`,contentStyle:{backgroundColor:"hsl(var(--background))",border:"1px solid hsl(var(--border))",borderRadius:"6px"}}),l.jsx(Ac,{}),l.jsx(Z0,{y1:0,y2:a.max,fill:"#22c55e",fillOpacity:.1}),l.jsx(Z0,{y1:a.min,y2:0,fill:"#ef4444",fillOpacity:.1}),l.jsx($S,{y:0,stroke:"hsl(var(--muted-foreground))",strokeWidth:2,strokeDasharray:"5 5",label:{value:"0% (Break-even)",position:"insideTopRight",style:{fontSize:"12px",fill:"hsl(var(--muted-foreground))"}}}),Ng.map((f,h)=>{const p=h+1;return r.has(p)?l.jsx(Nc,{type:"monotone",dataKey:`month_${p}`,stroke:_c[h],strokeWidth:2,name:f,connectNulls:!1,dot:{r:3},activeDot:{r:5}},p):null})]})})}),l.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[l.jsxs("p",{children:["• Shows monthly percentage returns for ",l.jsx("strong",{children:t})," over time"]}),l.jsx("p",{children:"• Each line represents a different calendar month across multiple years"}),l.jsxs("p",{children:["• ",l.jsx("span",{className:"text-green-600 dark:text-green-400",children:"Green shaded area"})," = positive returns, ",l.jsx("span",{className:"text-red-600 dark:text-red-400",children:"red shaded area"})," = negative returns"]}),l.jsx("p",{children:"• Dashed line at 0% shows break-even point"}),l.jsx("p",{children:"• Click month badges above to toggle visibility • Hover over data points for detailed values"})]})]}):l.jsx("div",{className:"flex items-center justify-center h-64 text-muted-foreground",children:l.jsxs("p",{children:["No historical data available for ",t]})}):l.jsx("div",{className:"flex items-center justify-center h-64 text-muted-foreground",children:l.jsx("p",{children:"Please select a stock to view the timeline performance chart"})})},vf=["All Months","January","February","March","April","May","June","July","August","September","October","November","December"],L7=()=>{const e=ms(),{monthlyData:t,monthlyStats:r,isLoading:n,error:s}=R7(),[a,i]=m.useState([]),[o,c]=m.useState(""),[u,d]=m.useState(!1),[f,h]=m.useState(!1),[p,v]=m.useState([10]),[g,x]=m.useState(50),y=m.useMemo(()=>Array.from(new Set(r.map(T=>T.name))).sort(),[r]),w=m.useMemo(()=>{let b=r;return a.length>0&&(b=b.filter(T=>a.includes(T.month))),o&&(b=b.filter(T=>T.name===o)),b=b.filter(T=>T.number_of_months_available>=p[0]),b.slice(0,g)},[r,a,o,p,g]),_=m.useMemo(()=>{let b=r;return b=b.filter(T=>T.number_of_months_available>=p[0]),o&&(b=b.filter(T=>T.name===o)),b},[r,o,p]);return m.useMemo(()=>{var S;if(w.length===0)return null;const b=w.reduce((E,C)=>E+C.pct_pos_return_months,0)/w.length,T=((S=[...w].sort((E,C)=>E.return_month_mean_pct_return_month-C.return_month_mean_pct_return_month)[Math.floor(w.length/2)])==null?void 0:S.return_month_mean_pct_return_month)||0,k=w.length;return{avgPosReturnMonths:b,medianReturn:T,stockCount:k}},[w]),n?l.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary mx-auto mb-4"}),l.jsx("p",{className:"text-muted-foreground",children:"Loading monthly analysis data..."})]})}):s?l.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:l.jsxs(Ke,{className:"max-w-md",children:[l.jsx(qe,{children:l.jsx(Je,{className:"text-destructive",children:"Error Loading Data"})}),l.jsxs(Ye,{children:[l.jsx("p",{className:"text-muted-foreground mb-4",children:s}),l.jsxs(Ee,{onClick:()=>e("/"),variant:"outline",children:[l.jsx(Zr,{className:"mr-2 h-4 w-4"}),"Back to Main Page"]})]})]})}):l.jsxs("div",{className:"min-h-screen bg-background",children:[l.jsx("div",{className:"border-b bg-card",children:l.jsx("div",{className:"container mx-auto px-4 py-4",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs(Ee,{onClick:()=>e("/"),variant:"ghost",size:"sm",children:[l.jsx(Zr,{className:"mr-2 h-4 w-4"}),"Back to Options"]}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold",children:"Monthly Stock Analysis"}),l.jsx("p",{className:"text-muted-foreground",children:"Historical seasonal patterns and performance metrics"})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(q2,{className:"h-5 w-5 text-muted-foreground"}),l.jsx("span",{className:"text-sm text-muted-foreground",children:a.length===0?"All Months":a.length===1?vf[a[0]]:`${a.length} months selected`})]})]})})}),l.jsxs("div",{className:"container mx-auto px-4 py-6 space-y-6",children:[l.jsxs(Ke,{children:[l.jsx(qe,{children:l.jsx(Je,{children:"Filters & Controls"})}),l.jsx(Ye,{children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(ze,{children:"Months"}),l.jsxs(La,{open:f,onOpenChange:h,children:[l.jsx(Ba,{asChild:!0,children:l.jsxs(Ee,{variant:"outline",role:"combobox","aria-expanded":f,className:"w-full justify-between",children:[a.length===0?"All months...":a.length===1?vf[a[0]]:`${a.length} months selected`,l.jsx(Ta,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),l.jsx(Js,{className:"w-full p-0",align:"start",children:l.jsxs(Gs,{children:[l.jsx(Ks,{placeholder:"Search months..."}),l.jsxs(Ys,{children:[l.jsx(Xs,{children:"No month found."}),l.jsxs(qs,{children:[l.jsxs(xr,{onSelect:()=>{i([])},children:[l.jsx(Lr,{checked:a.length===0,className:"mr-2"}),"All months"]}),vf.slice(1).map((b,T)=>{const k=T+1,S=a.includes(k);return l.jsxs(xr,{onSelect:()=>{i(S?E=>E.filter(C=>C!==k):E=>[...E,k])},children:[l.jsx(Lr,{checked:S,className:"mr-2"}),b]},k)})]})]})]})})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(ze,{children:"Select Stock"}),l.jsxs(La,{open:u,onOpenChange:d,children:[l.jsx(Ba,{asChild:!0,children:l.jsxs(Ee,{variant:"outline",role:"combobox","aria-expanded":u,className:"w-full justify-between",children:[o||"All stocks...",l.jsx(Ta,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),l.jsx(Js,{className:"w-full p-0",align:"start",children:l.jsxs(Gs,{children:[l.jsx(Ks,{placeholder:"Search stocks..."}),l.jsxs(Ys,{children:[l.jsx(Xs,{children:"No stock found."}),l.jsxs(qs,{children:[l.jsxs(xr,{value:"",onSelect:()=>{c(""),d(!1)},children:[l.jsx(pr,{className:`mr-2 h-4 w-4 ${o===""?"opacity-100":"opacity-0"}`}),"All stocks"]}),y.map(b=>l.jsxs(xr,{value:b,onSelect:T=>{c(T===o?"":T),d(!1)},children:[l.jsx(pr,{className:`mr-2 h-4 w-4 ${o===b?"opacity-100":"opacity-0"}`}),b]},b))]})]})]})})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs(ze,{children:["Min History (months): ",p[0]]}),l.jsx(q0,{value:p,onValueChange:v,min:1,max:50,step:1,className:"w-full"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(ze,{children:"Show Top N Stocks"}),l.jsxs(_a,{value:g.toString(),onValueChange:b=>x(parseInt(b)),children:[l.jsx(Fs,{children:l.jsx(ba,{})}),l.jsxs(Ls,{children:[l.jsx(jt,{value:"10",children:"Top 10"}),l.jsx(jt,{value:"25",children:"Top 25"}),l.jsx(jt,{value:"50",children:"Top 50"}),l.jsx(jt,{value:"100",children:"Top 100"}),l.jsx(jt,{value:"200",children:"Top 200"})]})]})]})]})})]}),l.jsxs(Ke,{children:[l.jsxs(qe,{children:[l.jsx(Je,{children:"Monthly Seasonality Heatmap"}),l.jsx("p",{className:"text-sm text-muted-foreground",children:"Percentage of positive return months by stock and calendar month"})]}),l.jsx(Ye,{children:l.jsx(O7,{data:_,selectedMonths:a})})]}),l.jsxs(Ke,{children:[l.jsxs(qe,{children:[l.jsx(Je,{children:"Timeline Performance Chart"}),l.jsx("p",{className:"text-sm text-muted-foreground",children:"Historical monthly returns over time - analyze when good/bad months occurred"})]}),l.jsx(Ye,{children:l.jsx(F7,{data:t,selectedStock:o})})]}),l.jsxs(Ke,{children:[l.jsxs(qe,{children:[l.jsx(Je,{children:"Detailed Statistics Table"}),l.jsx("p",{className:"text-sm text-muted-foreground",children:"Complete monthly performance metrics for all stocks"})]}),l.jsx(Ye,{children:l.jsx(M7,{data:r})})]})]})]})},B7=()=>{const[e,t]=m.useState([]),[r,n]=m.useState([]),[s,a]=m.useState(!0),[i,o]=m.useState(null),c=async()=>{try{a(!0),o(null),console.log("🔍 Attempting to load volatility event data...");const d=["https://raw.githubusercontent.com/datamilo/put-options-se/main/data/Stock_Events_Volatility_Data.csv","/data/Stock_Events_Volatility_Data.csv"];let f="",h="";for(const x of d)try{console.log(`🌐 Trying to fetch from: ${x}`);const y=x.includes("github")?`${x}?${Date.now()}`:x,w=await fetch(y);if(console.log(`📨 Response status: ${w.status} for ${x}`),w.ok){f=await w.text(),h=x,console.log(`✅ Successfully loaded from: ${x}`),console.log(`📄 CSV length: ${f.length} characters`);break}else console.log(`❌ Failed to load from ${x}: ${w.status} ${w.statusText}`)}catch(y){console.warn(`❌ Failed to fetch from ${x}:`,y)}if(!f)throw new Error("Could not load volatility event data from GitHub or local source. Please check if the file exists and is accessible.");const p=Sa.parse(f,{header:!0,skipEmptyLines:!0,delimiter:"|",transform:(x,y)=>["year","month"].includes(y)?parseInt(x)||0:["event_value","open","high","low","close","volume","volume_pct_change_from_previous_day","close_price_pct_change_from_previous_day","intraday_high_low_price_diff","pct_intraday_high_low_movement","pct_intraday_open_close_movement"].includes(y)?parseFloat(x)||0:x});p.errors.length>0&&console.warn("📝 CSV parsing warnings:",p.errors);const v=p.data.filter(x=>x.name&&x.date);console.log(`📊 Parsed ${v.length} volatility records`),console.log("📊 Sample records:",v.slice(0,3)),console.log("📊 Data is array:",Array.isArray(v)),console.log("📊 Data type:",typeof v),t(v);const g=u(v);console.log(`📈 Calculated stats for ${g.length} stocks`),console.log("📈 Stats is array:",Array.isArray(g)),console.log("📈 Stats sample:",g.slice(0,2)),n(g)}catch(d){console.error("❌ Error loading volatility data:",d),o(d instanceof Error?d.message:"Unknown error occurred")}finally{a(!1)}},u=d=>{const f=d.reduce((p,v)=>{const g=v.name;return p[g]||(p[g]=[]),p[g].push(v),p},{}),h=[];for(const[p,v]of Object.entries(f)){const g=v.map(X=>X.close_price_pct_change_from_previous_day).filter(X=>!isNaN(X));if(g.length===0)continue;const x=g.length,y=g.reduce((X,le)=>X+le,0)/x,w=[...g].sort((X,le)=>X-le),_=x%2===0?(w[x/2-1]+w[x/2])/2:w[Math.floor(x/2)],b=g.reduce((X,le)=>X+Math.pow(le-y,2),0)/x,T=Math.sqrt(b),k=Math.min(...g),S=Math.max(...g),E=v.find(X=>X.close_price_pct_change_from_previous_day===k),C=v.find(X=>X.close_price_pct_change_from_previous_day===S),L=x>0?w[Math.floor(x*.05)]:NaN,M=x>0?w[Math.floor(x*.95)]:NaN,j=g.reduce((X,le)=>X+Math.abs(le),0)/x,V=g.filter(X=>X<0).length,A=V/x,H=T/Math.sqrt(x),G=y-1.96*H,q=y+1.96*H,Y=v.map(X=>X.volume_pct_change_from_previous_day).filter(X=>!isNaN(X)),Q=Y.length>0?Y.reduce((X,le)=>X+le,0)/Y.length:0,fe=v.map(X=>Math.abs(X.pct_intraday_high_low_movement)).filter(X=>!isNaN(X)),oe=fe.length>0?fe.reduce((X,le)=>X+le,0)/fe.length:0;h.push({name:p,count:x,mean_change:y,median_change:_,std_dev:T,min_change:k,max_change:S,p05:L,p95:M,mean_abs_change:j,negative_count:V,negative_rate:A,se_mean:H,ci95_low:G,ci95_high:q,avg_volume_pct_change:Q,avg_intraday_spread_pct:oe,min_event_type:(E==null?void 0:E.type_of_event)||"",min_event_date:(E==null?void 0:E.date)||"",max_event_type:(C==null?void 0:C.type_of_event)||"",max_event_date:(C==null?void 0:C.date)||""})}return h.sort((p,v)=>v.mean_abs_change-p.mean_abs_change)};return m.useEffect(()=>{c()},[]),{volatilityData:e,volatilityStats:r,isLoading:s,error:i,loadVolatilityData:c}},$7=({data:e,rawData:t})=>{const[r,n]=m.useState([]),[s,a]=m.useState(["Bokslutskommuniké","Kvartalsrapport"]),[i,o]=m.useState(!1),[c,u]=m.useState(!1),d=m.useMemo(()=>Array.from(new Set(e.map(y=>y.name))).sort(),[e]),f=m.useMemo(()=>Array.from(new Set(t.map(y=>y.type_of_event))).sort(),[t]),h=m.useMemo(()=>{let y=t;s.length>0&&(y=y.filter(T=>s.includes(T.type_of_event)));const w=y.reduce((T,k)=>{const S=k.name;return T[S]||(T[S]=[]),T[S].push(k),T},{}),_=[];for(const[T,k]of Object.entries(w)){const S=k.map(R=>R.close_price_pct_change_from_previous_day).filter(R=>!isNaN(R));if(S.length===0)continue;const E=S.length,C=S.reduce((R,J)=>R+J,0)/E,L=[...S].sort((R,J)=>R-J),M=E%2===0?(L[E/2-1]+L[E/2])/2:L[Math.floor(E/2)],j=S.reduce((R,J)=>R+Math.pow(J-C,2),0)/E,V=Math.sqrt(j),A=Math.min(...S),H=Math.max(...S);S.indexOf(A),S.indexOf(H);const G=k.find(R=>R.close_price_pct_change_from_previous_day===A),q=k.find(R=>R.close_price_pct_change_from_previous_day===H),Y=E>0?L[Math.floor(E*.05)]:NaN,Q=E>0?L[Math.floor(E*.95)]:NaN,fe=S.reduce((R,J)=>R+Math.abs(J),0)/E,oe=S.filter(R=>R<0).length,X=oe/E,le=V/Math.sqrt(E),D=C-1.96*le,K=C+1.96*le,U=k.map(R=>R.volume_pct_change_from_previous_day).filter(R=>!isNaN(R)),I=U.length>0?U.reduce((R,J)=>R+J,0)/U.length:0,ee=k.map(R=>Math.abs(R.pct_intraday_high_low_movement)).filter(R=>!isNaN(R)),z=ee.length>0?ee.reduce((R,J)=>R+J,0)/ee.length:0;_.push({name:T,count:E,mean_change:C,median_change:M,std_dev:V,min_change:A,max_change:H,p05:Y,p95:Q,mean_abs_change:fe,negative_count:oe,negative_rate:X,se_mean:le,ci95_low:D,ci95_high:K,avg_volume_pct_change:I,avg_intraday_spread_pct:z,min_event_type:(G==null?void 0:G.type_of_event)||"",min_event_date:(G==null?void 0:G.date)||"",max_event_type:(q==null?void 0:q.type_of_event)||"",max_event_date:(q==null?void 0:q.date)||""})}let b=_.sort((T,k)=>k.mean_abs_change-T.mean_abs_change);return r.length>0&&(b=b.filter(T=>r.includes(T.name))),b.map(T=>({...T,mean_abs_change:T.mean_abs_change*100,mean_change:T.mean_change*100,median_change:T.median_change*100,ci95_low:T.ci95_low*100,ci95_high:T.ci95_high*100,p05:T.p05*100,p95:T.p95*100,min_change:T.min_change*100,max_change:T.max_change*100,avg_volume_pct_change:T.avg_volume_pct_change*100,avg_intraday_spread_pct:Math.abs(T.avg_intraday_spread_pct)*100}))},[t,r,s]),p=h.slice(0,20),v=({active:y,payload:w,label:_})=>{if(y&&w&&w.length){const b=h.find(T=>T.name===_);return l.jsxs("div",{className:"bg-background border border-border rounded-lg shadow-lg p-3",children:[l.jsx("p",{className:"font-medium",children:_}),w.map((T,k)=>l.jsxs("div",{children:[l.jsxs("p",{style:{color:T.color},children:[T.name,": ",typeof T.value=="number"?`${T.value.toFixed(2)}%`:T.value]}),b&&T.dataKey==="min_change"&&l.jsxs("p",{className:"text-xs text-muted-foreground",children:["Event: ",b.min_event_type," on ",b.min_event_date]}),b&&T.dataKey==="max_change"&&l.jsxs("p",{className:"text-xs text-muted-foreground",children:["Event: ",b.max_event_type," on ",b.max_event_date]})]},k))]})}return null},g=y=>{n(w=>w.includes(y)?w.filter(_=>_!==y):[...w,y])},x=y=>{a(w=>w.includes(y)?w.filter(_=>_!==y):[...w,y])};return l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(ze,{children:"Filter Stocks"}),l.jsxs(La,{open:i,onOpenChange:o,children:[l.jsx(Ba,{asChild:!0,children:l.jsxs(Ee,{variant:"outline",role:"combobox","aria-expanded":i,className:"w-full justify-between",children:[r.length===0?"All stocks":r.length===1?r[0]:`${r.length} stocks selected`,l.jsx(Ta,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),l.jsx(Js,{className:"w-full p-0",align:"start",children:l.jsxs(Gs,{children:[l.jsx(Ks,{placeholder:"Search stocks..."}),l.jsxs(Ys,{children:[l.jsx(Xs,{children:"No stock found."}),l.jsxs(qs,{children:[l.jsxs(xr,{onSelect:()=>{n([]),o(!1)},children:[l.jsx(pr,{className:`mr-2 h-4 w-4 ${r.length===0?"opacity-100":"opacity-0"}`}),"All stocks"]}),d.map(y=>l.jsxs(xr,{onSelect:()=>g(y),children:[l.jsx(pr,{className:`mr-2 h-4 w-4 ${r.includes(y)?"opacity-100":"opacity-0"}`}),y]},y))]})]})]})})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(ze,{children:"Filter Event Types"}),l.jsxs(La,{open:c,onOpenChange:u,children:[l.jsx(Ba,{asChild:!0,children:l.jsxs(Ee,{variant:"outline",role:"combobox","aria-expanded":c,className:"w-full justify-between",children:[s.length===0?"All event types":s.length===1?s[0]:`${s.length} event types selected`,l.jsx(Ta,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),l.jsx(Js,{className:"w-full p-0",align:"start",children:l.jsxs(Gs,{children:[l.jsx(Ks,{placeholder:"Search event types..."}),l.jsxs(Ys,{children:[l.jsx(Xs,{children:"No event type found."}),l.jsxs(qs,{children:[l.jsxs(xr,{onSelect:()=>{a([]),u(!1)},children:[l.jsx(pr,{className:`mr-2 h-4 w-4 ${s.length===0?"opacity-100":"opacity-0"}`}),"All event types"]}),f.map(y=>l.jsxs(xr,{onSelect:()=>x(y),children:[l.jsx(pr,{className:`mr-2 h-4 w-4 ${s.includes(y)?"opacity-100":"opacity-0"}`}),y]},y))]})]})]})})]})]})]}),l.jsxs(md,{defaultValue:"volatility",className:"w-full",children:[l.jsxs(Bl,{className:"grid w-full grid-cols-3",children:[l.jsx(Ln,{value:"volatility",children:"Mean Volatility"}),l.jsx(Ln,{value:"distribution",children:"Distribution Metrics"}),l.jsx(Ln,{value:"minmax",children:"Min/Max Changes"})]}),l.jsx(Bn,{value:"volatility",children:l.jsxs(Ke,{children:[l.jsxs(qe,{children:[l.jsx(Je,{children:"Mean Absolute Price Change During Events"}),l.jsx("p",{className:"text-sm text-muted-foreground",children:"Average absolute percentage change in closing price during corporate events"})]}),l.jsx(Ye,{children:l.jsx(Is,{width:"100%",height:400,children:l.jsxs(Sc,{data:p,margin:{top:20,right:30,left:20,bottom:5},children:[l.jsx(rs,{strokeDasharray:"3 3",className:"stroke-muted"}),l.jsx(ns,{dataKey:"name",angle:-45,textAnchor:"end",height:100,className:"text-xs"}),l.jsx(Fn,{className:"text-xs",label:{value:"Percentage (%)",angle:-90,position:"insideLeft"}}),l.jsx(ss,{content:l.jsx(v,{})}),l.jsx(Es,{dataKey:"mean_abs_change",fill:"hsl(var(--primary))",radius:[2,2,0,0]})]})})})]})}),l.jsx(Bn,{value:"distribution",children:l.jsxs(Ke,{children:[l.jsxs(qe,{children:[l.jsx(Je,{children:"Price Change Distribution Metrics"}),l.jsx("p",{className:"text-sm text-muted-foreground",children:"Statistical distribution of price changes: 5th percentile, median, and 95th percentile"})]}),l.jsx(Ye,{children:l.jsx(Is,{width:"100%",height:400,children:l.jsxs(Sc,{data:p,margin:{top:20,right:30,left:20,bottom:5},children:[l.jsx(rs,{strokeDasharray:"3 3",className:"stroke-muted"}),l.jsx(ns,{dataKey:"name",angle:-45,textAnchor:"end",height:100,className:"text-xs"}),l.jsx(Fn,{className:"text-xs",label:{value:"Percentage (%)",angle:-90,position:"insideLeft"}}),l.jsx(ss,{content:l.jsx(v,{})}),l.jsx(Es,{dataKey:"p05",fill:"hsl(var(--destructive))",name:"5th Percentile"}),l.jsx(Es,{dataKey:"median_change",fill:"hsl(var(--primary))",name:"Median"}),l.jsx(Es,{dataKey:"p95",fill:"hsl(220, 70%, 40%)",name:"95th Percentile"})]})})})]})}),l.jsx(Bn,{value:"minmax",children:l.jsxs(Ke,{children:[l.jsxs(qe,{children:[l.jsx(Je,{children:"Min/Max Price Changes During Events"}),l.jsx("p",{className:"text-sm text-muted-foreground",children:"Largest positive and negative percentage changes observed for each stock during events"})]}),l.jsx(Ye,{children:l.jsx(Is,{width:"100%",height:400,children:l.jsxs(Sc,{data:p,margin:{top:20,right:30,left:20,bottom:5},children:[l.jsx(rs,{strokeDasharray:"3 3",className:"stroke-muted"}),l.jsx(ns,{dataKey:"name",angle:-45,textAnchor:"end",height:100,className:"text-xs"}),l.jsx(Fn,{className:"text-xs",label:{value:"Percentage (%)",angle:-90,position:"insideLeft"}}),l.jsx(ss,{content:l.jsx(v,{})}),l.jsx(Es,{dataKey:"min_change",fill:"hsl(var(--destructive))",name:"Min Change"}),l.jsx(Es,{dataKey:"max_change",fill:"hsl(220, 70%, 40%)",name:"Max Change"})]})})})]})})]})]})},W7=({data:e})=>{const[t,r]=m.useState(""),[n,s]=m.useState(""),[a,i]=m.useState("all"),[o,c]=m.useState("all"),[u,d]=m.useState(!1),[f,h]=m.useState(!1),[p,v]=m.useState("date"),[g,x]=m.useState("desc"),y=m.useMemo(()=>Array.from(new Set(e.map(E=>E.name))).sort(),[e]),w=m.useMemo(()=>Array.from(new Set(e.map(E=>E.type_of_event))).sort(),[e]),_=m.useMemo(()=>Array.from(new Set(e.map(E=>E.year))).sort((E,C)=>C-E),[e]),b=[{value:"1",label:"January"},{value:"2",label:"February"},{value:"3",label:"March"},{value:"4",label:"April"},{value:"5",label:"May"},{value:"6",label:"June"},{value:"7",label:"July"},{value:"8",label:"August"},{value:"9",label:"September"},{value:"10",label:"October"},{value:"11",label:"November"},{value:"12",label:"December"}],T=m.useMemo(()=>{let E=e;return t&&(E=E.filter(C=>C.name===t)),n&&(E=E.filter(C=>C.type_of_event===n)),a&&a!=="all"&&(E=E.filter(C=>C.year===parseInt(a))),o&&o!=="all"&&(E=E.filter(C=>C.month===parseInt(o))),E.sort((C,L)=>{const M=C[p],j=L[p];if(typeof M=="number"&&typeof j=="number")return g==="asc"?M-j:j-M;const V=String(M),A=String(j);return g==="asc"?V.localeCompare(A):A.localeCompare(V)})},[e,t,n,a,o,p,g]),k=E=>{p===E?x(g==="asc"?"desc":"asc"):(v(E),x("desc"))},S=({children:E,sortKey:C})=>l.jsx(qr,{children:l.jsxs(Ee,{variant:"ghost",onClick:()=>k(C),className:"h-auto p-0 font-medium hover:bg-transparent",children:[E,l.jsx(Di,{className:"ml-2 h-4 w-4"})]})});return l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(ze,{children:"Stock Name"}),l.jsxs(La,{open:u,onOpenChange:d,children:[l.jsx(Ba,{asChild:!0,children:l.jsxs(Ee,{variant:"outline",role:"combobox","aria-expanded":u,className:"w-full justify-between",children:[t||"All stocks...",l.jsx(Ta,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),l.jsx(Js,{className:"w-full p-0",align:"start",children:l.jsxs(Gs,{children:[l.jsx(Ks,{placeholder:"Search stocks..."}),l.jsxs(Ys,{children:[l.jsx(Xs,{children:"No stock found."}),l.jsxs(qs,{children:[l.jsxs(xr,{value:"",onSelect:()=>{r(""),d(!1)},children:[l.jsx(pr,{className:`mr-2 h-4 w-4 ${t===""?"opacity-100":"opacity-0"}`}),"All stocks"]}),y.map(E=>l.jsxs(xr,{value:E,onSelect:C=>{r(C===t?"":C),d(!1)},children:[l.jsx(pr,{className:`mr-2 h-4 w-4 ${t===E?"opacity-100":"opacity-0"}`}),E]},E))]})]})]})})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(ze,{children:"Event Type"}),l.jsxs(La,{open:f,onOpenChange:h,children:[l.jsx(Ba,{asChild:!0,children:l.jsxs(Ee,{variant:"outline",role:"combobox","aria-expanded":f,className:"w-full justify-between",children:[n||"All event types...",l.jsx(Ta,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),l.jsx(Js,{className:"w-full p-0",align:"start",children:l.jsxs(Gs,{children:[l.jsx(Ks,{placeholder:"Search event types..."}),l.jsxs(Ys,{children:[l.jsx(Xs,{children:"No event type found."}),l.jsxs(qs,{children:[l.jsxs(xr,{value:"",onSelect:()=>{s(""),h(!1)},children:[l.jsx(pr,{className:`mr-2 h-4 w-4 ${n===""?"opacity-100":"opacity-0"}`}),"All event types"]}),w.map(E=>l.jsxs(xr,{value:E,onSelect:C=>{s(C===n?"":C),h(!1)},children:[l.jsx(pr,{className:`mr-2 h-4 w-4 ${n===E?"opacity-100":"opacity-0"}`}),E]},E))]})]})]})})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(ze,{children:"Year"}),l.jsxs(_a,{value:a,onValueChange:i,children:[l.jsx(Fs,{children:l.jsx(ba,{placeholder:"All years..."})}),l.jsxs(Ls,{children:[l.jsx(jt,{value:"all",children:"All years"}),_.map(E=>l.jsx(jt,{value:E.toString(),children:E},E))]})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(ze,{children:"Month"}),l.jsxs(_a,{value:o,onValueChange:c,children:[l.jsx(Fs,{children:l.jsx(ba,{placeholder:"All months..."})}),l.jsxs(Ls,{children:[l.jsx(jt,{value:"all",children:"All months"}),b.map(E=>l.jsx(jt,{value:E.value,children:E.label},E.value))]})]})]})]}),l.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",T.length," of ",e.length," records"]}),l.jsx(zu,{className:"h-[600px] w-full border rounded-md",children:l.jsxs(Sl,{children:[l.jsx(El,{children:l.jsxs(ds,{children:[l.jsx(S,{sortKey:"date",children:"Date"}),l.jsx(S,{sortKey:"name",children:"Stock"}),l.jsx(S,{sortKey:"type_of_event",children:"Event Type"}),l.jsx(S,{sortKey:"event_value",children:"Event Value"}),l.jsx(S,{sortKey:"close",children:"Close Price"}),l.jsx(S,{sortKey:"volume",children:"Volume"}),l.jsx(S,{sortKey:"close_price_pct_change_from_previous_day",children:"Price Change %"}),l.jsx(S,{sortKey:"volume_pct_change_from_previous_day",children:"Volume Change %"}),l.jsx(S,{sortKey:"pct_intraday_high_low_movement",children:"Intraday Spread %"})]})}),l.jsx(Tl,{children:T.map((E,C)=>{var L,M;return l.jsxs(ds,{children:[l.jsx(Dt,{children:E.date}),l.jsx(Dt,{className:"font-medium",children:E.name}),l.jsx(Dt,{children:E.type_of_event}),l.jsx(Dt,{children:E.event_value!==void 0&&E.event_value!==null?Math.round(E.event_value):"N/A"}),l.jsx(Dt,{children:(L=E.close)==null?void 0:L.toFixed(2)}),l.jsx(Dt,{children:(M=E.volume)==null?void 0:M.toLocaleString("sv-SE")}),l.jsxs(Dt,{className:E.close_price_pct_change_from_previous_day>=0?"text-green-600":"text-red-600",children:[(E.close_price_pct_change_from_previous_day*100).toFixed(2),"%"]}),l.jsxs(Dt,{className:E.volume_pct_change_from_previous_day>=0?"text-green-600":"text-red-600",children:[(E.volume_pct_change_from_previous_day*100).toFixed(2),"%"]}),l.jsxs(Dt,{children:[(Math.abs(E.pct_intraday_high_low_movement)*100).toFixed(2),"%"]})]},C)})})]})})]})},U7=()=>{const e=ms(),{volatilityData:t,volatilityStats:r,isLoading:n,error:s}=B7();if(n)return l.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary mx-auto mb-4"}),l.jsx("p",{className:"text-muted-foreground",children:"Loading volatility analysis data..."})]})});if(s)return l.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:l.jsxs(Ke,{className:"max-w-md",children:[l.jsx(qe,{children:l.jsx(Je,{className:"text-destructive",children:"Error Loading Data"})}),l.jsxs(Ye,{children:[l.jsx("p",{className:"text-muted-foreground mb-4",children:s}),l.jsxs(Ee,{onClick:()=>e("/"),variant:"outline",children:[l.jsx(Zr,{className:"mr-2 h-4 w-4"}),"Back to Main Page"]})]})]})});const a=t.length,i=r.reduce((c,u)=>c+u.mean_abs_change,0)/r.length,o=r.filter(c=>c.mean_abs_change>i).length;return l.jsxs("div",{className:"min-h-screen bg-background",children:[l.jsx("div",{className:"border-b bg-card",children:l.jsx("div",{className:"container mx-auto px-4 py-4",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs(Ee,{onClick:()=>e("/"),variant:"ghost",size:"sm",children:[l.jsx(Zr,{className:"mr-2 h-4 w-4"}),"Back to Options"]}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold",children:"Event Volatility Analysis"}),l.jsx("p",{className:"text-muted-foreground",children:"Stock price behavior around corporate events"})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Ea,{className:"h-5 w-5 text-muted-foreground"}),l.jsxs("span",{className:"text-sm text-muted-foreground",children:[a.toLocaleString("sv-SE")," events analyzed"]})]})]})})}),l.jsxs("div",{className:"container mx-auto px-4 py-6 space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.jsxs(Ke,{children:[l.jsxs(qe,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[l.jsx(Je,{className:"text-sm font-medium",children:"Total Events"}),l.jsx(Ea,{className:"h-4 w-4 text-muted-foreground"})]}),l.jsxs(Ye,{children:[l.jsx("div",{className:"text-2xl font-bold",children:a.toLocaleString("sv-SE")}),l.jsx("p",{className:"text-xs text-muted-foreground",children:"Corporate events analyzed"})]})]}),l.jsxs(Ke,{children:[l.jsxs(qe,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[l.jsx(Je,{className:"text-sm font-medium",children:"Average Volatility"}),l.jsx(Uo,{className:"h-4 w-4 text-muted-foreground"})]}),l.jsxs(Ye,{children:[l.jsxs("div",{className:"text-2xl font-bold",children:[i.toFixed(2),"%"]}),l.jsx("p",{className:"text-xs text-muted-foreground",children:"Mean absolute price change"})]})]}),l.jsxs(Ke,{children:[l.jsxs(qe,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[l.jsx(Je,{className:"text-sm font-medium",children:"High Volatility Stocks"}),l.jsx(yx,{className:"h-4 w-4 text-muted-foreground"})]}),l.jsxs(Ye,{children:[l.jsx("div",{className:"text-2xl font-bold",children:o}),l.jsx("p",{className:"text-xs text-muted-foreground",children:"Above average volatility"})]})]})]}),l.jsxs(Ke,{children:[l.jsxs(qe,{children:[l.jsx(Je,{children:"Volatility Statistics Visualization"}),l.jsx("p",{className:"text-sm text-muted-foreground",children:"Interactive charts showing price volatility patterns during corporate events"})]}),l.jsx(Ye,{children:l.jsx($7,{data:r,rawData:t})})]}),l.jsxs(Ke,{children:[l.jsxs(qe,{children:[l.jsx(Je,{children:"Event Data Details"}),l.jsx("p",{className:"text-sm text-muted-foreground",children:"Complete event-by-event data with filtering and sorting capabilities"})]}),l.jsx(Ye,{children:l.jsx(W7,{data:t})})]})]})]})};var V7="Separator",Dg="horizontal",H7=["horizontal","vertical"],RS=m.forwardRef((e,t)=>{const{decorative:r,orientation:n=Dg,...s}=e,a=z7(n)?n:Dg,o=r?{role:"none"}:{"aria-orientation":a==="vertical"?a:void 0,role:"separator"};return l.jsx(Ne.div,{"data-orientation":a,...o,...s,ref:t})});RS.displayName=V7;function z7(e){return H7.includes(e)}var OS=RS;const Ge=m.forwardRef(({className:e,orientation:t="horizontal",decorative:r=!0,...n},s)=>l.jsx(OS,{ref:s,decorative:r,orientation:t,className:Pe("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...n}));Ge.displayName=OS.displayName;const G7=e=>{const[t,r]=m.useState([]),[n,s]=m.useState(!0),[a,i]=m.useState(null);m.useEffect(()=>{o()},[]);const o=async()=>{try{s(!0),i(null);const d=[`https://raw.githubusercontent.com/datamilo/put-options-se/main/data/probability_history.csv?${Date.now()}`,`${window.location.origin}/put-options-sedata/probability_history.csv?${Date.now()}`];let f=null,h=null;for(const v of d)try{if(console.log("🔗 Trying probability history URL:",v),h=await fetch(v),h.ok){console.log("✅ Successfully loaded CSV from:",v);break}}catch(g){console.warn("❌ Failed to load from:",v,g),f=g}if(!h||!h.ok)throw f||new Error("Failed to load probability history from any URL");const p=await h.text();Sa.parse(p,{header:!0,delimiter:"|",skipEmptyLines:!0,transform:(v,g)=>typeof g=="string"&&["1_2_3_ProbOfWorthless_Weighted","ProbWorthless_Bayesian_IsoCal","1_ProbOfWorthless_Original","2_ProbOfWorthless_Calibrated","3_ProbOfWorthless_Historical_IV"].includes(g)?v===""||v===null||v===void 0?null:parseFloat(v):v,complete:v=>{console.log("Probability history data loaded:",v.data.length,"rows"),r(v.data),s(!1)},error:v=>{console.error("Error parsing probability history CSV:",v),i("Failed to parse probability history data"),s(!1)}})}catch(d){console.error("Error loading probability history data:",d),i("Failed to load probability history data"),s(!1)}},c=d=>t.filter(f=>String(f.OptionName)===d).sort((f,h)=>new Date(f.Update_date).getTime()-new Date(h.Update_date).getTime()),u=e?c(e):[];return{allData:t,optionData:u,isLoading:n,error:a,getProbabilityHistoryForOption:c}},bc=[{key:"1_2_3_ProbOfWorthless_Weighted",name:"Weighted Average",color:"#2563eb"},{key:"ProbWorthless_Bayesian_IsoCal",name:"Bayesian IsoCal",color:"#dc2626"},{key:"1_ProbOfWorthless_Original",name:"Original",color:"#16a34a"},{key:"2_ProbOfWorthless_Calibrated",name:"Calibrated",color:"#ca8a04"},{key:"3_ProbOfWorthless_Historical_IV",name:"Historical IV",color:"#9333ea"}],K7=({optionName:e})=>{const{optionData:t,isLoading:r,error:n}=G7(e),[s,a]=m.useState(new Set(bc.map(f=>f.key)));if(r)return l.jsxs(Ke,{children:[l.jsx(qe,{children:l.jsx(Je,{children:"Probability History Chart"})}),l.jsx(Ye,{children:l.jsx("div",{className:"h-96 flex items-center justify-center",children:"Loading probability history..."})})]});if(n)return l.jsxs(Ke,{children:[l.jsx(qe,{children:l.jsx(Je,{children:"Probability History Chart"})}),l.jsx(Ye,{children:l.jsxs("div",{className:"h-96 flex items-center justify-center text-muted-foreground",children:["Error loading probability history: ",n]})})]});if(t.length===0)return l.jsxs(Ke,{children:[l.jsx(qe,{children:l.jsx(Je,{children:"Probability History Chart"})}),l.jsx(Ye,{children:l.jsx("div",{className:"h-96 flex items-center justify-center text-muted-foreground",children:"No probability history data available for this option"})})]});const i=()=>{const f=t.flatMap(y=>bc.filter(w=>s.has(w.key)).map(w=>y[w.key]).filter(w=>w!=null));if(f.length===0)return[0,1];const h=Math.min(...f),p=Math.max(...f),v=(p-h)*.1,g=Math.max(0,h-v),x=Math.min(1,p+v);return[g,x]},o=(f,h)=>f==null?["N/A",h]:[`${(f*100).toFixed(2)}%`,h],c=f=>`${(f*100).toFixed(0)}%`,u=f=>new Date(f).toISOString().split("T")[0],d=f=>{const h=new Set(s);h.has(f)?h.delete(f):h.add(f),a(h)};return l.jsxs(Ke,{children:[l.jsxs(qe,{className:"space-y-4",children:[l.jsxs(Je,{className:"flex items-center gap-2",children:[l.jsx(Wo,{className:"h-5 w-5"}),"Probability of Worthless History"]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:"text-sm text-muted-foreground",children:"Select probability types to display:"}),l.jsx("div",{className:"flex flex-wrap gap-4",children:bc.map(f=>l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Lr,{id:f.key,checked:s.has(f.key),onCheckedChange:()=>d(f.key)}),l.jsxs("label",{htmlFor:f.key,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer",children:[l.jsx("span",{className:"inline-block w-3 h-3 mr-2 rounded-full",style:{backgroundColor:f.color}}),f.name]})]},f.key))})]})]}),l.jsx(Ye,{children:l.jsx("div",{className:"h-[480px]",children:l.jsx(Is,{width:"100%",height:"100%",children:l.jsxs(yh,{data:t,children:[l.jsx(rs,{strokeDasharray:"3 3",className:"opacity-30"}),l.jsx(ns,{dataKey:"Update_date",tickFormatter:u,className:"text-muted-foreground",angle:-45,textAnchor:"end",height:80}),l.jsx(Fn,{className:"text-muted-foreground",domain:i(),tickFormatter:c}),l.jsx(ss,{formatter:o,labelFormatter:f=>new Date(f).toISOString().split("T")[0],contentStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"var(--radius)"}}),bc.map(f=>s.has(f.key)&&l.jsx(Nc,{dataKey:f.key,stroke:f.color,strokeWidth:2,dot:!1,name:f.name,connectNulls:!1},f.key))]})})})})]})},Y7=({option:e})=>{const{underlyingValue:t}=Yi(),r=e.NumberOfContractsBasedOnLimit*e.StrikePrice*100,n=(d,f)=>ji(d,f),s="originalPremium"in e,a=({content:d})=>l.jsx("div",{className:"md:hidden",children:l.jsxs(Al,{children:[l.jsx(Nl,{asChild:!0,children:l.jsx(Mn,{className:"h-3 w-3 text-muted-foreground cursor-pointer"})}),l.jsx(qi,{className:"max-w-sm",children:l.jsx("p",{className:"text-sm",children:d})})]})}),i=({content:d,children:f})=>l.jsx("div",{className:"hidden md:block",children:l.jsxs(zo,{delayDuration:300,children:[l.jsx(Go,{asChild:!0,children:f}),l.jsx(Ii,{children:l.jsx("p",{children:d})})]})}),o=d=>d<=.6?{level:"High Risk",color:"bg-destructive"}:d<.8?{level:"Medium Risk",color:"bg-accent"}:{level:"Low Risk",color:"bg-secondary"},c=e.ProbWorthless_Bayesian_IsoCal??e["1_2_3_ProbOfWorthless_Weighted"],u=o(c);return l.jsx(zi,{children:l.jsxs("div",{className:"space-y-6",children:[l.jsxs(Ke,{children:[l.jsx(qe,{children:l.jsxs(Je,{className:"flex items-center justify-between",children:[l.jsxs("span",{children:[e.StockName," - ",e.OptionName]}),l.jsx(Pa,{className:u.color,children:u.level})]})}),l.jsx(Ye,{className:"space-y-4",children:l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-muted-foreground",children:"Premium"}),l.jsx("p",{className:"text-lg font-semibold",children:n(e.Premium,"Premium")})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-muted-foreground",children:"Strike Price"}),l.jsx("p",{className:"text-lg font-semibold",children:n(e.StrikePrice,"StrikePrice")})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-muted-foreground",children:"Days to Expiry"}),l.jsx("p",{className:"text-lg font-semibold",children:e.DaysToExpiry})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-muted-foreground",children:"Stock Price"}),l.jsx("p",{className:"text-lg font-semibold",children:n(e.StockPrice,"StockPrice")})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-muted-foreground",children:"Strike vs Stock %"}),l.jsx("p",{className:"text-lg font-semibold",children:n((e.StrikePrice-e.StockPrice)/e.StockPrice,"Pct")})]})]})})]}),l.jsxs(Ke,{children:[l.jsx(qe,{children:l.jsxs(Je,{className:"flex items-center gap-2",children:["Pricing",s&&l.jsxs(Pa,{variant:"secondary",className:"text-xs",children:["Recalculated for ",t.toLocaleString("sv-SE")]})]})}),l.jsxs(Ye,{className:"space-y-3",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"Underlying Value (Investment)"}),l.jsx("span",{className:"font-medium",children:r.toLocaleString("sv-SE")})]}),l.jsx(Ge,{}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"Strike Price"}),l.jsx("span",{className:"font-medium",children:n(e.StrikePrice,"StrikePrice")})]}),l.jsx(Ge,{}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"Number of Contracts Based on Limit"}),l.jsx("span",{className:"font-medium",children:n(e.NumberOfContractsBasedOnLimit,"NumberOfContractsBasedOnLimit")})]}),l.jsx(Ge,{}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"Bid Price"}),l.jsx("span",{className:"font-medium",children:n(e.Bid,"Bid")})]}),l.jsx(Ge,{}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"Ask Price"}),l.jsx("span",{className:"font-medium",children:n(e.Ask,"Ask")})]}),l.jsx(Ge,{}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"Bid-Ask Mid Price"}),l.jsx("span",{className:"font-medium",children:n(e.Bid_Ask_Mid_Price,"Bid_Ask_Mid_Price")})]}),l.jsx(Ge,{}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"Option Price Min"}),l.jsx("span",{className:"font-medium",children:n(e.Option_Price_Min,"Option_Price_Min")})]}),s&&l.jsxs(l.Fragment,{children:[l.jsx(Ge,{}),l.jsxs("div",{className:"bg-muted/50 p-3 rounded-lg space-y-2",children:[l.jsx("p",{className:"text-xs text-muted-foreground font-medium",children:"Original vs Recalculated Values"}),l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{children:"Original Premium:"}),l.jsx("span",{children:n(e.originalPremium,"Premium")})]}),l.jsxs("div",{className:"flex justify-between text-sm font-medium",children:[l.jsx("span",{children:"Current Premium:"}),l.jsx("span",{children:n(e.Premium,"Premium")})]})]})]})]})]}),l.jsx(K7,{optionName:e.OptionName}),l.jsxs(Ke,{children:[l.jsx(qe,{children:l.jsx(Je,{children:"Events Before Expiry Day"})}),l.jsx(Ye,{children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-muted-foreground",children:"Financial Report"}),l.jsx("p",{className:"font-medium",children:n(e.FinancialReport,"FinancialReport")})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-muted-foreground",children:"X-Day"}),l.jsx("p",{className:"font-medium",children:n(e["X-Day"],"X-Day")})]})]})})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"flex flex-col gap-6",children:[l.jsxs(Ke,{children:[l.jsx(qe,{children:l.jsx(Je,{children:"Risk Metrics"})}),l.jsxs(Ye,{className:"space-y-3",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"Historical 100Days Worst Decline"}),l.jsx("span",{className:"font-medium",children:n(e.Historical100DaysWorstDecline,"Historical100DaysWorstDecline")})]}),l.jsx(Ge,{}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"Historical 50Days Worst Decline"}),l.jsx("span",{className:"font-medium",children:n(e.Historical50DaysWorstDecline,"Historical50DaysWorstDecline")})]}),l.jsx(Ge,{}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"2008 100Days Worst Decline"}),l.jsx("span",{className:"font-medium",children:n(e["2008_100DaysWorstDecline"],"2008_100DaysWorstDecline")})]}),l.jsx(Ge,{}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"2008 50Days Worst Decline"}),l.jsx("span",{className:"font-medium",children:n(e["2008_50DaysWorstDecline"],"2008_50DaysWorstDecline")})]}),l.jsx(Ge,{}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"Worst Historical Decline"}),l.jsx("span",{className:"font-medium",children:n(e.WorstHistoricalDecline,"WorstHistoricalDecline")})]}),l.jsx(Ge,{}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"Bad Historical Decline"}),l.jsx("span",{className:"font-medium",children:n(e.BadHistoricalDecline,"BadHistoricalDecline")})]}),l.jsx(Ge,{}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"Stock Price After 100Day Worst Decline"}),l.jsx("span",{className:"font-medium",children:n(e.StockPrice_After_100DayWorstDecline,"StockPrice_After_100DayWorstDecline")})]}),l.jsx(Ge,{}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"Stock Price After 50Day Worst Decline"}),l.jsx("span",{className:"font-medium",children:n(e.StockPrice_After_50DayWorstDecline,"StockPrice_After_50DayWorstDecline")})]}),l.jsx(Ge,{}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"Stock Price After 2008 50Day Worst Decline"}),l.jsx("span",{className:"font-medium",children:n(e.StockPrice_After_2008_50DayWorstDecline,"StockPrice_After_2008_50DayWorstDecline")})]}),l.jsx(Ge,{}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"Stock Price After 2008 100Day Worst Decline"}),l.jsx("span",{className:"font-medium",children:n(e.StockPrice_After_2008_100DayWorstDecline,"StockPrice_After_2008_100DayWorstDecline")})]}),l.jsx(Ge,{}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"100Day Max Price"}),l.jsx("span",{className:"font-medium",children:n(e["100DayMaxPrice"],"100DayMaxPrice")})]}),l.jsx(Ge,{}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"100Day Max Price Date"}),l.jsx("span",{className:"font-medium",children:n(e["100DayMaxPriceDate"],"100DayMaxPriceDate")})]}),l.jsx(Ge,{}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"50Day Max Price"}),l.jsx("span",{className:"font-medium",children:n(e["50DayMaxPrice"],"50DayMaxPrice")})]}),l.jsx(Ge,{}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"50Day Max Price Date"}),l.jsx("span",{className:"font-medium",children:n(e["50DayMaxPriceDate"],"50DayMaxPriceDate")})]})]})]}),l.jsxs(Ke,{children:[l.jsx(qe,{children:l.jsx(Je,{children:"Risk Metrics (Absolute Values)"})}),l.jsxs(Ye,{className:"space-y-3",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"Figures Assume Underlying Value"}),l.jsx("span",{className:"font-medium",children:n(e.Underlying_Value,"Underlying_Value")})]}),l.jsx(Ge,{}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"100k Invested Loss Mean"}),l.jsx("span",{className:"font-medium",children:n(e["100k_Invested_Loss_Mean"],"100k_Invested_Loss_Mean")})]}),l.jsx(Ge,{}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"Loss Least Bad"}),l.jsx("span",{className:"font-medium",children:n(e.Loss_Least_Bad,"Loss_Least_Bad")})]}),l.jsx(Ge,{}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"Loss At 2008 100Day Worst Decline"}),l.jsx("span",{className:"font-medium",children:n(e.LossAt_2008_100DayWorstDecline,"LossAt_2008_100DayWorstDecline")})]}),l.jsx(Ge,{}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"Loss At 2008 50Day Worst Decline"}),l.jsx("span",{className:"font-medium",children:n(e.LossAt_2008_50DayWorstDecline,"LossAt_2008_50DayWorstDecline")})]}),l.jsx(Ge,{}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"Loss At 100Day Worst Decline"}),l.jsx("span",{className:"font-medium",children:n(e.LossAt100DayWorstDecline,"LossAt100DayWorstDecline")})]}),l.jsx(Ge,{}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"Loss At 50Day Worst Decline"}),l.jsx("span",{className:"font-medium",children:n(e.LossAt50DayWorstDecline,"LossAt50DayWorstDecline")})]})]})]})]}),l.jsxs(Ke,{children:[l.jsx(qe,{children:l.jsx(Je,{children:"Volatility"})}),l.jsxs(Ye,{className:"space-y-3",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"Implied Volatility (Current)"}),l.jsx(i,{content:"Current Option",children:l.jsx(Mn,{className:"h-3 w-3 text-muted-foreground cursor-help"})}),l.jsx(a,{content:"Current Option"})]}),l.jsx("span",{className:"font-medium",children:n(e.ImpliedVolatility,"ImpliedVolatility")})]}),l.jsx(Ge,{}),l.jsxs("div",{className:"flex justify-between",children:[l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"Implied Volatility (Market Median)"}),l.jsx(i,{content:"Median All Stock Options Nearest Strike, ≤ 100 Days to Expiry",children:l.jsx(Mn,{className:"h-3 w-3 text-muted-foreground cursor-help"})}),l.jsx(a,{content:"Median All Stock Options Nearest Strike, ≤ 100 Days to Expiry"})]}),l.jsx("span",{className:"font-medium",children:n(e.AllMedianIV_Maximum100DaysToExp,"AllMedianIV_Maximum100DaysToExp")})]}),l.jsx(Ge,{}),l.jsxs("div",{className:"flex justify-between",children:[l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"Implied Volatility (Stock Median)"}),l.jsx(i,{content:"Median All Stock Options, ≤ 100 Days to Expiry",children:l.jsx(Mn,{className:"h-3 w-3 text-muted-foreground cursor-help"})}),l.jsx(a,{content:"Median All Stock Options, ≤ 100 Days to Expiry"})]}),l.jsx("span",{className:"font-medium",children:n(e.TodayStockMedianIV_Maximum100DaysToExp,"TodayStockMedianIV_Maximum100DaysToExp")})]}),l.jsx(Ge,{}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"Lower Bound"}),l.jsx("span",{className:"font-medium",children:n(e.Lower_Bound,"Lower_Bound")})]}),l.jsx(Ge,{}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"Lower Bound at Accuracy"}),l.jsx("span",{className:"font-medium",children:n(e.Lower_Bound_at_Accuracy,"Lower_Bound_at_Accuracy")})]}),l.jsx(Ge,{}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"Lower Bound Hist Median IV"}),l.jsx("span",{className:"font-medium",children:n(e.Lower_Bound_HistMedianIV,"Lower_Bound_HistMedianIV")})]}),l.jsx(Ge,{}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"Lower Bound Hist Median IV at Accuracy"}),l.jsx("span",{className:"font-medium",children:n(e.Lower_Bound_HistMedianIV_at_Accuracy,"Lower_Bound_HistMedianIV_at_Accuracy")})]}),l.jsx(Ge,{}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"Implied Volatility Until Expiry"}),l.jsx("span",{className:"font-medium",children:n(e.ImpliedVolatilityUntilExpiry,"ImpliedVolatilityUntilExpiry")})]})]})]}),l.jsxs(Ke,{children:[l.jsx(qe,{children:l.jsx(Je,{children:"Probability of Worthless Bayesian IsoCal Monte Carlo Simulation"})}),l.jsxs(Ye,{className:"space-y-3",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"Mean Earnings"}),l.jsx("span",{className:"font-medium",children:n(e.PoW_Simulation_Mean_Earnings,"PoW_Simulation_Mean_Earnings")})]}),l.jsx(Ge,{}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"Stats Median Loss"}),l.jsx("span",{className:"font-medium",children:n(e.PoW_Stats_MedianLoss,"PoW_Stats_MedianLoss")})]}),l.jsx(Ge,{}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"Stats Median Loss Pct"}),l.jsx("span",{className:"font-medium",children:n(e.PoW_Stats_MedianLossPct,"PoW_Stats_MedianLossPct")})]}),l.jsx(Ge,{}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"Stats Worst Loss"}),l.jsx("span",{className:"font-medium",children:n(e.PoW_Stats_WorstLoss,"PoW_Stats_WorstLoss")})]}),l.jsx(Ge,{}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-muted-foreground",children:"Stats Worst Loss Pct"}),l.jsx("span",{className:"font-medium",children:n(e.PoW_Stats_WorstLossPct,"PoW_Stats_WorstLossPct")})]})]})]})]})]})})},X7=()=>{const{optionId:e}=Ug(),t=ms();wh();const{data:r}=O0(),n=()=>{t(-1)},s=r.find(a=>encodeURIComponent(a.OptionName)===e);return s?l.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("h1",{className:"text-3xl font-bold",children:"Option Details"}),l.jsxs(Ee,{variant:"outline",onClick:n,className:"flex items-center gap-2",children:[l.jsx(Zr,{className:"h-4 w-4"}),"Back to Overview"]})]}),l.jsx(Y7,{option:s})]}):l.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[l.jsx("div",{className:"flex items-center gap-4",children:l.jsxs(Ee,{variant:"outline",onClick:n,className:"flex items-center gap-2",children:[l.jsx(Zr,{className:"h-4 w-4"}),"Back to Overview"]})}),l.jsxs("div",{className:"text-center",children:[l.jsx("h1",{className:"text-2xl font-bold",children:"Option Not Found"}),l.jsx("p",{className:"text-muted-foreground mt-2",children:"The requested option could not be found."})]})]})},q7=({data:e,stockName:t})=>{const[r,n]=m.useState("6M"),[s,a]=m.useState("price"),o=(()=>{if(r==="ALL")return e;const v=new Date,g=r==="1M"?1:r==="3M"?3:r==="6M"?6:12,x=new Date(v.getFullYear(),v.getMonth()-g,v.getDate());return e.filter(y=>new Date(y.date)>=x)})(),c=()=>{if(s==="volume")return["auto","auto"];const v=o.map(w=>w.close);if(v.length===0)return["auto","auto"];const g=Math.min(...v),x=Math.max(...v),y=(x-g)*.1;return[Math.max(0,g-y),x+y]},u=()=>{if(o.length===0)return[];const v=[...o].sort((w,_)=>new Date(w.date).getTime()-new Date(_.date).getTime()),x=new Date(v[v.length-1].date).getDate();let y=[];if(r==="1M")y=v.filter((w,_)=>_%5===0);else if(r==="3M")y=v.filter((w,_)=>_%14===0);else if(r==="6M")y=v.filter(w=>{const _=new Date(w.date);return _.getDate()===x||Math.abs(_.getDate()-x)<=2});else if(r==="1Y")y=v.filter(w=>{const _=new Date(w.date);return _.getDate()===x||Math.abs(_.getDate()-x)<=2});else{const w=v.length,_=Math.max(1,Math.floor(w/8));y=v.filter((b,T)=>T%_===0)}return y.map(w=>w.date)},d=(v,g)=>g==="close"?[`${v.toFixed(2)}`,"Price"]:g==="volume"?[v.toLocaleString("sv-SE"),"Volume"]:[v,g],f=v=>v.toFixed(2),h=v=>v>=1e6?`${(v/1e6).toFixed(1)}M`:v>=1e3?`${(v/1e3).toFixed(0)}K`:v.toString(),p=v=>{const g=new Date(v);return r==="1Y"||r==="ALL"?g.toLocaleDateString("en-US",{month:"short",year:"2-digit"}):g.toLocaleDateString("en-US",{month:"short",day:"numeric"})};return l.jsxs(Ke,{children:[l.jsxs(qe,{className:"space-y-4",children:[l.jsxs(Je,{className:"flex items-center gap-2",children:[l.jsx(Wo,{className:"h-5 w-5"}),t," Stock Price Chart"]}),l.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.jsx("div",{className:"flex gap-1",children:["1M","3M","6M","1Y","ALL"].map(v=>l.jsx(Ee,{variant:r===v?"default":"outline",size:"sm",onClick:()=>n(v),children:v},v))}),l.jsxs("div",{className:"flex gap-1",children:[l.jsxs(Ee,{variant:s==="price"?"default":"outline",size:"sm",onClick:()=>a("price"),children:[l.jsx(Uo,{className:"h-4 w-4 mr-1"}),"Price"]}),l.jsxs(Ee,{variant:s==="volume"?"default":"outline",size:"sm",onClick:()=>a("volume"),children:[l.jsx(Ea,{className:"h-4 w-4 mr-1"}),"Volume"]}),l.jsx(Ee,{variant:s==="both"?"default":"outline",size:"sm",onClick:()=>a("both"),children:"Both"})]})]})]}),l.jsx(Ye,{children:l.jsx("div",{className:"h-96",children:l.jsx(Is,{width:"100%",height:"100%",children:s==="both"?l.jsxs(WS,{data:o,children:[l.jsx(rs,{strokeDasharray:"3 3",className:"opacity-30"}),l.jsx(ns,{dataKey:"date",tickFormatter:p,className:"text-muted-foreground",ticks:u()}),l.jsx(Fn,{yAxisId:"price",orientation:"left",className:"text-muted-foreground",domain:c(),tickFormatter:f}),l.jsx(Fn,{yAxisId:"volume",orientation:"right",className:"text-muted-foreground",tickFormatter:h}),l.jsx(ss,{formatter:d,labelFormatter:v=>new Date(v).toISOString().split("T")[0],contentStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"var(--radius)"}}),l.jsx(Ac,{}),l.jsx(Nc,{yAxisId:"price",dataKey:"close",stroke:"hsl(var(--primary))",strokeWidth:2,dot:!1,name:"Price"}),l.jsx(Es,{yAxisId:"volume",dataKey:"volume",fill:"hsl(var(--muted-foreground))",fillOpacity:.3,name:"Volume"})]}):l.jsxs(yh,{data:o,children:[l.jsx(rs,{strokeDasharray:"3 3",className:"opacity-30"}),l.jsx(ns,{dataKey:"date",tickFormatter:p,className:"text-muted-foreground",ticks:u()}),l.jsx(Fn,{className:"text-muted-foreground",domain:s==="price"?c():["auto","auto"],tickFormatter:s==="price"?f:h}),l.jsx(ss,{formatter:d,labelFormatter:v=>new Date(v).toISOString().split("T")[0],contentStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"var(--radius)"}}),l.jsx(Ac,{}),l.jsx(Nc,{dataKey:s==="price"?"close":"volume",stroke:"hsl(var(--primary))",strokeWidth:2,dot:!1,name:s==="price"?"Price":"Volume"})]})})})})]})},J7=({stockData:e,stockSummary:t})=>{const r=t.priceChange>=0,{getPriceRangeForPeriod:n}=pd(),s=[{label:"1 Week",days:7},{label:"1 Month",days:30},{label:"3 Months",days:90},{label:"6 Months",days:180},{label:"9 Months",days:270},{label:"1 Year",days:365}];return l.jsxs("div",{className:"space-y-6",children:[l.jsxs(Ke,{children:[l.jsx(qe,{children:l.jsxs(Je,{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(Ea,{className:"h-6 w-6"}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold",children:t.name}),l.jsx("p",{className:"text-muted-foreground",children:"Stock Analysis"})]})]}),l.jsxs(Pa,{variant:r?"default":"destructive",className:"text-lg px-3 py-1",children:[r?l.jsx(Uo,{className:"h-4 w-4 mr-1"}):l.jsx(yx,{className:"h-4 w-4 mr-1"}),r?"+":"",t.priceChangePercent.toFixed(2),"%"]})]})}),l.jsx(Ye,{children:l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:"text-sm text-muted-foreground",children:"Current Price"}),l.jsx("p",{className:"text-2xl font-bold",children:t.currentPrice.toFixed(2)}),l.jsxs("p",{className:`text-sm ${r?"text-green-600":"text-red-600"}`,children:[r?"+":"",t.priceChange.toFixed(2)]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[l.jsx(J2,{className:"h-4 w-4"}),"Median Daily Volume"]}),l.jsx("p",{className:"text-xl font-semibold",children:ji(t.medianVolume,"volume")})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[l.jsx(Di,{className:"h-4 w-4"}),"1 Year Range"]}),l.jsxs("p",{className:"text-lg font-medium",children:[t.lowPrice52Week.toFixed(2)," - ",t.highPrice52Week.toFixed(2)]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[l.jsx(Wo,{className:"h-4 w-4"}),"Volatility"]}),l.jsxs("p",{className:"text-xl font-semibold",children:[t.volatility.toFixed(1),"%"]})]})]})})]}),l.jsxs(Ke,{children:[l.jsx(qe,{children:l.jsxs(Je,{className:"flex items-center gap-2",children:[l.jsx(Di,{className:"h-5 w-5"}),"Price Ranges"]})}),l.jsx(Ye,{children:l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-6",children:s.map(a=>{const i=n(t.name,a.days);return l.jsxs("div",{className:"space-y-1",children:[l.jsx("p",{className:"text-xs text-muted-foreground font-medium",children:a.label}),i?l.jsxs("p",{className:"text-sm font-semibold",children:[i.low.toFixed(2)," - ",i.high.toFixed(2)]}):l.jsx("p",{className:"text-xs text-muted-foreground",children:"No data"})]},a.days)})})})]}),l.jsx(q7,{data:e,stockName:t.name}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxs(Ke,{children:[l.jsx(qe,{children:l.jsxs(Je,{className:"flex items-center gap-2",children:[l.jsx(Uo,{className:"h-5 w-5"}),"Performance Metrics"]})}),l.jsxs(Ye,{className:"space-y-4",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-muted-foreground",children:"1-Day Change"}),l.jsxs("span",{className:r?"text-green-600":"text-red-600",children:[r?"+":"",t.priceChangePercent.toFixed(2),"%"]})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-muted-foreground",children:"1-Year High"}),l.jsx("span",{className:"font-medium",children:t.highPrice52Week.toFixed(2)})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-muted-foreground",children:"1-Year Low"}),l.jsx("span",{className:"font-medium",children:t.lowPrice52Week.toFixed(2)})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-muted-foreground",children:"Distance from 1-Year High"}),l.jsxs("span",{className:"font-medium",children:[((t.currentPrice-t.highPrice52Week)/t.highPrice52Week*100).toFixed(1),"%"]})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-muted-foreground",children:"Distance from 1-Year Low"}),l.jsxs("span",{className:"font-medium",children:[((t.currentPrice-t.lowPrice52Week)/t.lowPrice52Week*100).toFixed(1),"%"]})]})]})]}),l.jsxs(Ke,{children:[l.jsx(qe,{children:l.jsxs(Je,{className:"flex items-center gap-2",children:[l.jsx(Wo,{className:"h-5 w-5"}),"Risk Metrics"]})}),l.jsxs(Ye,{className:"space-y-4",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-muted-foreground",children:"Annualized Volatility"}),l.jsxs("span",{className:"font-medium",children:[t.volatility.toFixed(1),"%"]})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-muted-foreground",children:"Median Volume"}),l.jsx("span",{className:"font-medium",children:ji(t.medianVolume,"volume")})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-muted-foreground",children:"Price Range (1Y)"}),l.jsx("span",{className:"font-medium",children:(t.highPrice52Week-t.lowPrice52Week).toFixed(2)})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-muted-foreground",children:"Range Ratio"}),l.jsxs("span",{className:"font-medium",children:[(t.highPrice52Week/t.lowPrice52Week).toFixed(2),"x"]})]})]})]})]})]})},Q7=()=>{const{stockName:e}=Ug(),t=ms();wh();const{getStockData:r,getStockSummary:n,isLoading:s,error:a}=pd(),i=()=>{t(-1)};if(!e)return l.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[l.jsx("div",{className:"flex items-center gap-4",children:l.jsxs(Ee,{variant:"outline",onClick:i,className:"flex items-center gap-2",children:[l.jsx(Zr,{className:"h-4 w-4"}),"Back to Options"]})}),l.jsxs("div",{className:"text-center",children:[l.jsx("h1",{className:"text-2xl font-bold",children:"Invalid Stock"}),l.jsx("p",{className:"text-muted-foreground mt-2",children:"No stock name provided."})]})]});const o=decodeURIComponent(e),c=r(o),u=n(o);return s?l.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[l.jsx("div",{className:"flex items-center gap-4",children:l.jsxs(Ee,{variant:"outline",onClick:i,className:"flex items-center gap-2",children:[l.jsx(Zr,{className:"h-4 w-4"}),"Back to Options"]})}),l.jsx("div",{className:"flex items-center justify-center py-12",children:l.jsxs("div",{className:"text-center space-y-4",children:[l.jsx(rE,{className:"h-8 w-8 animate-spin mx-auto"}),l.jsx("p",{className:"text-muted-foreground",children:"Loading stock data..."})]})})]}):a?l.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[l.jsx("div",{className:"flex items-center gap-4",children:l.jsxs(Ee,{variant:"outline",onClick:i,className:"flex items-center gap-2",children:[l.jsx(Zr,{className:"h-4 w-4"}),"Back to Options"]})}),l.jsxs("div",{className:"text-center",children:[l.jsx("h1",{className:"text-2xl font-bold",children:"Error Loading Stock Data"}),l.jsx("p",{className:"text-muted-foreground mt-2",children:a})]})]}):!u||c.length===0?l.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[l.jsx("div",{className:"flex items-center gap-4",children:l.jsxs(Ee,{variant:"outline",onClick:i,className:"flex items-center gap-2",children:[l.jsx(Zr,{className:"h-4 w-4"}),"Back to Options"]})}),l.jsxs("div",{className:"text-center",children:[l.jsx("h1",{className:"text-2xl font-bold",children:"Stock Not Found"}),l.jsxs("p",{className:"text-muted-foreground mt-2",children:['No data available for "',o,'".']})]})]}):l.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("h1",{className:"text-3xl font-bold",children:"Stock Analysis"}),l.jsxs(Ee,{variant:"outline",onClick:i,className:"flex items-center gap-2",children:[l.jsx(Zr,{className:"h-4 w-4"}),"Back to Options"]})]}),l.jsx(J7,{stockData:c,stockSummary:u})]})},Z7=()=>{const e=_h(),{session:t,loading:r}=ea();return m.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",e.pathname,"Session:",!!t,"Loading:",r)},[e.pathname,t,r]),l.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:l.jsxs("div",{className:"text-center",children:[l.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),l.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),l.jsxs("div",{className:"flex items-center justify-center gap-4",children:[l.jsx(Dc,{to:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"}),l.jsx(Dc,{to:"/auth",className:"text-blue-500 hover:text-blue-700 underline",children:"Go to Login"})]})]})})},eW=()=>{const{signIn:e,signUp:t,session:r}=ea(),n=ms(),s=_h(),[a,i]=m.useState(""),[o,c]=m.useState(""),[u,d]=m.useState(null),[f,h]=m.useState(null),p=m.useMemo(()=>{var x,y;return((y=(x=s.state)==null?void 0:x.from)==null?void 0:y.pathname)||"/"},[s.state]);m.useEffect(()=>{document.title="Sign in | Put Options SE"},[]),m.useEffect(()=>{r&&n(p,{replace:!0})},[r,n,p]);const v=async x=>{x.preventDefault(),d(null),h(null);const{error:y}=await e(a,o);if(y){console.error("Supabase sign-in error:",y);const w=y.message==="Failed to fetch"?"Network/CORS error. Please check your connection and try again.":y.message??"Failed to sign in";d(w)}},g=async x=>{x.preventDefault(),d(null),h(null);const{error:y}=await t(a,o);if(y){console.error("Supabase sign-up error:",y);const w=y.message==="Failed to fetch"?"Network/CORS error. Please check your connection and try again.":y.message??"Failed to sign up";d(w)}else h("Check your email to confirm your account, then return here.")};return l.jsx("main",{className:"min-h-screen flex items-center justify-center p-4",children:l.jsxs(Ke,{className:"w-full max-w-md",children:[l.jsx(qe,{children:l.jsx(Je,{className:"text-center",children:"Sign in to Put Options SE"})}),l.jsx(Ye,{children:l.jsxs(md,{defaultValue:"signin",children:[l.jsxs(Bl,{className:"grid grid-cols-2 w-full",children:[l.jsx(Ln,{value:"signin",children:"Sign In"}),l.jsx(Ln,{value:"signup",children:"Sign Up"})]}),l.jsx(Bn,{value:"signin",children:l.jsxs("form",{onSubmit:v,className:"space-y-4 mt-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(ze,{htmlFor:"email",children:"Email"}),l.jsx(Rt,{id:"email",type:"email",value:a,onChange:x=>i(x.target.value),required:!0,placeholder:"you@example.com"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(ze,{htmlFor:"password",children:"Password"}),l.jsx(Rt,{id:"password",type:"password",value:o,onChange:x=>c(x.target.value),required:!0,placeholder:"Your password"})]}),u&&l.jsx("p",{className:"text-sm",children:u}),l.jsx(Ee,{type:"submit",className:"w-full",children:"Sign In"})]})}),l.jsx(Bn,{value:"signup",children:l.jsxs("form",{onSubmit:g,className:"space-y-4 mt-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(ze,{htmlFor:"email2",children:"Email"}),l.jsx(Rt,{id:"email2",type:"email",value:a,onChange:x=>i(x.target.value),required:!0,placeholder:"you@example.com"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(ze,{htmlFor:"password2",children:"Password"}),l.jsx(Rt,{id:"password2",type:"password",value:o,onChange:x=>c(x.target.value),required:!0,placeholder:"Create a strong password"})]}),u&&l.jsx("p",{className:"text-sm",children:u}),f&&l.jsx("p",{className:"text-sm",children:f}),l.jsx(Ee,{type:"submit",className:"w-full",children:"Create Account"})]})})]})})]})})},tW=()=>{const e=ms();return m.useEffect(()=>{const t=setTimeout(async()=>{const{data:{session:r}}=await mr.auth.getSession();e(r?"/":"/auth",{replace:!0})},800);return()=>clearTimeout(t)},[e]),l.jsxs("div",{className:"p-6",children:[l.jsx("p",{children:"Finishing sign in…"}),l.jsxs("p",{className:"mt-2",children:["If you are not redirected, ",l.jsx(Dc,{to:"/auth",className:"underline",children:"go to login"}),"."]})]})},li=({children:e})=>{const{session:t,loading:r}=ea(),n=_h();return console.log("ProtectedRoute - session:",!!t,"loading:",r,"location:",n.pathname),r?l.jsx("div",{className:"p-6",children:"Loading..."}):t?l.jsx(l.Fragment,{children:e}):l.jsx(US,{to:"/auth",replace:!0,state:{from:n}})};class rW extends m.Component{constructor(){super(...arguments);Q0(this,"state",{hasError:!1})}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,n){console.error("ErrorBoundary caught an error:",r,n)}render(){var r,n;return this.state.hasError?l.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:l.jsxs("div",{className:"text-center max-w-md",children:[l.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Something went wrong"}),l.jsx("p",{className:"text-muted-foreground mb-4",children:"The application encountered an error and couldn't render properly."}),l.jsxs("details",{className:"text-left text-sm bg-muted p-4 rounded mb-4",children:[l.jsx("summary",{className:"cursor-pointer font-medium",children:"Error details"}),l.jsxs("pre",{className:"mt-2 text-xs overflow-auto",children:[(r=this.state.error)==null?void 0:r.message,`
`,(n=this.state.error)==null?void 0:n.stack]})]}),l.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-primary text-primary-foreground rounded hover:bg-primary/90",children:"Reload Page"})]})}):this.props.children}}const nW=({isOpen:e,onOpenChange:t,triggerButton:r=!0})=>{const{underlyingValue:n,setUnderlyingValue:s,transactionCost:a,setTransactionCost:i}=Yi(),[o,c]=m.useState(n),[u,d]=m.useState(a),[f,h]=m.useState(n.toString()),[p,v]=m.useState(!1),g=e!==void 0?e:p,x=t||v;m.useEffect(()=>{g&&(console.log("SettingsModal: Modal opened, syncing values:",{underlyingValue:n,transactionCost:a}),c(n),d(a),h(n.toString()))},[g,n,a]);const y=E=>{const C=E[0];c(C),h(C.toString())},w=E=>{h(E.target.value)},_=()=>{const E=f.replace(/[^0-9]/g,""),C=parseInt(E,10);if(isNaN(C))h(o.toString());else{const L=Math.max(1e4,Math.min(1e6,C));c(L),h(L.toString())}},b=E=>{const C=E.target.value.replace(/[^0-9]/g,""),L=parseInt(C,10);!isNaN(L)&&L>=0&&d(L)},T=()=>{o>=1e4&&o<=1e6?(s(o),i(u),x(!1),Ir.success(`Settings updated: Underlying value ${o.toLocaleString("sv-SE")}, Transaction cost ${u}`)):Ir.error("Please enter a value between 10 000 and 1 000 000")},k=()=>{c(n),d(a),h(n.toString()),x(!1)},S=E=>E.toLocaleString("sv-SE");return l.jsxs(Al,{open:g,onOpenChange:x,children:[r&&l.jsx(Nl,{asChild:!0,children:l.jsxs(Ee,{variant:"outline",size:"sm",onClick:()=>{c(n),d(a),h(n.toString()),x(!0)},children:[l.jsx(xl,{className:"h-4 w-4 mr-2"}),"Settings"]})}),l.jsxs(qi,{className:"sm:max-w-md",children:[l.jsx(Xu,{children:l.jsx(qu,{children:"Calculation Settings"})}),l.jsxs("div",{className:"space-y-6 py-4",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(ze,{htmlFor:"underlying-value",children:"Underlying Stock Value for Premium Calculation"}),l.jsx("p",{className:"text-sm text-muted-foreground",children:"This value is used to calculate the number of contracts and Premium. Default is 100,000."})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsxs(ze,{children:["Current Value: ",S(o)]}),l.jsx(q0,{value:[o],onValueChange:y,max:1e6,min:1e4,step:1e3,className:"w-full"}),l.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[l.jsx("span",{children:"10 000"}),l.jsx("span",{children:"1 000 000"})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(ze,{htmlFor:"underlying-input",children:"Or enter exact value:"}),l.jsx(Rt,{id:"underlying-input",type:"text",value:f,onChange:w,onBlur:_,placeholder:"100 000"})]})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(ze,{htmlFor:"transaction-cost",children:"Transaction Cost"}),l.jsx("p",{className:"text-sm text-muted-foreground",children:"The transaction cost that will be subtracted from the premium calculation. Default is 150."})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(ze,{htmlFor:"transaction-cost-input",children:"Transaction Cost:"}),l.jsx(Rt,{id:"transaction-cost-input",type:"text",value:u.toString(),onChange:b,placeholder:"150"})]})]}),l.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[l.jsx(Ee,{variant:"outline",onClick:k,children:"Cancel"}),l.jsx(Ee,{onClick:T,children:"Apply Settings"})]})]})]})]})},sW=()=>{const e=ms(),{signOut:t}=ea(),[r,n]=m.useState(!1);Yi();const{setTheme:s,theme:a}=Dx();return l.jsxs(l.Fragment,{children:[l.jsxs(On,{children:[l.jsx(In,{asChild:!0,children:l.jsxs(Ee,{variant:"outline",size:"icon",className:"h-9 w-9",children:[l.jsx(sE,{className:"h-4 w-4"}),l.jsx("span",{className:"sr-only",children:"Open menu"})]})}),l.jsxs(pn,{align:"start",className:"w-56 bg-background border shadow-lg z-50",children:[l.jsxs(Jt,{onClick:()=>e("/portfolio-generator"),className:"cursor-pointer",children:[l.jsx(Ea,{className:"mr-2 h-4 w-4"}),"Portfolio Generator"]}),l.jsxs(Jt,{onClick:()=>e("/monthly-analysis"),className:"cursor-pointer",children:[l.jsx(Uo,{className:"mr-2 h-4 w-4"}),"Monthly Analysis"]}),l.jsxs(Jt,{onClick:()=>e("/volatility-analysis"),className:"cursor-pointer",children:[l.jsx(Wo,{className:"mr-2 h-4 w-4"}),"Financial Reporting Volatility"]}),l.jsxs(Jt,{onClick:()=>{n(!0)},className:"cursor-pointer",children:[l.jsx(xl,{className:"mr-2 h-4 w-4"}),"Settings"]}),l.jsx(Jt,{onClick:()=>s(a==="light"?"dark":"light"),className:"cursor-pointer",children:a==="light"?l.jsx(aE,{className:"mr-2 h-4 w-4"}):l.jsx(lE,{className:"mr-2 h-4 w-4"})}),l.jsx(rb,{}),l.jsxs(Jt,{onClick:t,className:"cursor-pointer text-destructive focus:text-destructive",children:[l.jsx(nE,{className:"mr-2 h-4 w-4"}),"Sign out"]})]})]}),l.jsx(nW,{isOpen:r,onOpenChange:n,triggerButton:!1})]})},aW=new vk,iW=()=>{const{session:e}=ea();return l.jsxs("header",{className:"w-full flex items-center justify-between px-4 py-2",children:[l.jsx("div",{className:"flex items-center gap-3",children:e&&l.jsx(sW,{})}),l.jsx("div",{children:!e&&l.jsx(Ee,{asChild:!0,children:l.jsx(Dc,{to:"/auth",children:"Sign in"})})})]})},oW=()=>{const e=window.location.hostname==="datamilo.github.io",t=e?"/put-options-se":"";return console.log("App component rendering",{location:window.location.href,pathname:window.location.pathname,hash:window.location.hash,hostname:window.location.hostname,isGitHubPages:e,basename:t}),l.jsx(wk,{client:aW,children:l.jsx(YE,{attribute:"class",defaultTheme:"light",storageKey:"vite-ui-theme",children:l.jsx(BA,{children:l.jsx($A,{children:l.jsx(zi,{children:l.jsxs(rW,{children:[l.jsx(zE,{}),l.jsx(ST,{}),l.jsxs(VS,{basename:t,children:[l.jsx(iW,{}),l.jsxs(HS,{children:[l.jsx(Kn,{path:"/auth",element:l.jsx(eW,{})}),l.jsx(Kn,{path:"/auth/callback",element:l.jsx(tW,{})}),l.jsx(Kn,{path:"/",element:l.jsx(li,{children:l.jsx(J6,{})})}),l.jsx(Kn,{path:"/portfolio-generator",element:l.jsx(li,{children:l.jsx(rB,{})})}),l.jsx(Kn,{path:"/monthly-analysis",element:l.jsx(li,{children:l.jsx(L7,{})})}),l.jsx(Kn,{path:"/volatility-analysis",element:l.jsx(li,{children:l.jsx(U7,{})})}),l.jsx(Kn,{path:"/option/:optionId",element:l.jsx(li,{children:l.jsx(X7,{})})}),l.jsx(Kn,{path:"/stock/:stockName",element:l.jsx(li,{children:l.jsx(Q7,{})})}),l.jsx(Kn,{path:"*",element:l.jsx(Z7,{})})]})]})]})})})})})})};console.log("Main.tsx loading...",{env:"production",base:"/put-options-se",location:window.location.href,origin:window.location.origin});try{console.log("DOM ready, attempting to render React app...");const e=document.getElementById("root");if(!e)throw new Error("Root element not found in DOM");zg(e).render(l.jsx(oW,{})),console.log("✅ App rendered successfully on GitHub Pages")}catch(e){console.error("❌ Failed to render app:",e);const t=e instanceof Error?e.message:String(e);document.body.innerHTML=`
    <div style="padding: 20px; font-family: Arial, sans-serif; max-width: 600px; margin: 50px auto; background: #f5f5f5; border-radius: 8px;">
      <h1 style="color: #d32f2f;">Application Error</h1>
      <p>Failed to load the Put Options SE application.</p>
      <details style="margin: 20px 0; padding: 10px; background: white; border-radius: 4px;">
        <summary style="cursor: pointer; font-weight: bold;">Error Details</summary>
        <pre style="margin-top: 10px; font-size: 12px; overflow: auto;">${t}</pre>
      </details>
      <div style="margin-top: 20px;">
        <button onclick="window.location.reload()" style="padding: 10px 20px; background: #1976d2; color: white; border: none; border-radius: 4px; cursor: pointer; margin-right: 10px;">
          Reload Page
        </button>
        <button onclick="window.location.href='https://put-options-se.lovable.app/'" style="padding: 10px 20px; background: #2e7d32; color: white; border: none; border-radius: 4px; cursor: pointer;">
          Go to Staging
        </button>
      </div>
      <p style="margin-top: 20px; font-size: 12px; color: #666;">
        Base URL: /put-options-se<br>
        Mode: production<br>
        Location: ${window.location.href}
      </p>
    </div>
  `}
