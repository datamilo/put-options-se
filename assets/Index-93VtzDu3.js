import{c as xe,u as Oe,j as e,D as fe,a as we,B as W,S as Qe,b as be,d as Fe,e as He,T as _e,f as Ke,g as ze,h as Ue,I as Z,i as et,L as Y,k as tt,s as Ce,l as G,m as X,n as J,o as me,p as st,C as se,q as le}from"./index-m-D8N6ZR.js";import{r as x,h as at,i as it}from"./router-C0wDHNfv.js";import{u as rt}from"./usePageTitle-CpPgFbZv.js";import{u as ot,D as ce}from"./data-timestamp-CMUnQ5nQ.js";import{T as nt,a as lt,b as Ne,c as ct,d as dt,e as mt}from"./table-HqYCl6OD.js";import{S as ht,a as ut}from"./scroll-area-DrcYSP2b.js";import{C as K}from"./checkbox-DoLqnuTW.js";import{B as pt}from"./badge-CHzMNEoj.js";import{u as yt,a as Le,D as gt,c as xt,S as ft,v as wt,b as bt,d as _t,s as It,K as vt,P as St,e as kt,C as Pt,G as jt,F as Ee,f as Mt}from"./excelExport-Cs-ALxfi.js";import{I as ae}from"./info-DTjHuAI_.js";import{D as he}from"./xlsx-CFAW_Hl2.js";import{A as Dt}from"./arrow-up-down-BIre76zI.js";import{C as ue,a as pe,b as ye,c as ge}from"./card-CFv4AOJA.js";import{T as $e,a as qe,b as ie,c as re}from"./tabs-BAV5jQe8.js";import{R as We,S as Ct,C as Be,X as Ve,Y as Ae,T as Re,L as Nt,a as Lt,B as Et,b as Wt}from"./charts-B8eVsusH.js";import{u as Bt}from"./useEnrichedOptionsData-CGjGgNf5.js";import{u as Vt}from"./useStockData-BWzV3G2_.js";import{F as At}from"./file-text-Crd3rh1b.js";import{R as Rt}from"./rotate-ccw-DPye7aKO.js";import{C as Tt}from"./chart-column-CsWshXwX.js";import"./csv-B1Pu-2A6.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=xe("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ot=xe("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ft=xe("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]),Ht=({column:g,onVisibilityChange:p})=>{const{attributes:o,listeners:D,setNodeRef:P,transform:v,transition:S,isDragging:l}=kt({id:g.key}),m={transform:Pt.Transform.toString(v),transition:S,opacity:l?.5:1},a=n=>{const y={"1_2_3_ProbOfWorthless_Weighted":"PoW - Weighted Average",ProbWorthless_Bayesian_IsoCal:"PoW - Bayesian Calibrated","1_ProbOfWorthless_Original":"PoW - Original Black-Scholes","2_ProbOfWorthless_Calibrated":"PoW - Bias Corrected","3_ProbOfWorthless_Historical_IV":"PoW - Historical IV"},C={DaysToExpiry:"Days to Expiry (business days)"},f={EstTotalMargin:"Est. Total Margin",Est_Margin_SEK:"Est. Margin per Contract",Prob_Normal_2SD_Decline_Pct:"Probability Normal 2SD Decline %",Hist_Worst_Decline_Pct:"Historical Worst Decline %",SRI_Base:"SRI Base",Event_Buffer:"Event Buffer",Final_SRI:"Final Safety-Risk Index",OTM_Amount:"OTM Amount",Margin_A_Broker_Proxy:"Margin A Broker Proxy",Margin_B_Historical_Floor:"Margin B Historical Floor",Margin_Floor_15pct:"Margin Floor 15%",Net_Premium_After_Costs:"Net Premium After Costs",Annualized_ROM_Pct:"Annualized Return on Margin %"},B={IV_2sigma_Decline:"IV 2-Sigma Decline",BreakevenDecline:"Breakeven Decline",CVaR10pct_Decline:"CVaR 10% Decline",LossAtIV2sigmaDecline:"Loss at IV 2-Sigma",LossAtCVaR10pctDecline:"Loss at CVaR 10%"};return y[n]?y[n]:C[n]?C[n]:f[n]?f[n]:B[n]?B[n]:n.replace(/([A-Z])/g," $1").replace(/^./,_=>_.toUpperCase()).replace(/_/g," ")};return e.jsxs("div",{ref:P,style:m,className:"flex items-center space-x-3 p-3 bg-card rounded-lg border hover:bg-accent transition-colors",children:[e.jsx("div",{...o,...D,className:"cursor-grab active:cursor-grabbing p-1 hover:bg-muted rounded",children:e.jsx(jt,{className:"h-4 w-4 text-muted-foreground"})}),e.jsx(K,{checked:g.visible,onCheckedChange:n=>p(!!n),className:"data-[state=checked]:bg-primary data-[state=checked]:border-primary"}),e.jsx("span",{className:"flex-1 text-sm font-medium",children:a(g.key)}),e.jsx(pt,{variant:g.visible?"default":"secondary",className:"text-xs",children:g.visible?"Visible":"Hidden"})]})},Kt=({visibleColumns:g,onVisibilityChange:p,onColumnOrderChange:o})=>{const[D,P]=x.useState(!1),{columnPreferences:v,saveColumnPreferences:S,isLoading:l}=Oe(),[m,a]=x.useState([]),n=yt(Le(St),Le(vt,{coordinateGetter:It})),y=["StockName","OptionName","ExpiryDate","DaysToExpiry","StrikePrice","Premium","NumberOfContractsBasedOnLimit","1_2_3_ProbOfWorthless_Weighted","EstTotalMargin"],C=()=>["StockName","OptionName","ExpiryDate","FinancialReport","X-Day","Premium","PoW_Simulation_Mean_Earnings","100k_Invested_Loss_Mean","1_2_3_ProbOfWorthless_Weighted","ProbWorthless_Bayesian_IsoCal","1_ProbOfWorthless_Original","2_ProbOfWorthless_Calibrated","3_ProbOfWorthless_Historical_IV","Lower_Bound_at_Accuracy","LossAtBadDecline","LossAtWorstDecline","PoW_Stats_MedianLossPct","PoW_Stats_WorstLossPct","PoW_Stats_MedianLoss","PoW_Stats_WorstLoss","PoW_Stats_MedianProbOfWorthless","PoW_Stats_MinProbOfWorthless","PoW_Stats_MaxProbOfWorthless","LossAt100DayWorstDecline","LossAt_2008_100DayWorstDecline","Mean_Accuracy","Lower_Bound_HistMedianIV_at_Accuracy","Lower_Bound","Lower_Bound_HistMedianIV","Bid_Ask_Mid_Price","Option_Price_Min","NumberOfContractsBasedOnLimit","Bid","ProfitLossPctLeastBad","Loss_Least_Bad","IV_AllMedianIV_Maximum100DaysToExp_Ratio","StockPrice","DaysToExpiry","AskBidSpread","Underlying_Value","StrikePrice","StockPrice_After_2008_100DayWorstDecline","LossAt50DayWorstDecline","LossAt_2008_50DayWorstDecline","ProfitLossPctBad","ProfitLossPctWorst","ProfitLossPct100DayWorst","ImpliedVolatility","TodayStockMedianIV_Maximum100DaysToExp","AllMedianIV_Maximum100DaysToExp","ExpiryDate_Lower_Bound_Minus_Pct_Based_on_Accuracy","StrikeBelowLowerAtAcc","Ask","WorstHistoricalDecline","BadHistoricalDecline","ImpliedVolatilityUntilExpiry","StockPrice_After_100DayWorstDecline","StockPrice_After_50DayWorstDecline","StockPrice_After_2008_50DayWorstDecline","100DayMaxPrice","100DayMaxPriceDate","50DayMaxPrice","50DayMaxPriceDate","Historical100DaysWorstDecline","Historical50DaysWorstDecline","2008_100DaysWorstDecline","2008_50DaysWorstDecline","IV_ClosestToStrike","IV_UntilExpiryClosestToStrike","LowerBoundClosestToStrike","LowerBoundDistanceFromCurrentPrice","LowerBoundDistanceFromStrike","ImpliedDownPct","ToStrikePct","SafetyMultiple","SigmasToStrike","ProbAssignment","SafetyCategory","CushionMinusIVPct","PotentialLossAtLowerBound","EstTotalMargin","Est_Margin_SEK","Prob_Normal_2SD_Decline_Pct","Hist_Worst_Decline_Pct","SRI_Base","Event_Buffer","Final_SRI","OTM_Amount","Margin_A_Broker_Proxy","Margin_B_Historical_Floor","Margin_Floor_15pct","Net_Premium_After_Costs","Annualized_ROM_Pct","IV_2sigma_Decline","BreakevenDecline","CVaR10pct_Decline","LossAtIV2sigmaDecline","LossAtCVaR10pctDecline"];x.useEffect(()=>{const I=C(),h=new Map(v.map(u=>[u.key,u])),k=I.map((u,E)=>h.get(u)||{key:u,visible:y.includes(u),order:h.size+E});k.sort((u,E)=>{const O=h.has(u.key),H=h.has(E.key);return O&&H?u.order-E.order:O?-1:H?1:u.order-E.order}),a(k)},[v]);const f=I=>{const{active:h,over:k}=I;h.id!==(k==null?void 0:k.id)&&a(u=>{const E=u.findIndex(R=>R.key===h.id),O=u.findIndex(R=>R.key===(k==null?void 0:k.id));return _t(u,E,O).map((R,z)=>({...R,order:z}))})},B=(I,h)=>{a(k=>k.map(u=>u.key===I?{...u,visible:h}:u))},_=async()=>{await S(m);const I=m.filter(h=>h.visible).sort((h,k)=>h.order-k.order).map(h=>h.key);o(I),P(!1)},A=m.filter(I=>I.visible).length;return e.jsxs(fe,{open:D,onOpenChange:P,children:[e.jsx(we,{asChild:!0,children:e.jsxs(W,{variant:"outline",size:"sm",className:"ml-2",children:[e.jsx(Qe,{className:"h-4 w-4 mr-1"}),"Columns (",A,")"]})}),e.jsxs(be,{className:"max-w-2xl max-h-[80vh] overflow-hidden flex flex-col",children:[e.jsxs(Fe,{children:[e.jsx(He,{children:"Manage Table Columns"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Drag to reorder columns and check/uncheck to show/hide them. Click Save to persist your preferences."})]}),e.jsx("div",{className:"flex-1 overflow-y-auto space-y-2 pr-2",children:!l&&m.length>0&&e.jsx(gt,{sensors:n,collisionDetection:xt,onDragEnd:f,children:e.jsx(ft,{items:m.map(I=>I.key),strategy:wt,children:m.sort((I,h)=>I.order-h.order).map(I=>e.jsx(Ht,{column:I,onVisibilityChange:h=>B(I.key,h)},I.key))})})}),e.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:[A," of ",m.length," columns visible"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(W,{variant:"outline",onClick:()=>P(!1),children:"Cancel"}),e.jsxs(W,{onClick:_,disabled:l,children:[e.jsx(bt,{className:"h-4 w-4 mr-1"}),"Save Preferences"]})]})]})]})]})},zt={OptionName:{name:"Option Name",category:"Identification",whatItIs:"Unique code identifying this specific put option contract",whyItMatters:"Standard identifier for options trading and market data systems",example:"ERICB6U45 (Ericsson B-share, expiry code 6U, strike 45 SEK)"},StockName:{name:"Stock Name",category:"Identification",whatItIs:"Company name (Swedish convention)",whyItMatters:"Identifies the underlying stock for the option contract",example:"ERIC B for Ericsson B-shares"},ExpiryDate:{name:"Expiry Date",category:"Identification",whatItIs:"Last day the option is valid",whyItMatters:"Determines time remaining until contract expiration; affects all time-dependent calculations",unit:"YYYY-MM-DD"},FinancialReport:{name:"Financial Report",category:"Identification",whatItIs:"'Y' if company releases quarterly/annual report before expiry",whyItMatters:"Marks contracts with earnings events before expiration"},"X-Day":{name:"X-Day",category:"Identification",whatItIs:"'Y' if ex-dividend date falls before expiry",whyItMatters:"Marks contracts with dividend events before expiration; premium calculations account for dividend impact"},Premium:{name:"Premium",category:"Pricing",whatItIs:"Total income from selling the option position (Bid-Ask Mid Price Ã— Number of Contracts Ã— 100)",whyItMatters:"Gross income received at contract sale for the full position",unit:"SEK (for ~100,000 SEK position)"},Bid_Ask_Mid_Price:{name:"Bid-Ask Mid Price",category:"Pricing",whatItIs:"Average between what buyers offer (bid) and what sellers ask",whyItMatters:"Fair market price for one option. Used to calculate Premium field",unit:"SEK per option contract (1 contract = 100 shares)"},Option_Price_Min:{name:"Option Price Min",category:"Pricing",whatItIs:"Minimum price per option to break even after transaction costs",whyItMatters:"Break-even threshold for the option contract",unit:"SEK per option"},NumberOfContractsBasedOnLimit:{name:"Number of Contracts",category:"Pricing",whatItIs:"How many option contracts you'd sell for a 100,000 SEK position",whyItMatters:"All loss/premium calculations assume this position size"},Bid:{name:"Bid",category:"Pricing",whatItIs:"Highest price buyers are currently offering",whyItMatters:"Real-time market bid for the option contract",unit:"SEK per option"},Ask:{name:"Ask",category:"Pricing",whatItIs:"Lowest price sellers are currently offering",whyItMatters:"Real-time market ask for the option contract",unit:"SEK per option"},AskBidSpread:{name:"Ask-Bid Spread",category:"Pricing",whatItIs:"Difference between Ask and Bid prices",whyItMatters:"Market spread; indicates width between buy and sell prices",unit:"SEK"},"1_2_3_ProbOfWorthless_Weighted":{name:"Weighted Probability",category:"Probability",whatItIs:"Ensemble probability combining Black-Scholes, Calibrated, and Historical IV methods",whyItMatters:"Blended estimate from three independent calculation approaches",unit:"0.0 to 1.0 (0% to 100%)"},"1_ProbOfWorthless_Original":{name:"Black-Scholes Probability",category:"Probability",whatItIs:"Black-Scholes mathematical model probability",whyItMatters:"Pure mathematical calculation. Part of weighted probability but may over/underestimate",unit:"0.0 to 1.0"},"2_ProbOfWorthless_Calibrated":{name:"Calibrated Probability",category:"Probability",whatItIs:"Black-Scholes adjusted with historical accuracy for this stock",whyItMatters:"Corrects for consistent over/underestimation. More accurate than raw Black-Scholes",unit:"0.0 to 1.0"},"3_ProbOfWorthless_Historical_IV":{name:"Historical IV Probability",category:"Probability",whatItIs:"Probability based on how accurate implied volatility has been historically",whyItMatters:"Uses real market data to estimate probability",unit:"0.0 to 1.0"},ProbWorthless_Bayesian_IsoCal:{name:"Bayesian Probability",category:"Probability",whatItIs:"Sophisticated statistical adjustment based on similar past options",whyItMatters:"Groups similar options (by probability bucket and time to expiry) and learns from outcomes",unit:"0.0 to 1.0"},PoW_Simulation_Mean_Earnings:{name:"Simulation Mean Earnings",category:"Probability",whatItIs:"Average profit/loss from 1,000 Monte Carlo simulations",whyItMatters:"Simulated long-term average outcome. Positive = profitable strategy over many trades",unit:"SEK"},PoW_Stats_MedianLossPct:{name:"Median Loss %",category:"Probability",whatItIs:"Typical loss percentage when things go wrong (historical high-probability options)",whyItMatters:"Shows what actually happened to similar options in the past",unit:"Percentage"},PoW_Stats_WorstLossPct:{name:"Worst Loss %",category:"Probability",whatItIs:"Worst historical loss percentage (from similar high-probability options)",whyItMatters:"Reality check on worst-case scenarios",unit:"Percentage"},PoW_Stats_MedianLoss:{name:"Median Loss",category:"Probability",whatItIs:"Typical loss amount when things go wrong",whyItMatters:"Historical reality check in SEK",unit:"SEK"},PoW_Stats_WorstLoss:{name:"Worst Loss",category:"Probability",whatItIs:"Worst historical loss amount",whyItMatters:"Shows maximum pain in SEK from similar past options",unit:"SEK"},PoW_Stats_MedianProbOfWorthless:{name:"Median Probability",category:"Probability",whatItIs:"Typical probability value in this historical group",whyItMatters:"Reference point for similar options",unit:"0.0 to 1.0"},PoW_Stats_MinProbOfWorthless:{name:"Min Probability",category:"Probability",whatItIs:"Lowest probability in historical group",whyItMatters:"Shows range of similar options",unit:"0.0 to 1.0"},PoW_Stats_MaxProbOfWorthless:{name:"Max Probability",category:"Probability",whatItIs:"Highest probability in historical group",whyItMatters:"Shows range of similar options",unit:"0.0 to 1.0"},Lower_Bound_at_Accuracy:{name:"Lower Bound (80% Accuracy)",category:"Risk Protection",whatItIs:"Stock price level calculated with 80% historical accuracy threshold",whyItMatters:"Provides risk boundary estimate based on historical volatility patterns",unit:"SEK"},Lower_Bound_HistMedianIV_at_Accuracy:{name:"Lower Bound (Historical Median IV)",category:"Risk Protection",whatItIs:"Lower bound using historical median implied volatility (at 80% accuracy)",whyItMatters:"Alternative calculation method using longer-term volatility baseline",unit:"SEK"},Lower_Bound:{name:"Lower Bound",category:"Risk Protection",whatItIs:"Basic lower bound calculation using current implied volatility",whyItMatters:"Simplest estimate. Compare with other lower bounds for full picture",unit:"SEK"},Lower_Bound_HistMedianIV:{name:"Lower Bound (Hist Median)",category:"Risk Protection",whatItIs:"Lower bound using historical median IV (without accuracy adjustment)",whyItMatters:"Shows typical volatility range without accuracy weighting",unit:"SEK"},ExpiryDate_Lower_Bound_Minus_Pct_Based_on_Accuracy:{name:"Lower Bound Adjustment %",category:"Risk Protection",whatItIs:"Percentage adjustment used in lower bound calculations",whyItMatters:"Technical field showing how much volatility buffer is applied",unit:"Decimal (0.35 = 35%)"},StrikeBelowLowerAtAcc:{name:"Strike Below Lower Bound",category:"Risk Protection",whatItIs:"'Y' if strike price is below Lower_Bound_at_Accuracy AND spread is reasonable (â‰¤10 SEK)",whyItMatters:"Flag indicating strike position relative to calculated lower bound with adequate liquidity"},LossAtBadDecline:{name:"Loss at Bad Decline",category:"Loss Scenarios",whatItIs:"Loss if stock experiences a bad historical decline (10th-20th percentile worst)",whyItMatters:"Historical loss scenario for moderate adverse market movement",unit:"SEK (negative = loss)"},LossAtWorstDecline:{name:"Loss at Worst Decline",category:"Loss Scenarios",whatItIs:"Your loss if stock experiences its single worst historical decline",whyItMatters:"Absolute worst case seen in this stock's history. Very rare but possible",unit:"SEK (negative = loss)"},LossAt100DayWorstDecline:{name:"Loss at 100-Day Worst",category:"Loss Scenarios",whatItIs:"Loss if stock drops like its worst 100-day period ever",whyItMatters:"Time-matched risk (if option has ~100 days, shows relevant historical comparison)",unit:"SEK (negative = loss)"},LossAt_2008_100DayWorstDecline:{name:"Loss at 2008 (100-Day)",category:"Loss Scenarios",whatItIs:"Loss if stock drops like it did during 2008 financial crisis (100-day window)",whyItMatters:"Stress test against global financial crisis. Extreme but has happened",unit:"SEK (negative = loss)"},LossAt50DayWorstDecline:{name:"Loss at 50-Day Worst",category:"Loss Scenarios",whatItIs:"Loss if stock drops like its worst 50-day period ever",whyItMatters:"For shorter-term options (~50 days to expiry)",unit:"SEK (negative = loss)"},LossAt_2008_50DayWorstDecline:{name:"Loss at 2008 (50-Day)",category:"Loss Scenarios",whatItIs:"Loss if stock drops like it did during 2008 crisis (50-day window)",whyItMatters:"Shorter-term 2008 crisis stress test",unit:"SEK (negative = loss)"},Loss_Least_Bad:{name:"Least Bad Loss",category:"Loss Scenarios",whatItIs:"The smallest loss among Bad, Worst, and 100Day scenarios",whyItMatters:"Most optimistic of the realistic bad scenarios",unit:"SEK (negative = loss)"},WorstHistoricalDecline:{name:"Worst Historical Decline",category:"Loss Scenarios",whatItIs:"Percentage the stock dropped during its worst historical period",whyItMatters:"Shows the stock's maximum pain point",unit:"Decimal (0.45 = 45% decline)"},BadHistoricalDecline:{name:"Bad Historical Decline",category:"Loss Scenarios",whatItIs:"Percentage the stock dropped during 'bad' historical period",whyItMatters:"Typical significant decline for this stock",unit:"Decimal (0.25 = 25% decline)"},"100DayMaxPrice":{name:"100-Day Max Price",category:"Loss Scenarios",whatItIs:"Highest stock price in last 100 days",whyItMatters:"Shows recent peak. Current price vs this = how much stock has already fallen",unit:"SEK"},"100DayMaxPriceDate":{name:"100-Day Max Price Date",category:"Loss Scenarios",whatItIs:"Date when stock hit its 100-day maximum",whyItMatters:"Recent peak timing. If yesterday = near highs, if 95 days ago = already declined",unit:"YYYY-MM-DD"},"50DayMaxPrice":{name:"50-Day Max Price",category:"Loss Scenarios",whatItIs:"Highest stock price in last 50 days",whyItMatters:"Shorter-term peak reference",unit:"SEK"},"50DayMaxPriceDate":{name:"50-Day Max Price Date",category:"Loss Scenarios",whatItIs:"Date when stock hit its 50-day maximum",whyItMatters:"Recent trend indicator",unit:"YYYY-MM-DD"},Historical100DaysWorstDecline:{name:"Historical 100-Day Worst",category:"Loss Scenarios",whatItIs:"Worst decline percentage over any 100-day period in stock's history",whyItMatters:"Historical volatility reference for 100-day timeframe",unit:"Decimal (negative, e.g., -0.45 = -45%)"},Historical50DaysWorstDecline:{name:"Historical 50-Day Worst",category:"Loss Scenarios",whatItIs:"Worst decline percentage over any 50-day period in stock's history",whyItMatters:"Historical volatility reference for 50-day timeframe",unit:"Decimal (negative)"},"2008_100DaysWorstDecline":{name:"2008 100-Day Worst",category:"Loss Scenarios",whatItIs:"Worst 100-day decline during 2008 financial crisis",whyItMatters:"Crisis benchmark for 100-day timeframe",unit:"Decimal (negative)"},"2008_50DaysWorstDecline":{name:"2008 50-Day Worst",category:"Loss Scenarios",whatItIs:"Worst 50-day decline during 2008 financial crisis",whyItMatters:"Crisis benchmark for 50-day timeframe",unit:"Decimal (negative)"},IV_2sigma_Decline:{name:"IV 2-Sigma Decline",category:"Loss Scenarios",whatItIs:"IV-implied 2-sigma downside move over remaining DTE: âˆ’2 Ã— IV Ã— âˆš(DTE / 252)",whyItMatters:"What the options market currently prices as a severe decline. Reflects today's market conditions â€” rises automatically in high-IV environments",unit:"Decimal (negative, e.g. -0.207 = -20.7%)"},BreakevenDecline:{name:"Breakeven Decline",category:"Loss Scenarios",whatItIs:"Stock must fall at least this much before writing the put results in any monetary loss: (Strike âˆ’ Premium) / StockPrice âˆ’ 1",whyItMatters:"Threshold that anchors all other stress scenarios",unit:"Decimal (negative, e.g. -0.125 = -12.5%)"},CVaR10pct_Decline:{name:"CVaR 10% Decline",category:"Loss Scenarios",whatItIs:"Average of the worst 10% of historical declines (Expected Shortfall), DTE-matched. More robust than a single worst-case data point",whyItMatters:"Tail-risk estimate: not just the 10th-percentile threshold but the average outcome when losses are in that worst 10%",unit:"Decimal (negative)"},LossAtIV2sigmaDecline:{name:"Loss at IV 2-Sigma",category:"Loss Scenarios",whatItIs:"Loss if stock falls by the IV-implied 2-sigma move",whyItMatters:"SEK equivalent of the IV 2-sigma stress scenario for the current position size",unit:"SEK (negative = loss)"},LossAtCVaR10pctDecline:{name:"Loss at CVaR 10%",category:"Loss Scenarios",whatItIs:"Loss if stock falls by the CVaR 10% historical tail decline",whyItMatters:"SEK equivalent of the CVaR tail-risk scenario for the current position size",unit:"SEK (negative = loss)"},ProfitLossPctLeastBad:{name:"Profit/Loss % (Least Bad)",category:"Profit Ratios",whatItIs:"Premium Ã· Loss_Least_Bad (smallest of the bad scenarios)",whyItMatters:"Risk/reward ratio for most optimistic bad scenario. Higher = better payoff",unit:"Ratio",example:"0.25 = premium is 25% of potential loss"},ProfitLossPctBad:{name:"Profit/Loss % (Bad)",category:"Profit Ratios",whatItIs:"Premium Ã· LossAtBadDecline",whyItMatters:"Typical bad scenario risk/reward",unit:"Ratio",example:"0.20 = you get 20% of potential loss as premium"},ProfitLossPctWorst:{name:"Profit/Loss % (Worst)",category:"Profit Ratios",whatItIs:"Premium Ã· LossAtWorstDecline",whyItMatters:"Absolute worst-case risk/reward. Very low = scary losses possible",unit:"Ratio",example:"0.10 = premium is 10% of worst-case loss"},ProfitLossPct100DayWorst:{name:"Profit/Loss % (100-Day)",category:"Profit Ratios",whatItIs:"Premium Ã· LossAt100DayWorstDecline",whyItMatters:"Time-matched risk/reward for 100-day scenarios",unit:"Ratio"},ImpliedVolatility:{name:"Implied Volatility",category:"Volatility",whatItIs:"Market's expectation of future stock volatility (annualized)",whyItMatters:"Key pricing input. Higher IV = higher premiums but more risk",unit:"Decimal (0.30 = 30%)",example:"0.30 means market expects stock to move Â±30% over a year"},ImpliedVolatilityUntilExpiry:{name:"IV Until Expiry",category:"Volatility",whatItIs:"ImpliedVolatility scaled to actual time until expiry",whyItMatters:"More accurate volatility for shorter time periods",unit:"Decimal"},TodayStockMedianIV_Maximum100DaysToExp:{name:"Today's Median IV",category:"Volatility",whatItIs:"Today's median implied volatility across all options for this stock (â‰¤100 days to expiry)",whyItMatters:"Shows today's overall volatility level for this stock",unit:"Decimal"},AllMedianIV_Maximum100DaysToExp:{name:"Historical Median IV",category:"Volatility",whatItIs:"Historical median implied volatility for this stock (all-time, â‰¤100 days to expiry)",whyItMatters:"Baseline volatility. Current IV above this = elevated premiums",unit:"Decimal"},IV_AllMedianIV_Maximum100DaysToExp_Ratio:{name:"IV Ratio",category:"Volatility",whatItIs:"Current IV Ã· Historical median IV",whyItMatters:"Volatility indicator. >1.2 = high volatility (good premiums), <0.8 = low volatility (poor premiums)",unit:"Ratio",example:"1.5 = current volatility is 50% higher than usual"},StockPrice:{name:"Stock Price",category:"Position Sizing",whatItIs:"Current stock price (adjusted for dividends if X-Day = 'Y')",whyItMatters:"Reference price for strike comparison and lower bounds",unit:"SEK"},StrikePrice:{name:"Strike Price",category:"Position Sizing",whatItIs:"Price at which you must buy the stock if option is exercised",whyItMatters:"Key decision point. Stock must fall below strike before you lose money",unit:"SEK",example:"Strike = 100 SEK means you buy stock at 100 if it falls below that"},Underlying_Value:{name:"Underlying Value",category:"Position Sizing",whatItIs:"Total value of stocks you'd have to buy if exercised",whyItMatters:"Shows capital requirement if you get assigned",unit:"SEK",example:"StrikePrice Ã— NumberOfContracts Ã— 100"},StockPrice_After_2008_100DayWorstDecline:{name:"Stock Price After 2008 (100-Day)",category:"Position Sizing",whatItIs:"Where stock would be after a 2008-style 100-day crash",whyItMatters:"Concrete price level for worst-case scenario",unit:"SEK"},StockPrice_After_100DayWorstDecline:{name:"Stock Price After 100-Day Worst",category:"Position Sizing",whatItIs:"Where stock would be after its worst historical 100-day decline",whyItMatters:"Historical worst-case price level",unit:"SEK"},StockPrice_After_50DayWorstDecline:{name:"Stock Price After 50-Day Worst",category:"Position Sizing",whatItIs:"Where stock would be after its worst historical 50-day decline",whyItMatters:"Shorter-term worst-case price level",unit:"SEK"},StockPrice_After_2008_50DayWorstDecline:{name:"Stock Price After 2008 (50-Day)",category:"Position Sizing",whatItIs:"Where stock would be after a 2008-style 50-day crash",whyItMatters:"Shorter-term 2008 crisis price level",unit:"SEK"},DaysToExpiry:{name:"Days to Expiry",category:"Timing",whatItIs:"Calendar days until option expires",whyItMatters:"More days = more premium but more time for things to go wrong. Sweet spot often 30-90 days",unit:"Days"},Mean_Accuracy:{name:"Mean Accuracy",category:"Timing",whatItIs:"Historical accuracy of implied volatility predictions for this stock/timeframe",whyItMatters:"Confidence indicator. Higher = more reliable probability estimates",unit:"0.0 to 1.0 (0% to 100%)",example:"0.80 = implied volatility was accurate 80% of the time historically"},"100k_Invested_Loss_Mean":{name:"100k Invested Loss Mean",category:"Timing",whatItIs:"Average loss for 100k SEK positions with similar probability/expiry, based on historical outcomes",whyItMatters:"Real-world results from similar past trades. Reality check on your estimates",unit:"SEK"},EstTotalMargin:{name:"Est. Total Margin",category:"Margin & Capital",whatItIs:"ESTIMATED total margin capital required for this position (Est_Margin_SEK Ã— Number of Contracts). IMPORTANT: This is a conservative estimate using SRI methodology, NOT the exact requirement from Nasdaq Stockholm",whyItMatters:"Shows how much buying power is tied up. Lower margin = more efficient capital use. Use this to plan positions and understand capital efficiency (ROM)",unit:"SEK"},Est_Margin_SEK:{name:"Est. Margin per Contract",category:"Margin & Capital",whatItIs:"ESTIMATED margin requirement for one option contract (100 shares) calculated using Synthetic Risk Interval (SRI) methodology. DISCLAIMER: This is an estimate only, not Nasdaq's exact requirement",whyItMatters:"Base margin amount per contract. Total margin = this field Ã— number of contracts. Helps understand capital efficiency",unit:"SEK per contract"},Final_SRI:{name:"Final Safety-Risk Index",category:"Margin & Capital",whatItIs:"Conservative risk measure combining volatility and event risk. Used as basis for margin calculations",whyItMatters:"Higher SRI = more conservative margin = safer but requires more capital",unit:"Decimal"},Annualized_ROM_Pct:{name:"Annualized Return on Margin %",category:"Margin & Capital",whatItIs:"Premium as an annualized percentage of estimated margin requirement. Shows capital efficiency",whyItMatters:"Key efficiency metric. Higher = better use of capital",unit:"Percentage"},Net_Premium_After_Costs:{name:"Net Premium After Costs",category:"Margin & Capital",whatItIs:"Premium minus transaction costs. Represents actual profit if option expires worthless",whyItMatters:"More realistic than gross premium",unit:"SEK"},SRI_Base:{name:"SRI Base",category:"Margin & Capital",whatItIs:"Starting Safety-Risk Index before event adjustments",whyItMatters:"Building block for margin calculation",unit:"Decimal"},Event_Buffer:{name:"Event Buffer",category:"Margin & Capital",whatItIs:"Additional margin buffer if earnings report or dividend event occurs before expiry",whyItMatters:"Events increase volatility and risk",unit:"Decimal"},OTM_Amount:{name:"OTM Amount",category:"Margin & Capital",whatItIs:"How far out-of-the-money the strike is (Stock Price - Strike Price)",whyItMatters:"Larger OTM buffer = more safety = potentially lower margin",unit:"SEK"},Margin_A_Broker_Proxy:{name:"Margin A Broker Proxy",category:"Margin & Capital",whatItIs:"Margin calculation component based on broker-like formula",whyItMatters:"One approach to estimating margin",unit:"SEK"},Margin_B_Historical_Floor:{name:"Margin B Historical Floor",category:"Margin & Capital",whatItIs:"Margin calculation based on historical worst-case decline",whyItMatters:"Ensures margin covers actual historical worst cases",unit:"SEK"},Margin_Floor_15pct:{name:"Margin Floor 15%",category:"Margin & Capital",whatItIs:"Regulatory floor: minimum 15% of strike price (Swedish regulatory minimum)",whyItMatters:"Ensures compliance with Swedish regulatory minimum margins",unit:"SEK"},Prob_Normal_2SD_Decline_Pct:{name:"Probability Normal 2SD Decline %",category:"Margin & Capital",whatItIs:"Statistical 2-standard-deviation decline probability from implied volatility",whyItMatters:"Mathematical foundation for margin calculations",unit:"Percentage"},Hist_Worst_Decline_Pct:{name:"Historical Worst Decline %",category:"Margin & Capital",whatItIs:"Actual worst historical decline percentage for this stock",whyItMatters:"Real-world data point used in margin calculations",unit:"Percentage"}},Ut=g=>zt[g];function $t({fieldName:g,className:p}){const o=Ut(g);return o?e.jsx(_e,{children:e.jsxs(Ke,{delayDuration:200,children:[e.jsx(ze,{asChild:!0,children:e.jsx(ae,{className:`h-4 w-4 text-muted-foreground hover:text-foreground cursor-help transition-colors ${p||""}`})}),e.jsxs(Ue,{side:"right",className:"max-w-sm p-4 space-y-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-sm mb-1",children:o.name}),e.jsx("div",{className:"text-xs text-muted-foreground mb-2",children:o.category})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-xs",children:"What it is:"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-0.5",children:o.whatItIs})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-xs",children:"Why it matters:"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-0.5",children:o.whyItMatters})]}),o.unit&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-xs",children:"Unit:"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-0.5",children:o.unit})]}),o.example&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-xs",children:"Example:"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-0.5",children:o.example})]})]})]})]})}):null}const qt=({data:g,onRowClick:p,onStockClick:o,columnFilters:D=[],onColumnFiltersChange:P=()=>{},sortField:v,sortDirection:S,onSortChange:l,enableFiltering:m=!0})=>{const{columnPreferences:a,isLoading:n}=Oe(),[y,C]=x.useState([]),[f,B]=x.useState(null),[_,A]=x.useState({minValue:"",maxValue:""}),I=x.useRef(null),h=["StockName","OptionName","ExpiryDate","DaysToExpiry","StrikePrice","Premium","NumberOfContractsBasedOnLimit","1_2_3_ProbOfWorthless_Weighted","EstTotalMargin"];x.useEffect(()=>{if(!n)if(a.length>0){const s=a.filter(c=>c.visible).sort((c,i)=>c.order-i.order).map(c=>c.key);C(s)}else C(h)},[a,n]),x.useEffect(()=>{const s=c=>{I.current&&!I.current.contains(c.target)&&B(null)};if(f&&m)return document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s)},[f,m]);const k=s=>{if(s==="recalculatedNumberOfContracts")return"Number Of Contracts";const c={IV_ClosestToStrike:"IV Closest To Strike",IV_UntilExpiryClosestToStrike:"IV Until Expiry Closest To Strike",LowerBoundClosestToStrike:"Lower Bound Closest To Strike",LowerBoundDistanceFromCurrentPrice:"Lower Bound Distance From Current Price",LowerBoundDistanceFromStrike:"Lower Bound Distance From Strike",ImpliedDownPct:"Implied Down %",ToStrikePct:"To Strike %",SafetyMultiple:"Safety Multiple",SigmasToStrike:"Sigmas To Strike",ProbAssignment:"Prob Assignment",SafetyCategory:"Safety Category",CushionMinusIVPct:"Cushion Minus IV %",PotentialLossAtLowerBound:"Potential Loss At IV Lower Bound",EstTotalMargin:"Est. Total Margin",Est_Margin_SEK:"Est. Margin per Contract",Prob_Normal_2SD_Decline_Pct:"Probability Normal 2SD Decline %",Hist_Worst_Decline_Pct:"Historical Worst Decline %",SRI_Base:"SRI Base",Event_Buffer:"Event Buffer",Final_SRI:"Final Safety-Risk Index",OTM_Amount:"OTM Amount",Margin_A_Broker_Proxy:"Margin A Broker Proxy",Margin_B_Historical_Floor:"Margin B Historical Floor",Margin_Floor_15pct:"Margin Floor 15%",Net_Premium_After_Costs:"Net Premium After Costs",Annualized_ROM_Pct:"Annualized Return on Margin %","1_2_3_ProbOfWorthless_Weighted":"PoW - Weighted Average",ProbWorthless_Bayesian_IsoCal:"PoW - Bayesian Calibrated","1_ProbOfWorthless_Original":"PoW - Original Black-Scholes","2_ProbOfWorthless_Calibrated":"PoW - Bias Corrected","3_ProbOfWorthless_Historical_IV":"PoW - Historical IV",IV_2sigma_Decline:"IV 2-Sigma Decline",BreakevenDecline:"Breakeven Decline",CVaR10pct_Decline:"CVaR 10% Decline",LossAtIV2sigmaDecline:"Loss at IV 2-Sigma",LossAtCVaR10pctDecline:"Loss at CVaR 10%"};return c[s]?c[s]:s.replace(/([A-Z])/g," $1").replace(/_/g," ").replace(/^\w/,i=>i.toUpperCase()).replace(/\b\w/g,i=>i.toUpperCase())},u=s=>{v===s?l(s,S==="asc"?"desc":"asc"):l(s,"asc")},E=[...g].sort((s,c)=>{if(!v)return 0;const i=s[v],j=c[v];if(typeof i=="number"&&typeof j=="number")return S==="asc"?i-j:j-i;const M=String(i).toLowerCase(),w=String(j).toLowerCase();return S==="asc"?M.localeCompare(w):w.localeCompare(M)}),O=s=>g.length===0?"text":typeof g[0][s]=="number"?"number":"text",H=m?E.filter(s=>D.every(c=>{const i=s[c.field];return c.type==="text"?c.textValue?String(i).toLowerCase().includes(c.textValue.toLowerCase()):!0:typeof i!="number"?!1:c.minValue===void 0&&c.maxValue===void 0?!0:!(c.minValue!==void 0&&i<c.minValue||c.maxValue!==void 0&&i>c.maxValue)})):E,R=(s,c)=>{if(!m)return;const i=D,j=i.findIndex(L=>L.field===s),M=O(s);let w;if(j>=0){const L=[...i];L[j]={...L[j],...c},M==="text"&&!L[j].textValue?w=L.filter((V,F)=>F!==j):M==="number"&&L[j].minValue===void 0&&L[j].maxValue===void 0?w=L.filter((V,F)=>F!==j):w=L}else M==="text"&&!c.textValue||M==="number"&&c.minValue===void 0&&c.maxValue===void 0?w=i:w=[...i,{field:s,type:M,...c}];P(w)},z=s=>D.find(c=>c.field===s),U=(s,c)=>et(s,c),q=(s,c)=>{c?y.includes(s)||C(i=>[...i,s]):C(i=>i.filter(j=>j!==s))},Q=s=>{C(s)},oe=()=>{Mt({filename:"options_data",visibleColumns:y,data:H})};return e.jsx(_e,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[m&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ee,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Click on column headers to filter"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(fe,{children:[e.jsx(we,{asChild:!0,children:e.jsxs(W,{variant:"ghost",size:"sm",title:"Learn what PoW means and about the probability methods",className:"gap-1",children:[e.jsx(ae,{className:"h-4 w-4"}),e.jsx("span",{className:"text-xs",children:"PoW ?"})]})}),e.jsxs(be,{className:"max-w-md",children:[e.jsx(Fe,{children:e.jsx(He,{children:"PoW Legend"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-sm mb-2",children:"What is PoW?"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.jsx("strong",{children:"PoW = Probability of Worthless"})," â€” The probability that an option will expire worthless (meaning you keep the premium)."]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-sm mb-2",children:"The 5 Calculation Methods"}),e.jsxs("ul",{className:"text-sm text-muted-foreground space-y-2 ml-4 list-disc",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"PoW - Weighted Average:"})," Weighted combination of methods"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"PoW - Bayesian Calibrated:"})," Bayesian probability calibration"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"PoW - Original Black-Scholes:"})," Classic Black-Scholes model"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"PoW - Bias Corrected:"})," Calibrated with bias correction"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"PoW - Historical IV:"})," Based on historical implied volatility"]})]})]})]})]})]}),e.jsxs(W,{variant:"outline",size:"sm",onClick:oe,className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-4 w-4"}),"Export to Excel"]}),e.jsx(Kt,{visibleColumns:y,onVisibilityChange:q,onColumnOrderChange:Q})]})]}),e.jsxs(ht,{className:"w-full whitespace-nowrap rounded-md border",children:[e.jsxs(nt,{children:[e.jsx(lt,{children:e.jsx(Ne,{children:y.map(s=>{const c=O(s),i=z(s),j=!!i;return e.jsx(ct,{className:s==="StockName"?"w-28 max-w-28":"min-w-[120px]","aria-sort":v===s?S==="asc"?"ascending":"descending":void 0,children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs(W,{variant:"ghost",onClick:()=>u(s),className:"h-9 px-1 font-medium",title:k(s),children:[k(s)," ",e.jsx(Dt,{className:"ml-1 h-3 w-3"})]}),e.jsx($t,{fieldName:s})]}),m&&e.jsxs("div",{className:"relative",children:[e.jsxs(W,{variant:j?"default":"outline",size:"sm",onClick:()=>{const M=f!==s;if(B(M?s:null),M){const w=z(s);A({minValue:(w==null?void 0:w.minValue)!==void 0?String(w.minValue).replace(".",","):"",maxValue:(w==null?void 0:w.maxValue)!==void 0?String(w.maxValue).replace(".",","):""})}},className:"h-9 w-full text-xs",children:[e.jsx(Ee,{className:"h-3 w-3 mr-1"}),j?"Filtered":"Filter"]}),f===s&&e.jsxs("div",{ref:I,className:"absolute top-8 left-0 z-50 bg-background border rounded-md shadow-md p-2 min-w-48",children:[c==="text"?e.jsx(Z,{placeholder:"Search...","aria-label":`Search ${k(s)}`,value:(i==null?void 0:i.textValue)||"",onChange:M=>R(s,{textValue:M.target.value.slice(0,100)}),className:"h-8",maxLength:100,autoFocus:!0}):e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{type:"text",inputMode:"decimal",placeholder:"Min value","aria-label":`Minimum ${k(s)}`,value:_.minValue,onChange:M=>{const w=M.target.value;A(V=>({...V,minValue:w}));const L=w.replace(",",".");if(L==="")R(s,{minValue:void 0});else{const V=parseFloat(L);!isNaN(V)&&isFinite(V)&&R(s,{minValue:V})}},className:"h-8",autoFocus:!0}),e.jsx(Z,{type:"text",inputMode:"decimal",placeholder:"Max value","aria-label":`Maximum ${k(s)}`,value:_.maxValue,onChange:M=>{const w=M.target.value;A(V=>({...V,maxValue:w}));const L=w.replace(",",".");if(L==="")R(s,{maxValue:void 0});else{const V=parseFloat(L);!isNaN(V)&&isFinite(V)&&R(s,{maxValue:V})}},className:"h-8"})]}),e.jsx(W,{variant:"ghost",size:"sm",onClick:()=>{R(s,{minValue:void 0,maxValue:void 0}),A({minValue:"",maxValue:""}),B(null)},className:"mt-2 h-9 w-full text-xs",children:"Clear"})]})]})]})},s)})})}),e.jsx(dt,{children:H.map((s,c)=>e.jsx(Ne,{className:"hover:bg-muted/50",children:y.map(i=>{const j=()=>i!=="OptionName"?"":s.FinancialReport==="Y"?"text-orange-600 dark:text-orange-400":s["X-Day"]&&String(s["X-Day"]).toUpperCase()==="Y"?"text-red-600 dark:text-red-400":"text-primary";return e.jsx(mt,{className:`${i==="StockName"?"w-28 max-w-28 truncate":"min-w-[120px]"} ${i==="OptionName"||i==="StockName"?"cursor-pointer hover:bg-accent/50 transition-colors":""}`,onClick:i==="OptionName"?()=>p==null?void 0:p(s):i==="StockName"?()=>o==null?void 0:o(s.StockName):void 0,children:i==="OptionName"?e.jsx("span",{className:`font-medium ${j()} hover:opacity-80 transition-all`,children:U(s[i],i)}):i==="StockName"?e.jsx("span",{className:"font-medium text-foreground hover:text-primary transition-colors",children:U(s[i],i)}):U(s[i],i)},i)})},`${s.StockName}-${s.OptionName}-${c}`))})]}),e.jsx(ut,{orientation:"horizontal"})]})]})})},Yt=({data:g})=>{const[p,o]=x.useState(["ProbWorthless_Bayesian_IsoCal"]),D=[{value:"1_2_3_ProbOfWorthless_Weighted",label:"PoW - Weighted Average"},{value:"ProbWorthless_Bayesian_IsoCal",label:"PoW - Bayesian Calibrated"},{value:"1_ProbOfWorthless_Original",label:"PoW - Original Black-Scholes"},{value:"2_ProbOfWorthless_Calibrated",label:"PoW - Bias Corrected"},{value:"3_ProbOfWorthless_Historical_IV",label:"PoW - Historical IV"}],P=["hsl(var(--chart-1))","hsl(var(--chart-2))","hsl(var(--chart-3))","hsl(var(--chart-4))","hsl(var(--chart-5))"],v=g.map(a=>{const n={name:a.OptionName,x:a.Premium,z:a.DaysToExpiry,stockName:a.StockName};return p.forEach(y=>{n[y]=a[y]}),n}),S=g.reduce((a,n)=>{const y=n.ProbWorthless_Bayesian_IsoCal??n["1_2_3_ProbOfWorthless_Weighted"],C=y<=.6?"High Risk":y<.8?"Medium Risk":"Low Risk";return a[C]=(a[C]||0)+1,a},{}),l=Object.entries(S).map(([a,n])=>({risk:a,count:n})),m=a=>{o(n=>n.includes(a)?n.filter(y=>y!==a):[...n,a])};return e.jsxs($e,{defaultValue:"scatter",className:"w-full",children:[e.jsxs(qe,{className:"grid w-full grid-cols-2",children:[e.jsx(ie,{value:"scatter",children:"Risk vs Premium"}),e.jsx(ie,{value:"distribution",children:"Risk Distribution"})]}),e.jsx(re,{value:"scatter",children:e.jsxs(ue,{children:[e.jsxs(pe,{className:"space-y-4",children:[e.jsx(ye,{children:"Premium vs Probability of Worthless"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Y,{children:"Select Probability Fields:"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:D.map(a=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(K,{id:a.value,checked:p.includes(a.value),onCheckedChange:()=>m(a.value)}),e.jsx("label",{htmlFor:a.value,className:"text-sm cursor-pointer",children:a.label})]},a.value))})]})]}),e.jsx(ge,{children:e.jsx(We,{width:"100%",height:500,children:e.jsxs(Ct,{margin:{top:20,right:20,bottom:20,left:20},children:[e.jsx(Be,{strokeDasharray:"3 3"}),e.jsx(Ve,{type:"number",dataKey:"x",name:"Premium",domain:["dataMin","dataMax"]}),e.jsx(Ae,{type:"number",name:"Prob of Worthless",tickFormatter:a=>`${(a*100).toFixed(0)}%`}),e.jsx(Re,{cursor:{strokeDasharray:"3 3"},content:({active:a,payload:n})=>{if(a&&n&&n.length>0){const y=n[0].payload;return e.jsxs("div",{className:"bg-background border border-border rounded-lg p-3 shadow-lg",children:[e.jsxs("div",{className:"font-semibold text-foreground mb-2",children:[y.stockName," - ",y.name]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Premium:"})," ",Number(y.x).toLocaleString("sv-SE")]}),p.map(C=>e.jsxs("div",{className:"text-sm",children:[e.jsxs("span",{className:"font-medium",children:[C,":"]})," ",(Number(y[C])*100).toFixed(2),"%"]},C)),e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Days to Expiry:"})," ",y.z]})]})]})}return null}}),e.jsx(Nt,{}),p.map((a,n)=>e.jsx(Lt,{name:a,data:v,dataKey:a,fill:P[n%P.length]},a))]})})})]})}),e.jsx(re,{value:"distribution",children:e.jsxs(ue,{children:[e.jsx(pe,{children:e.jsx(ye,{children:"Options Risk Distribution"})}),e.jsx(ge,{children:e.jsx(We,{width:"100%",height:500,children:e.jsxs(Et,{data:l,children:[e.jsx(Be,{strokeDasharray:"3 3"}),e.jsx(Ve,{dataKey:"risk"}),e.jsx(Ae,{}),e.jsx(Re,{}),e.jsx(Wt,{dataKey:"count",fill:"hsl(var(--primary))"})]})})})]})})]})},Gt={selectedStocks:[],selectedExpiryDates:[],selectedRiskLevels:[],strikePriceFilter:"all",strikeBelowPeriod:null},de="mainPageFilterSettings",Xt=()=>{const{user:g}=tt(),[p,o]=x.useState(Gt),[D,P]=x.useState(!0);return x.useEffect(()=>{(()=>{try{const l=localStorage.getItem(de);if(l){const m=JSON.parse(l);o(m)}}catch(l){console.error("Error loading main page settings from localStorage:",l)}})()},[]),x.useEffect(()=>{if(!g){P(!1);return}(async()=>{try{P(!0);const{data:l,error:m}=await Ce.from("user_preferences").select("preference_data").eq("user_id",g.id).eq("preference_type","main_page_filters").maybeSingle();if(m){console.error("Error loading main page settings from Supabase:",m);return}if(l!=null&&l.preference_data){const a=l.preference_data;console.log("ðŸ”„ useMainPagePreferences - Loaded from Supabase:",a),o(a),localStorage.setItem(de,JSON.stringify(a))}else console.log("ðŸ”„ useMainPagePreferences - No saved preferences found in Supabase")}catch(l){console.error("Error loading main page settings:",l)}finally{P(!1)}})()},[g]),{settings:p,isLoading:D,saveSettings:async S=>{console.log("ðŸ’¾ useMainPagePreferences - Saving settings:",S),o(S);try{localStorage.setItem(de,JSON.stringify(S))}catch(l){console.error("Error saving to localStorage:",l)}if(g)try{const{error:l}=await Ce.from("user_preferences").upsert({user_id:g.id,preference_type:"main_page_filters",preference_data:S},{onConflict:"user_id,preference_type"});l?console.error("Error saving main page settings to Supabase:",l):console.log("âœ… useMainPagePreferences - Successfully saved to Supabase")}catch(l){console.error("Error saving main page settings:",l)}}}};function Jt({onExportCSV:g,onExportPNG:p,onExportPDF:o,label:D="Export",variant:P="outline",size:v="sm",className:S}){const l=[{label:"Export as CSV",icon:At,onClick:g},{label:"Export as PNG",icon:Te,onClick:p},{label:"Export as PDF",icon:Te,onClick:o}].filter(m=>m.onClick);if(l.length===1){const m=l[0];return e.jsxs(W,{variant:P,size:v,onClick:m.onClick,className:S,children:[e.jsx(he,{className:"h-4 w-4 mr-2"}),D]})}return e.jsxs(G,{children:[e.jsx(X,{asChild:!0,children:e.jsxs(W,{variant:P,size:v,className:S,children:[e.jsx(he,{className:"h-4 w-4 mr-2"}),D]})}),e.jsx(J,{align:"end",children:l.map(m=>e.jsxs(me,{onClick:m.onClick,children:[e.jsx(m.icon,{className:"h-4 w-4 mr-2"}),m.label]},m.label))})]})}function Zt(g,p){if(g.length===0)return;const o=Object.keys(g[0]),D=[o.join(","),...g.map(l=>o.map(m=>{const a=l[m];return typeof a=="string"&&(a.includes(",")||a.includes('"'))?`"${a.replace(/"/g,'""')}"`:a}).join(","))].join(`
`),P=new Blob([D],{type:"text/csv;charset=utf-8;"}),v=document.createElement("a"),S=URL.createObjectURL(P);v.setAttribute("href",S),v.setAttribute("download",p),v.style.visibility="hidden",document.body.appendChild(v),v.click(),document.body.removeChild(v)}const bs=()=>{var Ie,ve,Se,ke;console.log("ðŸ  Index component rendering"),rt("Options Analysis");const g=at(),[p]=it(),{data:o,isLoading:D,error:P,loadMockData:v}=Bt(),{getLowPriceForPeriod:S}=Vt(),{settings:l,isLoading:m,saveSettings:a}=Xt(),{timestamps:n}=ot(),{trackFilterChange:y,trackExport:C}=st(),[f,B]=x.useState([]),[_,A]=x.useState([]),I=x.useRef(!1),[h,k]=x.useState(()=>{const t=p.get("strikeBelowPeriod");return t?parseInt(t,10):null}),[u,E]=x.useState(()=>{const t=p.get("riskLevels");if(!t)return[];try{const d=decodeURIComponent(t),r=JSON.parse(d);return Array.isArray(r)?r:[]}catch{return t.split(",").filter(Boolean)}}),[O,H]=x.useState(()=>p.get("sortField")||null),[R,z]=x.useState(()=>p.get("sortDirection")==="desc"?"desc":"asc"),U=[{label:"1 Week Low",days:7},{label:"1 Month Low",days:30},{label:"3 Months Low",days:90},{label:"6 Months Low",days:180},{label:"9 Months Low",days:270},{label:"1 Year Low",days:365}],q=[{value:"High Risk",label:"High Risk"},{value:"Medium Risk",label:"Medium Risk"},{value:"Low Risk",label:"Low Risk"}],Q=t=>{const d=t.ProbWorthless_Bayesian_IsoCal??t["1_2_3_ProbOfWorthless_Weighted"];return d<=.6?"High Risk":d<.8?"Medium Risk":"Low Risk"},oe=()=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden md:block",children:e.jsx(_e,{children:e.jsxs(Ke,{children:[e.jsx(ze,{asChild:!0,children:e.jsx(ae,{className:"h-3 w-3 text-muted-foreground cursor-help"})}),e.jsx(Ue,{className:"max-w-sm bg-background border z-50",children:e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsx("p",{className:"font-medium",children:"Risk Level Classification:"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"High Risk:"})," â‰¤60% probability of being worthless"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Medium Risk:"})," ",">","60% and ","<","80% probability of being worthless"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Low Risk:"})," â‰¥80% probability of being worthless"]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Based on ProbWorthless_Bayesian_IsoCal field, or 1_2_3_ProbOfWorthless_Weighted as fallback. No overlapping values between categories."})]})})]})})}),e.jsx("div",{className:"md:hidden",children:e.jsxs(fe,{children:[e.jsx(we,{asChild:!0,children:e.jsx(ae,{className:"h-3 w-3 text-muted-foreground cursor-pointer"})}),e.jsx(be,{className:"max-w-sm",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-medium",children:"Risk Level Classification"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"High Risk:"})," â‰¤60% probability of being worthless"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Medium Risk:"})," ",">","60% and ","<","80% probability of being worthless"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Low Risk:"})," â‰¥80% probability of being worthless"]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Based on ProbWorthless_Bayesian_IsoCal field, or 1_2_3_ProbOfWorthless_Weighted as fallback. No overlapping values between categories."})]})})]})})]});x.useEffect(()=>{if(I.current||!o.length)return;if(p.has("stocks")||p.has("expiryDates")||p.has("riskLevels")){const d=p.get("stocks"),r=p.get("expiryDates"),b=p.get("riskLevels");if(d)try{const N=JSON.parse(decodeURIComponent(d));Array.isArray(N)&&B(N)}catch{B(d.split(",").filter(Boolean))}if(r)try{const N=JSON.parse(decodeURIComponent(r));Array.isArray(N)&&A(N)}catch{A(r.split(",").filter(Boolean))}if(b)try{const N=JSON.parse(decodeURIComponent(b));Array.isArray(N)&&E(N)}catch{E(b.split(",").filter(Boolean))}I.current=!0}},[o.length,p]),x.useEffect(()=>{if(I.current||o.length===0||m)return;console.log("ðŸ“¥ Loading preferences from Supabase:",l);const t=[...new Set(o.map(T=>T.StockName))],d=[...new Set(o.map(T=>T.ExpiryDate))],r=l.selectedStocks.filter(T=>t.includes(T)),b=l.selectedExpiryDates.filter(T=>d.includes(T));console.log("âœ… Valid saved stocks:",r),console.log("âœ… Valid saved dates:",b);let N=b;if(N.length===0){const T=s(d);T&&(N=[T]),console.log("ðŸŽ¯ Using default expiry date:",N)}B(r),A(N),E(l.selectedRiskLevels),k(l.strikeBelowPeriod||null),console.log("ðŸ“ Applied filters - stocks:",r,"dates:",N,"risk:",l.selectedRiskLevels,"strikeBelowPeriod:",l.strikeBelowPeriod)},[o,m,l]);const s=t=>{const d=new Date,r=new Date(d.getFullYear(),d.getMonth()+1,1),b=new Date(r),T=(5-b.getDay()+7)%7;b.setDate(b.getDate()+T);const ne=new Date(b);ne.setDate(ne.getDate()+14);let Pe=t[0],je=1/0;return t.forEach(Me=>{const Ze=new Date(Me),De=Math.abs(Ze.getTime()-ne.getTime());De<je&&(je=De,Pe=Me)}),Pe},c=()=>{const t=[...new Set(o.map(r=>r.ExpiryDate))],d=s(t);B([]),A(d?[d]:[]),E([]),k(null),le.success("Filters reset to default")};x.useEffect(()=>{if(!m&&o.length>0&&!I.current){const t=setTimeout(()=>{console.log("ðŸ’¾ Saving preferences to Supabase:",{selectedStocks:f,selectedExpiryDates:_,selectedRiskLevels:u,strikeBelowPeriod:h}),a({selectedStocks:f,selectedExpiryDates:_,selectedRiskLevels:u,strikePriceFilter:"all",strikeBelowPeriod:h})},500);return()=>clearTimeout(t)}},[f,_,u,h,m,o.length,a]);const[i,j]=x.useState(""),[M,w]=x.useState(""),[L,V]=x.useState([]),F=x.useMemo(()=>{if(h===null)return new Map;const t=new Map;return[...new Set(o.map(r=>r.StockName))].forEach(r=>{t.set(r,S(r,h))}),t},[o,h,S]),$=x.useMemo(()=>o.filter(t=>{const d=f.length===0||f.includes(t.StockName),r=_.length===0||_.includes(t.ExpiryDate);if(h!==null){const N=F.get(t.StockName);if(N==null||t.StrikePrice>N)return!1}const b=u.length===0||u.includes(Q(t));return d&&r&&b}),[o,f,_,h,u,F,Q]),ee=x.useMemo(()=>{let t=o;return _.length>0&&(t=t.filter(r=>_.includes(r.ExpiryDate))),h!==null&&(t=t.filter(r=>{const b=F.get(r.StockName);return b!=null&&r.StrikePrice<=b})),[...new Set(t.map(r=>r.StockName))].filter(r=>r.toLowerCase().includes(i.toLowerCase())).sort()},[o,_,h,F,i]),te=x.useMemo(()=>{let t=o;return f.length>0&&(t=t.filter(r=>f.includes(r.StockName))),h!==null&&(t=t.filter(r=>{const b=F.get(r.StockName);return b!=null&&r.StrikePrice<=b})),[...new Set(t.map(r=>r.ExpiryDate))].filter(r=>r.toLowerCase().includes(M.toLowerCase())).sort()},[o,f,h,F,M]),Ye=()=>{v(),le.success("Mock data loaded")},Ge=t=>{const d=encodeURIComponent(t.OptionName);g(`/option/${d}?${p.toString()}`)},Xe=t=>{g(`/stock/${encodeURIComponent(t)}?${p.toString()}`)},Je=()=>{C("export_csv_clicked",{export_type:"csv",data_source:"options_table",row_count:$.length}),Zt($,`swedish-put-options-${new Date().toISOString().split("T")[0]}.csv`),le.success("Data exported successfully")};return e.jsxs("div",{className:"container mx-auto p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-1",children:"Swedish Put Options"}),e.jsx("p",{className:"text-muted-foreground",children:"Analysis and insights for Swedish equity put options"})]}),e.jsxs("div",{className:"flex flex-col items-end gap-2",children:[e.jsx(ce,{timestamp:(Ie=n==null?void 0:n.optionsData)==null?void 0:Ie.lastUpdated,label:"Options data"}),e.jsx(ce,{timestamp:(ve=n==null?void 0:n.stockData)==null?void 0:ve.lastUpdated,label:"Stock data"}),e.jsx(ce,{timestamp:(Se=n==null?void 0:n.analysisCompleted)==null?void 0:Se.lastUpdated,label:"Analysis updated"})]})]}),o.length===0?e.jsxs(ue,{className:"max-w-2xl mx-auto",children:[e.jsx(pe,{children:e.jsxs(ye,{className:"flex items-center gap-2",children:[e.jsx(Ot,{className:"h-5 w-5"}),"Loading Options Data"]})}),e.jsxs(ge,{className:"space-y-4",children:[P&&e.jsxs("div",{className:"text-sm text-destructive bg-destructive/10 p-3 rounded",children:[P,e.jsx("div",{className:"mt-2 space-y-2",children:e.jsx("div",{className:"text-center",children:e.jsx(W,{onClick:Ye,variant:"outline",disabled:D,children:"Load Sample Data Instead"})})})]}),D&&e.jsx("div",{className:"text-center text-sm text-muted-foreground",children:"Loading..."}),!D&&!P&&e.jsx("div",{className:"text-center text-sm text-muted-foreground",children:"Loading..."})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Options Analysis"}),e.jsx(Jt,{onExportCSV:Je,size:"sm",variant:"ghost"})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",$.length," of ",o.length," options (",($.length/o.length*100).toFixed(1),"%)"]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start gap-4 flex-wrap",children:[e.jsxs(W,{onClick:c,variant:"ghost",size:"sm",className:"self-start text-xs text-muted-foreground hover:text-foreground",title:"Reset all filters to default (third Friday of next month)",children:[e.jsx(Rt,{className:"h-3 w-3 mr-1"}),"Reset to Default"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex items-center gap-1 min-h-5",children:e.jsx(Y,{children:"Strike Price Below"})}),e.jsxs(G,{children:[e.jsx(X,{asChild:!0,children:e.jsxs(W,{variant:"outline",className:"min-w-[200px] justify-between",children:[h===null?"Select Period":`âœ“ ${(ke=U.find(t=>t.days===h))==null?void 0:ke.label}`,e.jsx(se,{className:"h-4 w-4"})]})}),e.jsxs(J,{className:"w-[200px] bg-background z-50",children:[e.jsx(me,{onClick:()=>{y("filter_strike_below_period_changed",{filter_type:"strike_below_period",old_value:h,new_value:null,page:"index"}),k(null)},children:"Clear Filter"}),U.map(t=>e.jsx(me,{onClick:()=>{y("filter_strike_below_period_changed",{filter_type:"strike_below_period",old_value:h,new_value:t.days,page:"index"}),k(t.days)},children:t.label},t.days))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-1 min-h-5",children:[e.jsx(Y,{children:"Risk Level"}),e.jsx(oe,{})]}),e.jsxs(G,{children:[e.jsx(X,{asChild:!0,children:e.jsxs(W,{variant:"outline",className:"min-w-[200px] justify-between",children:[u.length===0?"All Risk Levels":u.length===1?u[0]:`${u.length} levels selected`,e.jsx(se,{className:"h-4 w-4"})]})}),e.jsx(J,{className:"w-[200px] p-3 bg-background z-50",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 border-b pb-2",children:[e.jsx(K,{id:"select-all-risk",checked:u.length===q.length,onCheckedChange:t=>{const d=t?q.map(r=>r.value):[];y("filter_risk_levels_changed",{filter_type:"risk_levels",old_value:u,new_value:d,page:"index"}),E(d)}}),e.jsx("label",{htmlFor:"select-all-risk",className:"text-sm cursor-pointer font-medium",children:"Select All"})]}),q.map(t=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(K,{id:`risk-${t.value}`,checked:u.includes(t.value),onCheckedChange:d=>{const r=d?[...u,t.value]:u.filter(b=>b!==t.value);y("filter_risk_levels_changed",{filter_type:"risk_levels",old_value:u,new_value:r,page:"index"}),E(r)}}),e.jsx("label",{htmlFor:`risk-${t.value}`,className:"text-sm cursor-pointer",children:t.label})]},t.value))]})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex items-center gap-1 min-h-5",children:e.jsx(Y,{children:"Filter by Stock"})}),e.jsxs(G,{children:[e.jsx(X,{asChild:!0,children:e.jsxs(W,{variant:"outline",className:"min-w-[200px] justify-between",children:[f.length===0?"All Stocks":f.length===1?f[0]:`${f.length} stocks selected`,e.jsx(se,{className:"h-4 w-4"})]})}),e.jsx(J,{className:"w-[200px] p-3 max-h-60 overflow-y-auto bg-background z-50",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{placeholder:"Search stocks...",value:i,onChange:t=>j(t.target.value.slice(0,50)),className:"h-8",maxLength:50}),e.jsxs("div",{className:"flex items-center space-x-2 border-b pb-2",children:[e.jsx(K,{id:"select-all-stocks",checked:f.length===ee.length&&ee.length>0,onCheckedChange:t=>{const d=t?ee:[];y("filter_stocks_changed",{filter_type:"stocks",old_value:f,new_value:d,page:"index"}),B(d)}}),e.jsx("label",{htmlFor:"select-all-stocks",className:"text-sm cursor-pointer font-medium",children:"Select All"})]}),ee.map(t=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(K,{id:`stock-${t}`,checked:f.includes(t),onCheckedChange:d=>{const r=d?[...f,t]:f.filter(b=>b!==t);y("filter_stocks_changed",{filter_type:"stocks",old_value:f,new_value:r,page:"index"}),B(r)}}),e.jsx("label",{htmlFor:`stock-${t}`,className:"text-sm cursor-pointer",children:t})]},t))]})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex items-center gap-1 min-h-5",children:e.jsx(Y,{children:"Filter by Expiry Date"})}),e.jsxs(G,{children:[e.jsx(X,{asChild:!0,children:e.jsxs(W,{variant:"outline",className:"min-w-[200px] justify-between",children:[_.length===0?"All Expiry Dates":_.length===1?_[0]:`${_.length} dates selected`,e.jsx(se,{className:"h-4 w-4"})]})}),e.jsx(J,{className:"w-[200px] p-3 max-h-60 overflow-y-auto bg-background z-50",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(Z,{placeholder:"Search dates...",value:M,onChange:t=>w(t.target.value.slice(0,50)),className:"h-8",maxLength:50}),e.jsxs("div",{className:"flex items-center space-x-2 border-b pb-2",children:[e.jsx(K,{id:"select-all-expiry",checked:_.length===te.length&&te.length>0,onCheckedChange:t=>{const d=t?te:[];y("filter_expiry_changed",{filter_type:"expiry_dates",old_value:_,new_value:d,page:"index"}),A(d)}}),e.jsx("label",{htmlFor:"select-all-expiry",className:"text-sm cursor-pointer font-medium",children:"Select All"})]}),te.map(t=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(K,{id:`expiry-${t}`,checked:_.includes(t),onCheckedChange:d=>{const r=d?[..._,t]:_.filter(b=>b!==t);y("filter_expiry_changed",{filter_type:"expiry_dates",old_value:_,new_value:r,page:"index"}),A(r)}}),e.jsx("label",{htmlFor:`expiry-${t}`,className:"text-sm cursor-pointer",children:t})]},t))]})})]})]})]})]}),e.jsxs($e,{defaultValue:"table",className:"w-full",children:[e.jsxs(qe,{className:"grid w-full grid-cols-2",children:[e.jsxs(ie,{value:"table",className:"flex items-center gap-2",children:[e.jsx(Ft,{className:"h-4 w-4"}),"Table View"]}),e.jsxs(ie,{value:"charts",className:"flex items-center gap-2",children:[e.jsx(Tt,{className:"h-4 w-4"}),"Charts"]})]}),e.jsx(re,{value:"table",children:e.jsx(qt,{data:$,onRowClick:Ge,onStockClick:Xe,columnFilters:L,onColumnFiltersChange:V,sortField:O,sortDirection:R,onSortChange:(t,d)=>{H(t),z(d)},enableFiltering:!0})}),e.jsx(re,{value:"charts",children:e.jsx(Yt,{data:$})})]})]})]})};export{bs as default};
