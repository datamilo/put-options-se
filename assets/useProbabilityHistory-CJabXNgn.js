import{r as i}from"./router-C0wDHNfv.js";import{P as h}from"./csv-B1Pu-2A6.js";const P=n=>{const[c,y]=i.useState([]),[p,s]=i.useState(!0),[b,l]=i.useState(null);i.useEffect(()=>{u()},[]);const u=async()=>{try{console.log("ðŸ“¥ Starting to load probability history..."),s(!0),l(null);const t=[`https://raw.githubusercontent.com/datamilo/put-options-se/main/data/probability_history.csv?${Date.now()}`,`${window.location.origin}/put-options-sedata/probability_history.csv?${Date.now()}`];console.log("ðŸ“ Trying URLs:",t);let e=null,r=null;for(const o of t)try{if(console.log("ðŸ”— Trying probability history URL:",o),r=await fetch(o),r.ok){console.log("âœ… Successfully loaded CSV from:",o);break}else console.warn("âš ï¸ HTTP error for URL:",o,"Status:",r.status)}catch(a){console.warn("âŒ Failed to load from:",o,a),e=a}if(!r||!r.ok)throw e||new Error("Failed to load probability history from any URL");const g=await r.text();h.parse(g,{header:!0,delimiter:"|",skipEmptyLines:!0,transform:(o,a)=>typeof a=="string"&&["1_2_3_ProbOfWorthless_Weighted","ProbWorthless_Bayesian_IsoCal","1_ProbOfWorthless_Original","2_ProbOfWorthless_Calibrated","3_ProbOfWorthless_Historical_IV"].includes(a)?o===""||o===null||o===void 0?null:parseFloat(o):o,complete:o=>{console.log("âœ… Probability history CSV parsed successfully!"),console.log("ðŸ“Š Total rows loaded:",o.data.length),console.log("First row sample:",o.data[0]),o.errors.length>0&&console.warn("âš ï¸ CSV parsing errors:",o.errors),y(o.data),s(!1)},error:o=>{console.error("âŒ Error parsing probability history CSV:",o),l("Failed to parse probability history data"),s(!1)}})}catch(t){console.error("Error loading probability history data:",t),l("Failed to load probability history data"),s(!1)}},d=t=>c.filter(e=>String(e.OptionName)===t).sort((e,r)=>new Date(e.Update_date).getTime()-new Date(r.Update_date).getTime()),f=n?d(n):[];return{allData:c,optionData:f,isLoading:p,error:b,getProbabilityHistoryForOption:d}};export{P as u};
