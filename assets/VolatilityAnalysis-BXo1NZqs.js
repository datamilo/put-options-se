import{j as e,L as B,B as D,K as G,x as Y}from"./index-BVw2Pzxv.js";import{r as o,h as X}from"./router-C0wDHNfv.js";import{u as Q}from"./usePageTitle-CpPgFbZv.js";import{C as j,a as g,b as p,c as v}from"./card-Dh7Q_ijz.js";import{P as W,a as Z,C as ee,b as se,c as ae,d as te,e as le,f as ne,g as re,h as z}from"./popover-D1HvfGk3.js";import{u as ie}from"./useVolatilityData-C2pxXklU.js";import{T as ce,a as oe,b as M,c as T}from"./tabs-DAwOGdlE.js";import{R as V,B as K,C as E,X as P,Y as L,T as F,b as C}from"./charts-B8eVsusH.js";import{T as de,a as he,b as H,d as xe,e as f,c as me}from"./table-W_lzODQg.js";import{S as O,a as R,b as $,c as J,d as k}from"./select-CzhzUq9X.js";import{S as ue}from"./scroll-area-iYhE9Q-7.js";import{A as je}from"./arrow-up-down-CgXERPoI.js";import{A as U}from"./arrow-left-Co53Anaq.js";import{C as q}from"./chart-column-CueXmNrU.js";import{T as ge}from"./trending-down-wpPGQwBP.js";import"./csv-B1Pu-2A6.js";const pe=({data:d,rawData:l})=>{const y=o.useMemo(()=>d.sort((a,x)=>x.mean_abs_change-a.mean_abs_change).map(a=>({...a,mean_abs_change:a.mean_abs_change*100,mean_change:a.mean_change*100,median_change:a.median_change*100,ci95_low:a.ci95_low*100,ci95_high:a.ci95_high*100,p05:a.p05*100,p95:a.p95*100,min_change:a.min_change*100,max_change:a.max_change*100,avg_volume_pct_change:a.avg_volume_pct_change*100,avg_intraday_spread_pct:Math.abs(a.avg_intraday_spread_pct)*100})),[d]),h=y.slice(0,20),b=({active:a,payload:x,label:m})=>{if(a&&x&&x.length){const i=y.find(n=>n.name===m);return e.jsxs("div",{className:"bg-background border border-border rounded-lg shadow-lg p-3",children:[e.jsx("p",{className:"font-medium",children:m}),x.map((n,N)=>e.jsxs("div",{children:[e.jsxs("p",{style:{color:n.color},children:[n.name,": ",typeof n.value=="number"?`${n.value.toFixed(2)}%`:n.value]}),i&&n.dataKey==="min_change"&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Event: ",i.min_event_type," on ",i.min_event_date]}),i&&n.dataKey==="max_change"&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Event: ",i.max_event_type," on ",i.max_event_date]})]},N))]})}return null};return e.jsx("div",{className:"space-y-4",children:e.jsxs(ce,{defaultValue:"volatility",className:"w-full",children:[e.jsxs(oe,{className:"grid w-full grid-cols-3",children:[e.jsx(M,{value:"volatility",children:"Mean Volatility"}),e.jsx(M,{value:"distribution",children:"Distribution Metrics"}),e.jsx(M,{value:"minmax",children:"Min/Max Changes"})]}),e.jsx(T,{value:"volatility",children:e.jsxs(j,{children:[e.jsxs(g,{children:[e.jsx(p,{children:"Mean Absolute Price Change During Events"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Average absolute percentage change in closing price during corporate events"})]}),e.jsx(v,{children:e.jsx(V,{width:"100%",height:400,children:e.jsxs(K,{data:h,margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(E,{strokeDasharray:"3 3",className:"stroke-muted"}),e.jsx(P,{dataKey:"name",angle:-45,textAnchor:"end",height:100,className:"text-xs"}),e.jsx(L,{className:"text-xs",label:{value:"Percentage (%)",angle:-90,position:"insideLeft"}}),e.jsx(F,{content:e.jsx(b,{})}),e.jsx(C,{dataKey:"mean_abs_change",fill:"hsl(var(--primary))",radius:[2,2,0,0]})]})})})]})}),e.jsx(T,{value:"distribution",children:e.jsxs(j,{children:[e.jsxs(g,{children:[e.jsx(p,{children:"Price Change Distribution Metrics"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Statistical distribution of price changes: 5th percentile, median, and 95th percentile"})]}),e.jsx(v,{children:e.jsx(V,{width:"100%",height:400,children:e.jsxs(K,{data:h,margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(E,{strokeDasharray:"3 3",className:"stroke-muted"}),e.jsx(P,{dataKey:"name",angle:-45,textAnchor:"end",height:100,className:"text-xs"}),e.jsx(L,{className:"text-xs",label:{value:"Percentage (%)",angle:-90,position:"insideLeft"}}),e.jsx(F,{content:e.jsx(b,{})}),e.jsx(C,{dataKey:"p05",fill:"hsl(var(--destructive))",name:"5th Percentile"}),e.jsx(C,{dataKey:"median_change",fill:"hsl(var(--primary))",name:"Median"}),e.jsx(C,{dataKey:"p95",fill:"hsl(220, 70%, 40%)",name:"95th Percentile"})]})})})]})}),e.jsx(T,{value:"minmax",children:e.jsxs(j,{children:[e.jsxs(g,{children:[e.jsx(p,{children:"Min/Max Price Changes During Events"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Largest positive and negative percentage changes observed for each stock during events"})]}),e.jsx(v,{children:e.jsx(V,{width:"100%",height:400,children:e.jsxs(K,{data:h,margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(E,{strokeDasharray:"3 3",className:"stroke-muted"}),e.jsx(P,{dataKey:"name",angle:-45,textAnchor:"end",height:100,className:"text-xs"}),e.jsx(L,{className:"text-xs",label:{value:"Percentage (%)",angle:-90,position:"insideLeft"}}),e.jsx(F,{content:e.jsx(b,{})}),e.jsx(C,{dataKey:"min_change",fill:"hsl(var(--destructive))",name:"Min Change"}),e.jsx(C,{dataKey:"max_change",fill:"hsl(220, 70%, 40%)",name:"Max Change"})]})})})]})})]})})},ve=({data:d})=>{const[l,y]=o.useState("all"),[h,b]=o.useState("all"),[a,x]=o.useState("date"),[m,i]=o.useState("desc"),n=o.useMemo(()=>Array.from(new Set(d.map(s=>s.year))).sort((s,r)=>r-s),[d]),N=[{value:"1",label:"January"},{value:"2",label:"February"},{value:"3",label:"March"},{value:"4",label:"April"},{value:"5",label:"May"},{value:"6",label:"June"},{value:"7",label:"July"},{value:"8",label:"August"},{value:"9",label:"September"},{value:"10",label:"October"},{value:"11",label:"November"},{value:"12",label:"December"}],_=o.useMemo(()=>{let s=d;return l&&l!=="all"&&(s=s.filter(r=>r.year===parseInt(l))),h&&h!=="all"&&(s=s.filter(r=>r.month===parseInt(h))),s.sort((r,S)=>{const t=r[a],u=S[a];if(typeof t=="number"&&typeof u=="number")return m==="asc"?t-u:u-t;const w=String(t),I=String(u);return m==="asc"?w.localeCompare(I):I.localeCompare(w)})},[d,l,h,a,m]),A=s=>{a===s?i(m==="asc"?"desc":"asc"):(x(s),i("desc"))},c=({children:s,sortKey:r})=>e.jsx(me,{children:e.jsxs(D,{variant:"ghost",onClick:()=>A(r),className:"h-auto p-0 font-medium hover:bg-transparent",children:[s,e.jsx(je,{className:"ml-2 h-4 w-4"})]})});return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Year"}),e.jsxs(O,{value:l,onValueChange:y,children:[e.jsx(R,{children:e.jsx($,{placeholder:"All years..."})}),e.jsxs(J,{children:[e.jsx(k,{value:"all",children:"All years"}),n.map(s=>e.jsx(k,{value:s.toString(),children:s},s))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Month"}),e.jsxs(O,{value:h,onValueChange:b,children:[e.jsx(R,{children:e.jsx($,{placeholder:"All months..."})}),e.jsxs(J,{children:[e.jsx(k,{value:"all",children:"All months"}),N.map(s=>e.jsx(k,{value:s.value,children:s.label},s.value))]})]})]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",_.length," of ",d.length," records"]}),e.jsx(ue,{className:"h-[600px] w-full border rounded-md",children:e.jsxs(de,{children:[e.jsx(he,{children:e.jsxs(H,{children:[e.jsx(c,{sortKey:"date",children:"Date"}),e.jsx(c,{sortKey:"name",children:"Stock"}),e.jsx(c,{sortKey:"type_of_event",children:"Event Type"}),e.jsx(c,{sortKey:"event_value",children:"Event Value"}),e.jsx(c,{sortKey:"close",children:"Close Price"}),e.jsx(c,{sortKey:"volume",children:"Volume"}),e.jsx(c,{sortKey:"close_price_pct_change_from_previous_day",children:"Price Change %"}),e.jsx(c,{sortKey:"volume_pct_change_from_previous_day",children:"Volume Change %"}),e.jsx(c,{sortKey:"pct_intraday_high_low_movement",children:"Intraday Spread %"})]})}),e.jsx(xe,{children:_.map((s,r)=>{var S,t;return e.jsxs(H,{children:[e.jsx(f,{children:s.date}),e.jsx(f,{className:"font-medium",children:s.name}),e.jsx(f,{children:s.type_of_event}),e.jsx(f,{children:s.event_value!==void 0&&s.event_value!==null?Math.round(s.event_value):"N/A"}),e.jsx(f,{children:(S=s.close)==null?void 0:S.toFixed(2)}),e.jsx(f,{children:(t=s.volume)==null?void 0:t.toLocaleString("sv-SE")}),e.jsxs(f,{className:s.close_price_pct_change_from_previous_day>=0?"text-green-600":"text-red-600",children:[(s.close_price_pct_change_from_previous_day*100).toFixed(2),"%"]}),e.jsxs(f,{className:s.volume_pct_change_from_previous_day>=0?"text-green-600":"text-red-600",children:[(s.volume_pct_change_from_previous_day*100).toFixed(2),"%"]}),e.jsxs(f,{children:[(Math.abs(s.pct_intraday_high_low_movement)*100).toFixed(2),"%"]})]},r)})})]})})]})},Pe=()=>{Q("Volatility Analysis");const d=X(),{volatilityData:l,volatilityStats:y,isLoading:h,error:b}=ie(),[a,x]=o.useState([]),[m,i]=o.useState(!1),n=o.useMemo(()=>!l||l.length===0?[]:Array.from(new Set(l.map(t=>t.name))).sort(),[l]),N=o.useMemo(()=>a.length===0?l:l.filter(t=>a.includes(t.name)),[l,a]),_=o.useMemo(()=>a.length===0?y:y.filter(t=>a.includes(t.name)),[y,a]),A=t=>{x(u=>u.includes(t)?u.filter(w=>w!==t):[...u,t])};if(h)return e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading volatility analysis data..."})]})});if(b)return e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs(j,{className:"max-w-md",children:[e.jsx(g,{children:e.jsx(p,{className:"text-destructive",children:"Error Loading Data"})}),e.jsxs(v,{children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:b}),e.jsxs(D,{onClick:()=>d("/"),variant:"outline",children:[e.jsx(U,{className:"mr-2 h-4 w-4"}),"Back to Main Page"]})]})]})});const c=N.length,s=_.length>0?_.reduce((t,u)=>t+u.mean_abs_change,0)/_.length:0,r=s*100,S=_.filter(t=>t.mean_abs_change>s).length;return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("div",{className:"border-b bg-card",children:e.jsx("div",{className:"container mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(D,{onClick:()=>d("/"),variant:"ghost",size:"sm",children:[e.jsx(U,{className:"mr-2 h-4 w-4"}),"Back to Options"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Financial Reporting Volatility"}),e.jsx("p",{className:"text-muted-foreground",children:"Stock price behavior during financial reporting days"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-5 w-5 text-muted-foreground"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[c.toLocaleString("sv-SE")," events analyzed"]})]})]})})}),e.jsxs("div",{className:"container mx-auto px-4 py-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(j,{children:[e.jsxs(g,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(p,{className:"text-sm font-medium",children:"Total Events"}),e.jsx(q,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(v,{children:[e.jsx("div",{className:"text-2xl font-bold",children:c.toLocaleString("sv-SE")}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Financial reports analyzed"})]})]}),e.jsxs(j,{children:[e.jsxs(g,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(p,{className:"text-sm font-medium",children:"Average Volatility"}),e.jsx(G,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(v,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[r.toFixed(2),"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Mean absolute price change"})]})]}),e.jsxs(j,{children:[e.jsxs(g,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(p,{className:"text-sm font-medium",children:"High Volatility Stocks"}),e.jsx(ge,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(v,{children:[e.jsx("div",{className:"text-2xl font-bold",children:S}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Above average volatility"})]})]})]}),e.jsxs(j,{children:[e.jsxs(g,{children:[e.jsx(p,{children:"Filter by Stock"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Select one or more stocks to analyze (default: all stocks)"})]}),e.jsx(v,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Stock Selection"}),e.jsxs(W,{open:m,onOpenChange:i,children:[e.jsx(Z,{asChild:!0,children:e.jsxs(D,{variant:"outline",role:"combobox","aria-expanded":m,className:"w-full justify-between",children:[a.length===0?"All stocks":a.length===1?a[0]:`${a.length} stocks selected`,e.jsx(ee,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(se,{className:"w-full p-0",align:"start",children:e.jsxs(ae,{children:[e.jsx(te,{placeholder:"Search stocks..."}),e.jsxs(le,{children:[e.jsx(ne,{children:"No stock found."}),e.jsxs(re,{children:[e.jsxs(z,{onSelect:()=>{x([]),i(!1)},children:[e.jsx(Y,{className:`mr-2 h-4 w-4 ${a.length===0?"opacity-100":"opacity-0"}`}),"All stocks"]}),n.map(t=>e.jsxs(z,{onSelect:()=>A(t),children:[e.jsx(Y,{className:`mr-2 h-4 w-4 ${a.includes(t)?"opacity-100":"opacity-0"}`}),t]},t))]})]})]})})]})]})})]}),e.jsxs(j,{children:[e.jsxs(g,{children:[e.jsx(p,{children:"Volatility Statistics Visualization"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Interactive charts showing price volatility patterns during financial reporting days"})]}),e.jsx(v,{children:e.jsx(pe,{data:_,rawData:N})})]}),e.jsxs(j,{children:[e.jsxs(g,{children:[e.jsx(p,{children:"Event Data Details"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Complete event-by-event data with filtering and sorting capabilities"})]}),e.jsx(v,{children:e.jsx(ve,{data:N})})]})]})]})};export{Pe as VolatilityAnalysis};
